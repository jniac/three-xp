(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6449,8181],{2210:(e,t,r)=>{"use strict";r.d(t,{d:()=>A});var i=r(28535),s=r(76999),n=r(57368),o=r(66066),a=r(15940),l=r(77674),c=r(49797),h=r(94065);let d=new c.kn4;function u(e,t){let{scale:{x:r,y:i,z:s},scaleFactor:n,shear:{x:o,y:a,z:l}}=e;t.makeRotationFromQuaternion(e.quaternion),t.multiply(d.set(1,o,a,0,0,1,l,0,0,0,1,0,0,0,0,1)),t.elements[0]*=r*n,t.elements[1]*=r*n,t.elements[2]*=r*n,t.elements[4]*=i*n,t.elements[5]*=i*n,t.elements[6]*=i*n,t.elements[8]*=s*n,t.elements[9]*=s*n,t.elements[10]*=s*n,t.setPosition(e.position)}let p=new c.Pq0,m=new c.Pq0,f=new c.Pq0,x=new c.Pq0,g=new c.Pq0,y=new c.Pq0,v=new c.Pq0;function w(e,t){let r=e.elements;t.position.set(r[12],r[13],r[14]),p.set(r[0],r[1],r[2]),m.set(r[4],r[5],r[6]),f.set(r[8],r[9],r[10]);let i=0>p.dot(x.crossVectors(m,f))?-1:1,s=p.length();g.copy(p).divideScalar(s);let n=g.dot(m);y.copy(m).addScaledVector(g,-n);let o=y.length();y.divideScalar(o);let a=g.dot(f),l=y.dot(f);v.copy(f).addScaledVector(g,-a).addScaledVector(y,-l);let c=v.length();v.divideScalar(c),i<0&&g.negate(),t.quaternion.setFromRotationMatrix(d.makeBasis(g,y,v)),t.scale.set(i*s,o,c),t.scaleFactor=1,t.shear.set(i*n/o,i*a/c,l/c)}function b(e,t){let{resetMissing:r=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return void 0!==e.position?(0,h.jj)(e.position,t.position):r&&t.position.set(0,0,0),void 0!==e.quaternion?(0,h.EC)(e.quaternion,t.quaternion):void 0!==e.rotation?t.quaternion.setFromEuler((0,h.if)(e.rotation)):r&&t.quaternion.set(0,0,0,1),void 0!==e.scale?(0,h.jj)(e.scale,t.scale):r&&t.scale.set(1,1,1),void 0!==e.scaleFactor?t.scaleFactor=e.scaleFactor:r&&(t.scaleFactor=1),void 0!==e.shear?(0,h.jj)(e.shear,t.shear):r&&t.shear.set(0,0,0),t}function j(e,t,r,i){i.position.lerpVectors(e.position,t.position,r),i.quaternion.slerpQuaternions(e.quaternion,t.quaternion,r),i.scale.lerpVectors(e.scale,t.scale,r),i.scaleFactor=e.scaleFactor+(t.scaleFactor-e.scaleFactor)*r,i.shear.lerpVectors(e.shear,t.shear,r)}function P(){return{position:new c.Pq0,quaternion:new c.PTz,scale:new c.Pq0(1,1,1),scaleFactor:1,shear:new c.Pq0}}let M=new c.kn4,S=P(),z=P(),k=P();var q=new WeakMap,C=new WeakSet;class A{static lerp(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(0,l._)(A,A,T);return b(e,S),b(t,z),j(S,z,r,i),i}static from(e){return new this().from(e)}get rotation(){return(0,o._)(this,C,N).call(this)}copy(e){return this.position.copy(e.position),this.scale.copy(e.scale),this.quaternion.copy(e.quaternion),this.shear.copy(e.shear),this}clone(){return(new this.constructor).copy(this)}toMatrix(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new c.kn4;return u(this,e),e}from(e){return e instanceof c.kn4?w(e,this):b(e,this),this}setTransform(e){let{partial:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return b(e,this,{resetMissing:!t}),this}lerpTransforms(e,t,r){return j(e,t,r,this),this}lerp(e,t){return j(this,e,t,this),this}identity(){return this.position.set(0,0,0),this.quaternion.set(0,0,0,1),this.scale.set(1,1,1),this.shear.set(0,0,0),this}isIdentity(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e-6;return this.position.lengthSq()<=e&&Math.abs(this.quaternion.x)<=e&&Math.abs(this.quaternion.y)<=e&&Math.abs(this.quaternion.z)<=e&&Math.abs(this.quaternion.w-1)<=e&&Math.abs(this.scale.x-1)<=e&&Math.abs(this.scale.y-1)<=e&&Math.abs(this.scale.z-1)<=e&&Math.abs(this.shear.x)<=e&&Math.abs(this.shear.y)<=e&&Math.abs(this.shear.z)<=e}isDirect(){let{x:e,y:t,z:r}=this.scale;return e*t*r>=0}toInfoString(){let{x:e,y:t,z:r}=this.position,{x:i,y:s,z:n}=this.scale,{x:o,y:a,z:l}=this.shear,c=this.scaleFactor,h=e=>e.toFixed(2).replace(/\.?0+$/,"");return"Position: (".concat(h(e),", ").concat(h(t),", ").concat(h(r),"), Scale: (").concat(h(i),", ").concat(h(s),", ").concat(h(n),")x(").concat(h(c),"), Shear: (").concat(h(o),", ").concat(h(a),", ").concat(h(l),")")}constructor(){(0,a._)(this,C),(0,s._)(this,q,{writable:!0,value:void 0}),this.position=new c.Pq0,this.scale=new c.Pq0(1,1,1),this.scaleFactor=1,this.quaternion=new c.PTz,this.shear=new c.Pq0,(0,n._)(this,q,null)}}A.lerpMatrixes=function(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return w(e,S),w(t,z),j(S,z,r,k),u(k,i),i};var T={writable:!0,value:new A};function N(){if(null===(0,i._)(this,q)){let e=new c.O9p().setFromQuaternion(this.quaternion);return e._onChangeCallback=()=>{this.quaternion.setFromEuler(e)},(0,n._)(this,q,e)}return(0,i._)(this,q)}},4076:(e,t,r)=>{"use strict";r.d(t,{Client:()=>b,X:()=>g});var i=r(70691),s=r(33540),n=r(77794),o=r(79911),a=r(67235),l=r(28737),c=r(79285),h=r(4941),d=r(38062),u=r(49797),p=r(69621),m=r(12033),f=r(31763);function x(){return(0,i.jsxs)(p.kE,{children:[(0,i.jsx)("h1",{className:"text-2xl font-bold mb-8",children:"Decompose Matrix4 with Shear"}),(0,i.jsx)(p.$n,{label:"Orthographic (reset)",onClick:()=>{a.Q.send(f.n).assertPayload().vertigo.set({perspective:0,zoom:1,focus:0,rotation:[0,0,0]})}}),(0,i.jsx)(p.$n,{label:"Perspective",onClick:()=>{a.Q.send(f.n).assertPayload().vertigo.set({perspective:1})}}),(0,i.jsx)(p.$n,{label:"Toggle Rotation",onClick:()=>{let e=a.Q.send(g).payload;e&&(e.rotate=!e.rotate)}})]})}class g{constructor(){this.rotate=!1,a.Q.on(g,e=>e.setPayload(this))}}function y(){return(0,s.dB)("my-test-1",function*(e,t){let r=(0,m.l1)({position:[-2,4,0],scale:[1,2,3],shear:[.1,.2,.3]}),i=m.W.transformToTransform(r),s=(0,o.mj)(new p.QT(i?"white":"red"),e);s.matrixAutoUpdate=!1,(0,m.Nb)(r,s.matrix);let n=(0,m.Ez)(s.matrix);console.log(n.position),console.log(n.scale),console.log(new u.O9p().setFromQuaternion(n.rotation)),console.log(n.shear);let a=(0,o.mj)(new p.QT("yellow"),e);a.matrixAutoUpdate=!1,(0,m.Nb)(n,a.matrix)},[]),null}function v(){return(0,s.dB)("my-test-2",function*(e,t){let r=[(0,m.l1)({position:[-2,-4,0],scale:[2,4,1],euler:[1,0,2],shear:[1,.5,.1]}),(0,m.l1)({position:[2,-4,0],scale:[4,1,2],euler:[0,1,-1],shear:[-.5,1,.25]})],i=new g,[s,n]=r.map(t=>{let r=(0,o.mj)(new p.QT,e);r.matrixAutoUpdate=!1;let s=1,n=()=>{(0,m.Nb)(t,r.matrix)};return n(),r.onTick=e=>{i.rotate&&(s+=e.deltaTime),n()},r}),a=(0,o.mj)(new p.QT("yellow"),e),l=(0,m.Ez)(s.matrix),u=(0,m.Ez)(n.matrix),f=(0,m.Ez)(a.matrix);yield t.ticker.onTick(e=>{let t=d.o.triangle(e.time,{frequency:1/4});t=(0,c.inverseLerp)(.05,.95,t),t=h.kY.inOut2(t),(0,m.$N)(l,u,t,f),a.matrixAutoUpdate=!1,a.matrix=(0,m.Nb)(f,a.matrix)})},[]),null}function w(){return(0,s.Fw)(function*(e){e.pipeline.basicPasses.fxaa.enabled=!1}),(0,s.dB)("my-settings",function*(e,t){(0,o.mj)(new n.u,e).regularGrid({size:12,subdivisions:[2,6],opacity:[1,.1]})},[]),null}function b(){return(0,i.jsxs)(s.uB,{vertigoControls:{eventTarget:"canvas",size:12,zoom:.7,rotation:["8deg","12deg","0deg"],focus:[0,0,.5]},children:[(0,i.jsx)(l.Leak,{}),(0,i.jsx)(w,{}),(0,i.jsx)(y,{}),(0,i.jsx)(v,{}),(0,i.jsx)(x,{})]})}},4941:(e,t,r)=>{"use strict";r.d(t,{_5:()=>s.ol,YN:()=>s.o8,cz:()=>n,kY:()=>s.kY});var i=r(37197),s=r(40074);let n={transition:s.kY,bump:i.$p}},12033:(e,t,r)=>{"use strict";r.d(t,{$N:()=>a,Ez:()=>o,Nb:()=>n,W:()=>c,l1:()=>l});var i=r(94065),s=r(49797);function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s.kn4,{position:r,rotation:i,scale:n,shear:o}=e,a=new s.kn4().makeScale(n.x,n.y,n.z),l=new s.kn4().set(1,o.xy,o.xz,0,0,1,o.yz,0,0,0,1,0,0,0,0,1),c=new s.kn4().makeRotationFromQuaternion(i),h=new s.kn4().makeTranslation(r.x,r.y,r.z);return t.identity(),t.multiply(c),t.multiply(l),t.multiply(a),t.premultiply(h),t}function o(e){let t=e.elements,r=new s.Pq0(t[12],t[13],t[14]);new s.kn4().set(t[0],t[4],t[8],0,t[1],t[5],t[9],0,t[2],t[6],t[10],0,0,0,0,1);let i=new s.Pq0(t[0],t[1],t[2]),n=new s.Pq0(t[4],t[5],t[6]),o=new s.Pq0(t[8],t[9],t[10]),a=0>i.dot(new s.Pq0().crossVectors(n,o))?-1:1,l=i.length(),c=i.clone().divideScalar(l),h=c.dot(n),d=n.clone().addScaledVector(c,-h),u=d.length(),p=d.divideScalar(u),m=c.dot(o),f=p.dot(o),x=o.clone().addScaledVector(c,-m).addScaledVector(p,-f),g=x.length(),y=x.divideScalar(g);a<0&&c.negate();let v=new s.kn4().makeBasis(c,p,y);return{position:r,rotation:new s.PTz().setFromRotationMatrix(v),scale:new s.Pq0(a*l,u,g),shear:{xy:h/u,xz:m/g,yz:f/g}}}function a(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{position:new s.Pq0,rotation:new s.PTz,scale:new s.Pq0,shear:{xy:0,xz:0,yz:0}};return i.position.lerpVectors(e.position,t.position,r),i.rotation.slerpQuaternions(e.rotation,t.rotation,r),i.scale.lerpVectors(e.scale,t.scale,r),i.shear.xy=e.shear.xy+(t.shear.xy-e.shear.xy)*r,i.shear.xz=e.shear.xz+(t.shear.xz-e.shear.xz)*r,i.shear.yz=e.shear.yz+(t.shear.yz-e.shear.yz)*r,i}function l(){let{position:e=0,euler:t=[0,0,0],scale:r=1,shear:n=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[o,a,l]=(0,i.jj)(n);return{position:(0,i.jj)(e),rotation:new s.PTz().setFromEuler((0,i.if)(t)),scale:(0,i.jj)(r),shear:{xy:o,xz:a,yz:l}}}class c{static matrixToMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-12,r=n(o(e));for(let i=0;i<16;i++)if(Math.abs(e.elements[i]-r.elements[i])>t)return!1;return!0}static transformToTransform(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-12,r=o(n(e));return!(e.position.distanceTo(r.position)>t||1-Math.abs(e.rotation.dot(r.rotation))>t||e.scale.distanceTo(r.scale)>t||Math.abs(e.shear.xy-r.shear.xy)>t||Math.abs(e.shear.xz-r.shear.xz)>t||Math.abs(e.shear.yz-r.shear.yz)>t)}}},13160:(e,t,r)=>{"use strict";r.d(t,{Q:()=>n});var i=r(49797),s=r(94065);class n{static setColor(e,t){let r=e.attributes.position.count,s=new i.THS(new Float32Array(3*r),3),{r:n,g:o,b:a}=new i.Q1f(t);for(let e=0;e<r;e++)s.setXYZ(e,n,o,a);return e.setAttribute("color",s),e}static setAsBounds(e,t,r){let{x:n,y:o,z:a}=(0,s.jj)(t),{x:l,y:c,z:h}=(0,s.jj)(r),d=new Float32Array([n,o,a,l,o,a,l,o,a,l,c,a,l,c,a,n,c,a,n,c,a,n,o,a,n,o,h,l,o,h,l,o,h,l,c,h,l,c,h,n,c,h,n,c,h,n,o,h,n,o,a,n,o,h,l,o,a,l,o,h,l,c,a,l,c,h,n,c,a,n,c,h]);return null!=e||(e=new i.LoY),e.setAttribute("position",new i.THS(d,3)),e.computeBoundingBox(),e.computeBoundingSphere(),e}}},15931:(e,t,r)=>{"use strict";r.d(t,{P:()=>a});var i=r(49797),s=r(94065),n=r(7147);let o={color:"white",opacity:.5,plane:"XY",size:[8,8],step:1,frame:!0,depthOffset:0};class a extends i.DXC{set(e){let{color:t,opacity:r,size:n,step:a,frame:l,plane:c,depthOffset:h}={...o,...e},d=(0,s.wX)(n),u=(0,s.wX)(null!=a?a:d),p=[],m=(e,t)=>p.push(new i.Pq0(e,t,0));l&&(m(-d.x/2,d.y/2),m(d.x/2,d.y/2),m(d.x/2,d.y/2),m(d.x/2,-d.y/2),m(d.x/2,-d.y/2),m(-d.x/2,-d.y/2),m(-d.x/2,-d.y/2),m(-d.x/2,d.y/2));let f=Math.ceil(-d.x/2/u.x)*u.x;f===-d.x/2&&(f+=u.x);do m(f,-d.y/2),m(f,d.y/2),f+=u.x;while(f<d.x/2);let x=Math.ceil(-d.y/2/u.y)*u.y;x===-d.y/2&&(x+=u.y);do m(-d.x/2,x),m(d.x/2,x),x+=u.y;while(x<d.y/2);switch(this.geometry.setFromPoints(p),c){case"XZ":this.geometry.rotateX(Math.PI/2);break;case"YZ":this.geometry.rotateY(Math.PI/2)}return this.uniforms.uDepthOffset.value=h,this.material.color.set(t),this.material.opacity=r,this.material.transparent=r<1,this}constructor(e){let t=new i.mrM,r={uDepthOffset:{value:0}};t.onBeforeCompile=e=>n.bI.with(e).uniforms(r).vertex.mainAfterAll("\n        gl_Position.w += uDepthOffset;\n      "),super(void 0,t),this.uniforms=r,this.set(null!=e?e:o)}}},16465:(e,t,r)=>{"use strict";r.d(t,{Y:()=>o});var i=r(49797),s=r(7147);let n={shadowColor:"#808080",luminosity:1,rampPower:1,onBeforeCompile:void 0};class o extends i.V9B{constructor(e){let{rampPower:t,shadowColor:r,luminosity:o,onBeforeCompile:a,...l}={...n,...e},c={uSunPosition:{value:new i.Pq0(.5,.7,.3)},uShadowColor:{value:new i.Q1f(r)},uRampPower:{value:t},uLuminosity:{value:o}};super(l),this.onBeforeCompile=e=>{s.bI.with(e).uniforms(c).varying({vAutoLitWorldNormal:"vec3"}).vertex.mainAfterAll("\n          vAutoLitWorldNormal = mat3(modelMatrix) * normal;\n          #ifdef USE_INSTANCING\n            vAutoLitWorldNormal = mat3(instanceMatrix) * vAutoLitWorldNormal;\n          #endif\n        ").fragment.after("map_fragment","\n          vec3 normal = normalize(vAutoLitWorldNormal);\n          vec3 lightDirection = normalize(uSunPosition);\n          float light = dot(normal, lightDirection) * 0.5 + 0.5;\n          light = pow(light, uRampPower);\n          diffuseColor.rgb *= mix(uShadowColor * uLuminosity, vec3(1.0), light);\n        "),null==a||a(e)},this.sunPosition=c.uSunPosition.value}}},18397:(e,t,r)=>{"use strict";r.d(t,{Client:()=>f});var i=r(70691),s=r(49797),n=r(33540),o=r(77794),a=r(79911),l=r(80446),c=r(69621),h=r(12033),d=r(31763),u=r(67235);function p(){return(0,i.jsxs)(c.kE,{children:[(0,i.jsx)("h1",{className:"text-2xl font-bold mb-8",children:"Some Shear Examples"}),(0,i.jsx)(c.$n,{label:"Orthographic (reset)",onClick:()=>{u.Q.send(d.n).assertPayload().vertigo.set({perspective:0,zoom:1,rotation:[0,0,0]})}}),(0,i.jsx)(c.$n,{label:"Perspective",onClick:()=>{u.Q.send(d.n).assertPayload().vertigo.set({perspective:1})}}),(0,i.jsxs)("p",{className:"max-w-sm",children:["Using ",(0,i.jsx)("code",{children:"TransformWithShear"})," from ",(0,i.jsx)("code",{children:"some-utils-three/experimental/transform-with-shear"}),"."]})]})}function m(){return(0,n.Fw)(function*(e){e.pipeline.basicPasses.fxaa.enabled=!1}),(0,n.dB)("my-scene",function*(e,t){(0,a.mj)(new o.u,e).regularGrid({size:12,subdivisions:[2,6],opacity:[1,.1]});let r=[{x:-5,y:3,z:0,xy:1,xz:0,yz:0},{x:-2,y:3,z:0,xy:0,xz:1,yz:0},{x:-3,y:1,z:0,xy:0,xz:0,yz:1},{x:1,y:4,z:0,xy:1,xz:1,yz:0},{x:4,y:3,z:0,xy:0,xz:1,yz:1},{x:1,y:1,z:0,xy:1,xz:0,yz:1}];for(let{x:t,y:i,z:n,xy:o,xz:l,yz:d}of r){let r={position:new s.Pq0(t,i,n),scale:new s.Pq0(1,1,1),rotation:new s.PTz,shear:{xy:o,xz:l,yz:d}},u=h.W.transformToTransform(r),p=(0,a.mj)(new c.QT(u?"white":"red"),e);p.matrixAutoUpdate=!1,(0,h.Nb)(r,p.matrix)}for(let{x:t,y:i,z:n,xy:o,xz:d,yz:u}of(l.n.setRandom("parkmiller",5678),r)){let r={position:new s.Pq0(t,i-6,n),scale:new s.Pq0(l.n.number(.1,2),l.n.number(.1,2),l.n.number(.1,2)),rotation:l.n.quaternion(new s.PTz),shear:{xy:o,xz:d,yz:u}},p=h.W.transformToTransform(r),m=(0,a.mj)(new c.QT(p?"white":"red"),e);m.matrixAutoUpdate=!1,(0,h.Nb)(r,m.matrix)}},[]),null}function f(){return(0,i.jsxs)(n.uB,{vertigoControls:{eventTarget:"canvas",size:12,zoom:.7,rotation:["15deg","20deg","0deg"],focus:[0,0,.5]},children:[(0,i.jsx)(m,{}),(0,i.jsx)(p,{})]})}},22273:(e,t,r)=>{"use strict";r.d(t,{PageClient:()=>h});var i=r(70691),s=r(18479),n=r(36508);function o(e){let{name:t="default",progress:r=0,className:s=""}=e;return(0,i.jsxs)("div",{className:"".concat(s," ProgressBar relative w-full h-5 bg-[#fff6] rounded-lg overflow-hidden"),children:[(0,i.jsx)("div",{className:"ProgressBarFill w-1/2 h-full bg-[white]",style:{width:"".concat((100*r).toFixed(2),"%")}}),(0,i.jsx)("div",{className:"absolute inset-0 flex flex-row px-2 text-black text-xs items-center justify-between",children:t})]})}function a(e){let{className:t="",...r}=e;return(0,i.jsx)("button",{className:"text-xs border border-white/20 rounded px-2 py-1 hover:bg-white/10 ".concat(t),...r})}function l(e){let{name:t=null,ticker:r={}}=e,l=t?n.Rv.get(t).set(r):n.Rv.current(),{ref:c}=(0,s.useEffects)(function*(e){let t=e.querySelector(".TickerInfo"),r=e.querySelector(".InactivityProgress .ProgressBarFill"),i=e.querySelector(".InactivityTimeScale .ProgressBarFill");yield l.onTick(e=>{t.textContent="f: ".concat(e.frame," t: ").concat(e.time.toFixed(2),"s dt: ").concat(e.deltaTime.toFixed(4),"s"),r.style.width="".concat((100*e.inactivityProgress).toFixed(2),"%"),i.style.width="".concat((100*e.inactivityTimeScale).toFixed(2),"%")})},[]);return(0,i.jsxs)("div",{ref:c,className:"w-[280px] p-4 border border-white/20 rounded flex flex-col gap-2",children:[(0,i.jsxs)("h2",{children:["Ticker: ",t]}),(0,i.jsx)("div",{className:"TickerInfo text-xs font-mono pre",children:"f: -- t: --s dt: --s"}),(0,i.jsx)(o,{className:"InactivityProgress",name:"Inactivity Progress"}),(0,i.jsx)(o,{className:"InactivityTimeScale",name:"Inactivity TimeScale"}),(0,i.jsx)(a,{onClick:()=>{l.requestActivation()},children:"Request Activation"})]})}var c=r(18461);function h(){let{ref:e}=(0,s.useEffects)(function*(e){let t=new c.$().set({drag:.99999,position:241.2037501114879,velocity:2498.8246366542717}),r=e.querySelector("#drag-mobile-position");yield(0,n.xy)(e=>{t.update(e.deltaTime),r.textContent=t.position.toFixed(6)})},[]);return(0,i.jsxs)("div",{ref:e,className:"page flex flex-col gap-8 p-16",children:[(0,i.jsx)("h1",{children:"Drag Mobile Debug Page"}),(0,i.jsx)(l,{}),(0,i.jsxs)("div",{children:["DragMobile.position: ",(0,i.jsx)("span",{id:"drag-mobile-position",children:"0"})]})]})}},34011:(e,t,r)=>{"use strict";r.d(t,{e:()=>l,k:()=>h});var i=r(49797),s=r(38921);let n={axis:"x",length:1,radialSegments:12,radius:.01,coneRatio:.1,radiusScale:1,vertexColor:!0,baseCap:"flat",color:"white",align:0,heightSegments:1},o=new i.Q1f;function a(e){let{axis:t,length:r,radius:a,radialSegments:l,heightSegments:c,coneRatio:h,radiusScale:d,vertexColor:u,baseCap:p,color:m,align:f}={...n,...e},x=a*d,g=r*h,y=Math.max(1,Math.ceil(c*h)),v=Math.max(1,Math.ceil(c*(1-h))),w=new i.qFE(3*x,g,l,y),b=new i.Ho_(x,x,1,l,v,!0),j=r-g,P=r-.5*g;w.rotateZ(-Math.PI/2).translate(P,0,0),b.scale(1,j,1).rotateZ(-Math.PI/2).translate(.5*j,0,0);let M="none"===p?new i.LoY:"flat"===p?new i.tcD(x,l).rotateY(-Math.PI/2):new i.Gu$(x,l,3,0,2*Math.PI,0,.5*Math.PI).rotateZ(Math.PI/2).rotateX(Math.PI/2),S=(0,s.pP)([w,b,M]);switch(0!==f&&S.translate(-r*f,0,0),t){case"y":S.rotateZ(Math.PI/2);break;case"z":S.rotateY(-Math.PI/2)}if(u){let e=S.attributes.position.count,t=new i.THS(new Float32Array(3*e),3);S.setAttribute("color",t),o.set(m);for(let r=0;r<e;r++)t.setXYZ(r,o.r,o.g,o.b)}return S}class l extends i.LoY{constructor(e){super();let t=a(e);this.copy(t),t.dispose()}}let c={xColor:"#ff3333",yColor:"#33cc66",zColor:"#3366ff"};class h extends i.LoY{static get defaultOptions(){return{...c}}constructor(e){super();let{xColor:t,yColor:r,zColor:i,...n}={...c,...e},o=a({...n,axis:"x",color:t}),l=a({...n,axis:"y",color:r}),h=a({...n,axis:"z",color:i}),d=(0,s.pP)([o,l,h]);this.copy(d),d.dispose()}}},34125:(e,t,r)=>{"use strict";r.d(t,{ServerProof:()=>o});var i=r(70691),s=r(67203);let n=function(){return(0,i.jsx)("div",{className:"w-full h-full flex flex-col items-center justify-center",children:"loading..."})};function o(){let[,e]=(0,s.useState)(0);return(0,s.useEffect)(()=>{let t=!0;return Promise.all([r.e(5611),r.e(6564),r.e(7962),r.e(7953),r.e(146),r.e(2294)]).then(r.bind(r,52294)).then(r=>{t&&(n=r.ChooseOne,e(Math.random()))}),()=>{t=!1}},[]),(0,i.jsx)("div",{className:"flex flex-col gap-2",children:(0,i.jsx)("div",{className:"absolute-through",children:(0,i.jsx)(n,{})})})}},37833:(e,t,r)=>{"use strict";r.d(t,{Client:()=>j,X:()=>v});var i=r(70691),s=r(49797),n=r(33540),o=r(2210),a=r(77794),l=r(79911),c=r(79285),h=r(4941),d=r(38062),u=r(67235),p=r(36508),m=r(28737),f=r(69621),x=r(31763);function g(){return(0,i.jsxs)(f.kE,{children:[(0,i.jsx)("h1",{className:"text-2xl font-bold mb-8",children:"Some Shear Examples"}),(0,i.jsx)(f.$n,{label:"Orthographic (reset)",onClick:()=>{u.Q.send(x.n).assertPayload().vertigo.set({perspective:0,zoom:1,rotation:[0,0,0]})}}),(0,i.jsx)(f.$n,{label:"Perspective",onClick:()=>{u.Q.send(x.n).assertPayload().vertigo.set({perspective:1})}}),(0,i.jsx)(f.$n,{label:"Negate Matrix",onClick:()=>{let e=u.Q.send(v).payload;e&&(e.negateMatrix=!e.negateMatrix)}}),(0,i.jsxs)("p",{className:"mt-4",children:["Using ",(0,i.jsx)("code",{children:"TransformWithShear"})," from ",(0,i.jsx)("code",{children:"some-utils-three/experimental/transform-with-shear"}),"."]}),(0,i.jsxs)("p",{children:["The ",(0,i.jsx)("span",{className:"text-yellow-500",children:"yellow object"})," is defined by position, rotation, scale, and shear (transform props)."]}),(0,i.jsxs)("p",{children:["The ",(0,i.jsx)("span",{className:"text-cyan-500",children:"cyan object"})," is defined by basis vectors (matrix), transform is inferred from matrix."]}),(0,i.jsx)("p",{children:'Works with reflections too (try clicking "Negate Matrix" button).'})]})}class y extends f.QT{setTransform(e){return this.transform.from(e),this.transform.toMatrix(this.matrix),this}constructor(e="white"){super(e),this.transform=new o.d,this.matrixAutoUpdate=!1}}class v{constructor(){this.negateMatrix=!1,u.Q.on(v,e=>e.setPayload(this))}}function w(){return(0,n.dB)("my-test-1",function*(e,t){let r=new v,i=(0,l.mj)(new y("yellow"),e).setTransform({position:[-2,-3,-1],scale:[3,2,1],rotation:["30deg","-120deg","10deg"],shear:[.1,.2,.3]}),n=(0,l.mj)(new y("cyan"),e),o=(0,l.mj)(new y("white"),e);yield(0,p.xy)("three",e=>{let t=new s.Pq0(0,1,-.5),a=new s.Pq0(0,.5,3),l=new s.Pq0(2.5,0,.5);r.negateMatrix&&l.negate(),n.matrix.makeBasis(t,a,l).setPosition(new s.Pq0(1,2,-1)),n.transform.from(n.matrix);let u=h.kY.inOut4((0,c.inverseLerp)(.05,.95,d.o.triangle(e.time,{f:.2})));o.transform.lerpTransforms(i.transform,n.transform,u),o.transform.toMatrix(o.matrix)})},[]),null}function b(){return(0,n.Fw)(function*(e){e.pipeline.basicPasses.fxaa.enabled=!1}),(0,n.dB)("my-settings",function*(e,t){(0,l.mj)(new a.u,e).regularGrid({size:12,subdivisions:[2,6],opacity:[1,.1]})},[]),null}function j(){return(0,i.jsxs)(n.uB,{vertigoControls:{eventTarget:"canvas",size:12,zoom:.7,rotation:["8deg","12deg","0deg"],focus:[0,0,.5]},children:[(0,i.jsx)(m.Leak,{}),(0,i.jsx)(b,{}),(0,i.jsx)(w,{}),(0,i.jsx)(g,{})]})}},48181:(e,t,r)=>{"use strict";r.d(t,{R:()=>u});var i=r(49797),s=r(20487),n=r(72612),o=r(94065);let a=new i.I9Y,l=new i.Pq0,c=new i.kn4;function*h(e){let t=new WeakSet;for(let r of e)t.has(r)||(t.add(r),yield r)}function d(e,t,r,i,s){if(null==r?void 0:r.transform)for(let e of((0,o.vl)(r.transform,c),h(t)))e.applyMatrix4(c);if((null==r?void 0:r.color)!==void 0&&e.color(r.color),i){for(let r=0;r<t.length-1;r++)e.points.push(t[r],t[r+1]);s&&e.points.push(t[t.length-1],t[0])}else e.points.push(...t)}class u extends i.DXC{addTo(e){return e?e.add(this):this.removeFromParent(),this}*uniquePoints(){yield*h(this.points)}opacity(e){return this.material.opacity=e,this.material.transparent=this.state.forceTransparent||e<1,this.material.depthWrite=e>=1,this.material.needsUpdate=!0,this}color(e){return this.colors.set(this.points.length,new i.Q1f(e)),this}forceTransparent(){return this.state.forceTransparent=!0,this.material.transparent=!0,this}translate(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[i,s,n]=1===t.length?(0,o.jj)(t[0],l):t;for(let e of this.uniquePoints())e.x+=i,e.y+=s,e.z+=n;return this}rescale(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[i,s,n]=1===t.length?(0,o.jj)(t[0],l):t;for(let e of this.uniquePoints())e.x*=i,e.y*=s,e.z*=n;return this}showOccludedLines(){let{opacity:e=.2}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new i.mrM({color:this.material.color,transparent:!0,depthFunc:i.K52,opacity:e}),r=new i.DXC(this.geometry,t);return this.add(r),this}clear(){return this.points.length=0,this.colors.clear(),this.geometry.setDrawRange(0,0),this}draw(){if(!1===this.state.hasAlreadyBeenRendered&&-1===this.state.reservePoints)this.geometry.setFromPoints(this.points),this.geometry.setDrawRange(0,this.points.length),this.state.reservePoints=this.points.length;else{let{position:e}=this.geometry.attributes;e||(e=new i.THS(new Float32Array(3*this.state.reservePoints),3),this.geometry.setAttribute("position",e));let t=this.points.length;t>e.count&&(console.warn("LineHelper: The number of points (".concat(t,") is greater than the reserved points (").concat(e.count,").")),t=e.count),this.geometry.setDrawRange(0,t);for(let r=0;r<t;r++){let{x:t,y:i,z:s}=this.points[r];e.setXYZ(r,t,i,s)}e.needsUpdate=!0}if(this.geometry.computeBoundingSphere(),this.material.vertexColors=this.colors.size>0,this.material.needsUpdate=!0,this.colors.size>0){var e;let{color:t}=this.geometry.attributes;t||(t=new i.THS(new Float32Array(3*this.geometry.attributes.position.count),3),this.geometry.setAttribute("color",t));let r=new i.Q1f(null!=(e=this.colors.get(0))?e:"white"),s=this.points.length;for(let e=0;e<s;e++){let i=this.colors.get(e);i&&r.copy(i),t.setXYZ(e,r.r,r.g,r.b)}t.needsUpdate=!0}return this}line(e,t,r){return d(this,[(0,o.jj)(e),(0,o.jj)(t)],r),this}capsule2(e,t,r,s){let a=(0,o.jj)(e),l=(0,o.jj)(t),c=new i.Pq0().subVectors(l,a),h=c.length(),u=c.clone().divideScalar(h),p=new i.Pq0(-u.y,u.x);return d(this,[...(0,n.loopArray)(24,e=>{let t=e.p*Math.PI;return a.clone().addScaledVector(p,r*Math.cos(t)).addScaledVector(u,-r*Math.sin(t))}),...(0,n.loopArray)(24,e=>{let t=e.p*Math.PI;return l.clone().addScaledVector(p,-r*Math.cos(t)).addScaledVector(u,r*Math.sin(t))})],s,!0,!0),this}polygon(e,t){let r=e.map(e=>(0,o.jj)(e)),i=[];for(let e=0;e<r.length;e++)i.push(r[e],r[(e+1)%r.length]);return d(this,i,t),this}polyline(e,t){let r=e.map(e=>(0,o.jj)(e)),i=[];for(let e=0;e<r.length-1;e++)i.push(r[e],r[e+1]);return d(this,i,t),this}circle(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let{x:s,y:n,z:l,radius:c,segments:h,plane:p,...m}={...u.circleDefaultOptions,...(()=>{if(t.length>1){let[e,r,i]=t,{x:s,y:n}=(0,o.wX)(e,a);return{x:s,y:n,radius:r,...i}}return t[0]})()},f=new i.Pq0(1,0,0),x=new i.Pq0(0,1,0),g=[];for(let e=0;e<h;e++){let t=e/h*Math.PI*2,r=(e+1)/h*Math.PI*2,o=Math.cos(t)*c,a=Math.sin(t)*c,d=Math.cos(r)*c,u=Math.sin(r)*c,p=new i.Pq0(s,n,l).addScaledVector(f,o).addScaledVector(x,a),m=new i.Pq0(s,n,l).addScaledVector(f,d).addScaledVector(x,u);g.push(p,m)}if("XZ"===p)for(let e of g)e.set(e.x,0,e.y);if("YZ"===p)for(let e of g)e.set(0,e.x,e.y);return d(this,g,m),this}sphere(e){return this.circle({...e,plane:"XY"}).circle({...e,plane:"XZ"}).circle({...e,plane:"YZ"})}rectangle(e,t){let{centerX:r,centerY:n,width:o,height:a}=s.M_.from(e),l=o/2,c=a/2,h=new i.Pq0(r-l,n-c,0),u=new i.Pq0(r+l,n-c,0),p=new i.Pq0(r+l,n+c,0),m=new i.Pq0(r-l,n+c,0);return d(this,[h,u,u,p,p,m,m,h],t),this}placeholder(e,t){let r=s.M_.from(e);return this.rectangle(r,t).line(r.fromRelativePoint(0,0),r.fromRelativePoint(1,1),t).line(r.fromRelativePoint(1,0),r.fromRelativePoint(0,1),t)}grid2(e){let{plane:t,x:r,y:s,z:n,size:l,subdivisions:c,width:h,height:p,widthSubdivisions:m,heightSubdivisions:f,...x}={...u.grid2DefaultOptions,...e},{x:g,y:y}=(0,o.wX)(l,a),{x:v,y:w}=(0,o.wX)(null!=c?c:l);h&&(g=h),p&&(y=p),m&&(v=m),f&&(w=f);let b=g/2,j=y/2,P=[];for(let e=0;e<=v;e++){let t=e/v*g-b;P.push(new i.Pq0(t,-j,0),new i.Pq0(t,j,0))}for(let e=0;e<=w;e++){let t=e/w*y-j;P.push(new i.Pq0(-b,t,0),new i.Pq0(b,t,0))}let M=new i.Pq0(r,s,n);for(let e of P)e.add(M);if("XZ"===t)for(let e of P)e.set(e.x,0,e.y);if("YZ"===t)for(let e of P)e.set(0,e.x,e.y);return d(this,P,x),this}box(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=0,r=0,s=0,n=1,a=1,c=1,{center:h,size:d,box3:u}=e;if(void 0!==h&&({x:t,y:r,z:s}=(0,o.jj)(h,l)),void 0!==d&&({x:n,y:a,z:c}=(0,o.jj)(d,l)),void 0!==u){let{min:i,max:o}=u,{x:l,y:h,z:d}=i,{x:p,y:m,z:f}=o;e.asIntBox3&&(p+=1,m+=1,f+=1),t=(l+p)/2,r=(h+m)/2,s=(d+f)/2,n=p-l,a=m-h,c=f-d}let p=n/2,m=a/2,f=c/2,x=new i.Pq0(t-p,r-m,s-f),g=new i.Pq0(t+p,r-m,s-f),y=new i.Pq0(t+p,r+m,s-f),v=new i.Pq0(t-p,r+m,s-f),w=new i.Pq0(t-p,r-m,s+f),b=new i.Pq0(t+p,r-m,s+f),j=new i.Pq0(t+p,r+m,s+f),P=new i.Pq0(t-p,r+m,s+f);return this.points.push(x,g,g,y,y,v,v,x),this.points.push(w,b,b,j,j,P,P,w),this.points.push(x,w,g,b,y,j,v,P),this}plus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,s=t/2,{x:n,y:l}=(0,o.wX)(e,a),c=new i.Pq0(n-s,l,0),h=new i.Pq0(n+s,l,0);return d(this,[c,h,new i.Pq0(n,l-s,0),new i.Pq0(n,l+s,0)],r),this}cross(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,s=t/2,{x:n,y:l}=(0,o.wX)(e,a),c=new i.Pq0(n-s,l-s,0),h=new i.Pq0(n+s,l+s,0);return d(this,[c,h,new i.Pq0(n-s,l+s,0),new i.Pq0(n+s,l-s,0)],r),this}constructor(e=-1,t=new i.mrM({vertexColors:!0})){super(new i.LoY,t),this.points=[],this.colors=new Map,this.state={forceTransparent:!1,hasAlreadyBeenRendered:!1,reservePoints:-1},this.state.reservePoints=e,this.onBeforeRender=()=>{this.state.hasAlreadyBeenRendered=!0}}}u.circleDefaultOptions={plane:"XY",x:0,y:0,z:0,radius:.5,segments:96},u.grid2DefaultOptions={plane:"XY",x:0,y:0,z:0,size:8,width:void 0,height:void 0,subdivisions:void 0,widthSubdivisions:void 0,heightSubdivisions:void 0}},48937:(e,t,r)=>{"use strict";r.d(t,{PageClient:()=>w});var i=r(70691),s=r(33540),n=r(77794),o=r(79911),a=r(72612),l=r(49797),c=r(99332),h=r(31763),d=r(16465),u=r(18461),p=r(67235),m=r(53245);function f(e){let t=(0,s.Fw)();return(0,s.dB)("basic-demo",e,function*(e){let r=p.Q.send(h.n).assertPayload();(0,o.mj)(new l.eaF(new l.O3Y(1.2,.05),new d.Y({color:"yellow"})),e);let i=(0,o.mj)(new l.eaF(new l.WBB(1,12),new d.Y({})),e),s=(0,o.mj)(new l.eaF(new l.O3Y(1.2,.05),new d.Y({})),e),n=new u.$({drag:.999999}),a=new m.r(8,0),f=!1,x=()=>r.dampedVertigo.state.realSize.y/t.domElement.clientHeight;yield(0,c.s)(t.domElement,{onVerticalDragStart:()=>{f=!0},onVerticalDrag:e=>{let r=-e.delta.y*x()*1;a.setValue(r/t.ticker.deltaTime,!0),n.position+=r},onVerticalDragStop:()=>{f=!1,n.velocity=a.average;let e=n.getDestination();s.position.y=e}}),yield t.ticker.onTick(()=>{f||n.update(t.ticker.deltaTime),i.position.y=n.position})},[]),null}var x=r(63106),g=r(91255);function y(e){let{dragDamping:t,...r}=e,i=(0,s.Fw)();return(0,s.dB)("toggle-demo",r,function*(e){let r=p.Q.send(h.n).assertPayload();(0,o.mj)(new n.u,e).text([0,-12,0],"d: ".concat((null==t?void 0:t.toPrecision(3).replace(/0+$/,""))||"default"),{size:1,color:"white"});let s=(0,o.mj)(new l.eaF(new l.WBB(1,12),new d.Y({})),e),a=(0,o.mj)(new n.u,s),u=new g.l({dragDamping:t,positions:[-10,-1.5,1.5,10],overshootLimit:3});for(let t of u.props.positions)(0,o.mj)(new l.eaF(new l.O3Y(1.2,.05),new d.Y({})),e).position.y=t;let m=(0,o.mj)(new l.eaF(new l.tcD(1.6,32),new d.Y({color:"#022c14"})),{parent:e,z:-.1}),f=(0,o.mj)(new l.eaF(new l.O3Y(1.4,.05),new d.Y({color:"#7636c9"})),{parent:e,z:-.1}),y=()=>r.dampedVertigo.state.realSize.y/i.domElement.clientHeight;yield(0,c.s)(i.domElement,{onVerticalDragStart:()=>{u.dragStart()},onVerticalDrag:e=>{let t=-(y()*e.delta.y);u.drag(t)},onVerticalDragStop:()=>{u.dragStop()},onWheel:e=>{let t=y()*e.delta.y*1;u.autoDrag(t)}}),yield(0,x.a)([[" ",()=>{m.visible=!m.visible,f.visible=!f.visible}]]),yield i.ticker.onTick(()=>{u.update(i.ticker.deltaTime),s.position.y=u.position,m.position.y=u.state.inputPosition,f.position.y=u.state.naturalDestination,a.textAt(0,"".concat(u.state.positionIndex),{position:[0,0,1],size:4,color:"blue"})})},[]),null}function v(){let e=(0,s.Fw)();return(0,s.dB)("my-scene",function*(t){e.pipeline.basicPasses.fxaa.enabled=!1,(0,o.mj)(new n.u,t).regularGrid()}),null}function w(){return(0,i.jsxs)(s.uB,{vertigoControls:{fixed:!0,size:32,perspective:0},children:[(0,i.jsxs)("div",{className:"layer thru p-8",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold",children:"Decay"}),(0,i.jsx)("p",{className:"mt-4 max-w-md",children:"Trying to combine mouse drag & mouse wheel to control a single object with multiple stop positions and decay."})]}),(0,i.jsx)(v,{}),(0,i.jsx)(f,{x:-5}),(0,a.loopArray)(4,e=>{let t=.001**(1+e.i/3);return(0,i.jsx)(y,{x:5+3*e.i,dragDamping:t},e.i)})]})}},54272:()=>{},59481:(e,t,r)=>{"use strict";r.d(t,{Main:()=>m});var i=r(70691),s=r(49797),n=r(61098),o=r(31763),a=r(48181),l=r(16465),c=r(79911),h=r(36508);class d extends s.eaF{constructor(){super(new s.bdM(4,.2),new l.Y({color:"#ff9900"}))}}class u extends s.eaF{constructor(){super(new s.bdM(4,.2),new s.BKk({uniforms:{uColor:{value:new s.Q1f("#ff9900")},uSunPosition:{value:new s.Pq0(.5,.7,.3)},uLuminosity:{value:.5}},vertexShader:"\n      varying vec3 vWorldNormal;\n      \n      void main() {\n        vWorldNormal = mat3(modelMatrix) * normal;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        gl_Position.z += -0.01;\n      }\n    ",fragmentShader:"\n      varying vec3 vWorldNormal;\n      varying vec3 vColor;\n      \n      uniform vec3 uSunPosition;\n      uniform vec3 uColor;\n      uniform float uLuminosity;\n      \n      void main() {\n        vec3 lightDirection = normalize(uSunPosition);\n        float light = dot(vWorldNormal, lightDirection) * 0.5 + 0.5;\n        light = pow(light, 2.0);\n        light = mix(uLuminosity, 1.0, light);\n        gl_FragColor = vec4(uColor * light, 1.0);\n      }\n    "}))}}function p(){return(0,n.hG)(function*(e){e.useOrbitControls=!1;let t=new o.n({size:[8,8]});t.start(e.three.renderer.domElement),yield(0,h.xy)("three",r=>{t.update(e.three.camera,e.three.aspect)})}),(0,n.yk)(function*(e){e.scene.background=new s.Q1f("#6699cc"),(0,c.mj)(new s.eaF(new s.WBB(1,4),new l.Y({color:"red"})),e.scene),(0,c.mj)(new a.R,e.scene).box({size:2}).draw().showOccludedLines(),(0,c.mj)(new d,{parent:e.scene,position:[0,.5,0]}),(0,c.mj)(new u,{parent:e.scene,position:[0,-.5,0]}),yield()=>e.scene.clear()},[]),null}function m(){return(0,i.jsx)(n.YV,{children:(0,i.jsx)(p,{})})}},66209:(e,t,r)=>{"use strict";r.d(t,{Main:()=>m});var i=r(70691),s=r(49797),n=r(61098),o=r(16465),a=r(7147),l=r(3293),c=r(79911),h=r(72612),d=r(17099);class u extends s.YJl{constructor(){super(),(0,c.mj)(new s.eaF(new s.WBB(1,12),new o.Y),this),(0,c.mj)(new s.eaF(new s.UPV(2,.1,256,16),new o.Y({color:"red"})),this);let e=new s.uWO(new Float32Array(100),4),t=new s.bdM;t.setAttribute("aRand",e);let r=new s.V9B({side:s.$EB});r.onBeforeCompile=e=>a.bI.with(e).vertex.top("\n        attribute vec4 aRand;\n      ").vertex.after("project_vertex","\n        // Move the vertex a bit based on aRand, and that's all!!!!\n        gl_Position.z += aRand.x * .1;\n      ");let i=(0,c.mj)(new s.ZLX(t,r,25),this);d.c.reset();let n=Array.from({length:25},()=>0xffffff*d.c.random());for(let t of(0,h.loop2)(5,5)){let r=(t.px-.5)*4,s=(t.py-.5)*4,o=(t.px+t.py)*.4;i.setMatrixAt(t.i,(0,l.wy)({x:r,y:s,z:o,scaleScalar:1.25})),i.setColorAt(t.i,(0,l._b)(d.c.pick(n))),e.setXYZW(t.i,d.c.random(),d.c.random(),d.c.random(),d.c.random())}}}function p(){return(0,n.yk)(function*(e){e.useOrbitControls(),e.scene.background=new s.Q1f("#345");let t=new u;e.scene.add(t),yield()=>t.removeFromParent()},[]),null}function m(){return(0,i.jsx)(n.YV,{children:(0,i.jsx)(p,{})})}},68516:(e,t,r)=>{"use strict";r.d(t,{SafeClient:()=>n});var i=r(70691),s=r(67203);function n(){let[e,t]=(0,s.useState)(null);return(0,s.useEffect)(()=>{Promise.all([r.e(5500),r.e(5611),r.e(7190),r.e(6564),r.e(7953),r.e(146),r.e(487),r.e(3445),r.e(9332),r.e(3414),r.e(9717),r.e(1763),r.e(7215)]).then(r.bind(r,51571)).then(e=>t(e))},[]),e?(0,i.jsx)(e.Client,{}):(0,i.jsx)("div",{className:"layer col-center",children:"loading..."})}},69621:(e,t,r)=>{"use strict";r.d(t,{$n:()=>p,QT:()=>h,Yr:()=>d,kE:()=>u});var i=r(70691),s=r(49797),n=r(34011),o=r(13160),a=r(16465),l=r(79911);class c{set(e,t,r,i){return this.p.copy(e),this.u.copy(t),this.v.copy(r),this.w.copy(i),this}fromMatrix4(e){return this.p.setFromMatrixPosition(e),this.u.setFromMatrixColumn(e,0),this.v.setFromMatrixColumn(e,1),this.w.setFromMatrixColumn(e,2),this}scale(e){return this.u.multiplyScalar(e.x),this.v.multiplyScalar(e.y),this.w.multiplyScalar(e.z),this}lerpBasis(e,t,r){return this.p.lerpVectors(e.p,t.p,r),this.u.lerpVectors(e.u,t.u,r),this.v.lerpVectors(e.v,t.v,r),this.w.lerpVectors(e.w,t.w,r),this}lerp(e,t){return this.p.lerp(e.p,t),this.u.lerp(e.u,t),this.v.lerp(e.v,t),this.w.lerp(e.w,t),this}toMatrix4(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s.kn4;return e.makeBasis(this.u,this.v,this.w),e.setPosition(this.p),e}constructor(){this.p=new s.Pq0,this.u=new s.Pq0(1,0,0),this.v=new s.Pq0(0,1,0),this.w=new s.Pq0(0,0,1)}}class h extends s.YJl{constructor(e="white"){super();let{torusKnotGeometry:t,axesGeometry:r,autoLitVertexColorsMaterial:i,cubeGeometry:n}=h.shared;(0,l.mj)(new s.eaF(t,new a.Y({color:e})),this),(0,l.mj)(new s.eaF(r,i),this),(0,l.mj)(new s.DXC(n,new s.mrM({color:e})),this)}}h.shared={torusKnotGeometry:new s.UPV(.15,.07,256,64),axesGeometry:new n.k,cubeGeometry:o.Q.setAsBounds(new s.LoY,0,1),autoLitVertexColorsMaterial:new a.Y({vertexColors:!0})};class d extends s.YJl{onTick(e){let t=e.sin01Time({frequency:.2});this.objC.matrixAutoUpdate=!1,this.basisA.fromMatrix4(this.objA.matrix),this.basisB.fromMatrix4(this.objB.matrix),this.basisC.lerpBasis(this.basisA,this.basisB,t),this.basisC.toMatrix4(this.objC.matrix)}constructor(...e){super(...e),this.objA=(0,l.mj)(new h,this),this.objB=(0,l.mj)(new h("yellow"),this),this.objC=(0,l.mj)(new h("red"),this),this.basisA=new c,this.basisB=new c,this.basisC=new c}}function u(e){let{children:t}=e;return(0,i.jsx)("div",{className:"ui layer thru p-8 flex flex-col gap-4 items-start",children:(0,i.jsx)("div",{className:"max-w-md flex flex-col gap-2 items-start p-4 backdrop-blur rounded-xl border border-white/10 bg-white/2",children:t})})}function p(e){let{label:t="Button",onClick:r=()=>{}}=e;return(0,i.jsx)("button",{className:"btn border rounded px-4 py-2",onClick:r,children:t})}},71936:(e,t,r)=>{"use strict";r.d(t,{k:()=>s});let i={name:"unnamed",initialValue:0,historySize:100,derivativeCount:0};class s{get name(){return this.props.name}get count(){return this.state.count}get actualCount(){return Math.min(this.state.count,this.props.historySize)}reset(e){var t;return this.state.index=0,this.state.count=1,this.historyNumber.fill(e),null==(t=this.derivative)||t.reset(0),this}push(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(r<=0)return console.warn("deltaTime must be positive. Ignoring push."),this;let{historySize:i}=this.props,{index:s}=this.state;return this.historyNumber[s]=e,this.state.index=(s+1)%i,this.state.count++,null==(t=this.derivative)||t.push((e-this.get(1))/r,r),this}createHistory(e){let{historySize:t}=this.props;this.reset(e(-1/(t-1)));for(let r=0;r<t;r++){let i=r/(t-1);this.push(e(i),1/(t-1))}return this}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,{historySize:t}=this.props;e<0&&(e=0),e>=t&&(e=t-1);let r=this.state.index-1-e;return r<0&&(r+=t),this.historyNumber[r]}linearSample(e){let t=e-Math.floor(e),r=Math.floor(e);return this.get(r)*(1-t)+this.get(r+1)*t}linearSamples(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=Array(e);for(let r=0;r<e;r++){let i=r/(e-1);t[r]=this.linearSample(i*(this.props.historySize-1))}return t}gaussianSmoothSample(e){let{stdDev:t=1,sampleCount:r=10,sampleHistoryWidth:i=.1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=i*this.props.historySize*.5,n=0,o=0;for(let i=0;i<r;i++){let a=s*(i/(r-1)*2-1),l=e-a,c=this.linearSample(l),h=Math.exp(-(a*a*.5)/(t*t));n+=c*h,o+=h}return n/o}gaussianSmoothSamples(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1?arguments[1]:void 0,r=Array(e);for(let i=0;i<e;i++){let s=i/(e-1);r[i]=this.gaussianSmoothSample(s*(this.props.historySize-1),t)}return r}*history(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.historySize,{wrapMode:t="end"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{historySize:r}=this.props,{count:i}=this.state;e=Math.min(e,r);for(let r=0;r<e&&(!(r>=i)||"end"!==t);r++)yield this.get(r)}historyInfo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.historySize,{wrapMode:t="end"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=1/0,i=-1/0,s=0,n=0;for(let o of this.history(e,{wrapMode:t}))n++,s+=o,o<r&&(r=o),o>i&&(i=o);return{actualCount:n,min:r,max:i,sum:s,average:s/n}}toSvgPathData(){let{offsetX:e=0,offsetY:t=0,width:r=100,height:i=100,yRange:s="auto"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[n,o]=(()=>{if("auto"===s){let e=this.historyInfo();return[e.min,e.max]}return s})();if(0==o-n)return"";let{historySize:a}=this.props,{count:l}=this.state,c=Math.min(a,l);if(c<2)return"";let h=e=>e.toFixed(2).replace(/\.?0+$/,""),d=[];for(let s=0;s<c;s++){let a=s/(c-1),l=(this.get(c-1-s)-n)/(o-n),u=e+a*r,p=t+(1-l)*i,m=0===s?"M":"L";isNaN(p)||isFinite(p),d.push("".concat(m).concat(h(u),",").concat(h(p)))}return d.join(" ")}constructor(e,t){var r,n;this.state={index:0,count:1},this.derivative=null,this.antiderivative=null;let o=null!=(n=null!=(r=null==e?void 0:e.name)?r:(null==t?void 0:t.props.name)&&"".concat(t.props.name,"'"))?n:"unnamed";if(this.props={...i,...e,name:o},this.props.historySize<1)throw Error("historySize must be at least 1");this.historyNumber=new Float32Array(this.props.historySize),this.reset(this.props.initialValue),this.props.derivativeCount>0&&(this.derivative=new s({historySize:this.props.historySize,derivativeCount:this.props.derivativeCount-1},this))}}},72612:(e,t,r)=>{"use strict";function*i(e){let t=0,r={get i(){return t},get t(){return t/e},get p(){return t/(e-1)},get size(){return e},clone(){return{...this}}};for(t=0;t<e;t++)yield r}function s(e,t){let r=[];for(let s of i(e)){let e=s.clone();r.push(t?t(e):e)}return r}function*n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=0,s=0;2===t.length?(i=t[0],s=t[1]):Array.isArray(t[0])?(i=t[0][0],s=t[0][1]):(i=t[0].x,s=t[0].y);let n=0,o=0,a=0,l={get i(){return n},get x(){return o},get y(){return a},get tx(){return o/i},get ty(){return a/s},get px(){return o/(i-1)},get py(){return a/(s-1)},get sizeX(){return i},get sizeY(){return s},clone(){return{...this}}};for(a=0;a<s;a++)for(o=0;o<i;o++)yield l,n++}function o(){let e;for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];let s=0,o=0;"number"==typeof r[0]?(s=r[0],o=r[1],e=r[2]):(Array.isArray(r[0])?(s=r[0][0],o=r[0][1]):(s=r[0].x,o=r[0].y),e=r[1]);let a=[];for(let t of n(s,o)){let r=t.clone();a.push(e?e(r):r)}return a}function*a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=0,s=0,n=0;3===t.length?(i=t[0],s=t[1],n=t[2]):Array.isArray(t[0])?(i=t[0][0],s=t[0][1],n=t[0][2]):(i=t[0].x,s=t[0].y,n=t[0].z);let o=0,a=0,l=0,c=0,h={get i(){return o},get x(){return a},get y(){return l},get z(){return c},get tx(){return a/i},get ty(){return l/s},get tz(){return c/n},get px(){return a/(i-1)},get py(){return l/(s-1)},get pz(){return c/(n-1)},clone(){return{...this}}};for(c=0;c<n;c++)for(l=0;l<s;l++)for(a=0;a<i;a++)yield h,o++}function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=[];for(let e of a(...t))i.push(e.clone());return i}r.r(t),r.d(t,{loop:()=>i,loop2:()=>n,loop2Array:()=>o,loop3:()=>a,loop3Array:()=>l,loopArray:()=>s})},72854:(e,t,r)=>{"use strict";r.d(t,{PageClient:()=>B});var i=r(70691),s=r(18479),n=r(36508),o=r(24223),a=r(63106),l=r(99332),c=r(67235),h=r(71936);function d(e){let{children:t,size:r="70vh",textColor:s="white",bgColor:n="red",className:o=""}=e;return(0,i.jsxs)("section",{className:"relative flex flex-col rounded-xl p-8 ".concat(o),style:{height:r,color:s,backgroundColor:n},children:[(0,i.jsx)(u,{borderColor:n}),(0,i.jsx)(u,{borderColor:n,right:!0}),t]})}function u(e){let{borderColor:t="white",right:r=!1}=e;return(0,i.jsx)("div",{style:{"--size":"24px",position:"absolute",top:"calc((100% - var(--size)) / 2)",left:r?"":"calc(var(--size) / -2)",right:r?"calc(var(--size) / -2)":"",width:"var(--size)",height:"var(--size)",backgroundColor:"currentColor",borderRadius:"50%",border:"8px solid ".concat(t)}})}var p=r(66066),m=r(15940),f=r(18461);class x{add(e,t){this.map.has(e)||this.map.set(e,new Set),this.map.get(e).add(t);let r=()=>this.unsubscribe(e,t);return{unsubscribe:r,destroy:r}}addOnce(e,t){return this.add(e,function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return t(...r),"unsubscribe"})}dispatch(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];let s=this.map.get("*");if(s){for(let t of s)"unsubscribe"===t(e,...r)&&s.delete(t);0===s.size&&this.map.delete("*")}let n=this.map.get(e);if(n){for(let t of n)"unsubscribe"===t(e,...r)&&n.delete(t);0===n.size&&this.map.delete(e)}return this}unsubscribe(e,t){let r=this.map.get(e);if(!r)return!1;let i=r.delete(t);return 0===r.size&&this.map.delete(e),i}constructor(){this.map=new Map}}function g(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=0,s=1/0;switch(r){case 1:for(let r=0;r<e.length;r++){let n=e[r];if(n<t)continue;let o=Math.abs(n-t);o<s&&(s=o,i=r)}return i;case 2:for(let r=0;r<e.length;r++){let n=e[r];if(n>t)continue;let o=Math.abs(n-t);o<s&&(s=o,i=r)}return i;default:for(let r=0;r<e.length;r++){let n=Math.abs(e[r]-t);n<s&&(s=n,i=r)}return i}}var y=r(79285);class v{reset(){this.delta=0}increment(e){this.delta+=e}update(e,t){this.time+=e,this.dragMobile.drag=.99999,this.dragMobile.position=this.position,this.dragMobile.velocity=this.delta/e;let r=g(t,this.dragMobile.getDestination()),i=t[r];r!==this.stopIndex&&(this.stopIndex=r,this.stopChangeTime=this.time);let s=this.time-this.stopChangeTime,n=(0,y.saturate)(s/this.fadeTime);this.dragMobile.position=this.position,this.dragMobile.setVelocityForDestination(i),this.dragMobile.update(e);let o=this.position;this.position=(0,y.lerp)(this.position+this.delta,this.dragMobile.position,n);let a=this.position-o;this.overshoot=a-this.delta,this.velocity=a/e,this.delta=0}constructor(){this.delta=0,this.position=0,this.velocity=0,this.fadeTime=.2,this.overshoot=0,this.time=0,this.stopIndex=-1,this.stopChangeTime=0,this.dragMobile=new f.$}}class w{increment(e){return this.delta+=e,this}start(e){this.delta=0,this.position=e,this.inputPosition=e,this.dragMobile.position=e,this.dragMobile.velocity=0}update(e){let t=this.inputPosition+this.delta;this.inputPosition=t,this.delta=0,this.dragMobile.drag=.9999,this.dragMobile.setVelocityForDestination(t),this.dragMobile.update(e);let r=this.position;this.position=this.dragMobile.position,this.velocity=(this.position-r)/e}constructor(){this.delta=0,this.position=0,this.velocity=0,this.inputPosition=0,this.dragMobile=new f.$}}var b=function(e){return e[e.Idle=0]="Idle",e[e.PointerDrag=1]="PointerDrag",e[e.AutoDrag=2]="AutoDrag",e}(b||{}),j=function(e){return e.InputModeChange="input-mode-change",e.StopIndexChange="stop-index-change",e}(j||{});let P={stops:[0,400,600],autoDragFadeTime:.2};var M=new WeakSet,S=new WeakSet;class z{get position(){return this.state.dragMobile.position}getClosestStopIndex(e){return g(this.props.stops,e)}getClosestStop(e){let t=this.getClosestStopIndex(e);return this.props.stops[t]}goToStop(e){let{stops:t}=this.props;return(e%=t.length)<0&&(e+=t.length),(0,p._)(this,S,q).call(this,e),this.state.dragMobile.set({drag:1-1e-6}),this.state.dragMobile.setVelocityForDestination(t[e]),this}goToPreviousStop(){let{loop:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.state.stopIndex-1;return t<0&&(t=e?this.props.stops.length-1:0),this.goToStop(t)}goToNextStop(){let{loop:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.state.stopIndex+1;return t>=this.props.stops.length&&(t=e?0:this.props.stops.length-1),this.goToStop(t)}inverseLerpPosition(e){let t=this.props.stops[0];return(e-t)/(this.props.stops[this.props.stops.length-1]-t)}startDrag(){return 1===this.state.inputMode||(this.state.pointerDrag.start(this.state.dragMobile.position),(0,p._)(this,M,k).call(this,1)),this}drag(e){return 1!==this.state.inputMode||this.state.pointerDrag.increment(e),this}stopDrag(){if(1!==this.state.inputMode)return this;let{pointerDrag:e,dragMobile:t}=this.state;t.position=e.position,t.velocity=2*e.velocity,t.drag=.99999;let r=t.getDestination(),i=this.getClosestStopIndex(r),s=this.props.stops[i];return t.setVelocityForDestination(s),(0,p._)(this,S,q).call(this,i),(0,p._)(this,M,k).call(this,0),this}autoDrag(e){let{autoDrag:t}=this.state;return 2!==this.state.inputMode&&t.reset(),t.increment(e),(0,p._)(this,M,k).call(this,2),this}update(e){let{dragMobile:t,inputMode:r,pointerDrag:i,autoDrag:s}=this.state;switch(r){case 0:t.update(e);break;case 1:i.update(e),t.position=i.position;break;case 2:s.fadeTime=this.props.autoDragFadeTime,s.update(e,this.props.stops),t.position=s.position}}svgRepresentation(e){return function(e){let{svg:t=null,margin:r=20,width:i=100,height:s=500,stopRadius:n=3,headRadius:o=5,headStrokeWidth:a=2,color:l="white"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t||(t=document.createElementNS("http://www.w3.org/2000/svg","svg"));let c=i+2*r,h=s+2*r;t.setAttribute("viewBox","".concat(-r," ").concat(-r," ").concat(c," ").concat(h)),t.setAttribute("width","".concat(c)),t.setAttribute("height","".concat(h));let d=t.querySelector("circle.head");d||((d=document.createElementNS("http://www.w3.org/2000/svg","circle")).classList.add("head"),d.setAttribute("r","".concat(o)),d.setAttribute("fill","none"),d.setAttribute("stroke",l),t.appendChild(d));let u=[...t.querySelectorAll("circle.stop")];for(;u.length<e.props.stops.length;){let e=document.createElementNS("http://www.w3.org/2000/svg","circle");e.classList.add("stop"),e.setAttribute("r","".concat(n)),e.setAttribute("fill",l),t.appendChild(e),u.push(e)}for(;u.length>e.props.stops.length;){let e=u.pop();e&&e.parentNode&&e.parentNode.removeChild(e)}let p=t=>e.inverseLerpPosition(t)*(s-2*r);for(let t=0;t<e.props.stops.length;t++){let r=p(e.props.stops[t]);u[t].setAttribute("cy","".concat(r))}return d.setAttribute("cy","".concat(p(e.position))),d.setAttribute("stroke-width","".concat(a)),t}(this,e)}constructor(e){(0,m._)(this,M),(0,m._)(this,S),this.state={inputMode:0,stopIndex:0,dragMobile:new f.$({drag:.99}),pointerDrag:new w,autoDrag:new v,callbackHandler:new x},this.props={...P,...e}}}function k(e){return this.state.inputMode!==e&&(this.state.inputMode=e,this.state.callbackHandler.dispatch("input-mode-change",this),!0)}function q(e){return this.state.stopIndex!==e&&(this.state.stopIndex=e,this.state.callbackHandler.dispatch("stop-index-change",this),!0)}r(83451),r(54272);var C=r(31623);let A={oldRed:"#cf324c",beige:"#fafad1",greyGreen:"#53776d",darkPurple:"#3d1b7a",blue:"#001eff"},T={pathStrokeWidth:8};function N(){let e=()=>(0,i.jsx)(d,{bgColor:A.oldRed,textColor:A.darkPurple,className:"justify-center items-center",children:(0,i.jsx)("h1",{className:"font-mono font-bold text-6xl",children:A.oldRed})}),t=()=>(0,i.jsx)(d,{size:"12rem",bgColor:A.blue,textColor:A.beige,className:"justify-center items-center",children:(0,i.jsx)("h1",{className:"font-mono font-bold text-6xl",children:A.blue})}),r=()=>(0,i.jsx)(d,{size:"4rem",bgColor:A.darkPurple,textColor:A.beige});return(0,i.jsxs)("div",{className:"Content w-full flex flex-col py-16 gap-8",children:[(0,i.jsx)(e,{}),(0,i.jsx)(r,{}),(0,i.jsx)(t,{}),(0,i.jsx)(e,{}),(0,i.jsx)(e,{}),(0,i.jsx)(r,{}),(0,i.jsx)(r,{}),(0,i.jsx)(r,{}),(0,i.jsx)(t,{}),(0,i.jsx)(e,{}),(0,i.jsx)(r,{}),(0,i.jsx)(t,{}),(0,i.jsx)(e,{}),(0,i.jsx)(t,{}),(0,i.jsx)(e,{})]})}function F(){let{ref:e}=(0,s.useEffects)(function*(e){let t=e.querySelector("svg"),r=e.querySelector("#mobile-fill"),i=e.querySelector("#mobile-line"),s=[...e.querySelectorAll("h1 span:last-child")],o=new h.k({historySize:100});yield(0,n.xy)(e=>{var n;let a=c.Q.send(z).assertPayload(),l=t.parentElement.clientWidth,h=t.parentElement.clientHeight;t.setAttribute("width","".concat(l)),t.setAttribute("height","".concat(h)),o.push(a.position);let d=a.props.stops.at(-1)+200,u=o.gaussianSmoothSamples(100,{sampleHistoryWidth:.3}).map((e,t,r)=>{let i=(t/(r.length-1)*l).toFixed(2),s=(h-(e- -200)/(d- -200)*h).toFixed(2);return"".concat(i,",").concat(s)}),p=[...u,"".concat(l,", ").concat(h),"0, ".concat(h)];i.setAttribute("points",u.join(" ")),r.setAttribute("points",p.join(" "));let m=(100*(a.position/(null!=(n=a.props.stops.at(-1))?n:1))).toFixed(1);for(let e of s)e.textContent="".concat(m,"%")})},[]);return(0,i.jsx)("div",{ref:e,className:"w-full h-full p-2 pl-0",children:(0,i.jsxs)("div",{className:"w-full h-full rounded-lg p-8 flex flex-col gap-4",style:{backgroundColor:A.greyGreen},children:[(0,i.jsxs)("h1",{className:"text-4xl font-bold flex flex-row justify-between",style:{color:A.blue},children:[(0,i.jsx)("span",{children:"Wheel"}),(0,i.jsx)("span",{children:"0%"})]}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsxs)("svg",{className:"rounded-lg overflow-hidden",style:{borderColor:A.blue,borderWidth:"".concat(T.pathStrokeWidth,"px"),borderStyle:"solid"},children:[(0,i.jsx)("line",{x1:"0",y1:"50%",x2:"100%",y2:"50%",stroke:A.blue,strokeWidth:T.pathStrokeWidth}),(0,i.jsx)("polygon",{id:"mobile-fill",fill:A.darkPurple}),(0,i.jsx)("polyline",{id:"mobile-line",stroke:A.blue,strokeWidth:T.pathStrokeWidth,fill:"none"})]})}),(0,i.jsxs)("h1",{className:"text-4xl font-bold flex flex-row justify-between",style:{color:A.blue,transform:"rotate(180deg)"},children:[(0,i.jsx)("span",{children:"Wheel"}),(0,i.jsx)("span",{children:"0%"})]})]})})}function B(){let e=(0,C.A)(),{ref:t}=(0,s.useEffects)(function*(t){let r=function(e){let t=e.parentElement,r=[...e.querySelectorAll("section")],i=r.map(e=>0);for(let e=1,s=r.length-1;e<s;e++){let s=r[e],n=s.offsetTop-(t.clientHeight-s.clientHeight)/2;i[e]=n}return i[r.length-1]=t.scrollHeight-t.clientHeight,i}(t.querySelector(".Content")),i=new z({stops:r});Object.assign(window,{mobile:i,stops:r}),yield(0,l.s)(t,{onVerticalDragStart:e=>{i.startDrag()},onVerticalDrag:e=>{i.drag(-e.delta.y)},onVerticalDragStop:e=>{i.stopDrag()},onWheel:e=>{i.autoDrag(.5*e.delta.y)}}),yield(0,o.O)(()=>n.Rv.current().requestActivation()),yield(0,n.xy)(e=>{var r;null==(r=document.querySelector("nextjs-portal"))||r.style.setProperty("display","none"),i.update(e.deltaTime),t.querySelector(".Content ").style.transform="translateY(".concat(-i.position,"px)");let s=t.querySelector("#mobile-svg");i.svgRepresentation({svg:s,height:s.parentElement.clientHeight,width:0,color:A.oldRed,margin:32,headRadius:12,stopRadius:T.pathStrokeWidth/2,headStrokeWidth:T.pathStrokeWidth})}),yield(0,a.a)([["ArrowUp",()=>{i.goToPreviousStop({loop:!0})}],["ArrowDown",()=>{i.goToNextStop({loop:!0})}],[{code:"KeyF",modifiers:"shift"},()=>{document.fullscreenElement?document.exitFullscreen():t.requestFullscreen()}]]),yield c.Q.on(z,e=>e.setPayload(i)),document.body.addEventListener("resize",e),yield()=>{document.body.removeEventListener("resize",e)}},[]);return(0,i.jsxs)("div",{ref:t,className:"page bg-[#fafad1]",style:{fontFamily:"'IBM Plex Mono', monospace"},children:[(0,i.jsxs)("div",{className:"layer flex flex-col",children:[(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsx)("div",{style:{flex:"0 0 ".concat(T.pathStrokeWidth,"px"),backgroundColor:A.blue}}),(0,i.jsx)("div",{className:"flex-1"})]}),(0,i.jsxs)("div",{className:"layer flex flex-row gap-16",children:[(0,i.jsx)("div",{style:{flex:"0 0 ".concat(72,"px"),padding:"8px",paddingRight:"0"},children:(0,i.jsx)("div",{className:"w-full h-full rounded-lg",style:{backgroundColor:A.blue},children:(0,i.jsx)("svg",{id:"mobile-svg",width:0,height:0})})}),(0,i.jsx)("div",{style:{flex:1},children:(0,i.jsx)(N,{})}),(0,i.jsx)("div",{style:{flex:1},children:(0,i.jsx)(F,{})})]}),(0,i.jsx)("div",{className:"ScrollMobileSvg fixed top-0 left-0",children:(0,i.jsx)("svg",{})})]})}},73341:(e,t,r)=>{"use strict";r.d(t,{Main:()=>f});var i=r(70691),s=r(49797),n=r(12719),o=r(64028),a=r(61098),l=r(15931),c=r(48181),h=r(16465),d=r(79911),u=r(36508);class p extends s.YJl{onTick(e){let{sphere:t,pivot:r,position:i}=this.parts,n=e.lerpSin01Time(.5,1.5,{frequency:.2}),o=new s.Pq0().copy(r.position).addScaledVector(r.position,-n);t.matrixAutoUpdate=!1,t.matrix.makeScale(n,n,n).setPosition(o.add(i.position))}constructor(...e){super(...e),this.parts={sphere:(0,d.mj)(new s.eaF(new s.WBB(1,8),new h.Y),{name:"sphere",parent:this}),circle:(0,d.mj)(new c.R().circle({radius:.5}).circle({radius:1}).circle({radius:1.5}).draw(),{name:"circle",parent:this}),pivot:(0,d.mj)(new s.YJl,{name:"pivot",parent:this}),position:(0,d.mj)(new s.YJl,{name:"position",parent:this}),grid:(0,d.mj)(new l.P,{name:"grid",parent:this,rotationX:"90deg"})}}}function m(){let e=(0,a.hG)();return(0,a.yk)(function*(t){t.scene.background=new s.Q1f("#345");let r=new p;t.scene.add(r),yield(0,u.xy)("three",e=>r.onTick(e)),e.sceneSelection.set("Hop!",[r.parts.pivot]),e.toolType.set(n.pv.Move),(0,o._t)(e,r.parts.pivot),yield()=>r.removeFromParent()},[]),null}function f(){return(0,i.jsxs)(a.YV,{children:[(0,i.jsx)(m,{}),(0,i.jsxs)("div",{className:"flex flex-col p-4 gap-2",children:[(0,i.jsx)("p",{children:"Pivot offset to perform translate and scale is quite straightforward:"}),(0,i.jsx)("pre",{className:"bg-[#fff1] rounded px-2 py-1",children:"\nconst scale = ... // some value\nconst translate = new Vector3()\n  .copy(pivot.position)\n  .addScaledVector(pivot.position, -scale)\n\nmatrix\n  .makeScale(scale, scale, scale)\n  .setPosition(translate)\n".trim()})]})]})}},76033:(e,t,r)=>{"use strict";r.d(t,{Client:()=>u});var i=r(70691),s=r(33540),n=r(77794),o=r(79911),a=r(69621),l=r(31763),c=r(67235);function h(){return(0,i.jsxs)("div",{className:"ui layer thru p-8 flex flex-col gap-4 items-start",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold mb-8",children:"Matrix with Shear"}),(0,i.jsx)("button",{className:"btn border rounded px-4 py-2",onClick:()=>{c.Q.send(l.n).assertPayload().vertigo.set({perspective:0,zoom:1,rotation:[0,0,0]})},children:"Orthographic (reset)"}),(0,i.jsx)("button",{className:"btn border rounded px-4 py-2",onClick:()=>{c.Q.send(l.n).assertPayload().vertigo.set({perspective:1})},children:"Perspective"}),(0,i.jsxs)("p",{className:"flex w-[400px]",children:["The problem:",(0,i.jsx)("br",{}),"Linear interpolation of matrix columns produces weird intermediate states."]}),(0,i.jsxs)("p",{className:"flex w-[400px]",children:["Conclusion:",(0,i.jsx)("br",{}),"The matrices should be decomposed to position, rotation, scale, shear, interpolated, then recomposed."]}),(0,i.jsx)("p",{className:"flex w-[400px]",children:"But shear is tricky..."})]})}function d(){return(0,s.Fw)(function*(e){e.pipeline.basicPasses.fxaa.enabled=!1}),(0,s.dB)("my-scene",function*(e,t){(0,o.mj)(new n.u,e).regularGrid({size:12,subdivisions:[2,6],opacity:[1,.1]});let r=(0,o.mj)(new a.Yr,e);(0,o.mj)(r.objA,{x:1,y:4}),(0,o.mj)(r.objB,{x:-1,y:4,rotation:["0deg","180deg","0deg"]});let i=(0,o.mj)(new a.Yr,e);(0,o.mj)(i.objA,{x:1,y:2}),(0,o.mj)(i.objB,{x:-1,y:2,rotation:["90deg","90deg","0deg"]})},[]),null}function u(){return(0,i.jsxs)(s.uB,{vertigoControls:{eventTarget:"canvas",size:12,zoom:1,rotation:["0deg","0deg","0deg"],focus:[0,0,.5]},children:[(0,i.jsx)(d,{}),(0,i.jsx)(h,{})]})}},77247:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,89294,23)),Promise.resolve().then(r.bind(r,66209)),Promise.resolve().then(r.bind(r,72854)),Promise.resolve().then(r.bind(r,22273)),Promise.resolve().then(r.bind(r,99651)),Promise.resolve().then(r.bind(r,48937)),Promise.resolve().then(r.bind(r,59481)),Promise.resolve().then(r.bind(r,76033)),Promise.resolve().then(r.bind(r,18397)),Promise.resolve().then(r.bind(r,4076)),Promise.resolve().then(r.bind(r,37833)),Promise.resolve().then(r.bind(r,73341)),Promise.resolve().then(r.bind(r,34125)),Promise.resolve().then(r.bind(r,99398)),Promise.resolve().then(r.bind(r,68516)),Promise.resolve().then(r.bind(r,85862)),Promise.resolve().then(r.bind(r,94449))},80446:(e,t,r)=>{"use strict";r.d(t,{n:()=>s});var i=r(79105);let s=function e(){let t=Math.random,r=()=>{};function s(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r)|0;return t}function n(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];if(0===r.length)return t();if(1===r.length)return t()*r[0];if(2===r.length)return t()*(r[1]-r[0])+r[0];throw Error("Invalid arguments")}function o(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];if(1===r.length)return Math.floor(t()*r[0]);if(2===r.length)return Math.floor(t()*(r[1]-r[0]))+r[0];throw Error("Invalid arguments")}function a(e){let{weightsAreNormalized:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===e.length)throw Error("Weights array is empty");if(!1===r){let r=e.reduce((e,t)=>e+t,0),i=t()*r,s=0;for(let t=0;t<e.length;t++)if(i<(s+=e[t]))return t;return e.length-1}{let r=t(),i=0;for(let t=0;t<e.length;t++)if(r<(i+=e[t]))return t;return e.length-1}}let l={new:function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return e().setRandom(...r)},setRandom:function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];let[a,c=0]=n,h="string"==typeof c?s(c):c;if("parkmiller"===a){let e=i.Ts(h);t=()=>(e=i.K2(e),i.Tj(e)),r=t=>{e=i.Ts(t)}}else{if(void 0!==a&&"function"!=typeof a)throw Error("Invalid random function");t=null!=a?a:Math.random,r=()=>{}}return r(h),l},seed:function(e){return r("string"==typeof e?s(e):null!=e?e:0),l},get random(){return t},chance:function(e){return t()<e},number:n,float:n,f:n,sign:function(){return .5>t()?-1:1},int:o,i:o,hexColor:function(){let e=Math.floor(0xffffff*t());return"#".concat(e.toString(16).padStart(6,"0"))},pickIndex:a,pick:function(e,r){if(0===e.length)throw Error("Array is empty");if(r)return e[a(r)];let i=Math.floor(t()*e.length);return e[i]},createPicker:function(e){let t=e.map(e=>e[0]),r=e.map(e=>e[1]),i=t.reduce((e,t)=>e+t,0);for(let e=0;e<t.length;e++)t[e]/=i;return()=>r[a(t,{weightsAreNormalized:!0})]},direction2:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},r=t()*Math.PI*2;return e.x=Math.cos(r),e.y=Math.sin(r),e},direction3:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0},r=t(),i=t(),s=2*Math.PI*r,n=Math.acos(1-2*i);return e.x=Math.sin(n)*Math.cos(s),e.y=Math.sin(n)*Math.sin(s),e.z=Math.cos(n),e},quaternion:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0,w:1},r=t(),i=t(),s=t(),n=Math.sqrt(1-r),o=Math.sqrt(r);return e.x=n*Math.sin(2*Math.PI*i),e.y=n*Math.cos(2*Math.PI*i),e.z=o*Math.sin(2*Math.PI*s),e.w=o*Math.cos(2*Math.PI*s),e},shuffleIndexes:function*(e){if(e<=0)throw Error("N must be greater than 0");let r=0,i=Math.floor((2+2*t())*e);for(;1!==function(e,t){for(;0!==t;)[e,t]=[t,e%t];return e}(e,i);){if(++r>1e3)throw Error("Failed to find a suitable a value after 1000 attempts");i=e+Math.floor(t()*e)}let s=Math.floor(t()*e);for(let t=0;t<e;t++)yield(s+t*i)%e},shuffleArray:function(e){let{inPlace:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r?e:e.slice(),s=i.length;for(let e=s-1;e>0;e--){let r=Math.floor(t()*(e+1));[i[e],i[r]]=[i[r],i[e]]}return i}};return l}()},83451:()=>{},85862:(e,t,r)=>{"use strict";r.d(t,{SafeClient:()=>n});var i=r(70691),s=r(67203);function n(){let[e,t]=(0,s.useState)(null);return(0,s.useEffect)(()=>{Promise.all([r.e(5611),r.e(7190),r.e(6564),r.e(7953),r.e(146),r.e(487),r.e(3445),r.e(9332),r.e(3414),r.e(9717),r.e(1763),r.e(1080)]).then(r.bind(r,92622)).then(e=>t(e))},[]),e?(0,i.jsx)(e.Client,{}):(0,i.jsx)("div",{className:"layer col-center",children:"loading..."})}},94449:(e,t,r)=>{"use strict";r.d(t,{SafeClient:()=>n});var i=r(70691),s=r(67203);function n(){let[e,t]=(0,s.useState)(null);return(0,s.useEffect)(()=>{Promise.all([r.e(5611),r.e(7190),r.e(6564),r.e(7953),r.e(146),r.e(487),r.e(3445),r.e(9332),r.e(3414),r.e(9717),r.e(1763),r.e(8413)]).then(r.bind(r,71237)).then(e=>t(e))},[]),e?(0,i.jsx)(e.Client,{}):(0,i.jsx)("div",{className:"layer col-center",children:"loading..."})}},99398:(e,t,r)=>{"use strict";r.d(t,{SafeClient:()=>n});var i=r(70691),s=r(67203);function n(){let[e,t]=(0,s.useState)(null);return(0,s.useEffect)(()=>{Promise.all([r.e(5611),r.e(7190),r.e(6564),r.e(7953),r.e(146),r.e(487),r.e(3445),r.e(9332),r.e(3414),r.e(9717),r.e(1763),r.e(6224)]).then(r.bind(r,92358)).then(e=>t(e))},[]),e?(0,i.jsx)(e.Client,{}):(0,i.jsx)("div",{className:"layer col-center",children:"loading..."})}}},e=>{var t=t=>e(e.s=t);e.O(0,[2193,9850,5611,7190,6564,7962,9635,8921,7953,4512,7775,7436,7706,9294,146,487,3445,9332,3414,9717,1763,2143,3540,1450,358,1118,1319,6852,7358],()=>t(77247)),_N_E=e.O()}]);