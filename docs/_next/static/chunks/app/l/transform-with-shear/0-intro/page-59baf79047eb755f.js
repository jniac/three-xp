(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8829],{13160:(t,e,s)=>{"use strict";s.d(e,{Q:()=>i});var r=s(49797),o=s(94065);class i{static setColor(t,e){let s=t.attributes.position.count,o=new r.THS(new Float32Array(3*s),3),{r:i,g:n,b:a}=new r.Q1f(e);for(let t=0;t<s;t++)o.setXYZ(t,i,n,a);return t.setAttribute("color",o),t}static setAsBounds(t,e,s){let{x:i,y:n,z:a}=(0,o.jj)(e),{x:l,y:u,z:c}=(0,o.jj)(s),h=new Float32Array([i,n,a,l,n,a,l,n,a,l,u,a,l,u,a,i,u,a,i,u,a,i,n,a,i,n,c,l,n,c,l,n,c,l,u,c,l,u,c,i,u,c,i,u,c,i,n,c,i,n,a,i,n,c,l,n,a,l,n,c,l,u,a,l,u,c,i,u,a,i,u,c]);return null!=t||(t=new r.LoY),t.setAttribute("position",new r.THS(h,3)),t.computeBoundingBox(),t.computeBoundingSphere(),t}}},16465:(t,e,s)=>{"use strict";s.d(e,{Y:()=>n});var r=s(49797),o=s(7147);let i={shadowColor:"#808080",luminosity:1,rampPower:1,onBeforeCompile:void 0};class n extends r.V9B{constructor(t){let{rampPower:e,shadowColor:s,luminosity:n,onBeforeCompile:a,...l}={...i,...t},u={uSunPosition:{value:new r.Pq0(.5,.7,.3)},uShadowColor:{value:new r.Q1f(s)},uRampPower:{value:e},uLuminosity:{value:n}};super(l),this.onBeforeCompile=t=>{o.bI.with(t).uniforms(u).varying({vAutoLitWorldNormal:"vec3"}).vertex.mainAfterAll("\n          vAutoLitWorldNormal = mat3(modelMatrix) * normal;\n          #ifdef USE_INSTANCING\n            vAutoLitWorldNormal = mat3(instanceMatrix) * vAutoLitWorldNormal;\n          #endif\n        ").fragment.after("map_fragment","\n          vec3 normal = normalize(vAutoLitWorldNormal);\n          vec3 lightDirection = normalize(uSunPosition);\n          float light = dot(normal, lightDirection) * 0.5 + 0.5;\n          light = pow(light, uRampPower);\n          diffuseColor.rgb *= mix(uShadowColor * uLuminosity, vec3(1.0), light);\n        "),null==a||a(t)},this.sunPosition=u.uSunPosition.value}}},34011:(t,e,s)=>{"use strict";s.d(e,{e:()=>l,k:()=>c});var r=s(49797),o=s(38921);let i={axis:"x",length:1,radialSegments:12,radius:.01,coneRatio:.1,radiusScale:1,vertexColor:!0,baseCap:"flat",color:"white",align:0,heightSegments:1},n=new r.Q1f;function a(t){let{axis:e,length:s,radius:a,radialSegments:l,heightSegments:u,coneRatio:c,radiusScale:h,vertexColor:d,baseCap:m,color:p,align:x}={...i,...t},w=a*h,b=s*c,f=Math.max(1,Math.ceil(u*c)),v=Math.max(1,Math.ceil(u*(1-c))),j=new r.qFE(3*w,b,l,f),y=new r.Ho_(w,w,1,l,v,!0),g=s-b,C=s-.5*b;j.rotateZ(-Math.PI/2).translate(C,0,0),y.scale(1,g,1).rotateZ(-Math.PI/2).translate(.5*g,0,0);let P="none"===m?new r.LoY:"flat"===m?new r.tcD(w,l).rotateY(-Math.PI/2):new r.Gu$(w,l,3,0,2*Math.PI,0,.5*Math.PI).rotateZ(Math.PI/2).rotateX(Math.PI/2),M=(0,o.pP)([j,y,P]);switch(0!==x&&M.translate(-s*x,0,0),e){case"y":M.rotateZ(Math.PI/2);break;case"z":M.rotateY(-Math.PI/2)}if(d){let t=M.attributes.position.count,e=new r.THS(new Float32Array(3*t),3);M.setAttribute("color",e),n.set(p);for(let s=0;s<t;s++)e.setXYZ(s,n.r,n.g,n.b)}return M}class l extends r.LoY{constructor(t){super();let e=a(t);this.copy(e),e.dispose()}}let u={xColor:"#ff3333",yColor:"#33cc66",zColor:"#3366ff"};class c extends r.LoY{static get defaultOptions(){return{...u}}constructor(t){super();let{xColor:e,yColor:s,zColor:r,...i}={...u,...t},n=a({...i,axis:"x",color:e}),l=a({...i,axis:"y",color:s}),c=a({...i,axis:"z",color:r}),h=(0,o.pP)([n,l,c]);this.copy(h),h.dispose()}}},66620:(t,e,s)=>{"use strict";s.d(e,{_:()=>i});var r=s(89868),o=s(44138);function i(t,e){var s=(0,o._)(t,e,"update");return(0,r._)(t,s)}},69621:(t,e,s)=>{"use strict";s.d(e,{$n:()=>m,QT:()=>c,Yr:()=>h,kE:()=>d});var r=s(70691),o=s(49797),i=s(34011),n=s(13160),a=s(16465),l=s(79911);class u{set(t,e,s,r){return this.p.copy(t),this.u.copy(e),this.v.copy(s),this.w.copy(r),this}fromMatrix4(t){return this.p.setFromMatrixPosition(t),this.u.setFromMatrixColumn(t,0),this.v.setFromMatrixColumn(t,1),this.w.setFromMatrixColumn(t,2),this}scale(t){return this.u.multiplyScalar(t.x),this.v.multiplyScalar(t.y),this.w.multiplyScalar(t.z),this}lerpBasis(t,e,s){return this.p.lerpVectors(t.p,e.p,s),this.u.lerpVectors(t.u,e.u,s),this.v.lerpVectors(t.v,e.v,s),this.w.lerpVectors(t.w,e.w,s),this}lerp(t,e){return this.p.lerp(t.p,e),this.u.lerp(t.u,e),this.v.lerp(t.v,e),this.w.lerp(t.w,e),this}toMatrix4(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new o.kn4;return t.makeBasis(this.u,this.v,this.w),t.setPosition(this.p),t}constructor(){this.p=new o.Pq0,this.u=new o.Pq0(1,0,0),this.v=new o.Pq0(0,1,0),this.w=new o.Pq0(0,0,1)}}class c extends o.YJl{constructor(t="white"){super();let{torusKnotGeometry:e,axesGeometry:s,autoLitVertexColorsMaterial:r,cubeGeometry:i}=c.shared;(0,l.mj)(new o.eaF(e,new a.Y({color:t})),this),(0,l.mj)(new o.eaF(s,r),this),(0,l.mj)(new o.DXC(i,new o.mrM({color:t})),this)}}c.shared={torusKnotGeometry:new o.UPV(.15,.07,256,64),axesGeometry:new i.k,cubeGeometry:n.Q.setAsBounds(new o.LoY,0,1),autoLitVertexColorsMaterial:new a.Y({vertexColors:!0})};class h extends o.YJl{onTick(t){let e=t.sin01Time({frequency:.2});this.objC.matrixAutoUpdate=!1,this.basisA.fromMatrix4(this.objA.matrix),this.basisB.fromMatrix4(this.objB.matrix),this.basisC.lerpBasis(this.basisA,this.basisB,e),this.basisC.toMatrix4(this.objC.matrix)}constructor(...t){super(...t),this.objA=(0,l.mj)(new c,this),this.objB=(0,l.mj)(new c("yellow"),this),this.objC=(0,l.mj)(new c("red"),this),this.basisA=new u,this.basisB=new u,this.basisC=new u}}function d(t){let{children:e}=t;return(0,r.jsx)("div",{className:"ui layer thru p-8 flex flex-col gap-4 items-start",children:(0,r.jsx)("div",{className:"max-w-md flex flex-col gap-2 items-start p-4 backdrop-blur rounded-xl border border-white/10 bg-white/2",children:e})})}function m(t){let{label:e="Button",onClick:s=()=>{}}=t;return(0,r.jsx)("button",{className:"btn border rounded px-4 py-2",onClick:s,children:e})}},76033:(t,e,s)=>{"use strict";s.d(e,{Client:()=>d});var r=s(70691),o=s(33540),i=s(77794),n=s(79911),a=s(69621),l=s(31763),u=s(67235);function c(){return(0,r.jsxs)("div",{className:"ui layer thru p-8 flex flex-col gap-4 items-start",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-8",children:"Matrix with Shear"}),(0,r.jsx)("button",{className:"btn border rounded px-4 py-2",onClick:()=>{u.Q.send(l.n).assertPayload().vertigo.set({perspective:0,zoom:1,rotation:[0,0,0]})},children:"Orthographic (reset)"}),(0,r.jsx)("button",{className:"btn border rounded px-4 py-2",onClick:()=>{u.Q.send(l.n).assertPayload().vertigo.set({perspective:1})},children:"Perspective"}),(0,r.jsxs)("p",{className:"flex w-[400px]",children:["The problem:",(0,r.jsx)("br",{}),"Linear interpolation of matrix columns produces weird intermediate states."]}),(0,r.jsxs)("p",{className:"flex w-[400px]",children:["Conclusion:",(0,r.jsx)("br",{}),"The matrices should be decomposed to position, rotation, scale, shear, interpolated, then recomposed."]}),(0,r.jsx)("p",{className:"flex w-[400px]",children:"But shear is tricky..."})]})}function h(){return(0,o.Fw)(function*(t){t.pipeline.basicPasses.fxaa.enabled=!1}),(0,o.dB)("my-scene",function*(t,e){(0,n.mj)(new i.u,t).regularGrid({size:12,subdivisions:[2,6],opacity:[1,.1]});let s=(0,n.mj)(new a.Yr,t);(0,n.mj)(s.objA,{x:1,y:4}),(0,n.mj)(s.objB,{x:-1,y:4,rotation:["0deg","180deg","0deg"]});let r=(0,n.mj)(new a.Yr,t);(0,n.mj)(r.objA,{x:1,y:2}),(0,n.mj)(r.objB,{x:-1,y:2,rotation:["90deg","90deg","0deg"]})},[]),null}function d(){return(0,r.jsxs)(o.uB,{vertigoControls:{eventTarget:"canvas",size:12,zoom:1,rotation:["0deg","0deg","0deg"],focus:[0,0,.5]},children:[(0,r.jsx)(h,{}),(0,r.jsx)(c,{})]})}},92523:(t,e,s)=>{Promise.resolve().then(s.bind(s,76033))}},t=>{var e=e=>t(t.s=e);t.O(0,[5611,7190,6564,7962,9635,8921,7953,4512,7775,7436,146,487,3445,9332,3414,9717,1763,2143,3540,1319,6852,7358],()=>e(92523)),_N_E=t.O()}]);