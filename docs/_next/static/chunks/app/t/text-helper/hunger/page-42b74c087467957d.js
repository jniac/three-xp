(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[982],{888:(e,t,r)=>{"use strict";function n(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}r.d(t,{_:()=>n})},6697:(e,t,r)=>{"use strict";r.d(t,{O0:()=>n.O0,XW:()=>n.XW});var n=r(4266)},17099:(e,t,r)=>{"use strict";r.d(t,{c:()=>s});var n=r(79105);let a=e=>e,i={weightsAreNormalized:!1,indexOffset:0,forbiddenItems:[]};function o(){let e=(0,n.K2)((0,n.K2)((0,n.Ts)(n.KP)));function t(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.KP;return"string"==typeof t&&(t=t.split("").reduce((e,t)=>7*e+t.charCodeAt(0),0)),e=(0,n.K2)((0,n.K2)((0,n.Ts)(t))),u}function r(){return e=(0,n.K2)(e),(0,n.Tj)(e)}function o(e){switch(e.length){default:return[0,1,a];case 1:return[0,e[0],a];case 2:return[e[0],e[1],a];case 3:return[e[0],e[1],e[2]]}}function s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[a,i,s]=o(t);return a+(i-a)*s(r())}function l(){for(var e,t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];let[o,s,{weightsAreNormalized:l,indexOffset:c,forbiddenItems:u}]=function(e){let[t,r=null,n]=e,a={...i,...n};if(Array.isArray(t))return[t,r,a];if("object"==typeof t)return[Object.values(t),r?Object.values(r):null,a];throw Error("pick: unsupported options type")}(n);if(u.length>0){let t=new Set;for(let e of u){let r=o.indexOf(e);r>=0&&t.add(r)}if(o=o.filter((e,r)=>!t.has(r)),s=null!=(e=null==s?void 0:s.filter((e,r)=>!t.has(r)))?e:null,0===o.length)throw Error("pick: all items are forbidden")}if(null===s){let e=Math.floor(r()*o.length);return c&&(e+=c,(e%=o.length)<0&&(e+=o.length)),o[e]}if(!l){let e=s.reduce((e,t)=>e+t,0);s=s.map(t=>t/e)}let f=r(),m=0;for(let e=0;e<o.length;e++)if(f<(m+=s[e]))return o[e];throw Error("among: unreachable")}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=r(),a=r(),i=Math.sqrt(-2*Math.log(n)),o=2*Math.PI*a;return[e+t*i*Math.cos(o),e+t*i*Math.sin(o)]}let u={seed:t,seedMax:function(){return n.Zu},reset:function(){return t(n.KP),u},next:function(){return e=(0,n.K2)(e),u},getState:function(){return e},setState:function(t){return e=t&n.Zu,u},random:r,between:s,around:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[i=1,o=a]=t,s=2*r();return(s>1?1:-1)*o(s>1?s-1:s)*i},int:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[a,i,s]=o(t);return a+Math.floor(s(r())*(i-a))},chance:function(e){return r()<e},shuffle:function(e){let{mutate:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t&&Array.isArray(e)?e:[...e],a=n.length;for(let e=0;e<a;e++){let t=Math.floor(a*r()),i=n[e];n[e]=n[t],n[t]=i}return n},pick:l,createPicker:function(e){let t=e.map(e=>{let[t]=e;return t}),r=e.map(e=>{let[t,r]=e;return r}),n=r.reduce((e,t)=>e+t,0);for(let[e,t]of r.entries())r[e]=t/n;return()=>l(t,r,{weightsAreNormalized:!0})},vector:function(e,t){let[r=0,n=1]=Array.isArray(t)?t:[null==t?void 0:t.min,null==t?void 0:t.max];for(let t of Object.keys(e))e[t]=s(r,n);return e},unitVector2:function(e){let t=2*Math.PI*r();return e.x=Math.cos(t),e.y=Math.sin(t),e},unitVector3:function(e){let t=r(),n=r(),a=2*Math.PI*t,i=Math.acos(1-2*n);return e.x=Math.sin(i)*Math.cos(a),e.y=Math.sin(i)*Math.sin(a),e.z=Math.cos(i),e},normalVector:function(e){let t=Object.keys(e),r=t.length,n=Math.sqrt(r);for(let a=0;a<r;a+=2){let[i,o]=c();e[t[a]]=i/n,a+1<r&&(e[t[a+1]]=o/n)}return e},unitVector:function(e){let t=Object.keys(e),r=t.length,n=0;for(let a=0;a<r;a+=2){let[i,o]=c();e[t[a]]=i,n+=i*i,a+1<r&&(e[t[a+1]]=o,n+=o*o)}n=Math.sqrt(n);for(let a=0;a<r;a++)e[t[a]]/=n;return e},boxMuller:c,quaternion:function(e){let t=r(),n=r(),a=r(),i=Math.sqrt(1-t),o=Math.sqrt(t);return e.x=i*Math.sin(2*Math.PI*n),e.y=i*Math.cos(2*Math.PI*n),e.z=o*Math.sin(2*Math.PI*a),e.w=o*Math.cos(2*Math.PI*a),e},insideCircle:function(e,t){let n=2*r()*Math.PI,a=Math.sqrt(r())*e;return t.x=a*Math.cos(n),t.y=a*Math.sin(n),t}};return u}let s=class{constructor(e){Object.assign(this,o().seed(e))}};Object.assign(s,o())},35375:(e,t,r)=>{"use strict";r.d(t,{$:()=>a});let n="/three-xp/assets/",a={development:!1,assetsPath:n,assets:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(n).concat(e)}}},37441:(e,t,r)=>{Promise.resolve().then(r.bind(r,89651))},60041:(e,t,r)=>{"use strict";r.d(t,{b:()=>x,e:()=>w});var n=r(888),a=r(30158);let i=["common","uv_pars_vertex","displacementmap_pars_vertex","color_pars_vertex","fog_pars_vertex","normal_pars_vertex","morphtarget_pars_vertex","skinning_pars_vertex","shadowmap_pars_vertex","logdepthbuf_pars_vertex","clipping_planes_pars_vertex","uv_vertex","color_vertex","morphcolor_vertex","beginnormal_vertex","morphnormal_vertex","skinbase_vertex","skinnormal_vertex","defaultnormal_vertex","normal_vertex","begin_vertex","morphtarget_vertex","skinning_vertex","displacementmap_vertex","project_vertex","logdepthbuf_vertex","clipping_planes_vertex","worldpos_vertex","shadowmap_vertex","fog_vertex","common","packing","dithering_pars_fragment","color_pars_fragment","uv_pars_fragment","map_pars_fragment","alphamap_pars_fragment","alphatest_pars_fragment","alphahash_pars_fragment","aomap_pars_fragment","lightmap_pars_fragment","emissivemap_pars_fragment","iridescence_fragment","cube_uv_reflection_fragment","envmap_common_pars_fragment","envmap_physical_pars_fragment","fog_pars_fragment","lights_pars_begin","normal_pars_fragment","lights_physical_pars_fragment","transmission_pars_fragment","shadowmap_pars_fragment","bumpmap_pars_fragment","normalmap_pars_fragment","clearcoat_pars_fragment","iridescence_pars_fragment","roughnessmap_pars_fragment","metalnessmap_pars_fragment","logdepthbuf_pars_fragment","clipping_planes_pars_fragment","clipping_planes_fragment","logdepthbuf_fragment","map_fragment","color_fragment","alphamap_fragment","alphatest_fragment","alphahash_fragment","roughnessmap_fragment","metalnessmap_fragment","normal_fragment_begin","normal_fragment_maps","clearcoat_normal_fragment_begin","clearcoat_normal_fragment_maps","emissivemap_fragment","lights_physical_fragment","lights_fragment_begin","lights_fragment_maps","lights_fragment_end","aomap_fragment","transmission_fragment","opaque_fragment","tonemapping_fragment","colorspace_fragment","fog_fragment","premultiplied_alpha_fragment","dithering_fragment"];var o=r(49797),s=r(85795);class l{static from(e,t){if(t instanceof s.Observable){if("number"==typeof t.value)return new l(e,t);throw Error("Observable value must be a number")}let r=typeof t;return"object"===r&&(t.constructor===Object||t instanceof o.nc$)&&"value"in t?new l(e,t):"string"===r?new l(e,{value:new o.Q1f(t)}):new l(e,{value:t})}get value(){return this.target.value}computeDeclaration(){let e=this.name,t=this.target.value,r="";if(t instanceof Float32Array)return"uniform float ".concat(e,"[").concat(t.length,"];");if(Array.isArray(t)&&(r="[".concat(t.length,"]"),t=t[0]),"number"==typeof t)return"uniform float ".concat(e).concat(r,";");if(t.isVector2)return"uniform vec2 ".concat(e).concat(r,";");if(t.isVector3||t.isColor)return"uniform vec3 ".concat(e).concat(r,";");if(t.isVector4||t.isQuaternion)return"uniform vec4 ".concat(e).concat(r,";");if(t.isMatrix3)return"uniform mat3 ".concat(e).concat(r,";");if(t.isMatrix4)return"uniform mat4 ".concat(e).concat(r,";");if(t.isTexture)if(t.isCubeTexture)return"uniform samplerCube ".concat(e).concat(r,";");else return"uniform sampler2D ".concat(e).concat(r,";");throw console.log("unhandled value:",t),Error('unhandled value: "'.concat(null==t?void 0:t.constructor.name,'"'))}constructor(e,t){this.name=e,this.target=t}}function c(){let e=(0,n._)(["","s*",""],["","\\s*",""]);return c=function(){return e},e}let u=null,f=e=>(u=e,x),m="// ShaderForge (injected code) ->",p="// <- ShaderForge",h=e=>"".concat(m,"\n").concat(e.trim(),"\n").concat(p),d=e=>{let t=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=RegExp(String.raw(c(),t(p),t(m)),"g");return e.replaceAll(r,"")};class g{getPattern(e){let{throwError:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="#include <".concat(e,">"),n=this.type;if(t&&!1===u[n].includes(r))throw Error('"'.concat(r,'" is not present in the shader template program.'));return{pattern:r,type:n}}replace(e,t){if(e instanceof RegExp){let{type:r}=this;u[r]=u[r].replace(e,h(t))}else{let{type:r,pattern:n}=this.getPattern(e),a=h(t);u[r]=u[r].replace(n,a)}return x}inject(e,t,r){let{type:n,pattern:a}=this.getPattern(t),i="after"===e?"".concat(a,"\n").concat(h(r)):"".concat(h(r),"\n").concat(a);return u[n]=u[n].replace(a,i),x}injectTokenComments(){for(let e of i){let{type:t,pattern:r}=this.getPattern(e,{throwError:!1});u[t]=u[t].replace(r,"\n        ".concat(r,"\n        // ShaderForge TOKEN: ").concat(e,"\n      "))}return x}header(e){let t=this.type;return u[t]="".concat(e,"\n").concat(u[t]),x}before(e,t){return this.inject("before",e,t)}after(e,t){return this.inject("after",e,t)}top(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return u[this.type]=u[this.type].replace("void main() {","\n      ".concat(h(t.join("\n\n")),"\n      void main() {\n    ")),x}mainBeforeAll(e){return u[this.type]=u[this.type].replace("void main() {","void main() {\n        ".concat(h(e))),x}mainAfterAll(e){return u[this.type]=u[this.type].replace(/}\s*$/,"\n      ".concat(h(e),"\n    }")),x}uniforms(e){if("string"==typeof e)this.top(e);else{let t=[];for(let[r,n]of Object.entries(e)){let e=l.from(r,n);t.push(e.computeDeclaration())}this.top(t.join("\n")),function(e){for(let[t,r]of Object.entries(e)){let e=l.from(t,r);if(t in u.uniforms){if(e.value!==u.uniforms[t].value)throw Error("Shader redefinition! (Uniform values are not equal)")}else u.uniforms[t]=e}}(e)}return x}clean(){return u[this.type]=d(u[this.type]),x}printFinalCode(){return console.log(u[this.type].replace(/#include <(.*)>/g,(e,t)=>{let r=a.ShaderChunk[t];if(!r)throw Error('Shader chunk "'.concat(t,'" not found'));return r})),x}constructor(e){this.type=e}}let _=new g("fragmentShader"),v=new g("vertexShader"),x=Object.assign(function(e){return e&&f(e),x},{shaderName:function(e){return u.shaderName="".concat(e," (ShaderForge)"),x},defines:function(e){return u.defines?Object.assign(u.defines,e):u.defines=e,x},uniforms:function(e){return v.uniforms(e),_.uniforms(e),x},varying:function(e){let t="";if("string"==typeof e)t=e;else{let r=[];for(let[t,n]of Object.entries(e))r.push("varying ".concat(n," ").concat(t,";"));t=r.join("\n")}return v.top(t),_.top(t),x},top:function(e){return v.top(e),_.top(e),x},vertex:v,fragment:_,header:function(e){return _.header(e),v.header(e),x},clean:function(){return _.clean(),v.clean(),x},with:f,wrap:(e,t)=>(e.onBeforeCompile=e=>{u=e},e)}),y=new o.Q1f;function w(e){let{r:t,g:r,b:n}=y.set(e);return"vec3(".concat(t.toFixed(3),", ").concat(r.toFixed(3),", ").concat(n.toFixed(3),")")}},64857:(e,t,r)=>{"use strict";r.d(t,{w:()=>n.w});var n=r(67840)},79105:(e,t,r)=>{"use strict";r.d(t,{K2:()=>o,KP:()=>a,Tj:()=>s,Ts:()=>i,Zu:()=>n});let n=0x7fffffff,a=123456,i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;if((e=(e=(7*e+Math.sqrt(e)+16087*Math.sin(e))%n)<0?e+n:e)>1)return e&n;if(0===e)return 345678;throw Error("Impossible.")},o=e=>e=Math.imul(e,48271)&n,s=e=>(e-1)/(n-1)},87381:(e,t,r)=>{"use strict";r.d(t,{$z:()=>function* e(t,r){let{includeSelf:n}={...l,...r};for(let r of(n&&(yield t),t.children))yield*e(r,{includeSelf:!0})},DN:()=>o,mj:()=>i,rd:()=>s});var n=r(61567),a=r(90927);function i(e,t,r){return t&&((0,n.Th)(t)?t.add(e):(0,a.N)(e,t)),null==r||r(e),e}let o=i;function s(e,t){let r=t;for(;r.parent;){if(r.parent===e)return!0;r=r.parent}return!1}let l={includeSelf:!1}},88493:(e,t,r)=>{"use strict";r.d(t,{uB:()=>f,yk:()=>l});var n=r(70691),a=r(67203),i=r(7587),o=r(6697);r(90927);let s=(0,a.createContext)(null);function l(e,t){let r=(0,a.useContext)(s);return(0,i.C7)(async function*(t,n){if(e){let t=e(r,n);if(t&&"function"==typeof t.next)do{let{value:e,done:r}=await t.next();if(r)break;yield e}while(n.mounted)}},null!=t?t:"always"),r}let c={className:"",assetsPath:"/"};function u(e){let{children:t,className:r,assetsPath:l}={...c,...e},u=(0,a.useMemo)(()=>new o.XW,[]);u.loader.setPath(l);let{ref:f}=(0,i.IZ)({debounce:!0},function*(e,t){yield u.initialize(e.firstElementChild),t.triggerRender(),Object.assign(window,{three:u})},[]);return(0,n.jsx)("div",{ref:f,className:r,style:{position:"absolute",inset:0},children:(0,n.jsxs)(s.Provider,{value:u,children:[(0,n.jsx)("div",{style:{position:"absolute",inset:"0"}}),(0,n.jsx)("div",{style:{position:"absolute",inset:"0"},className:"thru",children:u.initialized&&t})]})})}function f(e){return function(){let[e,t]=(0,a.useState)(!1);return(0,a.useLayoutEffect)(()=>{t(!0)},[]),e}()&&(0,n.jsx)(u,{...e})}},89651:(e,t,r)=>{"use strict";r.d(t,{Client:()=>v});var n=r(70691),a=r(88493),i=r(49797),o=r(48083),s=r(64857),l=r(87381),c=r(36508),u=r(66851),f=r(17099),m=r(11577),p=r(35375);async function h(e){let t=new m.zg(new m.pp(e)),r=await t.getEntries(),n=await r[0].getData(new m.$i);return await t.close(),n}async function d(){let e=await fetch(p.$.assets("misc/knut-hamsun-hunger.bin.zip")),t=await e.arrayBuffer(),r=await h(new Uint8Array(t));return s.w.Data.decode(r)}async function*g(e){let t=new o.n({size:100}).initialize(e.renderer.domElement).start();yield(0,c.xy)("three",r=>{t.update(e.camera,e.aspect,r.deltaTime)});let r=await d();document.querySelector("#instance-count").textContent=r.metadata.textCount.toString();let n=new s.w({textCount:r.metadata.textCount,lineCount:r.metadata.lineCount,lineLength:r.metadata.lineLength,textSize:1.2});n.setData(r);let a=new i.Pq0;for(let e=0,t=r.metadata.textCount;e<t;e++)f.c.unitVector3(a),a.multiplyScalar(30+5*f.c.boxMuller()[0]),n.setMatrixAt(e,(0,u.w)({position:a})),n.setColorAt(e,(0,u._)(0xffffff*f.c.random()));(0,l.mj)(n,e.scene),(0,l.mj)(new i.eaF(new i.WBB,new i.V9B({wireframe:!0})),e.scene),yield()=>e.scene.clear()}function _(){return(0,a.yk)(g,[]),null}function v(){return(0,n.jsx)("div",{className:"layer thru",children:(0,n.jsxs)(a.uB,{children:[(0,n.jsxs)("div",{className:"layer thru p-4",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold",children:"Knut Hamsum - Hunger Demo"}),(0,n.jsxs)("p",{children:["63,862 words \xa0 (",(0,n.jsx)("span",{id:"instance-count",children:"X"}),"\xa0instances)"]})]}),(0,n.jsx)(_,{})]})})}},90927:(e,t,r)=>{"use strict";r.d(t,{N:()=>l});var n=r(49797),a=r(22641);new n.Pq0(0,0,0),new n.O9p(0,0,0,"XYZ"),new n.Pq0(1,1,1);let i={x:0,y:0,z:0,rotationX:0,rotationY:0,rotationZ:0,rotationOrder:"XYZ",rotationUnit:"rad",scaleX:1,scaleY:1,scaleZ:1,scaleScalar:1,pivot:void 0,visible:void 0,name:void 0,parent:void 0,userData:void 0},o=new n.dwI,s=new n.Pq0;function l(e,t){let{x:r,y:l,z:c,position:u=new n.Pq0(r,l,c),rotationX:f,rotationY:m,rotationZ:p,rotationOrder:h,rotationUnit:d,rotation:g,scaleX:_,scaleY:v,scaleZ:x,scaleScalar:y,scale:w=new n.Pq0(_,v,x).multiplyScalar(y),pivot:b,visible:j,name:M,parent:O,userData:P}={...i,...t};return(0,a.jj)(u,e.position),(0,a.if)(null!=g?g:[f,m,p,h,d],e.rotation),(0,a.jj)(w,e.scale),void 0!==b&&(e.updateMatrix(),o.setFromMatrix4(e.matrix),(0,a.jj)(b,s).applyMatrix3(o),e.position.sub(s)),void 0!==j&&(e.visible=j),void 0!==M&&(e.name=M),void 0!==O&&O!==e.parent&&(null===O?e.removeFromParent():O.add(e)),void 0!==P&&Object.assign(e.userData,P),e}}},e=>{var t=t=>e(e.s=t);e.O(0,[5611,7190,6564,7223,9635,8921,4957,7775,16,7953,1577,4638,6726,2598,7373,8083,5795,4266,7840,1319,6852,7358],()=>t(37441)),_N_E=e.O()}]);