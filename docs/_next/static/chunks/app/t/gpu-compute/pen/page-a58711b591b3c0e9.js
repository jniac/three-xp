(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9680],{13261:(n,e,t)=>{Promise.resolve().then(t.bind(t,33925))},17099:(n,e,t)=>{"use strict";t.d(e,{c:()=>s});var r=t(79105);let a=n=>n,o={weightsAreNormalized:!1,indexOffset:0,forbiddenItems:[]};function l(){let n=(0,r.K2)((0,r.K2)((0,r.Ts)(r.KP)));function e(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.KP;return"string"==typeof e&&(e=e.split("").reduce((n,e)=>7*n+e.charCodeAt(0),0)),n=(0,r.K2)((0,r.K2)((0,r.Ts)(e))),i}function t(){return n=(0,r.K2)(n),(0,r.Tj)(n)}function l(n){switch(n.length){default:return[0,1,a];case 1:return[0,n[0],a];case 2:return[n[0],n[1],a];case 3:return[n[0],n[1],n[2]]}}function s(){for(var n=arguments.length,e=Array(n),r=0;r<n;r++)e[r]=arguments[r];let[a,o,s]=l(e);return a+(o-a)*s(t())}function c(){for(var n,e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];let[l,s,{weightsAreNormalized:c,indexOffset:u,forbiddenItems:i}]=function(n){let[e,t=null,r]=n,a={...o,...r};if(Array.isArray(e))return[e,t,a];if("object"==typeof e)return[Object.values(e),t?Object.values(t):null,a];throw Error("pick: unsupported options type")}(r);if(i.length>0){let e=new Set;for(let n of i){let t=l.indexOf(n);t>=0&&e.add(t)}if(l=l.filter((n,t)=>!e.has(t)),s=null!=(n=null==s?void 0:s.filter((n,t)=>!e.has(t)))?n:null,0===l.length)throw Error("pick: all items are forbidden")}if(null===s){let n=Math.floor(t()*l.length);return u&&(n+=u,(n%=l.length)<0&&(n+=l.length)),l[n]}if(!c){let n=s.reduce((n,e)=>n+e,0);s=s.map(e=>e/n)}let f=t(),d=0;for(let n=0;n<l.length;n++)if(f<(d+=s[n]))return l[n];throw Error("among: unreachable")}function u(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=t(),a=t(),o=Math.sqrt(-2*Math.log(r)),l=2*Math.PI*a;return[n+e*o*Math.cos(l),n+e*o*Math.sin(l)]}let i={seed:e,seedMax:function(){return r.Zu},reset:function(){return e(r.KP),i},next:function(){return n=(0,r.K2)(n),i},getState:function(){return n},setState:function(e){return n=e&r.Zu,i},random:t,between:s,around:function(){for(var n=arguments.length,e=Array(n),r=0;r<n;r++)e[r]=arguments[r];let[o=1,l=a]=e,s=2*t();return(s>1?1:-1)*l(s>1?s-1:s)*o},int:function(){for(var n=arguments.length,e=Array(n),r=0;r<n;r++)e[r]=arguments[r];let[a,o,s]=l(e);return a+Math.floor(s(t())*(o-a))},chance:function(n){return t()<n},shuffle:function(n){let{mutate:e=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e&&Array.isArray(n)?n:[...n],a=r.length;for(let n=0;n<a;n++){let e=Math.floor(a*t()),o=r[n];r[n]=r[e],r[e]=o}return r},pick:c,createPicker:function(n){let e=n.map(n=>{let[e]=n;return e}),t=n.map(n=>{let[e,t]=n;return t}),r=t.reduce((n,e)=>n+e,0);for(let[n,e]of t.entries())t[n]=e/r;return()=>c(e,t,{weightsAreNormalized:!0})},vector:function(n,e){let[t=0,r=1]=Array.isArray(e)?e:[null==e?void 0:e.min,null==e?void 0:e.max];for(let e of Object.keys(n))n[e]=s(t,r);return n},unitVector2:function(n){let e=2*Math.PI*t();return n.x=Math.cos(e),n.y=Math.sin(e),n},unitVector3:function(n){let e=t(),r=t(),a=2*Math.PI*e,o=Math.acos(1-2*r);return n.x=Math.sin(o)*Math.cos(a),n.y=Math.sin(o)*Math.sin(a),n.z=Math.cos(o),n},normalVector:function(n){let e=Object.keys(n),t=e.length,r=Math.sqrt(t);for(let a=0;a<t;a+=2){let[o,l]=u();n[e[a]]=o/r,a+1<t&&(n[e[a+1]]=l/r)}return n},unitVector:function(n){let e=Object.keys(n),t=e.length,r=0;for(let a=0;a<t;a+=2){let[o,l]=u();n[e[a]]=o,r+=o*o,a+1<t&&(n[e[a+1]]=l,r+=l*l)}r=Math.sqrt(r);for(let a=0;a<t;a++)n[e[a]]/=r;return n},boxMuller:u,quaternion:function(n){let e=t(),r=t(),a=t(),o=Math.sqrt(1-e),l=Math.sqrt(e);return n.x=o*Math.sin(2*Math.PI*r),n.y=o*Math.cos(2*Math.PI*r),n.z=l*Math.sin(2*Math.PI*a),n.w=l*Math.cos(2*Math.PI*a),n},insideCircle:function(n,e){let r=2*t()*Math.PI,a=Math.sqrt(t())*n;return e.x=a*Math.cos(r),e.y=a*Math.sin(r),e}};return i}let s=class{constructor(n){Object.assign(this,l().seed(n))}};Object.assign(s,l())},22899:(n,e,t)=>{"use strict";t.d(e,{I:()=>o});var r=t(65927);let a=["linear"];for(let n=1;n<=10;n++)a.push("easeIn".concat(n)),a.push("easeOut".concat(n)),a.push("easeInOut".concat(n)),a.push("easeOutIn".concat(n));let o="\n#ifndef GLSL_EASING\n#define GLSL_EASING\n\n".concat(r.S,"\n\nfloat easePow1(float x) {\n  return x;\n}\n\nfloat easePow2(float x) {\n  return x * x;\n}\n\nfloat easePow3(float x) {\n  return x * x * x;\n}\n\nfloat easePow4(float x) {\n  x *= x;\n  return x *= x;\n}\n\nfloat easePow5(float x) {\n  float x0 = x;\n  x *= x;\n  x *= x;\n  return x0 * x;\n}\n\nfloat easePow6(float x) {\n  x *= x * x;\n  return x *= x;\n}\n\nfloat easePow7(float x) {\n  float x0 = x;\n  x *= x * x;\n  x *= x;\n  return x0 * x;\n}\n\nfloat easePow8(float x) {\n  x *= x;\n  x *= x;\n  return x *= x;\n}\n\nfloat easePow9(float x) {\n  x *= x * x;\n  return x *= x * x;\n}\n\nfloat easePow10(float x) {\n  float x0 = x;\n  x *= x * x;\n  x *= x * x;\n  return x0 * x;\n}\n\nfloat linear(float x) {\n  return clamp01(x);\n}\n\n").concat(Array.from({length:10},(n,e)=>{let t=e+1;return"\n\n  float easeIn".concat(t," (float x) {\n    return easePow").concat(t,"(clamp01(x));\n  }\n  float easeOut").concat(t," (float x) {\n    return 1.0 - easePow").concat(t,"(clamp01(1.0 - x));\n  }\n  float easeInOut").concat(t," (float x) {\n    return x < 0.5 \n      ? 0.5 * easePow").concat(t,"(2.0 * x) \n      : 1.0 - 0.5 * easePow").concat(t,"(2.0 * (1.0 - x));\n  }\n  float easeOutIn").concat(t," (float x) {\n    return x < 0.5\n      ? 0.5 * (1.0 - easePow").concat(t,"(1.0 - x * 2.0))\n      : 1.0 - 0.5 * (1.0 - easePow").concat(t,"(2.0 * x - 1.0));\n  }\n\n").trim()}).join("\n\n"),"\n\n\n// https://www.desmos.com/calculator/mqou4lf9zc?lang=fr\nfloat easeInOut(float x, float p, float i) {\n  return  x <= 0.0 ? 0.0 :\n          x >= 1.0 ? 1.0 :\n          x <= i ? 1.0 / pow(i, p - 1.0) * pow(x, p) :\n          1.0 - 1.0 / pow(1.0 - i, p - 1.0) * pow(1.0 - x, p);\n}\n\n// https://www.desmos.com/calculator/nrjlezusdv\nfloat easeInThenOut(float x, float p) {\n  return 1.0 - pow(abs(2.0 * x - 1.0), p);\n}\n\n#endif\n")},28737:(n,e,t)=>{"use strict";t.d(e,{Leak:()=>f,O:()=>i});var r={};t.r(r),t.d(r,{distribute:()=>o.mn,every:()=>o.Si,findMaxBy:()=>o.vj,pairwise:()=>o.Ju,recordBy:()=>o.VY,some:()=>o.zN,split:()=>o.mn,uniqueBy:()=>o.pD});var a=t(30158),o=t(43107),l=t(38062),s=t(85795),c=t(17099),u=t(96122);function i(n){Object.assign(window,{...a,...s,...r,...n,PRNG:c.c,waveform:l.o,dedent:u.T})}function f(n){return i(n),null}},31423:(n,e,t)=>{"use strict";t.d(e,{l:()=>s});var r=t(70691),a=t(18479),o=t(36508);let l={frequency:3,tickerName:"three",precision:1};function s(n){let{frequency:e,tickerName:t,precision:s,...c}={...l,...n},{ref:u}=(0,a.C7)(function*(){let n=o.Rv.get("three");yield n.onTick({timeInterval:1/3},()=>{u.current.innerText="".concat(n.averageFps.toFixed(s)," fps")})},[e,t,s]);return(0,r.jsx)("div",{ref:u,...c,children:"-- fps"})}},33925:(n,e,t)=>{"use strict";t.d(e,{PageClient:()=>b});var r=t(70691),a=t(49797),o=t(99332),l=t(31423),s=t(53097),c=t(55227),u=t(59813);let i={...u.q.defaultParams,colors:["#ffcc00","#00ffcc","#00ccff"]};class f extends u.q{penAt(n,e,t){let{uPen:r,uPenLast:a}=this.updateUniforms;r.value.set(n,e,t),a.value.copy(r.value)}penMove(n,e,t){let{uPen:r,uPenLast:a}=this.updateUniforms;a.value.copy(r.value),r.value.set(n,e,t)}constructor(n){super(n),this.enableGlslLib("glsl_blending","glsl_blur_3_11","glsl_sdf_2d"),this.shaders({initial:{fragmentColor:"\n          gl_FragColor.rgb = vec3(0.0);\n          gl_FragColor.a = 1.0;\n        "},update:{uniforms:{uPenLast:{value:new a.Pq0(.5,.5,.02)},uPen:{value:new a.Pq0(.5,.5,.02)},uColors:{value:this.params.colors.map(n=>new a.Q1f(n))}},fragmentTop:c.M,fragmentColor:"\n          vec2 uv = vUv;\n          vec2 center = uPen.xy;\n          float radius = uPen.z * 0.5;\n          \n          // Draw single circle:\n          // float dist = distance(uv, center) - radius;\n          // Draw rounded line (enabled via glsl_sdf_2d):\n          float dist = sdRoundedSegment(uv, uPenLast.xy, uPen.xy, radius);\n\n          float strength = smoothstep(0.005, -0.005, dist);\n          \n          float decay = 0.995;\n          // No blur:\n          // vec3 prev = texture2D(uTexture, uv).rgb * decay;\n          // With blur (enabled via glsl_blur_3_11):\n          vec3 prev = gaussianBlur11x11(uv, 2.0).rgb * decay;\n\n          Vec3Ramp r = ramp(mod(uTime, 1.0), uColors[0], uColors[1], uColors[2], uColors[0]);\n          vec3 color = mix(r.a, r.b, r.t);\n\n          vec3 pen = color * strength;\n          // gl_FragColor.rgb = max(prev, pen);\n          gl_FragColor.rgb = screenBlending(prev, pen * 0.1);\n        "}})}}f.defaultParams=i;var d=t(77794),x=t(79911),h=t(79285),p=t(36508),v=t(28737),m=t(88352);function g(){let n=(0,s.Fw)();return(0,s.dB)("my-scene",function*(e){n.pipeline.basicPasses.fxaa.enabled=!1;let t=(0,x.mj)(new a.eaF(new a.bdM,new a.V9B),e);t.scale.setScalar(10),(0,x.mj)(new d.u,e).regularGrid({size:10,subdivisions:[2,5]}).onTop();let r=new f({size:2048}).initialize(n.renderer),l=new a.I9Y,s=new a.I9Y,c=!0,u=.2,i=()=>{let e=n.pointer.intersectPlane("xy");if(e.intersected){s.set((0,h.inverseLerp)(-5,5,e.point.x),(0,h.inverseLerp)(-5,5,e.point.y));let n=s.distanceTo(l),t=(0,h.lerp)(.15,.5,100*n);u=(0,h.lerp)(u,t,.01),l.copy(s)}};yield(0,p.xy)("three",n=>{c&&(i(),r.penMove(s.x,s.y,u),r.update(n.deltaTime),t.material.map=r.currentTexture(),t.material.needsUpdate=!0)}),yield(0,o.s)(n.domElement,{onTap:()=>{(c=!c)&&(i(),r.penAt(s.x,s.y,u))}})},[]),null}function b(){return(0,v.O)(),(0,r.jsxs)(s.uB,{vertigoControls:{fixed:!0,size:10,frame:"cover",eventTarget:"canvas"},fullscreenKey:{key:"f",modifiers:"shift"},children:[(0,r.jsxs)("div",{className:"layer thru flex flex-col p-12",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold",children:"GPU Compute - Pen Demo"}),(0,r.jsx)("p",{children:'Simple demo of a "pen" drawing on a canvas using GPU compute shaders.'}),(0,r.jsx)("p",{children:'Currently using a heavy non-optimized (one-pass) kernel 11x11 gaussian blur for the pen "diffuse" effect.'}),(0,r.jsx)(m.A,{}),(0,r.jsx)(l.l,{})]}),(0,r.jsx)(g,{})]})}},38062:(n,e,t)=>{"use strict";t.d(e,{o:()=>r});let r={triangle:function(n){let{frequency:e=1,phase:t=0,f:r=e,p:a=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n*r+a,l=2*o-Math.floor(2*o);return o-Math.floor(o)<.5?l:1-l}}},43107:(n,e,t)=>{"use strict";function r(n,e){for(let t of n)if(e(t))return!0;return!1}function a(n,e){for(let t of n)if(!e(t))return!1;return!0}function o(n,e,t){let r=[];function a(n){let e=[];return r[n]=e,e}if(void 0!==t)for(let n=0;n<t;n++)a(n);for(let t of n){var o;let n=e(t);(null!=(o=r[n])?o:a(n)).push(t)}return r}function*l(n){let e;for(let t of n)void 0!==e&&(yield[e,t]),e=t}function s(n,e){let t,r=-1/0;for(let a of n){let n=e(a);n>r&&(r=n,t=a)}return t}function c(n){let e=new Set;return t=>{let r=n(t);return!e.has(r)&&(e.add(r),!0)}}function u(n){return(e,t)=>{if(null!==e&&"object"!=typeof e)throw Error("Accumulator must be an object");let r=null===e?{}:e,a=n(t);return r[a]||(r[a]=[]),r[a].push(t),r}}t.d(e,{Ju:()=>l,Si:()=>a,VY:()=>u,mn:()=>o,pD:()=>c,vj:()=>s,zN:()=>r})},55227:(n,e,t)=>{"use strict";t.d(e,{M:()=>l});var r=t(22899),a=t(1029);let o="\n\nstruct FloatRamp {\n  float a;\n  float b;\n  float t;\n};\n\nstruct Vec2Ramp {\n  vec2 a;\n  vec2 b;\n  float t;\n};\n\nstruct Vec3Ramp {\n  vec3 a;\n  vec3 b;\n  float t;\n};\n\nstruct Vec4Ramp {\n  vec4 a;\n  vec4 b;\n  float t;\n};\n\n".concat((0,a.N)("vecX",n=>{let e=n[0].toUpperCase()+n.slice(1)+"Ramp";return"\n\n// 1 stop (simple linear interpolation)\n".concat(e," ramp(float t, T a, T b) {\n  return ").concat(e,"(a, b, t);\n}\n\n// 2 stops\n").concat(e," ramp(float t, T a, T b, T c) {\n  if (t < 0.5) {\n    return ").concat(e,"(a, b, t * 2.0);\n  } else {\n    return ").concat(e,"(b, c, t * 2.0 - 1.0);\n  }\n}\n\n// 4 stops\n").concat(e," ramp(float t, T a, T b, T c, T d) {\n  if (t < 0.333) {\n    return ").concat(e,"(a, b, t * 3.0);\n  } else if (t < 0.666) {\n    return ").concat(e,"(b, c, t * 3.0 - 1.0);\n  } else {\n    return ").concat(e,"(c, d, t * 3.0 - 2.0);\n  }\n}\n\n// 5 stops\n").concat(e," ramp(float t, T a, T b, T c, T d, T e) {\n  if (t < 0.25) {\n    return ").concat(e,"(a, b, t * 4.0);\n  } else if (t < 0.5) {\n    return ").concat(e,"(b, c, t * 4.0 - 1.0);\n  } else if (t < 0.75) {\n    return ").concat(e,"(c, d, t * 4.0 - 2.0);\n  } else {\n    return ").concat(e,"(d, e, t * 4.0 - 3.0);\n  }\n}\n\n").slice(1,-1)})),l="\n#ifndef GLSL_RAMP\n#define GLSL_RAMP\n".concat(r.I,"\n").concat(o,"\n#endif\n")},66620:(n,e,t)=>{"use strict";t.d(e,{_:()=>o});var r=t(89868),a=t(44138);function o(n,e){var t=(0,a._)(n,e,"update");return(0,r._)(n,t)}},79105:(n,e,t)=>{"use strict";t.d(e,{K2:()=>l,KP:()=>a,Tj:()=>s,Ts:()=>o,Zu:()=>r});let r=0x7fffffff,a=123456,o=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;if(Number.isNaN(n))throw Error("NaN is not a valid seed.");let e=n;if(10>Math.abs(e)&&(e*=1e6),e%=r,(e=e<0?e+r:e)>1)return e&r;if(0===e)return a;throw Error("Impossible. ".concat(e))},l=n=>n=Math.imul(n,48271)&r,s=n=>(n-1)/(r-1)},88352:(n,e,t)=>{"use strict";t.d(e,{A:()=>o});var r=t(70691),a=t(53097);function o(){let n=(0,a.yk)();return(0,r.jsx)("button",{className:"absolute top-12 right-12 z-10 border border-white/50 hover:bg-black/10 hover:border-white text-white px-2 py-1 rounded transition",onClick:()=>n.setFullscreen("canvas"),children:"Fullscreen"})}}},n=>{var e=e=>n(n.s=e);n.O(0,[5611,7190,6564,7962,9635,8921,7953,4512,7775,7436,146,6726,3445,9332,3414,9717,1763,2143,3097,9813,1319,6852,7358],()=>e(13261)),_N_E=n.O()}]);