(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9680],{13261:(e,t,r)=>{Promise.resolve().then(r.bind(r,33925))},17099:(e,t,r)=>{"use strict";r.d(t,{c:()=>u});var n=r(79105);let l=e=>e,o={weightsAreNormalized:!1,indexOffset:0,forbiddenItems:[]};function a(){let e=(0,n.K2)((0,n.K2)((0,n.Ts)(n.KP)));function t(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.KP;return"string"==typeof t&&(t=t.split("").reduce((e,t)=>7*e+t.charCodeAt(0),0)),e=(0,n.K2)((0,n.K2)((0,n.Ts)(t))),c}function r(){return e=(0,n.K2)(e),(0,n.Tj)(e)}function a(e){switch(e.length){default:return[0,1,l];case 1:return[0,e[0],l];case 2:return[e[0],e[1],l];case 3:return[e[0],e[1],e[2]]}}function u(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[l,o,u]=a(t);return l+(o-l)*u(r())}function i(){for(var e,t=arguments.length,n=Array(t),l=0;l<t;l++)n[l]=arguments[l];let[a,u,{weightsAreNormalized:i,indexOffset:s,forbiddenItems:c}]=function(e){let[t,r=null,n]=e,l={...o,...n};if(Array.isArray(t))return[t,r,l];if("object"==typeof t)return[Object.values(t),r?Object.values(r):null,l];throw Error("pick: unsupported options type")}(n);if(c.length>0){let t=new Set;for(let e of c){let r=a.indexOf(e);r>=0&&t.add(r)}if(a=a.filter((e,r)=>!t.has(r)),u=null!=(e=null==u?void 0:u.filter((e,r)=>!t.has(r)))?e:null,0===a.length)throw Error("pick: all items are forbidden")}if(null===u){let e=Math.floor(r()*a.length);return s&&(e+=s,(e%=a.length)<0&&(e+=a.length)),a[e]}if(!i){let e=u.reduce((e,t)=>e+t,0);u=u.map(t=>t/e)}let f=r(),h=0;for(let e=0;e<a.length;e++)if(f<(h+=u[e]))return a[e];throw Error("among: unreachable")}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=r(),l=r(),o=Math.sqrt(-2*Math.log(n)),a=2*Math.PI*l;return[e+t*o*Math.cos(a),e+t*o*Math.sin(a)]}let c={seed:t,seedMax:function(){return n.Zu},reset:function(){return t(n.KP),c},next:function(){return e=(0,n.K2)(e),c},getState:function(){return e},setState:function(t){return e=t&n.Zu,c},random:r,between:u,around:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[o=1,a=l]=t,u=2*r();return(u>1?1:-1)*a(u>1?u-1:u)*o},int:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[l,o,u]=a(t);return l+Math.floor(u(r())*(o-l))},chance:function(e){return r()<e},shuffle:function(e){let{mutate:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t&&Array.isArray(e)?e:[...e],l=n.length;for(let e=0;e<l;e++){let t=Math.floor(l*r()),o=n[e];n[e]=n[t],n[t]=o}return n},pick:i,createPicker:function(e){let t=e.map(e=>{let[t]=e;return t}),r=e.map(e=>{let[t,r]=e;return r}),n=r.reduce((e,t)=>e+t,0);for(let[e,t]of r.entries())r[e]=t/n;return()=>i(t,r,{weightsAreNormalized:!0})},vector:function(e,t){let[r=0,n=1]=Array.isArray(t)?t:[null==t?void 0:t.min,null==t?void 0:t.max];for(let t of Object.keys(e))e[t]=u(r,n);return e},unitVector2:function(e){let t=2*Math.PI*r();return e.x=Math.cos(t),e.y=Math.sin(t),e},unitVector3:function(e){let t=r(),n=r(),l=2*Math.PI*t,o=Math.acos(1-2*n);return e.x=Math.sin(o)*Math.cos(l),e.y=Math.sin(o)*Math.sin(l),e.z=Math.cos(o),e},normalVector:function(e){let t=Object.keys(e),r=t.length,n=Math.sqrt(r);for(let l=0;l<r;l+=2){let[o,a]=s();e[t[l]]=o/n,l+1<r&&(e[t[l+1]]=a/n)}return e},unitVector:function(e){let t=Object.keys(e),r=t.length,n=0;for(let l=0;l<r;l+=2){let[o,a]=s();e[t[l]]=o,n+=o*o,l+1<r&&(e[t[l+1]]=a,n+=a*a)}n=Math.sqrt(n);for(let l=0;l<r;l++)e[t[l]]/=n;return e},boxMuller:s,quaternion:function(e){let t=r(),n=r(),l=r(),o=Math.sqrt(1-t),a=Math.sqrt(t);return e.x=o*Math.sin(2*Math.PI*n),e.y=o*Math.cos(2*Math.PI*n),e.z=a*Math.sin(2*Math.PI*l),e.w=a*Math.cos(2*Math.PI*l),e},insideCircle:function(e,t){let n=2*r()*Math.PI,l=Math.sqrt(r())*e;return t.x=l*Math.cos(n),t.y=l*Math.sin(n),t}};return c}let u=class{constructor(e){Object.assign(this,a().seed(e))}};Object.assign(u,a())},33925:(e,t,r)=>{"use strict";r.d(t,{PageClient:()=>y});var n=r(70691),l=r(49797),o=r(31423),a=r(53097),u=r(55227),i=r(13565);let s={...i.q.defaultParams,colors:["#ffcc00","#00ffcc","#00ccff"]};class c extends i.q{pen(e,t,r){let{uPen:n,uPenLast:l}=this.updateUniforms;n.value.set(e,t,r),l.value.copy(n.value)}penMove(e,t,r){let{uPen:n,uPenLast:l}=this.updateUniforms;l.value.copy(n.value),n.value.set(e,t,r)}constructor(e){super(e),this.enableGlslLib("glsl_blur_3_11","glsl_sdf_2d"),this.shaders({initial:{fragmentColor:"\n          gl_FragColor.rgb = vec3(0.0);\n          gl_FragColor.a = 1.0;\n        "},update:{uniforms:{uPenLast:{value:new l.Pq0},uPen:{value:new l.Pq0},uColors:{value:this.params.colors.map(e=>new l.Q1f(e))}},fragmentTop:u.M,fragmentColor:"\n          vec2 uv = vUv;\n          vec2 center = uPen.xy;\n          float radius = uPen.z * 0.5;\n          \n          // Draw single circle:\n          // float dist = distance(uv, center) - radius;\n          // Draw rounded line (enabled via glsl_sdf_2d):\n          float dist = sdRoundedSegment(uv, uPenLast.xy, uPen.xy, radius);\n\n          float strength = smoothstep(0.005, -0.005, dist);\n          \n          float decay = 0.995;\n          // No blur:\n          // vec3 prev = texture2D(uTexture, uv).rgb * decay;\n          // With blur (enabled via glsl_blur_3_11):\n          vec3 prev = gaussianBlur11x11(uv, 2.0).rgb * decay;\n\n          Vec3Ramp r = ramp(mod(uTime, 1.0), uColors[0], uColors[1], uColors[2], uColors[0]);\n          vec3 color = mix(r.a, r.b, r.t);\n\n          vec3 pen = color * strength;\n          gl_FragColor.rgb = max(prev, pen);\n        "}})}}c.defaultParams=s;var f=r(77794),h=r(79911),d=r(79285),v=r(36508),p=r(28737),g=r(88352);function m(){let e=(0,a.Fw)();return(0,a.dB)("my-scene",function*(t){e.pipeline.basicPasses.fxaa.enabled=!1;let r=(0,h.mj)(new l.eaF(new l.bdM,new l.V9B),t);r.scale.setScalar(10),(0,h.mj)(new f.u,t).regularGrid({size:10,subdivisions:[2,5]}).onTop();let n=new c({size:2048}).initialize(e.renderer),o=new l.I9Y,a=.2;yield(0,v.xy)("three",t=>{let u=e.pointer.intersectPlane("xy");if(u.intersected){let e=new l.I9Y((0,d.inverseLerp)(-5,5,u.point.x),(0,d.inverseLerp)(-5,5,u.point.y)),t=e.distanceTo(o),r=(0,d.lerp)(.2,.05,500*t);a=(0,d.lerp)(a,r,.01),n.penMove(e.x,e.y,a),o.copy(e)}n.update(t.deltaTime),r.material.map=n.currentTexture(),r.material.needsUpdate=!0})},[]),null}function y(){return(0,p.O)(),(0,n.jsxs)(a.uB,{vertigoControls:{fixed:!0,size:10,frame:"cover",eventTarget:"canvas"},fullscreenKey:{key:"f",modifiers:"shift"},children:[(0,n.jsxs)("div",{className:"layer thru flex flex-col p-12",children:[(0,n.jsx)("h1",{className:"text-4xl font-bold",children:"GPU Compute - Pen Demo"}),(0,n.jsx)("p",{children:'Simple demo of a "pen" drawing on a canvas using GPU compute shaders.'}),(0,n.jsx)("p",{children:'Currently using a heavy non-optimized (one-pass) kernel 11x11 gaussian blur for the pen "diffuse" effect.'}),(0,n.jsx)(g.A,{}),(0,n.jsx)(o.l,{})]}),(0,n.jsx)(m,{})]})}},43107:(e,t,r)=>{"use strict";function n(e,t){for(let r of e)if(t(r))return!0;return!1}function l(e,t){for(let r of e)if(!t(r))return!1;return!0}function o(e,t,r){let n=[];function l(e){let t=[];return n[e]=t,t}if(void 0!==r)for(let e=0;e<r;e++)l(e);for(let r of e){var o;let e=t(r);(null!=(o=n[e])?o:l(e)).push(r)}return n}function*a(e){let t;for(let r of e)void 0!==t&&(yield[t,r]),t=r}function u(e,t){let r,n=-1/0;for(let l of e){let e=t(l);e>n&&(n=e,r=l)}return r}function i(e){let t=new Set;return r=>{let n=e(r);return!t.has(n)&&(t.add(n),!0)}}function s(e){return(t,r)=>{if(null!==t&&"object"!=typeof t)throw Error("Accumulator must be an object");let n=null===t?{}:t,l=e(r);return n[l]||(n[l]=[]),n[l].push(r),n}}r.d(t,{Ju:()=>a,Si:()=>l,VY:()=>s,mn:()=>o,pD:()=>i,vj:()=>u,zN:()=>n})},66620:(e,t,r)=>{"use strict";r.d(t,{_:()=>o});var n=r(89868),l=r(44138);function o(e,t){var r=(0,l._)(e,t,"update");return(0,n._)(e,r)}},79105:(e,t,r)=>{"use strict";r.d(t,{K2:()=>a,KP:()=>l,Tj:()=>u,Ts:()=>o,Zu:()=>n});let n=0x7fffffff,l=123456,o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l;if(Number.isNaN(e))throw Error("NaN is not a valid seed.");let t=e;if(10>Math.abs(t)&&(t*=1e6),t%=n,(t=t<0?t+n:t)>1)return t&n;if(0===t)return l;throw Error("Impossible. ".concat(t))},a=e=>e=Math.imul(e,48271)&n,u=e=>(e-1)/(n-1)}},e=>{var t=t=>e(e.s=t);e.O(0,[5611,7190,6564,7962,9635,8921,7953,4512,7775,7436,146,6726,3445,9332,3414,9717,1763,2143,3097,4722,1319,6852,7358],()=>t(13261)),_N_E=e.O()}]);