(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4780],{17099:(e,t,r)=>{"use strict";r.d(t,{c:()=>u});var n=r(79105);let i=e=>e,l={weightsAreNormalized:!1,indexOffset:0,forbiddenItems:[]};function o(){let e=(0,n.K2)((0,n.K2)((0,n.Ts)(n.KP)));function t(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.KP;return"string"==typeof t&&(t=t.split("").reduce((e,t)=>7*e+t.charCodeAt(0),0)),e=(0,n.K2)((0,n.K2)((0,n.Ts)(t))),c}function r(){return e=(0,n.K2)(e),(0,n.Tj)(e)}function o(e){switch(e.length){default:return[0,1,i];case 1:return[0,e[0],i];case 2:return[e[0],e[1],i];case 3:return[e[0],e[1],e[2]]}}function u(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[i,l,u]=o(t);return i+(l-i)*u(r())}function a(){for(var e,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];let[o,u,{weightsAreNormalized:a,indexOffset:s,forbiddenItems:c}]=function(e){let[t,r=null,n]=e,i={...l,...n};if(Array.isArray(t))return[t,r,i];if("object"==typeof t)return[Object.values(t),r?Object.values(r):null,i];throw Error("pick: unsupported options type")}(n);if(c.length>0){let t=new Set;for(let e of c){let r=o.indexOf(e);r>=0&&t.add(r)}if(o=o.filter((e,r)=>!t.has(r)),u=null!=(e=null==u?void 0:u.filter((e,r)=>!t.has(r)))?e:null,0===o.length)throw Error("pick: all items are forbidden")}if(null===u){let e=Math.floor(r()*o.length);return s&&(e+=s,(e%=o.length)<0&&(e+=o.length)),o[e]}if(!a){let e=u.reduce((e,t)=>e+t,0);u=u.map(t=>t/e)}let f=r(),h=0;for(let e=0;e<o.length;e++)if(f<(h+=u[e]))return o[e];throw Error("among: unreachable")}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=r(),i=r(),l=Math.sqrt(-2*Math.log(n)),o=2*Math.PI*i;return[e+t*l*Math.cos(o),e+t*l*Math.sin(o)]}let c={seed:t,seedMax:function(){return n.Zu},reset:function(){return t(n.KP),c},next:function(){return e=(0,n.K2)(e),c},getState:function(){return e},setState:function(t){return e=t&n.Zu,c},random:r,between:u,around:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[l=1,o=i]=t,u=2*r();return(u>1?1:-1)*o(u>1?u-1:u)*l},int:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[i,l,u]=o(t);return i+Math.floor(u(r())*(l-i))},chance:function(e){return r()<e},shuffle:function(e){let{mutate:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t&&Array.isArray(e)?e:[...e],i=n.length;for(let e=0;e<i;e++){let t=Math.floor(i*r()),l=n[e];n[e]=n[t],n[t]=l}return n},pick:a,createPicker:function(e){let t=e.map(e=>{let[t]=e;return t}),r=e.map(e=>{let[t,r]=e;return r}),n=r.reduce((e,t)=>e+t,0);for(let[e,t]of r.entries())r[e]=t/n;return()=>a(t,r,{weightsAreNormalized:!0})},vector:function(e,t){let[r=0,n=1]=Array.isArray(t)?t:[null==t?void 0:t.min,null==t?void 0:t.max];for(let t of Object.keys(e))e[t]=u(r,n);return e},unitVector2:function(e){let t=2*Math.PI*r();return e.x=Math.cos(t),e.y=Math.sin(t),e},unitVector3:function(e){let t=r(),n=r(),i=2*Math.PI*t,l=Math.acos(1-2*n);return e.x=Math.sin(l)*Math.cos(i),e.y=Math.sin(l)*Math.sin(i),e.z=Math.cos(l),e},normalVector:function(e){let t=Object.keys(e),r=t.length,n=Math.sqrt(r);for(let i=0;i<r;i+=2){let[l,o]=s();e[t[i]]=l/n,i+1<r&&(e[t[i+1]]=o/n)}return e},unitVector:function(e){let t=Object.keys(e),r=t.length,n=0;for(let i=0;i<r;i+=2){let[l,o]=s();e[t[i]]=l,n+=l*l,i+1<r&&(e[t[i+1]]=o,n+=o*o)}n=Math.sqrt(n);for(let i=0;i<r;i++)e[t[i]]/=n;return e},boxMuller:s,quaternion:function(e){let t=r(),n=r(),i=r(),l=Math.sqrt(1-t),o=Math.sqrt(t);return e.x=l*Math.sin(2*Math.PI*n),e.y=l*Math.cos(2*Math.PI*n),e.z=o*Math.sin(2*Math.PI*i),e.w=o*Math.cos(2*Math.PI*i),e},insideCircle:function(e,t){let n=2*r()*Math.PI,i=Math.sqrt(r())*e;return t.x=i*Math.cos(n),t.y=i*Math.sin(n),t}};return c}let u=class{constructor(e){Object.assign(this,o().seed(e))}};Object.assign(u,o())},43107:(e,t,r)=>{"use strict";function n(e,t){for(let r of e)if(t(r))return!0;return!1}function i(e,t){for(let r of e)if(!t(r))return!1;return!0}function l(e,t,r){let n=[];function i(e){let t=[];return n[e]=t,t}if(void 0!==r)for(let e=0;e<r;e++)i(e);for(let r of e){var l;let e=t(r);(null!=(l=n[e])?l:i(e)).push(r)}return n}function*o(e){let t;for(let r of e)void 0!==t&&(yield[t,r]),t=r}function u(e,t){let r,n=-1/0;for(let i of e){let e=t(i);e>n&&(n=e,r=i)}return r}function a(e){let t=new Set;return r=>{let n=e(r);return!t.has(n)&&(t.add(n),!0)}}function s(e){return(t,r)=>{if(null!==t&&"object"!=typeof t)throw Error("Accumulator must be an object");let n=null===t?{}:t,i=e(r);return n[i]||(n[i]=[]),n[i].push(r),n}}r.d(t,{Ju:()=>o,Si:()=>i,VY:()=>s,mn:()=>l,pD:()=>a,vj:()=>u,zN:()=>n})},66620:(e,t,r)=>{"use strict";r.d(t,{_:()=>l});var n=r(89868),i=r(44138);function l(e,t){var r=(0,i._)(e,t,"update");return(0,n._)(e,r)}},75549:(e,t,r)=>{"use strict";r.d(t,{PageClient:()=>y});var n=r(70691),i=r(49797),l=r(31423),o=r(53097),u=r(13565);let a={...u.q.defaultParams,viscosity:.99};class s extends u.q{pointer(e,t,r,n){let{uPointer:i}=this.updateUniforms;i.value.set(e,t,r,n)}constructor(e){super(e),this.shaders({initial:{fragmentColor:"\n          gl_FragColor.rgb = vec3(0.0);\n          gl_FragColor.a = 1.0;\n        "},update:{uniforms:{uViscosity:{value:this.params.viscosity},uPointer:{value:new i.IUQ(.5,.5,.1,1)}},fragmentColor:"\n          vec2 uv = vUv;\n          float viscosity = uViscosity;\n          float scale = 3.0;\n          vec2 cellSize = scale / uTextureSize;\n\n          vec4 center = texture2D(uTexture, uv);\n          vec4 north = texture2D(uTexture, uv + vec2(0.0, cellSize.y));\n          vec4 south = texture2D(uTexture, uv - vec2(0.0, cellSize.y));\n          vec4 east = texture2D(uTexture, uv + vec2(cellSize.x, 0.0));\n          vec4 west = texture2D(uTexture, uv - vec2(cellSize.x, 0.0));\n\n          // x: previous height\n          // y: penultimate height\n          // z: unused\n          // w: unused\n\n          float newHeight = ((north.x + south.x + east.x + west.x) * 0.5 - center.y) * viscosity;\n\n          // Pointer influence\n          float radius = uPointer.z;\n          float strength = uPointer.w;\n          float dist = distance(uv, uPointer.xy) - radius;\n          float cellLength = length(cellSize);\n          float influence = smoothstep(cellLength * 0.5, -cellLength * 0.5, dist);\n          newHeight += influence * strength * cos(uTime * 10.0);\n\n          gl_FragColor = vec4(newHeight, center.x, 0.0, 1.0);\n        "}})}}s.defaultParams=a;var c=r(77794),f=r(7147),h=r(79911),d=r(79285),v=r(36508),g=r(28737),m=r(55227),p=r(88352);function x(){let e=(0,o.Fw)();return(0,o.dB)("my-scene",function*(t){e.pipeline.basicPasses.fxaa.enabled=!1;let r=(0,h.mj)(new i.eaF(new i.bdM,new i.V9B),t);r.scale.setScalar(10),r.material.onBeforeCompile=e=>f.bI.with(e).fragment.top(m.M).fragment.after("map_fragment","\n        vec3 data = diffuseColor.rgb;\n        diffuseColor.r = clamp(data.r, 0.0, 1.0);\n        diffuseColor.g = clamp(-data.r, 0.0, 1.0);\n\n        Vec3Ramp r = ramp(0.5 + data.r * 0.1, ".concat((0,f.eR)("#9e0202ff"),", ").concat((0,f.eR)("#000000"),", ").concat((0,f.eR)("#027254ff"),");\n        diffuseColor.rgb = mix(r.a, r.b, r.t);\n      ")),(0,h.mj)(new c.u,t).regularGrid({size:10,subdivisions:[2,5]}).onTop();let n=new s({size:2048,viscosity:.99}).initialize(e.renderer);yield(0,v.xy)("three",t=>{let i=e.pointer.intersectPlane("xy");if(i.intersected){let e=(0,d.inverseLerp)(-5,5,i.point.x),t=(0,d.inverseLerp)(-5,5,i.point.y);n.pointer(e,t,.02,1)}n.update(t.deltaTime),r.material.map=n.currentTexture(),r.material.needsUpdate=!0})},[]),null}function y(){return(0,g.O)(),(0,n.jsxs)(o.uB,{vertigoControls:{fixed:!0,size:10.5,eventTarget:"canvas"},children:[(0,n.jsxs)("div",{className:"layer thru flex flex-col p-12",children:[(0,n.jsx)("h1",{className:"text-4xl font-bold",children:"GPU Compute - Water Demo"}),(0,n.jsx)("p",{children:"Classic water simulation using a height map and GPU Compute."}),(0,n.jsx)(p.A,{}),(0,n.jsx)(l.l,{})]}),(0,n.jsx)(x,{})]})}},79105:(e,t,r)=>{"use strict";r.d(t,{K2:()=>o,KP:()=>i,Tj:()=>u,Ts:()=>l,Zu:()=>n});let n=0x7fffffff,i=123456,l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;if(Number.isNaN(e))throw Error("NaN is not a valid seed.");let t=e;if(10>Math.abs(t)&&(t*=1e6),t%=n,(t=t<0?t+n:t)>1)return t&n;if(0===t)return i;throw Error("Impossible. ".concat(t))},o=e=>e=Math.imul(e,48271)&n,u=e=>(e-1)/(n-1)},97313:(e,t,r)=>{Promise.resolve().then(r.bind(r,75549))}},e=>{var t=t=>e(e.s=t);e.O(0,[5611,7190,6564,7962,9635,8921,7953,4512,7775,7436,146,6726,3445,9332,3414,9717,1763,2143,3097,4722,1319,6852,7358],()=>t(97313)),_N_E=e.O()}]);