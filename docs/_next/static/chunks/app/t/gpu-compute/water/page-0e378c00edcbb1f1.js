(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4780],{17099:(e,t,n)=>{"use strict";n.d(t,{c:()=>o});var r=n(79105);let l=e=>e,i={weightsAreNormalized:!1,indexOffset:0,forbiddenItems:[]};function u(){let e=(0,r.K2)((0,r.K2)((0,r.Ts)(r.KP)));function t(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.KP;return"string"==typeof t&&(t=t.split("").reduce((e,t)=>7*e+t.charCodeAt(0),0)),e=(0,r.K2)((0,r.K2)((0,r.Ts)(t))),c}function n(){return e=(0,r.K2)(e),(0,r.Tj)(e)}function u(e){switch(e.length){default:return[0,1,l];case 1:return[0,e[0],l];case 2:return[e[0],e[1],l];case 3:return[e[0],e[1],e[2]]}}function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[l,i,o]=u(t);return l+(i-l)*o(n())}function a(){for(var e,t=arguments.length,r=Array(t),l=0;l<t;l++)r[l]=arguments[l];let[u,o,{weightsAreNormalized:a,indexOffset:s,forbiddenItems:c}]=function(e){let[t,n=null,r]=e,l={...i,...r};if(Array.isArray(t))return[t,n,l];if("object"==typeof t)return[Object.values(t),n?Object.values(n):null,l];throw Error("pick: unsupported options type")}(r);if(c.length>0){let t=new Set;for(let e of c){let n=u.indexOf(e);n>=0&&t.add(n)}if(u=u.filter((e,n)=>!t.has(n)),o=null!=(e=null==o?void 0:o.filter((e,n)=>!t.has(n)))?e:null,0===u.length)throw Error("pick: all items are forbidden")}if(null===o){let e=Math.floor(n()*u.length);return s&&(e+=s,(e%=u.length)<0&&(e+=u.length)),u[e]}if(!a){let e=o.reduce((e,t)=>e+t,0);o=o.map(t=>t/e)}let f=n(),h=0;for(let e=0;e<u.length;e++)if(f<(h+=o[e]))return u[e];throw Error("among: unreachable")}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=n(),l=n(),i=Math.sqrt(-2*Math.log(r)),u=2*Math.PI*l;return[e+t*i*Math.cos(u),e+t*i*Math.sin(u)]}let c={seed:t,seedMax:function(){return r.Zu},reset:function(){return t(r.KP),c},next:function(){return e=(0,r.K2)(e),c},getState:function(){return e},setState:function(t){return e=t&r.Zu,c},random:n,between:o,around:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[i=1,u=l]=t,o=2*n();return(o>1?1:-1)*u(o>1?o-1:o)*i},int:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[l,i,o]=u(t);return l+Math.floor(o(n())*(i-l))},chance:function(e){return n()<e},shuffle:function(e){let{mutate:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t&&Array.isArray(e)?e:[...e],l=r.length;for(let e=0;e<l;e++){let t=Math.floor(l*n()),i=r[e];r[e]=r[t],r[t]=i}return r},pick:a,createPicker:function(e){let t=e.map(e=>{let[t]=e;return t}),n=e.map(e=>{let[t,n]=e;return n}),r=n.reduce((e,t)=>e+t,0);for(let[e,t]of n.entries())n[e]=t/r;return()=>a(t,n,{weightsAreNormalized:!0})},vector:function(e,t){let[n=0,r=1]=Array.isArray(t)?t:[null==t?void 0:t.min,null==t?void 0:t.max];for(let t of Object.keys(e))e[t]=o(n,r);return e},unitVector2:function(e){let t=2*Math.PI*n();return e.x=Math.cos(t),e.y=Math.sin(t),e},unitVector3:function(e){let t=n(),r=n(),l=2*Math.PI*t,i=Math.acos(1-2*r);return e.x=Math.sin(i)*Math.cos(l),e.y=Math.sin(i)*Math.sin(l),e.z=Math.cos(i),e},normalVector:function(e){let t=Object.keys(e),n=t.length,r=Math.sqrt(n);for(let l=0;l<n;l+=2){let[i,u]=s();e[t[l]]=i/r,l+1<n&&(e[t[l+1]]=u/r)}return e},unitVector:function(e){let t=Object.keys(e),n=t.length,r=0;for(let l=0;l<n;l+=2){let[i,u]=s();e[t[l]]=i,r+=i*i,l+1<n&&(e[t[l+1]]=u,r+=u*u)}r=Math.sqrt(r);for(let l=0;l<n;l++)e[t[l]]/=r;return e},boxMuller:s,quaternion:function(e){let t=n(),r=n(),l=n(),i=Math.sqrt(1-t),u=Math.sqrt(t);return e.x=i*Math.sin(2*Math.PI*r),e.y=i*Math.cos(2*Math.PI*r),e.z=u*Math.sin(2*Math.PI*l),e.w=u*Math.cos(2*Math.PI*l),e},insideCircle:function(e,t){let r=2*n()*Math.PI,l=Math.sqrt(n())*e;return t.x=l*Math.cos(r),t.y=l*Math.sin(r),t}};return c}let o=class{constructor(e){Object.assign(this,u().seed(e))}};Object.assign(o,u())},43107:(e,t,n)=>{"use strict";function r(e,t){for(let n of e)if(t(n))return!0;return!1}function l(e,t){for(let n of e)if(!t(n))return!1;return!0}function i(e,t,n){let r=[];function l(e){let t=[];return r[e]=t,t}if(void 0!==n)for(let e=0;e<n;e++)l(e);for(let n of e){var i;let e=t(n);(null!=(i=r[e])?i:l(e)).push(n)}return r}function*u(e){let t;for(let n of e)void 0!==t&&(yield[t,n]),t=n}function o(e,t){let n,r=-1/0;for(let l of e){let e=t(l);e>r&&(r=e,n=l)}return n}function a(e){let t=new Set;return n=>{let r=e(n);return!t.has(r)&&(t.add(r),!0)}}function s(e){return(t,n)=>{if(null!==t&&"object"!=typeof t)throw Error("Accumulator must be an object");let r=null===t?{}:t,l=e(n);return r[l]||(r[l]=[]),r[l].push(n),r}}n.d(t,{Ju:()=>u,Si:()=>l,VY:()=>s,mn:()=>i,pD:()=>a,vj:()=>o,zN:()=>r})},66620:(e,t,n)=>{"use strict";n.d(t,{_:()=>i});var r=n(89868),l=n(44138);function i(e,t){var n=(0,l._)(e,t,"update");return(0,r._)(e,n)}},75549:(e,t,n)=>{"use strict";n.d(t,{PageClient:()=>x});var r=n(70691),l=n(49797),i=n(31423),u=n(53097),o=n(13565);class a extends o.q{pointer(e,t,n,r){let{uPointer:l}=this.updateUniforms;l.value.set(e,t,n,r)}constructor(e){super(e),this.shaders({initial:{fragmentColor:"\n          gl_FragColor.rgb = vec3(0.0);\n          gl_FragColor.a = 1.0;\n        "},update:{uniforms:{uPointer:{value:new l.IUQ(.5,.5,.1,1)}},fragmentColor:"\n          vec2 uv = vUv;\n          float viscosity = 0.98;\n          float scale = 3.0;\n          vec2 cellSize = scale / uTextureSize;\n\n          vec4 center = texture2D(uTexture, uv);\n          vec4 north = texture2D(uTexture, uv + vec2(0.0, cellSize.y));\n          vec4 south = texture2D(uTexture, uv - vec2(0.0, cellSize.y));\n          vec4 east = texture2D(uTexture, uv + vec2(cellSize.x, 0.0));\n          vec4 west = texture2D(uTexture, uv - vec2(cellSize.x, 0.0));\n\n          // x: previous height\n          // y: penultimate height\n          // z: unused\n          // w: unused\n\n          float newHeight = ((north.x + south.x + east.x + west.x) * 0.5 - center.y) * viscosity;\n\n          // Pointer influence\n          float radius = uPointer.z;\n          float strength = uPointer.w;\n          float dist = distance(uv, uPointer.xy) - radius;\n          float cellLength = length(cellSize);\n          float influence = smoothstep(cellLength * 0.5, -cellLength * 0.5, dist);\n          newHeight += influence * strength * cos(uTime * 10.0);\n\n          gl_FragColor = vec4(newHeight, center.x, 0.0, 1.0);\n        "}})}}var s=n(79911),c=n(79285),f=n(36508),h=n(28737),d=n(77794),v=n(88352);function g(){let e=(0,u.Fw)();return(0,u.dB)("my-scene",function*(t){e.pipeline.basicPasses.fxaa.enabled=!1;let n=(0,s.mj)(new l.eaF(new l.bdM,new l.V9B),t);n.scale.setScalar(10),(0,s.mj)(new d.u,t).regularGrid({size:10,subdivisions:[2,5]}).onTop();let r=new a({size:2048}).initialize(e.renderer);yield(0,f.xy)("three",t=>{let l=e.pointer.intersectPlane("xy");if(l.intersected){let e=(0,c.inverseLerp)(-5,5,l.point.x),t=(0,c.inverseLerp)(-5,5,l.point.y);r.pointer(e,t,.02,1)}r.update(t.deltaTime),n.material.map=r.currentTexture(),n.material.needsUpdate=!0})},[]),null}function x(){return(0,h.O)(),(0,r.jsxs)(u.uB,{vertigoControls:{fixed:!0,size:10.5,eventTarget:"canvas"},children:[(0,r.jsxs)("div",{className:"layer thru flex flex-col p-12",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold",children:"GPU Compute - Water Demo"}),(0,r.jsx)("p",{children:"Classic water simulation using a height map and GPU Compute."}),(0,r.jsx)(v.A,{}),(0,r.jsx)(i.l,{})]}),(0,r.jsx)(g,{})]})}},79105:(e,t,n)=>{"use strict";n.d(t,{K2:()=>u,KP:()=>l,Tj:()=>o,Ts:()=>i,Zu:()=>r});let r=0x7fffffff,l=123456,i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l;if(Number.isNaN(e))throw Error("NaN is not a valid seed.");let t=e;if(10>Math.abs(t)&&(t*=1e6),t%=r,(t=t<0?t+r:t)>1)return t&r;if(0===t)return l;throw Error("Impossible. ".concat(t))},u=e=>e=Math.imul(e,48271)&r,o=e=>(e-1)/(r-1)},97313:(e,t,n)=>{Promise.resolve().then(n.bind(n,75549))}},e=>{var t=t=>e(e.s=t);e.O(0,[5611,7190,6564,7962,9635,8921,7953,4512,7775,7436,146,6726,3445,9332,3414,9717,1763,2143,3097,3542,1319,6852,7358],()=>t(97313)),_N_E=e.O()}]);