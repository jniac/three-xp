(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[678,3097,7840],{2765:(e,t,n)=>{"use strict";n.d(t,{Client:()=>_});var r=n(70691),i=n(1253),a=n(67203),o=n(49797),s=n(30158),l=n(55551),u=n(57165),c=n(72598),d=n(49617),h=n(7587),f=n(31107),p=n(48083),g=n(56647);class v extends g.R{constructor(e,{color:t="#ffff00"}={}){super(void 0,new o.mrM({color:t})),this.position.copy(e.focus),this.rotation.copy(e.rotation);let{x:n,y:r}=e.size;1!==e.zoom&&this.rectangle([-n/2,-r/2,n,r]),n/=e.zoom,r/=e.zoom,this.rectangle([-n/2,-r/2,n,r]).plus([0,0],.5).draw();let i=new o.eaF(new o.bdM(1,.25),new o.V9B({color:t,alphaMap:function(){let e;return null!=e?e:e=(()=>{let e=document.createElement("canvas"),t=e.getContext("2d");e.width=1024,e.height=256,t.fillStyle="white",t.font="200px Fira Code",t.textBaseline="top",t.fillText("Vertigo",20,20);let n=new o.gPd(e);return n.needsUpdate=!0,n})()}(),transparent:!0,side:o.$EB}));i.position.set(-n/2+.5+.1,r/2-.125-.1,0),this.add(i)}}var x=n(9723),m=n(87381),y=n(29717),w=n(17099),b=n(80425),C=n(36508),P=n(25809),I=n(82091),S=n(16008);class z extends o.YJl{onTick(e){this.parts.rings.rotation.y+=.123*e.deltaTime,this.parts.rings.rotation.x+=.435*e.deltaTime}constructor(...e){super(...e),this.internal={ringGeometry:new o.O3Y(3,.01,16,128)},this.parts=(()=>{let e=(0,m.mj)(new o.YJl,{parent:this}),t=(0,m.mj)(new o.eaF(this.internal.ringGeometry,new x.Y({color:"#eb1640",luminosity:.8})),{parent:e,name:"ring-x",rotationY:"90deg"}),n=(0,m.mj)(new o.eaF(this.internal.ringGeometry,new x.Y({color:"#00ff9d",luminosity:.8})),{parent:e,name:"ring-y",rotationX:"90deg"}),r=(0,m.mj)(new o.eaF(this.internal.ringGeometry,new x.Y({color:"#3b80e7",luminosity:.8})),{parent:e,name:"ring-z"});return{rings:e,ringX:t,ringY:n,ringZ:r,torusKnot:(0,m.mj)(new o.eaF(new o.UPV(3,.1,512,64),new x.Y({luminosity:.8})),{parent:this,name:"torus-knot"})}})()}}class M extends o.Z58{constructor(...e){super(...e),this.parts={sky:(0,m.mj)(new I.N({color:"#027bff"}),{parent:this}),thing:(0,m.mj)(new z,{parent:this}),gridZ:(0,m.mj)(new P.P({step:.5}),{parent:this}),widget:(0,m.mj)(new S.XI,{parent:this})}}}class A extends o.BKk{constructor(){super({uniforms:{uResolution:{value:new o.IUQ},uRect:{value:new o.IUQ},map:{value:null}},vertexShader:"\n        uniform vec4 uResolution;\n        uniform vec4 uRect;\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position.xy = ((position.xy * 2.0 + 1.0) * uRect.zw + uRect.xy * 2.0) / uResolution.xy - 1.0; \n          gl_Position.z = 0.0;\n          gl_Position.w = 1.0;\n          // gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:"\n        uniform sampler2D map;\n        varying vec2 vUv;\n        void main() {\n          gl_FragColor = texture2D(map, vUv);\n        }\n      ",transparent:!0,depthWrite:!1,depthTest:!1})}}class B extends o.eaF{*initialize(e,t){let{rt:n,scene:r,camera:i,vertigo:a,widget:s}=this.internal,l=this.material.uniforms.uResolution.value,u=this.material.uniforms.uRect.value,d=new o.I9Y,h=new o.I9Y(-1,-1),f=!1;yield(0,c.s)(e.domElement,{onDown:()=>{f=!0},onUp:()=>{f=!1},onChange:e=>{h.x=(e.localPosition.x-u.x)/u.z*2-1,h.y=-(e.localPosition.y/u.w*2-1)},onTap:()=>{switch(s.getPressed()){case S.KJ.BOX:t.actions.togglePerspective();break;case S.KJ.POSITIVE_X:t.actions.positiveXAlign();break;case S.KJ.NEGATIVE_X:t.actions.negativeXAlign();break;case S.KJ.POSITIVE_Y:t.actions.positiveYAlign();break;case S.KJ.NEGATIVE_Y:t.actions.negativeYAlign();break;case S.KJ.POSITIVE_Z:t.actions.positiveZAlign();break;case S.KJ.NEGATIVE_Z:t.actions.negativeZAlign()}}}),yield(0,C.xy)("three",{order:1},()=>{e.getSize(d),l.set(d.x,d.y,e.getPixelRatio(),0),u.x=d.x-u.z,u.y=d.y-u.w,a.rotation.copy(t.vertigo.rotation),a.perspective=t.vertigo.perspective,a.apply(i,1),s.widgetUpdate(h,f,i),h.x>=-1&&h.x<=1&&h.y>=-1&&h.y<=1&&(null!==s.getHovered()?document.body.style.cursor="pointer":document.body.style.removeProperty("cursor")),e.setRenderTarget(n),e.setClearColor("white",0),e.render(r,i),e.setRenderTarget(null)})}constructor({planeSize:e=120}={}){let t=new A;super(new o.bdM(1,1),t),this.vertigoControls=null;let n=2*e,r=new o.nWS(n,n,{format:o.GWd,colorSpace:"srgb"}),i=new o.Z58,a=new o.ubm,s=new f.B({perspective:1,size:[2.8,2.8]}),l=new S.XI;i.add(l),this.internal={rt:r,scene:i,camera:a,vertigo:s,widget:l},this.renderOrder=1,this.frustumCulled=!1,t.uniforms.map.value=this.internal.rt.texture,t.uniforms.uRect.value.set(10,10,e,e),this.position.x=2}}var T=n(56652),j=n.n(T);function k(e){let{vertigo:t}=e,{ref:n}=(0,h.C7)(function*(e){yield(0,C.xy)("three",{timeInterval:1/6},()=>{e.querySelector("pre").textContent=i.Ay.dump(t.toDeclaration(),{flowLevel:1}).replace(/-?\d+\.\d+/g,e=>(0,b.ZV)(Number.parseFloat(e),{maxDigits:6}))})},[]);return(0,r.jsx)("div",{ref:n,className:"self-start p-4 border border-white rounded text-xs ".concat(j().BgBlur),style:{minWidth:"24rem"},children:(0,r.jsx)("pre",{})})}class O extends o.YJl{onTick(e){for(let t of this.parts.cubes){let{angularVelocity:n}=t.userData;t.rotation.x+=n.x*e.deltaTime,t.rotation.y+=n.y*e.deltaTime,t.rotation.z+=n.z*e.deltaTime}}constructor(...e){super(...e),this.parts={knot:(0,m.mj)(new o.eaF(new o.UPV(1,.5,256,32),new x.Y),{parent:this}),knot2:(0,m.mj)(new o.eaF(new o.UPV(1.37,.05,256,32),new x.Y({color:S.Bn.xColor})),{parent:this}),cubes:Array.from({length:20},(e,t)=>{let n=w.c.between(-3,3),r=w.c.between(-1.5,1.5),i=w.c.between(-3,3),a=["".concat(w.c.between(0,360),"deg"),"".concat(w.c.between(0,360),"deg"),"".concat(w.c.between(0,360),"deg")],s=w.c.between(.5,1),u=(0,m.mj)(new o.eaF(new l.j(1),new x.Y({color:w.c.pick(Object.values(S.Bn))})),{parent:this,x:n,y:r,z:i,rotation:a,scaleScalar:s});return u.userData={angularVelocity:new o.O9p(w.c.between(-1,1),w.c.between(-1,1),w.c.between(-1,1))},u})}}}function _(){let e=(0,a.useMemo)(()=>{let e=new f.B({size:[4.2,4.2]}),t=new f.B({perspective:0,focus:[-10,3,0],size:[8,4],rotation:[0,"45deg",0]}),n=t.clone().set({perspective:1,size:t.size.clone().multiplyScalar(1.2)}),r=t.clone().set({perspective:1,size:t.size.clone().multiplyScalar(1.5),rotation:[0,"-15deg","-25deg"]}),i=new f.B({perspective:1,focus:[-4.5,1.8,10],size:[12,9],rotation:["-3deg","1deg","12deg"]}),a=new f.B({perspective:1,focus:[-4.5,1.8,14],size:i.size.clone().multiplyScalar(1.5),rotation:["-3deg","1deg","0deg"]}),o={main:e,a0:t,a1:n,a2:r,back:i,back2:a,zoom:new f.B({focus:[6,-4,0],size:[4,4],zoom:.25}),revert:new f.B({rotation:["12.6deg","145.3deg","0deg"],focus:[-5,-.5,3.6],size:[12,12],fov:"60deg"})},s=new p.n(o.main);return{vertigos:o,vertigoControls:s}},[]),{ref:t}=(0,h.C7)(function*(t){let{vertigoControls:n}=e,r=new s.WebGLRenderer({antialias:!0});r.outputColorSpace="srgb",t.prepend(r.domElement);let i=1;yield(0,d.G)(t,{onSize:()=>{r.setPixelRatio(window.devicePixelRatio),r.setSize(t.clientWidth,t.clientHeight),i=t.clientWidth/t.clientHeight}});let a=new o.ubm(75,1,.1,1e3);a.position.z=5,yield n.start(r.domElement);let l=new M,h=C.Rv.get("three");(0,u.O)(h.requestActivation);let f=new B;l.add(f),yield*f.initialize(r,n);let p=new o.I9Y,g=!1;for(let t of(yield h.onTick(e=>{e.propagate(l),l.parts.widget.widgetUpdate(p,g,a),null!==l.parts.widget.getHovered()?document.body.style.cursor="pointer":document.body.style.removeProperty("cursor"),n.update(a,i),r.render(l,a)}),yield(0,c.s)(r.domElement,{onChange:e=>{let{x:t,y:n}=e.relativeLocalPosition;p.set(2*t-1,-((2*n-1)*1))},onDown:()=>{g=!0},onUp:()=>{g=!1},onTap:()=>{let e=l.parts.widget.getPressed();switch(null!==e&&n.actions.focus([0,0,0]),e){case S.KJ.BOX:n.actions.togglePerspective();break;case S.KJ.POSITIVE_X:n.actions.positiveXAlign();break;case S.KJ.NEGATIVE_X:n.actions.negativeXAlign();break;case S.KJ.POSITIVE_Y:n.actions.positiveYAlign();break;case S.KJ.NEGATIVE_Y:n.actions.negativeYAlign();break;case S.KJ.POSITIVE_Z:n.actions.positiveZAlign();break;case S.KJ.NEGATIVE_Z:n.actions.negativeZAlign()}}}),Object.values(e.vertigos)))(0,m.mj)(new v(t),l);let x=new O;l.add(x),x.position.copy(e.vertigos.a0.focus),x.rotation.copy(e.vertigos.a0.rotation),yield()=>{r.dispose(),t.removeChild(r.domElement)}},[]),{vertigoControls:n}=e;return(0,r.jsx)("div",{ref:t,className:"".concat(j().VertigoWidgetClient," layer thru"),children:(0,r.jsxs)("div",{className:"layer thru p-4 flex flex-col gap-4 items-start",children:[(0,r.jsx)("h1",{className:"text-2xl self-start",children:"Vertigo-widget"}),(0,r.jsxs)("div",{className:"".concat(j().BgBlur," thru flex flex-col gap-1 items-start p-1 border border-white rounded"),style:{width:"min(200px, 30%)"},children:[(0,r.jsx)("h2",{children:"Actions:"}),(0,r.jsxs)("div",{className:"thru flex flex-row flex-wrap items-start gap-1",children:[(0,r.jsx)("button",{className:"".concat(j().BgBlur," px-2 py-1 border border-white rounded hover:bg-[#fff2]"),onClick:()=>{y.X5.tween({target:n.vertigo,duration:1,ease:"inOut2",to:{perspective:0}})},children:"ortho"}),(0,r.jsx)("button",{className:"".concat(j().BgBlur," px-2 py-1 border border-white rounded hover:bg-[#fff2]"),onClick:()=>{y.X5.tween({target:n.vertigo,duration:1,ease:"inOut2",to:{perspective:1}})},children:"pers:1"}),(0,r.jsx)("button",{className:"".concat(j().BgBlur," px-2 py-1 border border-white rounded hover:bg-[#fff2]"),onClick:()=>{y.X5.tween({target:n.vertigo,duration:1,ease:"inOut2",to:{perspective:1.5}})},children:"pers:1.5"}),(0,r.jsx)("button",{className:"".concat(j().BgBlur," px-2 py-1 border border-white rounded hover:bg-[#fff2]"),onClick:()=>{y.X5.tween({target:n.vertigo,duration:1,ease:"inOut2",to:{zoom:1}})},children:"zoom:1"}),(0,r.jsx)("button",{className:"".concat(j().BgBlur," px-2 py-1 border border-white rounded hover:bg-[#fff2]"),onClick:()=>{y.X5.tween({target:n.vertigo,duration:.75,ease:"inOut2",to:{focus:new o.Pq0}})},children:"focus:(0,0,0)"})]})]}),(0,r.jsxs)("div",{className:"".concat(j().BgBlur," thru flex flex-col gap-1 items-start p-1 border border-white rounded"),style:{width:"min(200px, 30%)"},children:[(0,r.jsx)("h2",{children:"Presets:"}),(0,r.jsx)("div",{className:"flex flex-row gap-1 flex-wrap",children:Object.entries(e.vertigos).map(t=>{let[n,i]=t;return(0,r.jsx)("button",{className:"".concat(j().BgBlur," px-2 py-1 border border-white rounded hover:bg-[#fff2]"),onClick:()=>{let t=e.vertigoControls.vertigo.clone();y.X5.during(1).onUpdate(n=>{let{progress:r}=n,a=y.X5.ease("inOut3")(r);e.vertigoControls.vertigo.lerpVertigos(t,i,a)})},children:n},n)})})]}),(0,r.jsx)("div",{className:"Space flex-1 pointer-events-none"}),(0,r.jsx)(k,{vertigo:n.vertigo})]})})}},9723:(e,t,n)=>{"use strict";n.d(t,{Y:()=>o});var r=n(49797),i=n(60041);let a={shadowColor:"#808080",luminosity:1,rampPower:1,onBeforeCompile:void 0};class o extends r.V9B{constructor(e){let{rampPower:t,shadowColor:n,luminosity:o,onBeforeCompile:s,...l}={...a,...e},u={uSunPosition:{value:new r.Pq0(.5,.7,.3)},uShadowColor:{value:new r.Q1f(n)},uRampPower:{value:t},uLuminosity:{value:o}};super(l),this.onBeforeCompile=e=>{i.b.with(e).uniforms(u).varying({vWorldNormal:"vec3"}).vertex.mainAfterAll("\n          vWorldNormal = mat3(modelMatrix) * normal;\n        ").fragment.after("map_fragment","\n          vec3 lightDirection = normalize(uSunPosition);\n          float light = dot(vWorldNormal, lightDirection) * 0.5 + 0.5;\n          light = pow(light, uRampPower);\n          diffuseColor.rgb *= mix(uShadowColor * uLuminosity, vec3(1.0), light);\n        "),null==s||s(e)},this.sunPosition=u.uSunPosition.value}}},14274:(e,t,n)=>{"use strict";n.d(t,{K:()=>l});var r=n(17953),i=n(81074),a=n(49797),o=n(57165),s=n(37027);class l extends s.${setSize(e){let{width:t,height:n,pixelRatio:r}={...this,...e};if(t===this.width&&n===this.height&&r===this.pixelRatio)return this;this.width=t,this.height=n,this.pixelRatio=r;let{renderer:i,perspectiveCamera:a,orthographicCamera:o}=this;i.setSize(t,n),i.setPixelRatio(r);let s=t/n;return a.aspect=s,a.updateProjectionMatrix(),o.left=-s,o.right=s,o.top=1,o.bottom=-1,o.updateProjectionMatrix(),this}initialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(this.initialized)return console.warn("ThreeWebGLContext is already initialized."),this;Object.defineProperty(this,"initialized",{value:!0,writable:!1,configurable:!1,enumerable:!1});let n=this.scenePass.getTextureNode("output");this.postProcessing.outputNode=n,new ResizeObserver(()=>{this.setSize({width:e.clientWidth,height:e.clientHeight,pixelRatio:window.devicePixelRatio})}).observe(e);let{domElement:r}=this.renderer;return r.style.display="block",r.style.width="100%",r.style.height="100%",e.appendChild(r),this.setSize({width:r.clientWidth,height:r.clientHeight,pixelRatio:window.devicePixelRatio}),this.internal.cancelTick=this.ticker.onTick(()=>{this.renderFrame()}).destroy,this.internal.cancelRequestActivation=(0,o.O)(document.body,this.ticker.requestActivation).destroy,this.internal.cancelPointer=this.pointer.initialize(this.renderer.domElement,t,this.camera,this.ticker),this.domContainer=e,this.domElement=r,this}renderFrame(){let{scene:e,postProcessing:t,pointer:n}=this;n.updateStart(e),e.traverse(e=>{"onTick"in e&&e.onTick(this.ticker,this)}),!1===this.skipRender&&t.renderAsync(),n.updateEnd()}constructor(){super(s.s.WebGPU),this.renderer=new i.uV1({antialias:!0}),this.perspectiveCamera=new a.ubm,this.orthographicCamera=new a.qUd,this.camera=this.perspectiveCamera,this.postProcessing=new i.io7(this.renderer),this.scenePass=(0,r.IXH)(this.scene,this.perspectiveCamera),this.internal={observer:null,cancelRequestActivation:null,cancelTick:null,cancelPointer:null},this.initialized=!1,this.destroyed=!1,this.destroy=()=>{var e,t,n,r,i,a,o;if(this.destroyed)return void console.warn("ThreeWebGLContext is already destroyed.");Object.defineProperty(this,"destroyed",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.renderer.dispose(),null==(e=this.internal.observer)||e.disconnect(),null==(t=(n=this.internal).cancelTick)||t.call(n),null==(r=(i=this.internal).cancelRequestActivation)||r.call(i),null==(a=(o=this.internal).cancelPointer)||a.call(o)},this.camera.position.set(0,1,10),this.camera.lookAt(0,0,0),this.pointer.updatePosition(this.camera,{x:0,y:0},this.renderer.domElement.getBoundingClientRect())}}},17099:(e,t,n)=>{"use strict";n.d(t,{c:()=>s});var r=n(79105);let i=e=>e,a={weightsAreNormalized:!1,indexOffset:0,forbiddenItems:[]};function o(){let e=(0,r.K2)((0,r.K2)((0,r.Ts)(r.KP)));function t(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.KP;return"string"==typeof t&&(t=t.split("").reduce((e,t)=>7*e+t.charCodeAt(0),0)),e=(0,r.K2)((0,r.K2)((0,r.Ts)(t))),c}function n(){return e=(0,r.K2)(e),(0,r.Tj)(e)}function o(e){switch(e.length){default:return[0,1,i];case 1:return[0,e[0],i];case 2:return[e[0],e[1],i];case 3:return[e[0],e[1],e[2]]}}function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[i,a,s]=o(t);return i+(a-i)*s(n())}function l(){for(var e,t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];let[o,s,{weightsAreNormalized:l,indexOffset:u,forbiddenItems:c}]=function(e){let[t,n=null,r]=e,i={...a,...r};if(Array.isArray(t))return[t,n,i];if("object"==typeof t)return[Object.values(t),n?Object.values(n):null,i];throw Error("pick: unsupported options type")}(r);if(c.length>0){let t=new Set;for(let e of c){let n=o.indexOf(e);n>=0&&t.add(n)}if(o=o.filter((e,n)=>!t.has(n)),s=null!=(e=null==s?void 0:s.filter((e,n)=>!t.has(n)))?e:null,0===o.length)throw Error("pick: all items are forbidden")}if(null===s){let e=Math.floor(n()*o.length);return u&&(e+=u,(e%=o.length)<0&&(e+=o.length)),o[e]}if(!l){let e=s.reduce((e,t)=>e+t,0);s=s.map(t=>t/e)}let d=n(),h=0;for(let e=0;e<o.length;e++)if(d<(h+=s[e]))return o[e];throw Error("among: unreachable")}function u(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=n(),i=n(),a=Math.sqrt(-2*Math.log(r)),o=2*Math.PI*i;return[e+t*a*Math.cos(o),e+t*a*Math.sin(o)]}let c={seed:t,seedMax:function(){return r.Zu},reset:function(){return t(r.KP),c},next:function(){return e=(0,r.K2)(e),c},getState:function(){return e},setState:function(t){return e=t&r.Zu,c},random:n,between:s,around:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[a=1,o=i]=t,s=2*n();return(s>1?1:-1)*o(s>1?s-1:s)*a},int:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[i,a,s]=o(t);return i+Math.floor(s(n())*(a-i))},chance:function(e){return n()<e},shuffle:function(e){let{mutate:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t&&Array.isArray(e)?e:[...e],i=r.length;for(let e=0;e<i;e++){let t=Math.floor(i*n()),a=r[e];r[e]=r[t],r[t]=a}return r},pick:l,createPicker:function(e){let t=e.map(e=>{let[t]=e;return t}),n=e.map(e=>{let[t,n]=e;return n}),r=n.reduce((e,t)=>e+t,0);for(let[e,t]of n.entries())n[e]=t/r;return()=>l(t,n,{weightsAreNormalized:!0})},vector:function(e,t){let[n=0,r=1]=Array.isArray(t)?t:[null==t?void 0:t.min,null==t?void 0:t.max];for(let t of Object.keys(e))e[t]=s(n,r);return e},unitVector2:function(e){let t=2*Math.PI*n();return e.x=Math.cos(t),e.y=Math.sin(t),e},unitVector3:function(e){let t=n(),r=n(),i=2*Math.PI*t,a=Math.acos(1-2*r);return e.x=Math.sin(a)*Math.cos(i),e.y=Math.sin(a)*Math.sin(i),e.z=Math.cos(a),e},normalVector:function(e){let t=Object.keys(e),n=t.length,r=Math.sqrt(n);for(let i=0;i<n;i+=2){let[a,o]=u();e[t[i]]=a/r,i+1<n&&(e[t[i+1]]=o/r)}return e},unitVector:function(e){let t=Object.keys(e),n=t.length,r=0;for(let i=0;i<n;i+=2){let[a,o]=u();e[t[i]]=a,r+=a*a,i+1<n&&(e[t[i+1]]=o,r+=o*o)}r=Math.sqrt(r);for(let i=0;i<n;i++)e[t[i]]/=r;return e},boxMuller:u,quaternion:function(e){let t=n(),r=n(),i=n(),a=Math.sqrt(1-t),o=Math.sqrt(t);return e.x=a*Math.sin(2*Math.PI*r),e.y=a*Math.cos(2*Math.PI*r),e.z=o*Math.sin(2*Math.PI*i),e.w=o*Math.cos(2*Math.PI*i),e},insideCircle:function(e,t){let r=2*n()*Math.PI,i=Math.sqrt(n())*e;return t.x=i*Math.cos(r),t.y=i*Math.sin(r),t}};return c}let s=class{constructor(e){Object.assign(this,o().seed(e))}};Object.assign(s,o())},25809:(e,t,n)=>{"use strict";n.d(t,{P:()=>o});var r=n(49797),i=n(96273);let a={color:"white",opacity:.5,plane:"XY",size:[8,8],step:1,frame:!0};class o extends r.DXC{set(e){let{color:t,opacity:n,size:o,step:s,frame:l,plane:u}={...a,...e},c=(0,i.wX)(o),d=(0,i.wX)(null!=s?s:c),h=[],f=(e,t)=>h.push(new r.Pq0(e,t,0));l&&(f(-c.x/2,c.y/2),f(c.x/2,c.y/2),f(c.x/2,c.y/2),f(c.x/2,-c.y/2),f(c.x/2,-c.y/2),f(-c.x/2,-c.y/2),f(-c.x/2,-c.y/2),f(-c.x/2,c.y/2));let p=Math.ceil(-c.x/2/d.x)*d.x;p===-c.x/2&&(p+=d.x);do f(p,-c.y/2),f(p,c.y/2),p+=d.x;while(p<c.x/2);let g=Math.ceil(-c.y/2/d.y)*d.y;g===-c.y/2&&(g+=d.y);do f(-c.x/2,g),f(c.x/2,g),g+=d.y;while(g<c.y/2);switch(this.geometry.setFromPoints(h),u){case"XZ":this.geometry.rotateX(Math.PI/2);break;case"YZ":this.geometry.rotateY(Math.PI/2)}return this.material.color.set(t),this.material.opacity=n,this.material.transparent=n<1,this}constructor(e){super(),this.set(null!=e?e:a)}}},37821:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});var r=n(67203);function i(){let[e,t]=(0,r.useState)(!1);return(0,r.useLayoutEffect)(()=>{t(!0)},[]),e}},53097:(e,t,n)=>{"use strict";n.d(t,{q:()=>w,uB:()=>P,dB:()=>d,yk:()=>u,Fw:()=>c});var r=n(67203),i=n(49797),a=n(7587),o=n(37027),s=n(87381);let l=(0,r.createContext)(null);function u(e,t){let n=(0,r.useContext)(l);return(0,a.C7)(async function*(t,r){if(e){let t=e(n,r);if(t&&"function"==typeof t.next)do{let{value:e,done:n}=await t.next();if(n)break;yield e}while(r.mounted)}},null!=t?t:"always"),n}function c(e,t){let n=u(async function*(t,n){if(t.type===o.s.WebGL&&e){let r=e(t,n);if(r&&"function"==typeof r.next)for(;;){let{value:e,done:t}=await r.next();if(t)break;yield e}}},t);return n.type===o.s.WebGL?n:null}function d(e,t,n){let a=(0,r.useMemo)(()=>new i.YJl,[]);return a.name=e,u(async function*(e,n){if(e.scene.add(a),yield()=>{a.clear(),a.removeFromParent()},t){let r=t(a,e,n);if(r&&"function"==typeof r.next)do{let{value:e,done:t}=await r.next();if(t)break;yield e}while(n.mounted)}},n),a}var h=n(70691),f=n(30158),p=n(57165),g=n(37821),v=n(48083),x=n(17112),m=n(14274),y=n(67235);function w(e){return Array.isArray(null==e?void 0:e.value)?(0,h.jsx)(h.Fragment,{children:e.value.map((t,n)=>(0,h.jsx)(w,{...e,value:t},n))}):(u(async function*(t){let{value:n,hidden:r}=e;if(!n)return;let i="function"==typeof n?new n:n;for(let n of((0,s.mj)(i,{parent:t.scene,...e.transform}),r&&(i.visible=!1),(0,s.$z)(i,{includeSelf:!0})))if("onInitialize"in n){let e=n.onInitialize(t);if(e&&"function"==typeof e.next)for(;;){let{value:t,done:n}=await e.next();if(n)break;yield t}}yield()=>{for(let t of(i.removeFromParent(),(0,s.$z)(i,{includeSelf:!0})))if("onDestroy"in t){var e;null==(e=t.onDestroy)||e.call(t)}}},"always"),null)}let b={type:void 0,webgl:void 0,webgpu:void 0,className:"",assetsPath:"/",vertigoControls:!1,minActiveDuration:30};function C(e){var t;let n={...b,...e},{children:i,className:o,vertigoControls:s}=n,u=null!=(t=n.type)?t:n.webgpu?"webgpu":"webgl",c=(0,r.useRef)(void 0);c.current&&c.current!==u&&console.warn('ThreeProvider: the prop "type" is not intended to change after the component is mounted.'),c.current=u;let d=(0,r.useMemo)(()=>"webgl"===u?new x.XW:new m.K,[u]);d.ticker.set({minActiveDuration:n.minActiveDuration});let{ref:g}=(0,a.IZ)({debounce:!0},function*(e,t){yield d.initialize(e.firstElementChild,document.body),t.triggerRender(),Object.assign(window,{three:d,THREE:f})},[]);(0,a.C7)(function*(){if(yield y.Q.on("THREE",e=>{e.setPayload(d)}),yield(0,p.O)(d.ticker.requestActivation),s){var e,t;let n="object"==typeof s?s:{},r=new v.n(n).initialize(g.current);Object.assign(r.inputConfig,n.inputConfig),r.parsePanInputs(null!=(e=n.panInput)?e:""),r.parseOrbitInputs(null!=(t=n.orbitInput)?t:""),n.fixed||r.start(),yield r.destroy,yield y.Q.on("VERTIGO_CONTROLS",e=>{e.setPayload(r)}),yield d.ticker.onTick({order:-1},e=>{r.update(d.camera,d.aspect,e.deltaTime)})}},[s]);let w={position:"absolute",inset:0};return(0,h.jsx)("div",{ref:g,className:o,style:w,children:(0,h.jsxs)(l.Provider,{value:d,children:[(0,h.jsx)("div",{style:w}),(0,h.jsx)("div",{style:w,className:"thru",children:d.initialized&&i})]})})}function P(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,g.D)()&&(0,h.jsx)(C,{...t[0]})}var I=n(95736);let S={hotkey:"g",show:void 0,hide:void 0,isHelper:e=>!0===e.userData.helper};class z{*initialize(){let{hotkey:e}=this.safeParams;yield(0,I.a)([[{key:e,keyCaseInsensitive:!0},()=>this.toggle()]])}toggle(){return this.currentShowHelpers=!this.currentShowHelpers,this.updateHelpers(),this.currentShowHelpers}updateHelpers(){let{isHelper:e}=this.safeParams;for(let t of(0,s.$z)(this.root))e(t)&&(t.visible=this.currentShowHelpers)}set showHelpers(e){this.currentShowHelpers=null!=e?e:this.currentShowHelpers,this.updateHelpers()}constructor(e,t){var n;z.instances.set(e,this),this.safeParams={...S,...t},this.root=e.scene,this.currentShowHelpers=null!=(n=null==t?void 0:t.show)?n:(null==t?void 0:t.hide)!==!1,this.updateHelpers()}}z.instances=new Map},56652:e=>{e.exports={VertigoWidgetClient:"vertigo_VertigoWidgetClient__UIsqY",BgBlur:"vertigo_BgBlur__om6v3"}},65897:(e,t,n)=>{"use strict";n.d(t,{Client:()=>c});var r=n(70691),i=n(49797),a=n(84306),o=n(9723),s=n(87381),l=n(16008);function u(){return(0,a.yk)(function*(e){(0,s.mj)(new i.eaF(new i.WBB(1,0),new o.Y),{parent:e.scene,x:-4}),(0,s.mj)(new l.XI,{parent:e.scene})},[]),null}function c(){return(0,r.jsx)(a.uB,{children:(0,r.jsxs)(a.zz,{children:[(0,r.jsx)("div",{className:"layer thru p-4",children:(0,r.jsx)("h1",{children:"Vertigo Widget"})}),(0,r.jsx)(u,{})]})})}},66851:(e,t,n)=>{"use strict";n.d(t,{_:()=>l,w:()=>o});var r=n(49797),i=n(96273);let a=new r.kn4;function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;return(0,i.vl)(e,t)}let s=new r.Q1f;function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s;return t.set(e)}},67235:(e,t,n)=>{"use strict";n.d(t,{Q:()=>l});var r=n(54530);class i{_getId(){return i._idHash.init().update(++this._count).getValue()}_registerObject(e){let t=this._getId();return this._weakMap.set(e,t),t}_registerPrimitive(e){let t=this._getId();return this._map.set(e,t),t}_requirePrimitiveId(e){var t;return null!=(t=this._map.get(e))?t:this._registerPrimitive(e)}_requireObjectId(e){var t;return null!=(t=this._weakMap.get(e))?t:this._registerObject(e)}_requireArrayId(e){let{_arrayHash:t}=i;for(let n of(t.init(),e.flat(16)))t.update(this.requireId(n));return t.getValue()}requireId(e){return!function(e){if(null==e)return!0;switch(typeof e){case"function":case"object":return!1;default:return!0}}(e)?Array.isArray(e)?this._requireArrayId(e):this._requireObjectId(e):this._requirePrimitiveId(e)}constructor(){this._count=1,this._map=new Map,this._weakMap=new WeakMap}}i._idHash=new r.V,i._arrayHash=new r.V;class a{constructor(e,t){this.filter=e,this.callback=t,this.match="*"===e?()=>!0:"string"==typeof e?t=>t===e:e instanceof RegExp?t=>e.test(t):()=>!1}}let o=new i,s=new Map;class l{setPayload(e){return this.payload=e,this}assignPayload(e){let{overwrite:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.payload=t?{...this.payload,...e}:{...e,...this.payload},this}payloadAssign(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.assignPayload(...t)}assertPayload(){if(void 0!==this.payload)return this.payload;throw Error('Message.payloadAssert: assertion failed for message with target "'.concat(this.target,'"'))}constructor(e,t,n){var r;this.id=l.nextId++,this.debug={currentListenerIndex:-1,listenerCount:0},this.targetId=o.requireId(e),this.target=e,this.type=null!=t?t:"message",this.payload=n;let i=(null!=(r=s.get(this.targetId))?r:[]).filter(e=>e.match(this.type));for(let e of(this.debug.listenerCount=i.length,i))this.debug.currentListenerIndex++,e.callback(this)}}function u(e){if(2===e.length){let[t,n]=e;return[t,"*",n]}return e}function c(){for(var e,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];let[i,l,c]=u(n),d=o.requireId(i),h=new a(l,c);return(null!=(e=s.get(d))?e:(()=>{let e=[];return s.set(d,e),e})()).push(h),{destroy:()=>{!function(e,t){let n=s.get(e);if(n){let r=n.indexOf(t);if(-1!==r)n.splice(r,1),0===n.length&&s.delete(e)}}(d,h)}}}l.send=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[r,i,a]=function(e){let[t,...n]=e;if(2===n.length){let[e,{payload:r}]=n;return[t,e,r]}if(1===n.length){let[e]=n;return"string"==typeof e?[t,e]:[t,void 0,e.payload]}return[t]}(t);return new l(r,i,a)},l.on=c,l.wait=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Promise(e=>{let n=t=>{e(t)},[r,i]=u([...t,n]);c(r,i,n)})},l.debug={listenerMap:s,idRegister:o},l.nextId=0},67840:(e,t,n)=>{"use strict";n.d(t,{w:()=>v});var r=n(49797),i=n(96273),a=n(66851),o=n(79285);function s(){return[...new Set(["�",..."abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",..."\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff",..."0123456789",..." @#.,!?\xbf:;-+*/=%&|()[]{}<>$'’\""])].join("")}class l{constructor(){let e=s(),t=new r.I9Y(16,24),n=t.x/t.y,i=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new r.I9Y;return n.x=Math.ceil(Math.sqrt(e/t)),n.y=Math.ceil(e/n.x),n}(e.length,n),a=t.clone().multiplyScalar(3),l=(0,o.ceilPowerOfTwo)(a.x*i.x),u=(0,o.ceilPowerOfTwo)(a.y*i.y),c=l/(a.x*i.x),d=u/(a.y*i.y);if("undefined"==typeof document){this.canvas=null,this.texture=null,this.symbols="",this.charGrid=new r.I9Y;return}let h=document.createElement("canvas");h.width=l,h.height=u;let f=h.getContext("2d");f.font="".concat(.8*a.y,"px monospace"),f.textBaseline="top",f.fillStyle="black",f.fillRect(0,0,l,u),f.fillStyle="white",f.transform(c,0,0,d,0,0);for(let t=0;t<e.length;t++){let n=Math.floor(t/i.x),r=(t-n*i.x+.12)*a.x,o=a.y*(n+.19999999999999996);f.fillText(e[t],r,o)}this.canvas=h,this.texture=new r.GOR(h),this.symbols=e,this.charGrid=i}}l.getDefaultSymbols=s;let u={oriented:0,billboard:1},c={nodeMaterial:!1,textCount:1e3,lineLength:24,lineCount:2,charSize:new r.I9Y(.2,.3),textSize:1,textOffset:0,orientation:"billboard",textDefaults:{color:"#ff00ff",size:1}};class d{get textCount(){return this.metadata.textCount}get lineCount(){return this.metadata.lineCount}get lineLength(){return this.metadata.lineLength}get strideHeaderByteSize(){return this.metadata.strideHeaderByteSize}get strideByteSize(){return this.metadata.strideByteSize}get textureSize(){return new r.I9Y(this.metadata.textureWidth,this.metadata.textureHeight)}encode(){let e=JSON.stringify(this.metadata),t=new TextEncoder().encode(e),n=t.length,r=new Uint8Array(4);new DataView(r.buffer).setUint32(0,n,!0);let i=new Uint8Array(4+n+this.array.length);return i.set(r,0),i.set(t,4),i.set(this.array,4+n),i}static decode(e){let t=new DataView(e.buffer).getUint32(0,!0),n=e.slice(4,4+t),r=JSON.parse(new TextDecoder().decode(n)),i=new d(r.symbols,r.textCount,r.lineCount,r.lineLength),a=e.slice(4+t);return i.array.set(a),i}info(){return"data: ".concat(this.array.length," bytes, ").concat(this.textureSize.x,"x").concat(this.textureSize.y)}getTextAt(e){let{array:t}=this,{symbols:n,lineLength:r,strideByteSize:i,strideHeaderByteSize:a}=this.metadata,o=e*i,s=t[o+0],l=t[o+16],u=e=>e.toString(16).padStart(2,"0"),c="#".concat(u(t[o+4])).concat(u(t[o+4+1])).concat(u(t[o+4+2])),d=t[o+4+3],h="#".concat(u(t[o+8])).concat(u(t[o+8+1])).concat(u(t[o+8+2])),f=t[o+8+3],p=[];for(let e=0;e<s;e++){let i=o+a+e*r,s=[];for(let e=0;e<l;e++){let r=n[t[i+e]];s.push(r)}p.push(s.join(""))}return{text:p.join("\n"),textColor:c,textOpacity:d,backgroundColor:h,backgroundOpacity:f,currentLineCount:s,currentLineLength:l}}setSizeAt(e,t){let{array:n}=this,{strideByteSize:r}=this.metadata;return new DataView(n.buffer).setFloat32(e*r+12,t),this}setColorAt(e,t){let{color:n,opacity:r,textColor:i=n,textOpacity:s=r,backgroundColor:l=i,backgroundOpacity:u=+(null!=r?!!r:!!t.backgroundColor)}=t,{array:c}=this,{strideByteSize:d}=this.metadata;{let t=e*d+4;if(void 0!==i){let{r:e,g:n,b:r}=(0,a._)(i);c[t+0]=255*e,c[t+1]=255*n,c[t+2]=255*r}void 0!==s&&(c[t+3]=(0,o.toff)(s))}{let t=e*d+8;if(void 0!==l){let{r:e,g:n,b:r}=(0,a._)(l);c[t+0]=255*e,c[t+1]=255*n,c[t+2]=255*r}void 0!==u&&(c[t+3]=(0,o.toff)(u))}return this.texture.needsUpdate=!0,this}setTextAt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{trim:r=!1,size:i=1,...a}=n;this.setColorAt(e,a),this.setSizeAt(e,i);let{array:o}=this,{symbols:s,lineCount:l,lineLength:u,strideByteSize:c,strideHeaderByteSize:d}=this.metadata,h=(r?t.trim():t).split("\n");h.length>l&&(console.warn("TextHelper: Text has more lines than ".concat(l,", truncating.")),h=h.slice(0,l)),h=h.map(e=>(r&&(e=e.trim()),e.length>u)?(console.warn("TextHelper: Line length is greater than ".concat(u," characters, clamping.")),e.slice(0,u)):e),o[e*c+0]=h.length;let f=e*c,p=h.length;for(let e=0;e<l;e++){let t=0;e<p&&(o[f+16+4*e]=h[e].length,t=h[e].length);let n=f+d+e*u;for(let r=0;r<u;r++){let i=n+r;if(e>=p||r>=t)o[i]=0;else{let t=s.indexOf(h[e].charAt(r));o[i]=-1===t?0:t}}}this.texture.needsUpdate=!0}constructor(e,t,n,i,{defaultColor:s="#ffffff",defaultTextOpacity:l=1,defaultBackgroundOpacity:u=0}={}){let c=16+4*n,d=c+4*Math.ceil(n*i/4),h=Math.ceil((c+t*d)/4),f=(0,o.ceilPowerOfTwo)(Math.sqrt(h)),p=Math.ceil(h/f);this.metadata={symbols:e,textCount:t,lineCount:n,lineLength:i,strideHeaderByteSize:c,strideByteSize:d,textureWidth:f,textureHeight:p};let g=new Uint8Array(f*p*4),{r:v,g:x,b:m}=(0,a._)(s);for(let e=0;e<t;e++){let t=e*d;g[(t+=4)+0]=255*v,g[t+1]=255*x,g[t+2]=255*m,g[t+3]=255*l,g[(t+=4)+0]=255*v,g[t+1]=255*x,g[t+2]=255*m,g[t+3]=255*u}this.array=g,this.texture=new r.GYF(g,f,p,r.GWd,r.OUM),this.texture.needsUpdate=!0}}var h=n(17953),f=n(81074),p=n(60041);let g=0;class v extends r.ZLX{applyTransform(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let a=(0,i.GD)(t),o=new r.kn4,s=this.instanceMatrix.array.length;for(let e=0;e<s;e+=16)o.fromArray(this.instanceMatrix.array,e).multiply(a).toArray(this.instanceMatrix.array,e);return this}addTo(e){return e?e.add(this):this.removeFromParent(),this}onTop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return 0!==e?(this.renderOrder=e,this.material.depthTest=!1,this.material.depthWrite=!1,this.material.transparent=!0):(this.renderOrder=0,this.material.depthTest=!0,this.material.depthWrite=!0,this.material.transparent=!1),this}setData(e){return this.data=e,this}clearAllText(){return this.instanceMatrix.array.fill(0),this.instanceMatrix.needsUpdate=!0,this}setTextAt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.data.setTextAt(e,t,{...this.options.textDefaults,...n}),this.setMatrixAt(e,(0,a.w)(n)),this.instanceMatrix.needsUpdate=!0,this}setColorAt(e,t){this.data.setColorAt(e,{color:t})}setTextColorAt(e,t){return this.data.setColorAt(e,t),this}getDataStringView(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return function(e,t,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:3,s=Array.from({length:t.length/4},(e,n)=>{let r=4*n,i=t[r+0],a=t[r+1];return[i,a,t[r+2],t[r+3]]}).slice(a*n/4,o*n/4),l=[];l.push("\nData texture array (".concat(t.length," bytes):")),l.push("\ndataStride: ".concat(n," (").concat(n/4," x 4 bytes)"));let u=4+r;for(let t=0;t<s.length;t++){let a=t%(n/4);0===a&&(l.push("\npack #".concat(t/(n/4))),l.push("info:")),4===a&&l.push("lines (".concat(r,"):")),a===u&&l.push("chars (".concat(i,"):"));let[o,c,d,h]=s[t],f="".concat(t.toString().padEnd(3)," - ").concat((4*t).toString().padEnd(4),":   ").concat(o.toString().padStart(3),", ").concat(c.toString().padStart(3),", ").concat(d.toString().padStart(3),", ").concat(h.toString().padStart(3));a>=u&&(f+="     ".concat(e.symbols[o]).concat(e.symbols[c]).concat(e.symbols[d]).concat(e.symbols[h])),l.push("  "+f)}return l.join("\n")}(this.atlas,this.data.array,this.data.strideByteSize,this.options.lineCount,this.options.lineLength,e,t)}constructor(e){let t={...c,...e},n=new l,a=new d(n.symbols,t.textCount,t.lineCount,t.lineLength),o=function(e,t,n){let a={...c,...e},o=new r.I9Y(a.textSize*a.lineLength*a.charSize.x,a.textSize*a.lineCount*a.charSize.y);return{uCameraMatrix:{value:new r.kn4},uOrientation:{value:function(e){if("string"==typeof e){if(e in u)return u[e];throw Error("Invalid orientation: ".concat(e))}if(Object.values(u).includes(e))return e;throw Error("Invalid orientation: ".concat(e))}(a.orientation)},uTextOffset:{value:(0,i.wX)(a.textOffset)},uPlaneSize:{value:o},uCharSize:{value:a.charSize},uLineLength:{value:a.lineLength},uLineCount:{value:a.lineCount},uAtlasCharGrid:{value:n.charGrid},uDataStrideHeader:{value:t.strideHeaderByteSize},uDataStride:{value:t.strideByteSize/4},uDataTexture:{value:t.texture},uDataTextureSize:{value:t.textureSize},uBoxBorderWidth:{value:0}}}(t,a,n),s=o.uPlaneSize.value;super(new r.bdM(s.width,s.height),t.nodeMaterial?function(e,t){let n=new f.P8l;n.name="TextHelperMaterial",n.transparent=!0,n.alphaTest=.5,n.side=r.$EB,console.warn("TextHelperMaterial is not supported in WebGPU yet, do not expect it to work.");let i=(0,h.PiW)(e.uDataTextureSize.value).onFrameUpdate(()=>e.uDataTextureSize.value),a=(0,h.PiW)(e.uDataStride.value).onFrameUpdate(()=>e.uDataStride.value);function o(t,n){let r=i.x,o=(0,h.WQq)((0,h.lKK)(t,a),n),s=(0,h.y4m)(o,r),l=(0,h.jbE)(o,(0,h.lKK)(s,r));return(0,h.wHr)(e.uDataTexture.value,(0,h.ZcS)(l,s))}(0,h.PiW)(e.uDataStrideHeader.value).onFrameUpdate(()=>e.uDataStrideHeader.value),(0,h.PiW)(e.uAtlasCharGrid.value).onFrameUpdate(()=>e.uAtlasCharGrid.value);let s=o(h.cGD,0);(0,h.PCg)((0,h.lKK)(s.r,255)),(0,h.PCg)(o(h.cGD,1)),(0,h.PCg)(o(h.cGD,2)),(0,h.fVC)(1);let l=(0,h.PiW)(1).onRenderUpdate(()=>e.uOrientation.value);return n.positionNode=(0,h.Fn)(()=>{let e=(0,h.eR5)().toVar();return(0,h.If)(l.equal(0),()=>{e.assign(h.WVU)}).Else(()=>{e.assign((0,h.w00)(h.FLB).mul(h.WVU))}),e})(),n.colorNode=(0,h.yWT)("yellow"),n}(o,0):function(e,t){let n=new r.V9B({map:t.texture,transparent:!0,alphaTest:.5,side:r.$EB});return n.name="TextHelperMaterial",n.onBeforeCompile=t=>p.b.with(t).uniforms(e).varying({vInstanceId:"float",vTextColor:"vec4",vBackgroundColor:"vec4",vCurrentLineCount:"float"}).top("\n      vec4 getData4(int instanceId, int offset) {\n        int width = int(uDataTextureSize.x);\n        int index = instanceId * int(uDataStride) + offset;\n        int dataY = index / width;\n        int dataX = index - dataY * width;\n        return texelFetch(uDataTexture, ivec2(dataX, dataY), 0);\n      }\n      vec4 getData4(float instanceId, int offset) {\n        return getData4(int(instanceId), offset);\n      }\n        \n      vec2 getCharOffset(float instanceId, float charIndex) {\n        int p = int(uDataStrideHeader + charIndex);\n        int q = p / 4;\n        int r = p - q * 4; // p % 4;\n        vec4 charIndexes = getData4(instanceId, q);\n        float i = charIndexes[r] * 255.0;\n        float x = mod(i, uAtlasCharGrid.x);\n        float y = floor(i / uAtlasCharGrid.x);\n        return vec2(x, uAtlasCharGrid.y - y - 1.0) / uAtlasCharGrid;\n      }\n      vec2 getCharOffset(float instanceId, float line, float char) {\n        // return vec2(line * 82.0 + char, 0.0) / uAtlasCharGrid;\n        return getCharOffset(instanceId, line * uLineLength + char);\n      }\n    ").vertex.replace("project_vertex","\n      vec4 infoTexel = getData4(gl_InstanceID, 0);\n      vCurrentLineCount = infoTexel.r * 255.0;\n\n      vTextColor = getData4(gl_InstanceID, 1);\n      vBackgroundColor = getData4(gl_InstanceID, 2);\n\n      vec4 sizeBytes = getData4(gl_InstanceID, 3) * 255.0;\n      uint encoded =\n        uint(sizeBytes.x) << 24 |\n        uint(sizeBytes.y) << 16 |\n        uint(sizeBytes.z) << 8  |\n        uint(sizeBytes.w);\n      float size = uintBitsToFloat(encoded);\n\n      vec4 mvPosition = vec4(transformed * size, 1.0);\n\n      mat4 textMatrix = uOrientation < 0.5\n        ? modelMatrix * instanceMatrix\n        : mat4(\n          uCameraMatrix[0],\n          uCameraMatrix[1],\n          uCameraMatrix[2],\n          modelMatrix * vec4(instanceMatrix[3].xyz, 1.0));\n\n      mvPosition.xy += uTextOffset;\n\n      mvPosition = viewMatrix * textMatrix * mvPosition;\n\n      gl_Position = projectionMatrix * mvPosition;\n\n      vInstanceId = float(gl_InstanceID);\n    ").fragment.top("\n      float sdBox(in vec2 p, in vec2 b) {\n        vec2 d = abs(p) - b;\n        return length(max(d, 0.0)) + min(max(d.x, d.y), 0.0);\n      }\n\n      vec4 getCharColor() {\n        vec2 uv = vMapUv * vec2(uLineLength, uLineCount);\n\n        uv.y += (uLineCount - vCurrentLineCount) * 0.5;\n        float lineIndex = floor((uLineCount - uv.y));\n\n        if (lineIndex < 0.0 || lineIndex >= vCurrentLineCount)\n          discard;\n\n        float currentLineLength = getData4(vInstanceId, 4 + int(lineIndex)).r * 255.0;\n        // vec2 ddx = dFdx(uv);\n        // vec2 ddy = dFdy(uv);\n        uv.x += (uLineLength - currentLineLength) * -0.5;\n        float charIndex = floor(uv.x);\n\n        if (charIndex < 0.0 || charIndex >= currentLineLength)\n          discard;\n\n        uv = fract(uv);\n        // diffuseColor = vec4(uv, 1.0, 1.0);\n        uv /= uAtlasCharGrid;\n\n        uv += getCharOffset(vInstanceId, lineIndex, charIndex);\n        // float lod = log2(max(length(dFdx(vMapUv)), length(dFdy(vMapUv))));\n        vec4 charColor = textureLod(map, uv, 0.0);\n        // Use textureGrad for better quality, when the square texture will be used\n        // vec4 sampledDiffuseColor = textureGrad(map, uv, ddx, ddy);\n        float char = charColor.r;\n        \n        return vec4(\n          mix(vBackgroundColor.rgb, vTextColor.rgb, charColor.r),\n          mix(vBackgroundColor.a, vTextColor.a, charColor.r));\n      }\n\n      vec4 getCharColorWithBorder() {\n        if (uBoxBorderWidth > 0.0) {\n          vec2 p = (vMapUv - 0.5) * uPlaneSize;\n          float d = sdBox(p, uPlaneSize * 0.5) + uBoxBorderWidth;\n          if (d > 0.0) {\n            return vTextColor;\n          }\n        }\n        return getCharColor();\n      }\n    ").fragment.replace("map_fragment","\n      diffuseColor = getCharColorWithBorder();\n    "),n}(o,n),t.textCount),this.textHelperId=g++,this.onBeforeRender=(e,t,n,r,i,a)=>{o.uCameraMatrix.value.copy(n.matrixWorld)},this.frustumCulled=!1,this.layers,this.options=t,this.atlas=n,this.data=a,this.derived={planeSize:s}}}v.defaultOptions=c,v.Atlas=l,v.Data=d},79105:(e,t,n)=>{"use strict";n.d(t,{K2:()=>o,KP:()=>i,Tj:()=>s,Ts:()=>a,Zu:()=>r});let r=0x7fffffff,i=123456,a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;if(Number.isNaN(e))throw Error("NaN is not a valid seed.");let t=e;if(10>Math.abs(t)&&(t*=1e6),t%=r,(t=t<0?t+r:t)>1)return t&r;if(0===t)return i;throw Error("Impossible. ".concat(t))},o=e=>e=Math.imul(e,48271)&r,s=e=>(e-1)/(r-1)},82091:(e,t,n)=>{"use strict";n.d(t,{N:()=>a});var r=n(49797);let i=new r.WBB(1,4);class a extends r.eaF{constructor(e){super(i,new r.V9B({color:"#0c529d",...e,side:r.hsX,depthWrite:!1,depthTest:!1})),this.renderOrder=-1,this.frustumCulled=!1,this.matrixAutoUpdate=!1,this.onBeforeRender=(e,t,n)=>{let r=(n.near+n.far)/2;this.position.copy(n.position),this.scale.setScalar(r),this.updateMatrix(),this.updateMatrixWorld()}}}},99078:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,89294,23)),Promise.resolve().then(n.bind(n,2765)),Promise.resolve().then(n.bind(n,15774)),Promise.resolve().then(n.bind(n,65897))}},e=>{var t=t=>e(e.s=t);e.O(0,[5012,2193,5611,7190,6564,7223,9635,8921,4957,7775,6814,7953,9547,9294,8907,4638,6726,2598,1213,9673,8083,7112,41,6647,7558,5774,1319,6852,7358],()=>t(99078)),_N_E=e.O()}]);