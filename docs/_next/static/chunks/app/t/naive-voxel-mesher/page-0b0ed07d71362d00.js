(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7669],{96086:function(e,t,n){Promise.resolve().then(n.bind(n,66342))},66342:function(e,t,n){"use strict";n.d(t,{Main:function(){return K}});var r,o,i,l,s,u,a=n(78485),c=n(37457),f=n(494),y=n(9710),h=n(4917),d=n(8834),v=n(87858),g=n(52471);(r=l||(l={}))[r.X=0]="X",r[r.Y=2]="Y",r[r.Z=4]="Z",(o=s||(s={}))[o.R=0]="R",o[o.L=1]="L",o[o.U=2]="U",o[o.D=3]="D",o[o.F=4]="F",o[o.B=5]="B",(i=u||(u={}))[i.None=0]="None",i[i.All=63]="All",i[i.R=1]="R",i[i.L=2]="L",i[i.U=4]="U",i[i.D=8]="D",i[i.F=16]="F",i[i.B=32]="B";let x=[5,4,0,1,0,1],w=[new g.Vector3(1,0,0),new g.Vector3(-1,0,0),new g.Vector3(0,1,0),new g.Vector3(0,-1,0),new g.Vector3(0,0,1),new g.Vector3(0,0,-1)],m=0,p=0,F=0,A=0,k=[],b={A:()=>(k[m++]=p,k[m++]=F,k[m++]=A,b),B:()=>(k[m++]=p,k[m++]=F,k[m++]=A+1,b),C:()=>(k[m++]=p,k[m++]=F+1,k[m++]=A,b),D:()=>(k[m++]=p,k[m++]=F+1,k[m++]=A+1,b),E:()=>(k[m++]=p+1,k[m++]=F,k[m++]=A,b),F:()=>(k[m++]=p+1,k[m++]=F,k[m++]=A+1,b),G:()=>(k[m++]=p+1,k[m++]=F+1,k[m++]=A,b),H:()=>(k[m++]=p+1,k[m++]=F+1,k[m++]=A+1,b)},B={R:()=>(k[m++]=1,k[m++]=0,k[m++]=0,B),L:()=>(k[m++]=-1,k[m++]=0,k[m++]=0,B),U:()=>(k[m++]=0,k[m++]=1,k[m++]=0,B),D:()=>(k[m++]=0,k[m++]=-1,k[m++]=0,B),F:()=>(k[m++]=0,k[m++]=0,k[m++]=1,B),B:()=>(k[m++]=0,k[m++]=0,k[m++]=-1,B),R6:()=>B.R().R().R().R().R().R(),L6:()=>B.L().L().L().L().L().L(),U6:()=>B.U().U().U().U().U().U(),D6:()=>B.D().D().D().D().D().D(),F6:()=>B.F().F().F().F().F().F(),B6:()=>B.B().B().B().B().B().B()};class D{positionToArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{position:n,direction:r}=this;switch(k=e,m=t,p=n.x,F=n.y,A=n.z,r){case s.R:b.E().G().F().F().G().H();break;case s.L:b.A().B().D().A().D().C();break;case s.U:b.D().H().G().D().G().C();break;case s.D:b.A().E().F().A().F().B();break;case s.F:b.B().F().H().B().H().D();break;case s.B:b.A().C().E().E().C().G()}return e}normalToArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{direction:n}=this;switch(k=e,m=t,n){case s.R:B.R6();break;case s.L:B.L6();break;case s.U:B.U6();break;case s.D:B.D6();break;case s.F:B.F6();break;case s.B:B.B6()}return e}constructor(e,t,n=x[t]){this.position=e,this.direction=t,this.tangent=n}}class S{getVoxelState(e,t,n){let{size:r,size2:o,size3:i,voxelStateByteSize:l,voxelState:s}=this;return new DataView(s,(e+t*r+n*o)*l,l)}tryGetVoxelState(e,t,n){let{size:r}=this;return e<0||e>=r||t<0||t>=r||n<0||n>=r?null:this.getVoxelState(e,t,n)}*voxelFaces(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>0!==e.getUint8(0),{size:t}=this,n=new D(new g.Vector3,0);for(let r=0;r<t;r++)for(let o=0;o<t;o++)for(let i=0;i<t;i++)if(e(this.getVoxelState(r,o,i)))for(let t=0;t<6;t++){let l=w[t],s=this.tryGetVoxelState(r+l.x,o+l.y,i+l.z);s&&e(s)||(n.position.set(r,o,i),n.direction=t,yield n)}}constructor(e=16,t=4){this.worldConnection=null,this.size=e,this.size2=e*e,this.size3=e*e*e,this.voxelStateByteSize=t,this.voxelState=new ArrayBuffer(e**3*t)}}class C{ensureSize(e){if(this.array.length<e){let t=new Float32Array(1<<Math.ceil(Math.log(e)/Math.log(2)));t.set(this.array),this.array=t}return this.array}copy(e){return new Float32Array(this.array.buffer,0,e).slice()}constructor(e=0){this.array=new Float32Array(0),this.ensureSize(e)}}let L=new C(768),V=new C(768);function z(e){let{geometry:t=new g.BufferGeometry}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="function"==typeof e?e():e;L.array.fill(0),V.array.fill(0);let r=0;for(let e of n){let t=18*r;L.ensureSize(t+18),V.ensureSize(t+18),e.positionToArray(L.array,t),e.normalToArray(V.array,t),r++}return t.setAttribute("position",new g.BufferAttribute(L.copy(18*r),3)),t.setAttribute("normal",new g.BufferAttribute(V.copy(18*r),3)),t}var U=n(31454),M=n(63549),P=n(38137),R=n(16573);function E(e,t,n,r,o){let i=r-e,l=o-t,s=Math.sqrt(i*i+l*l);return[e+i/s*n,t+l/s*n]}class G extends g.Group{constructor(...e){super(...e),this.parts=(()=>{(0,v.cY)(new g.Mesh(new g.TorusKnotGeometry(10,.4,512,64),new M.P),this),(0,v.cY)(new U.K,{parent:this,rotationX:"90deg"});let e=(0,v.cY)(new P.w,this),t=new g.Vector3,n=new g.Vector3;{let e=new S(16);for(let{x:r,y:o,z:i}of(0,R.KA)(16,16,16)){t.set(r,o,i);let[l,s]=E(8,8,16/3,r,i);n.set(l,16/6,s);let u=t.distanceTo(n)<16/6;e.getVoxelState(r,o,i).setUint8(0,u?1:0)}(0,v.cY)(new g.Mesh(z(e.voxelFaces()),new M.P({color:"#ffdd55"})),{parent:this,x:-16,z:-16})}{let e=new S(16);for(let{x:r,y:o,z:i}of(0,R.KA)(16,16,16)){t.set(r,o,i);let[l,s]=E(8,8,8,r,i);n.set(l,4,s);let u=4>t.distanceTo(n);e.getVoxelState(r,o,i).setUint8(0,u?1:0)}(0,v.cY)(new g.Mesh(z(e.voxelFaces()),new M.P({color:"#ff5566"})),{parent:this,x:0,z:-16}),console.log(e.getVoxelState(0,2,4).getUint8(0))}{let e=new S(16);for(let{x:n,y:r,z:o}of(0,R.KA)(16,16,16)){let i=15>t.set(n,r,o).length();e.getVoxelState(n,r,o).setUint8(0,i?1:0)}(0,v.cY)(new g.Mesh(z(e.voxelFaces()),new M.P({color:"#55ff96"})),{parent:this,x:-32})}return{sky:e}})()}}function T(){return(0,h.Ky)(function*(e){(0,d.a)({three:e});let t=new f.F({size:10,perspective:1});yield t.initialize(e.renderer.domElement),y.vB.get("three").set({minActiveDuration:60}),yield(0,y.RC)("three",n=>{let{aspect:r,camera:o}=e;t.update(o,r,n.deltaTime)}),yield(0,c.p)([[{code:"Space",modifiers:"shift"},()=>{document.body.requestFullscreen()}]])},[]),null}function j(){return(0,h._v)("main",function*(e){(0,v.cY)(new G,e)},[]),null}function K(){return(0,a.jsx)("div",{children:(0,a.jsxs)(h.H7,{children:[(0,a.jsx)(T,{}),(0,a.jsx)(j,{})]})})}},96966:function(e,t,n){"use strict";n.d(t,{v:function(){return o}});let r="/three-xp/assets/",o={development:!1,assetsPath:r,assets:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(r).concat(e)}}},4917:function(e,t,n){"use strict";n.d(t,{H7:function(){return d},Ky:function(){return f},_v:function(){return y}});var r=n(78485),o=n(27275),i=n(52471),l=n(48583),s=n(48181),u=n(96966),a=n(11030);let c=(0,o.createContext)(null);function f(e,t){let n=(0,o.useContext)(c);return(0,l.sv)(async function*(t,r){if(e){let t=e(n,r);if(t&&"function"==typeof t.next)do{let{value:e,done:n}=await t.next();if(n)break;yield e}while(r.mounted)}},null!=t?t:"always"),n}function y(e,t,n){let r=(0,o.useMemo)(()=>new i.Group,[]);return r.name=e,f(async function*(e,n){if(e.scene.add(r),yield()=>{r.clear(),r.removeFromParent()},t){let o=t(r,e,n);if(o&&"function"==typeof o.next)do{let{value:e,done:t}=await o.next();if(t)break;yield e}while(n.mounted)}},n),r}function h(e){let{children:t,className:n}=e,a=(0,o.useMemo)(()=>new s.Vu,[]),{ref:f}=(0,l.sv)(function*(e){a.loader.setPath(u.v.assetsPath),yield a.initialize(e),Object.assign(window,{three:a,THREE:i})},[]);return(0,r.jsx)("div",{ref:f,className:"ThreeProvider absolute-through ".concat(null!=n?n:""),children:(0,r.jsx)(c.Provider,{value:a,children:t})})}function d(e){return(0,a.O)()&&(0,r.jsx)(h,{...e})}},11030:function(e,t,n){"use strict";n.d(t,{O:function(){return o}});var r=n(27275);function o(){let[e,t]=(0,r.useState)(!1);return(0,r.useLayoutEffect)(()=>{t(!0)},[]),e}},8834:function(e,t,n){"use strict";n.d(t,{Leak:function(){return s},a:function(){return l}});var r=n(40855),o=n(79509),i=n(28142);function l(e){Object.assign(window,{...o,...r,...e,PRNG:i.T})}function s(e){return l(e),null}},37457:function(e,t,n){"use strict";function r(e,t){return"*"===t||("string"==typeof t?t===e:t instanceof RegExp?t.test(e):"function"==typeof t&&t(e))}n.d(t,{p:function(){return l}});let o={preventDefault:!1,strictTarget:void 0},i={key:"*",keyCaseInsensitive:!0,code:"*",noModifiers:!1,modifiers:""};function l(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[l,s,u]=1===t.length?[document.body,{},t[0]]:2===t.length?[t[0],{},t[1]]:t,{preventDefault:a}={...o,...s},c=e=>{var t;if((null!==(t=s.strictTarget)&&void 0!==t?!!t:l===document.body)&&e.target!==l)return;let{ctrlKey:n,altKey:o,shiftKey:c,metaKey:f}=e,y={event:e,modifiers:{ctrl:n,alt:o,shift:c,meta:f}};for(let t=0,l=u.length;t<l;t++){let[l,s]=u[t],{key:h,keyCaseInsensitive:d,code:v,noModifiers:g,modifiers:x}=function(e){let t="string"==typeof e?{...i,key:e}:{...i,...e};return t.keyCaseInsensitive&&"string"==typeof t.key&&(t.key=t.key.toLowerCase()),t}(l);Object.values({key:r(d?e.key.toLowerCase():e.key,h),code:r(e.code,v),noModifiers:!g||!1===n&&!1===o&&!1===c&&!1===f,modifiers:function(e,t){let{ctrlKey:n,altKey:r,shiftKey:o,metaKey:i}=e;if("function"==typeof t)return t({ctrl:n,alt:r,shift:o,meta:i});let{ctrl:l=!1,alt:s=!1,shift:u=!1,meta:a=!1}=Object.fromEntries(t.split("-").map(e=>[e,!0]));return l===n&&s===r&&u===o&&a===i}(e,x)}).every(Boolean)&&(a&&e.preventDefault(),s(y))}};return l.addEventListener("keydown",c,{passive:!1}),{destroy:()=>{l.removeEventListener("keydown",c)}}}},31454:function(e,t,n){"use strict";n.d(t,{K:function(){return l}});var r=n(52471),o=n(81796);let i={color:"white",opacity:.5,size:[8,8],step:1,frame:!0};class l extends r.LineSegments{set(e){let{color:t,opacity:n,size:l,step:s,frame:u}={...i,...e},a=(0,o.iK)(l),c=(0,o.iK)(null!=s?s:a),f=[],y=(e,t)=>f.push(new r.Vector3(e,t,0));u&&(y(-a.x/2,+a.y/2),y(+a.x/2,+a.y/2),y(+a.x/2,+a.y/2),y(+a.x/2,-a.y/2),y(+a.x/2,-a.y/2),y(-a.x/2,-a.y/2),y(-a.x/2,-a.y/2),y(-a.x/2,+a.y/2));let h=Math.ceil(-a.x/2/c.x)*c.x;h===-a.x/2&&(h+=c.x);do y(h,-a.y/2),y(h,+a.y/2),h+=c.x;while(h<a.x/2);let d=Math.ceil(-a.y/2/c.y)*c.y;d===-a.y/2&&(d+=c.y);do y(-a.x/2,d),y(+a.x/2,d),d+=c.y;while(d<a.y/2);return this.geometry.setFromPoints(f),this.material.color.set(t),this.material.opacity=n,this.material.transparent=n<1,this}constructor(e){super(),this.set(null!=e?e:i)}}},63549:function(e,t,n){"use strict";n.d(t,{P:function(){return i}});var r=n(52471);let o={vertexColors:!0,color:"white",luminosity:.5};class i extends r.ShaderMaterial{constructor(e){let{color:t,luminosity:n,vertexColors:i,...l}={...o,...e};super({...l,uniforms:{uColor:{value:new r.Color(t)},uSunPosition:{value:new r.Vector3(.5,.7,.3)},uLuminosity:{value:n}},vertexColors:i,vertexShader:"\nvarying vec3 vWorldNormal;\nvarying vec3 vColor;\n\nvoid main() {\n  vWorldNormal = mat3(modelMatrix) * normal;\n  vColor = color;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"\nvarying vec3 vWorldNormal;\nvarying vec3 vColor;\n\nuniform vec3 uSunPosition;\nuniform vec3 uColor;\nuniform float uLuminosity;\n\nvoid main() {\n  vec3 lightDirection = normalize(uSunPosition);\n  float light = dot(vWorldNormal, lightDirection) * 0.5 + 0.5;\n  light = pow(light, 2.0);\n  light = mix(uLuminosity, 1.0, light);\n  gl_FragColor = vec4(vColor * uColor * light, 1.0);\n}\n"}),this.sunPosition=this.uniforms.uSunPosition.value}}},40855:function(e,t,n){"use strict";function r(e,t){for(let n of e)if(t(n))return!0;return!1}function o(e,t){for(let n of e)if(!t(n))return!1;return!0}function i(e,t,n){let r=[];function o(e){let t=[];return r[e]=t,t}if(void 0!==n)for(let e=0;e<n;e++)o(e);for(let n of e){var i;let e=t(n);(null!==(i=r[e])&&void 0!==i?i:o(e)).push(n)}return r}n.r(t),n.d(t,{every:function(){return o},some:function(){return r},split:function(){return i}})},16573:function(e,t,n){"use strict";function*r(e){let t=0,n={get i(){return t},get t(){return t/e},get p(){return t/(e-1)}};for(t=0;t<e;t++)yield n}function*o(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let r=0,o=0;2===t.length?(r=t[0],o=t[1]):Array.isArray(t[0])?(r=t[0][0],o=t[0][1]):(r=t[0].x,o=t[0].y);let i=0,l=0,s=0,u={get i(){return i},get x(){return l},get y(){return s},get tx(){return l/r},get ty(){return s/o},get px(){return l/(r-1)},get py(){return s/(o-1)}};for(s=0;s<o;s++)for(l=0;l<r;l++)yield u,i++}function*i(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let r=0,o=0,i=0;3===t.length?(r=t[0],o=t[1],i=t[2]):Array.isArray(t[0])?(r=t[0][0],o=t[0][1],i=t[0][2]):(r=t[0].x,o=t[0].y,i=t[0].z);let l=0,s=0,u=0,a=0,c={get i(){return l},get x(){return s},get y(){return u},get z(){return a},get tx(){return s/r},get ty(){return u/o},get tz(){return a/i},get px(){return s/(r-1)},get py(){return u/(o-1)},get pz(){return a/(i-1)}};for(a=0;a<i;a++)for(u=0;u<o;u++)for(s=0;s<r;s++)yield c,l++}n.d(t,{B0:function(){return o},KA:function(){return i},VX:function(){return r}})}},function(e){e.O(0,[5244,6712,6666,5792,2452,7741,2722,4940,8648,4831,9918,8181,3425,1904,2920,7936,1744],function(){return e(e.s=96086)}),_N_E=e.O()}]);