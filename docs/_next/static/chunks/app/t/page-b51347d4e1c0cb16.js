(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2143,3540,3565,4354,7289,8181,9332],{158:(e,t,n)=>{"use strict";n.d(t,{PageClient:()=>v});var i=n(70691),r=n(19069),s=n(79285),o=n(4941),a=n(71323),l=n(35315),c=n(48647);function d(){return(0,i.jsx)(a.O,{title:(0,i.jsx)("h2",{children:"Nested"}),description:(0,i.jsxs)(i.Fragment,{children:["Nested ",(0,i.jsx)("span",{style:{color:c.Tj.magenta},children:'"fit-children"'}),", alignChildren and alignSelf demo"]}),size:[800,200],root:[new r.$x({offset:[10,10],size:"fit-children",spacing:10,alignChildrenY:.5}).add(new r.$x({size:"fit-children",spacing:10}).populate(2,{size:100})).populate(3,{size:[20,60]}).add(new r.$x({size:"fit-children",direction:"vertical",spacing:10}).populate(2,{size:[100,65]})),new r.$x({offset:[620,10],size:"fit-children",direction:"vertical",spacing:10,alignChildrenX:.5}).add(new r.$x({size:"fit-children",direction:"vertical",spacing:10}).populate(2,{size:[100,20]})).populate(3,{size:[60,20]})],computeLayout:e=>e.computeLayout2(),colorRule:e=>e.isRoot()?c.Tj.yellow:e.sizeXFitChildren||e.sizeYFitChildren?c.Tj.magenta:c.Tj.blue,onTick:(e,t)=>{for(let i of e){var n;i.set({alignChildren:t.sin01Time({frequency:1/3})}),null==(n=i.get(3))||n.set({alignSelf:o.cz.transition.inOut5(t.sin01Time({frequency:1/3}))})}}})}var u=n(98054);function h(){return(0,i.jsx)(a.O,{title:(0,i.jsx)("h2",{children:"(D5) Nested fit/fr space"}),description:(0,i.jsxs)(i.Fragment,{children:["Nested ",(0,i.jsx)("span",{style:{color:c.Tj.paleGreen},children:'"fit-children"'}),", ",(0,i.jsx)("span",{style:{color:c.Tj.blue},children:'"fraction"'}),", ",(0,i.jsx)("span",{style:{color:c.Tj.magenta},children:'"absolute"'})," spaces demo"]}),size:[800,600],root:[new r.$x({offset:[10,10],size:[780,580],spacing:10}).add(new r.$x({size:[120,240]}),new r.$x({spacing:10,alignChildren:0}).add(new r.$x({size:["fit-children",240],spacing:10,alignChildren:0}).add(new r.$x({size:40}),new r.$x({size:40}),new r.$x({size:80})),new r.$x),new r.$x({size:[120,240]}),new r.$x({size:"fit-children",spacing:10,alignChildren:1}).add(new r.$x({size:[50,50]}),new r.$x({size:[100,100]})))],colorRule:u.Y,directionArrow:!0,computeLayout:e=>e.computeLayout2(),tickDisabled:!0,onTick:(e,t)=>{for(let n of e)n.set({alignChildren:t.sin01Time({frequency:1/3})})}})}function p(){return(0,i.jsx)(a.O,{title:(0,i.jsx)("h2",{children:"(D5_Vertical) Nested fit/fr space"}),description:(0,i.jsxs)(i.Fragment,{children:["Nested ",(0,i.jsx)("span",{style:{color:c.Tj.paleGreen},children:'"fit-children"'}),", ",(0,i.jsx)("span",{style:{color:c.Tj.blue},children:'"fraction"'}),", ",(0,i.jsx)("span",{style:{color:c.Tj.magenta},children:'"absolute"'})," spaces demo"]}),size:[800,600],root:[new r.$x({offset:[10,10],size:[780,580],spacing:10,direction:"vertical"}).add(new r.$x({size:[240,60]}),new r.$x({spacing:10,direction:"vertical"}).add(new r.$x({size:[240,"fit-children"],direction:"vertical",spacing:10,alignChildren:0}).add(new r.$x({size:40}),new r.$x({size:40})),new r.$x),new r.$x({size:[240,60]}),new r.$x({direction:"vertical",size:"fit-children",spacing:10,alignChildrenY:1}).add(new r.$x({size:[240,60]}),new r.$x({size:[100,100]})))],colorRule:u.Y,directionArrow:!0,computeLayout:e=>e.computeLayout2(),tickDisabled:!0,onTick:(e,t)=>{for(let n of e)n.set({alignChildren:t.sin01Time({frequency:1/3})})}})}function f(){return(0,i.jsx)(a.O,{title:(0,i.jsx)("h2",{children:"(D6) Aspect"}),description:(0,i.jsxs)(i.Fragment,{children:["Nested ",(0,i.jsx)("span",{style:{color:c.Tj.paleGreen},children:'"fit-children"'}),", ",(0,i.jsx)("span",{style:{color:c.Tj.blue},children:'"fraction"'}),", ",(0,i.jsx)("span",{style:{color:c.Tj.magenta},children:'"absolute"'})," spaces demo"]}),size:[800,600],root:[new r.$x({offset:[100,100],size:[600,400],spacing:10}).add(new r.$x({aspect:1/8}),new r.$x({aspect:.5}),new r.$x({aspect:1/8}),new r.$x({sizeY:"50%",aspect:1}))],colorRule:u.Y,directionArrow:!0,computeLayout:e=>e.computeLayout2(),tickDisabled:!0,onTick:(e,t)=>{for(let n of e)n.set({alignChildren:t.sin01Time({frequency:1/3})})}})}n(14043);var x=n(71978);function m(){let e=(0,l.h)(800,600);return(0,i.jsx)(a.O,{size:[800,600],root:e.root,computeLayout:e=>e.computeLayout2(),title:(0,i.jsx)("h2",{children:"D4 Positioning Demo"}),onTick:(t,n)=>{e.updateOnTick(n)}})}function v(){let[e,t]=(0,x.Q)("#demo-4"),n=parseInt(e.replace("#demo-","")||"-1"),l=[()=>(0,i.jsx)(a.O,{size:[800,200],root:[new r.$x({offset:[20,20],size:"fit-children",spacing:10}).populate(3,{size:100}),new r.$x({offset:[420,20],size:"fit-children",direction:"vertical",spacing:10,alignChildrenY:1}).populate(3,{size:[100,20]})],computeLayout:e=>e.computeLayout2(),title:(0,i.jsx)("h2",{children:"Simple"})}),d,h,p,f,()=>(0,i.jsx)(a.O,{size:[800,600],root:[new r.$x({offset:[50,50],size:[325,500],spacing:10}).add(new r.$x,new r.$x,new r.$x({size:["2fr","50%"],spacing:10}),new r.$x({size:"10%",spacing:10}),new r.$x({size:"10%",spacing:10})),new r.$x({offset:[425,50],size:[325,500],spacing:10,direction:"vertical"}).add(new r.$x,new r.$x,new r.$x({size:["50%","2fr"],spacing:10}),new r.$x({size:"10%",spacing:10}),new r.$x({size:"10%",spacing:10}))],computeLayout:e=>e.computeLayout2(),onTick:(e,t)=>{let n="".concat((0,s.lerp)(1,3,t.sin01Time({frequency:1/3})).toFixed(4),"fr");for(let s of e){var i;s.set({alignChildren:t.sin01Time({frequency:1/3})}),s.get(2).set({size:s.direction===r.OP.Horizontal?[n,"50%"]:["50%",n]}),null==(i=s.get(-1))||i.set({alignSelf:o.cz.transition.inOut5(t.sin01Time({frequency:1/3}))})}},title:(0,i.jsx)("h2",{children:"No fit children"}),description:(0,i.jsx)(i.Fragment,{children:"computeLayout2 demo, support for regular sizes"})}),()=>(0,i.jsx)(m,{})].filter((e,t)=>-1===n||n===t);return(0,i.jsxs)("div",{className:"FlexLayoutDemo p-16 h-screen overflow-auto",children:[(0,i.jsx)("h1",{className:"text-3xl text-center font-bold",children:"Fit Children"}),l.map((e,r)=>(0,i.jsx)("div",{className:"my-8",onClick:()=>t(-1===n?"#demo-".concat(r):null),children:(0,i.jsx)(e,{})},r))]})}},1029:(e,t,n)=>{"use strict";n.d(t,{N:()=>r});let i={vecX:["float","vec2","vec3","vec4"]},r=(e,t)=>{let n=[],r=Array.isArray(e)?e:[e].map(e=>e in i?i[e]:e).flat();if("function"==typeof t)for(let e of r)n.push(t(e).replaceAll(/\bT\b/g,e));else for(let e of r)n.push(t.replaceAll(/\bT\b/g,e));return n.join("\n")}},2210:(e,t,n)=>{"use strict";n.d(t,{d:()=>D});var i=n(28535),r=n(76999),s=n(57368),o=n(66066),a=n(15940),l=n(77674),c=n(49797),d=n(94065);let u=new c.kn4;function h(e,t){let{scale:{x:n,y:i,z:r},scaleFactor:s,shear:{x:o,y:a,z:l}}=e;t.makeRotationFromQuaternion(e.quaternion),t.multiply(u.set(1,o,a,0,0,1,l,0,0,0,1,0,0,0,0,1)),t.elements[0]*=n*s,t.elements[1]*=n*s,t.elements[2]*=n*s,t.elements[4]*=i*s,t.elements[5]*=i*s,t.elements[6]*=i*s,t.elements[8]*=r*s,t.elements[9]*=r*s,t.elements[10]*=r*s,t.setPosition(e.position)}let p=new c.Pq0,f=new c.Pq0,x=new c.Pq0,m=new c.Pq0,v=new c.Pq0,g=new c.Pq0,w=new c.Pq0;function y(e,t){let n=e.elements;t.position.set(n[12],n[13],n[14]),p.set(n[0],n[1],n[2]),f.set(n[4],n[5],n[6]),x.set(n[8],n[9],n[10]);let i=0>p.dot(m.crossVectors(f,x))?-1:1,r=p.length();v.copy(p).divideScalar(r);let s=v.dot(f);g.copy(f).addScaledVector(v,-s);let o=g.length();g.divideScalar(o);let a=v.dot(x),l=g.dot(x);w.copy(x).addScaledVector(v,-a).addScaledVector(g,-l);let c=w.length();w.divideScalar(c),i<0&&v.negate(),t.quaternion.setFromRotationMatrix(u.makeBasis(v,g,w)),t.scale.set(i*r,o,c),t.scaleFactor=1,t.shear.set(i*s/o,i*a/c,l/c)}function b(e,t){let{resetMissing:n=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return void 0!==e.position?(0,d.jj)(e.position,t.position):n&&t.position.set(0,0,0),void 0!==e.quaternion?(0,d.EC)(e.quaternion,t.quaternion):void 0!==e.rotation?t.quaternion.setFromEuler((0,d.if)(e.rotation)):n&&t.quaternion.set(0,0,0,1),void 0!==e.scale?(0,d.jj)(e.scale,t.scale):n&&t.scale.set(1,1,1),void 0!==e.scaleFactor?t.scaleFactor=e.scaleFactor:n&&(t.scaleFactor=1),void 0!==e.shear?(0,d.jj)(e.shear,t.shear):n&&t.shear.set(0,0,0),t}function j(e,t,n,i){i.position.lerpVectors(e.position,t.position,n),i.quaternion.slerpQuaternions(e.quaternion,t.quaternion,n),i.scale.lerpVectors(e.scale,t.scale,n),i.scaleFactor=e.scaleFactor+(t.scaleFactor-e.scaleFactor)*n,i.shear.lerpVectors(e.shear,t.shear,n)}function P(){return{position:new c.Pq0,quaternion:new c.PTz,scale:new c.Pq0(1,1,1),scaleFactor:1,shear:new c.Pq0}}let z=new c.kn4,C=P(),T=P(),S=P();var F=new WeakMap,A=new WeakSet;class D{static lerp(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(0,l._)(D,D,k);return b(e,C),b(t,T),j(C,T,n,i),i}static from(e){return new this().from(e)}get rotation(){return(0,o._)(this,A,E).call(this)}copy(e){return this.position.copy(e.position),this.scale.copy(e.scale),this.quaternion.copy(e.quaternion),this.shear.copy(e.shear),this}clone(){return(new this.constructor).copy(this)}toMatrix(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new c.kn4;return h(this,e),e}from(e){return e instanceof c.kn4?y(e,this):b(e,this),this}setTransform(e){let{partial:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return b(e,this,{resetMissing:!t}),this}lerpTransforms(e,t,n){return j(e,t,n,this),this}lerp(e,t){return j(this,e,t,this),this}identity(){return this.position.set(0,0,0),this.quaternion.set(0,0,0,1),this.scale.set(1,1,1),this.shear.set(0,0,0),this}isIdentity(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e-6;return this.position.lengthSq()<=e&&Math.abs(this.quaternion.x)<=e&&Math.abs(this.quaternion.y)<=e&&Math.abs(this.quaternion.z)<=e&&Math.abs(this.quaternion.w-1)<=e&&Math.abs(this.scale.x-1)<=e&&Math.abs(this.scale.y-1)<=e&&Math.abs(this.scale.z-1)<=e&&Math.abs(this.shear.x)<=e&&Math.abs(this.shear.y)<=e&&Math.abs(this.shear.z)<=e}isDirect(){let{x:e,y:t,z:n}=this.scale;return e*t*n>=0}toInfoString(){let{x:e,y:t,z:n}=this.position,{x:i,y:r,z:s}=this.scale,{x:o,y:a,z:l}=this.shear,c=this.scaleFactor,d=e=>e.toFixed(2).replace(/\.?0+$/,"");return"Position: (".concat(d(e),", ").concat(d(t),", ").concat(d(n),"), Scale: (").concat(d(i),", ").concat(d(r),", ").concat(d(s),")x(").concat(d(c),"), Shear: (").concat(d(o),", ").concat(d(a),", ").concat(d(l),")")}constructor(){(0,a._)(this,A),(0,r._)(this,F,{writable:!0,value:void 0}),this.position=new c.Pq0,this.scale=new c.Pq0(1,1,1),this.scaleFactor=1,this.quaternion=new c.PTz,this.shear=new c.Pq0,(0,s._)(this,F,null)}}D.lerpMatrixes=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:z;return y(e,C),y(t,T),j(C,T,n,S),h(S,i),i};var k={writable:!0,value:new D};function E(){if(null===(0,i._)(this,F)){let e=new c.O9p().setFromQuaternion(this.quaternion);return e._onChangeCallback=()=>{this.quaternion.setFromEuler(e)},(0,s._)(this,F,e)}return(0,i._)(this,F)}},2218:e=>{e.exports={Client:"page_client_Client__icnsc"}},3009:(e,t,n)=>{"use strict";n.d(t,{Zt:()=>o,zf:()=>i,QS:()=>a});let i="\n#ifndef GLSL_BEND\n#define GLSL_BEND\n  vec4 applyBend(vec4 position, float factor, mat4 bendMatrix, mat4 bendMatrixInverse) {\n    float q = 1.0 / factor;\n    \n    if (abs(factor) < 0.0001)\n      return position;\n    \n    position = bendMatrixInverse * position;\n    vec2 center = vec2(0.0, q);\n    float a = position.x / q;\n    float r = center.y - position.y;\n    position.x = center.x + r * sin(a);\n    position.y = center.y + -r * cos(a);\n    position = bendMatrix * position;\n    return position;\n  }\n#endif\n";var r=n(49797),s=n(7147);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"white";return{uBendFactor:{value:0},uBendMatrix:{value:e.clone()},uBendMatrixInverse:{value:e.clone().invert()},uMyColor:{value:new r.Q1f(t)}}}function a(e,t){s.bI.with(e).uniforms(t).vertex.top(i).vertex.replace("project_vertex","\n  vec4 mvPosition = vec4( transformed, 1.0 );\n  #ifdef USE_BATCHING\n    mvPosition = batchingMatrix * mvPosition;\n  #endif\n  #ifdef USE_INSTANCING\n    mvPosition = instanceMatrix * mvPosition;\n  #endif\n  mvPosition = modelMatrix * mvPosition;\n  mvPosition = applyBend(mvPosition, uBendFactor, uBendMatrix, uBendMatrixInverse);\n  mvPosition = viewMatrix * mvPosition;\n  gl_Position = projectionMatrix * mvPosition;\n")}},3261:(e,t,n)=>{"use strict";n.d(t,{PageClient:()=>b});var i=n(70691),r=n(49797),s=n(63106),o=n(99332),a=n(98839),l=n(33540),c=n(61572),d=n(77794),u=n(7147),h=n(79911),p=n(55227),f=n(79285),x=n(67235),m=n(36508),v=n(28737),g=n(88352);class w extends r.YJl{*initialize(e){let{water:t}=this;t.initialize(e.renderer),yield x.Q.on(w,e=>{e.setPayload(this)});let n=!1,i=0,a=new r.I9Y(.5,.5);return yield(0,m.xy)("three",{timeInterval:1/60},r=>{let{playing:s,autoRotate:o}=this.state;if(s){if(this.state.strength*=.9,n){let t=e.pointer.intersectPlane("xy");t.intersected&&a.set((0,f.inverseLerp)(-5,5,t.point.x),(0,f.inverseLerp)(-5,5,t.point.y)),this.state.strength=1}if(o&&!n){let e=2*(i+=r.deltaTime)*Math.PI*.4;a.set(.5+.3*Math.cos(e),.5+.3*Math.sin(e)),this.state.strength=1}t.pointer(a.x,a.y,40,this.state.strength*this.state.direction),t.update(r.deltaTime),this.plane.material.map=t.currentTexture(),this.plane.material.needsUpdate=!0}}),yield(0,o.s)(e.domElement,{onTap:()=>this.state.direction*=-1,onDragStart:()=>n=!0,onDragStop:()=>n=!1}),yield(0,s.a)([[{key:" "},()=>{this.state.playing=!this.state.playing}]]),this}constructor(){super(),this.plane=(0,h.mj)(new r.eaF(new r.bdM,new r.V9B),this),this.water=new c.S,this.grid=(0,h.mj)(new d.u,this).regularGrid({size:10,subdivisions:[2,10]}).onTop(),this.state={playing:!0,autoRotate:!1,strength:1,direction:1},this.name="water-demo",this.plane.scale.setScalar(10),this.plane.material.onBeforeCompile=e=>u.bI.with(e).fragment.top(p.M).fragment.after("map_fragment","\n        vec3 data = diffuseColor.rgb;\n        diffuseColor.r = clamp(data.r, 0.0, 1.0);\n        diffuseColor.g = clamp(-data.r, 0.0, 1.0);\n\n        Vec3Ramp r = ramp(0.5 + data.r * 0.1, ".concat((0,u.eR)("#9e0202ff"),", ").concat((0,u.eR)("#000000"),", ").concat((0,u.eR)("#027254ff"),");\n        diffuseColor.rgb = mix(r.a, r.b, r.t);\n      "))}}function y(){let e=(0,l.Fw)();return(0,l.dB)("my-scene",function*(t){e.pipeline.basicPasses.fxaa.enabled=!1;let n=(0,h.mj)(new w,t);yield*n.initialize(e)},[]),null}function b(){return(0,v.O)(),(0,i.jsxs)(l.uB,{vertigoControls:{fixed:!0,size:10.5,eventTarget:"canvas"},children:[(0,i.jsxs)("div",{className:"layer thru flex flex-col p-12 gap-2 items-start",children:[(0,i.jsx)("h1",{className:"text-4xl font-bold",children:"GPU Compute - Water Demo"}),(0,i.jsx)("p",{children:"Classic water simulation using a height map and GPU Compute."}),(0,i.jsx)("div",{className:"flex gap-2",children:(0,i.jsx)("button",{className:"px-2 py-1 border rounded bg-white/10 hover:bg-white/20 transition",onClick:()=>{let e=x.Q.send(w).assertPayload();e.state.playing=!e.state.playing},children:"Play / Pause [space]"})}),(0,i.jsx)("div",{className:"flex gap-2",children:[new r.I9Y(512,512),new r.I9Y(256,512),new r.I9Y(256,128)].map((e,t)=>(0,i.jsxs)("button",{className:"px-2 py-1 border rounded bg-white/10 hover:bg-white/20 transition",onClick:()=>{var t;let n=x.Q.send(w).assertPayload();n.water.setSize(e);let i=e.x/e.y;null!=(t=n.plane.scale)||(t=new r.I9Y),i>1?(t.x=10,t.y=10/i):(t.x=10*i,t.y=10),1===i?n.grid.clear().regularGrid({size:10,subdivisions:[2,10]}):n.grid.clear().rect({center:0,size:n.plane.scale})},children:[e.x,"x",e.y]},t))}),(0,i.jsx)(g.A,{}),(0,i.jsx)(a.l,{})]}),(0,i.jsx)(y,{})]})}},4003:(e,t,n)=>{"use strict";n.d(t,{w:()=>i.w});var i=n(3461)},4941:(e,t,n)=>{"use strict";n.d(t,{_5:()=>r.ol,YN:()=>r.o8,cz:()=>s,kY:()=>r.kY});var i=n(37197),r=n(40074);let s={transition:r.kY,bump:i.$p}},6688:(e,t,n)=>{"use strict";n.d(t,{Client:()=>l});var i=n(70691),r=n(18479),s=n(19069),o=n(54167),a=n.n(o);function l(){let{ref:e}=(0,r.useEffects)(function*(e){let t=new s.$x;t.parse(e.dataset.layout),t.sizeX.set(e.clientWidth,s.LN.Absolute),t.sizeY.set(e.clientHeight,s.LN.Absolute),t.alignChildrenX=0,t.alignChildrenY=0;let n=[{element:e,space:t}];for(;n.length>0;){let e=n.shift(),t=[...e.element.children].filter(e=>!!e.dataset.layout);for(let i=0;i<t.length;i++){let r=t[i],o=new s.$x;o.parse(r.dataset.layout),o.userData.element=r,e.space.add(o),n.push({element:r,space:o})}}for(let e of(t.computeLayout(),t.allDescendants({includeSelf:!1}))){let t=e.userData.element,n=e.rect;t.style.position="absolute",t.style.left="".concat(n.x,"px"),t.style.top="".concat(n.y,"px"),t.style.width="".concat(n.width,"px"),t.style.height="".concat(n.height,"px")}Object.assign(window,{root:t})},[]);return(0,i.jsxs)("div",{ref:e,className:"".concat(a().FlexibleLayout," layer"),"data-layout":"vertical",children:[(0,i.jsxs)("div",{"data-layout":"horizontal size(1sh)",children:[(0,i.jsx)("div",{"data-layout":"size(200,100%)",children:(0,i.jsx)("div",{className:a().Container,children:(0,i.jsx)("h1",{children:"Panel - 0"})})}),(0,i.jsx)("div",{"data-layout":"size(1sh)"}),(0,i.jsx)("div",{"data-layout":"size(320, 100%)",children:(0,i.jsx)("div",{className:a().Container,children:(0,i.jsx)("h1",{children:"Panel - 1"})})})]}),(0,i.jsx)("div",{"data-layout":"size(1sh, 200)",children:(0,i.jsxs)("div",{className:a().Container,children:[(0,i.jsx)("h1",{children:"Timeline or asset panel"}),(0,i.jsxs)("ul",{children:[(0,i.jsx)("li",{children:"Todo:"}),(0,i.jsx)("li",{children:"Create a draggable UI!"})]})]})})]})}},8144:(e,t,n)=>{"use strict";n.d(t,{H:()=>s});var i=n(65927),r=n(1029);let s="\n".concat(i.S,"\n\n#ifndef GLSL_UTILS\n#define GLSL_UTILS\n\nfloat sin01(float x) {\n  return 0.5 + 0.5 * sin(x * 6.283185307179586);\n}\n\nvec2 scaleAround(vec2 p, vec2 c, float s) {\n  return c + (p - c) / s;\n}\n\n// Same as mix, but clamped.\n").concat((0,r.N)("vecX","\n  T lerp(in T a, in T b, in float x) {\n    return mix(a, b, clamp01(x));\n  }\n"),"\n\nfloat inverseLerpUnclamped(in float a, in float b, float x) {\n  return (x - a) / (b - a);\n}\n\nfloat inverseLerp(in float a, in float b, float x) {\n  return clamp01((x - a) / (b - a));\n}\n\nfloat remap(in float x, in float a, in float b, in float c, in float d) {\n  return c + (d - c) * inverseLerp(a, b, x);\n}\n\n// Remap from [-1, 1] to [0, 1]\nfloat remap1101(in float x) {\n  return clamp01(0.5 + 0.5 * x);\n}\n\n").concat((0,r.N)("vecX","\n  T oneMinus(in T x) {\n    return 1.0 - x;\n  }\n"),"\n\n// Returns x^p, but handles negative x values correctly.\nfloat spow(in float x, in float p) {\n  return x >= 0.0 ? pow(x, p) : -pow(-x, p);\n}\n\nfloat threshold(in float x, in float thresholdValue) {\n  return x < thresholdValue ? 0. : 1.;\n}\n\nfloat threshold(in float x, in float thresholdValue, in float width) {\n  return width < 1e-9 \n    ? (x < thresholdValue ? 0. : 1.)\n    : clamp01((x - thresholdValue + width * .5) / width);\n}\n\nmat3 extractRotation(mat4 matrix) {\n  return mat3(matrix[0].xyz, matrix[1].xyz, matrix[2].xyz);\n}\n\nvec2 rotate(vec2 p, float a) {\n  float c = cos(a);\n  float s = sin(a);\n  float x = c * p.x + s * p.y;\n  float y = -s * p.x + c * p.y;\n  return vec2(x, y);\n}\n\nvec2 rotateAround(vec2 p, float a, vec2 c) {\n  return c + rotate(p - c, a);\n}\n\nvec2 rotateScaleAround(vec2 p, float a, float s, vec2 c) {\n  return c + rotate((p - c) / s, a);\n}\n\nfloat positiveModulo(float x) {\n  x = mod(x, 1.0);\n  return x < 0.0 ? x + 1.0 : x;\n}\n\n// Modulo that keeps the result in the range [0, modulo]\nfloat positiveModulo(float x, float modulo) {\n  x = mod(x, modulo);\n  return x < 0.0 ? x + modulo : x;\n}\n\n// Modulo that keeps the result in the range [-m/2, m/2]\nfloat middleModulo(float x, float modulo) {\n  x = mod(x, modulo);\n  return x < -modulo / 2.0 ? x + modulo : x > modulo / 2.0 ? x - modulo : x;\n}\n\n// Limit a value to a maximum that the function tends to reach when x -> ∞\n// https://www.desmos.com/calculator/0vewkbnscu\nfloat limited(float x, float maxValue) {\n  return x <= 0.0 ? x : maxValue * x / (maxValue + x);\n}\n\n// Symmetric version of limited\n// \n// Limit a value to a maximum that the function tends to reach when x -> ∞\n// and a minimum (-maximum) that the function tends to reach when x -> -∞\n// https://www.desmos.com/calculator/0vewkbnscu\nfloat slimited(float x, float maxValue) {\n  return x <= 0.0\n    ? -limited(-x, maxValue)\n    : limited(x, maxValue);\n}\n\n// https://www.desmos.com/calculator/0vewkbnscu\nfloat limited(float x, float minValue, float maxValue) {\n  float d = maxValue - minValue;\n  float xd = x - minValue;\n  return x <= minValue ? x : minValue + d * xd / (d + xd);\n}\n\n// Symmetric version of limited\nfloat slimited(float x, float minValue, float maxValue) {\n  return x <= 0.0\n    ? -limited(-x, maxValue, minValue)\n    : limited(x, minValue, maxValue);\n}\n\nfloat sqLength(in vec2 p) {\n  return p.x * p.x + p.y * p.y;\n}\n\nfloat sqLength(in vec3 p) {\n  return p.x * p.x + p.y * p.y + p.z * p.z;\n}\n\nfloat pcurve(float x, float a, float b) {\n  float k = pow(a + b, a + b) / (pow(a, a) * pow(b, b));\n  return k * pow(x, a) * pow(1.0 - x, b);\n}\n\nfloat hash(float p) {\n  return fract(sin(p * 12.9898) * 43758.5453);\n}\n\nfloat hash(vec2 p) {\n  return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nfloat hash(vec3 p) {\n  return fract(sin(dot(p, vec3(12.9898, 78.233, 45.164))) * 43758.5453);\n}\n\nfloat hash(vec4 p) {\n  return fract(sin(dot(p, vec4(12.9898, 78.233, 45.164, 94.673))) * 43758.5453);\n}\n\nvec2 hash2(float p) {\n  return vec2(hash(p), hash(p + 1.0));\n}\n\nvec2 hash2(vec2 p) {\n  return vec2(hash(p.x), hash(p.y));\n}\n\nvec2 hash2(vec3 p) {\n  return vec2(hash(p.xy), hash(p.yz));\n}\n\nvec2 hash2(vec4 p) {\n  return vec2(hash(p.xyz), hash(p.yzw));\n}\n\nvec3 hash3(float p) {\n  return vec3(hash2(p),  hash(p + 2.0));\n}\n\nvec3 hash3(vec2 p) {\n  return vec3(hash2(p), hash(p));\n}\n\nvec3 hash3(vec3 p) {\n  return vec3(hash(p.x), hash(p.y), hash(p.z));\n}\n\nvec3 hash3(vec4 p) {\n  return vec3(hash(p.xy), hash(p.yz), hash(p.zw));\n}\n\nfloat hash_alt(float p) {\n  return fract(sin(p * 127.1) * 311.7);\n}\n\nfloat hash_alt(vec2 p) {\n  return fract(sin(dot(p, vec2(127.1, 311.7))) * 269.5);\n}\n\nfloat hash_alt(vec3 p) {\n  return fract(sin(dot(p, vec3(127.1, 311.7, 74.7))) * 269.5);\n}\n\nfloat hash_alt(vec4 p) {\n  return fract(sin(dot(p, vec4(127.1, 311.7, 74.7, 113.5))) * 269.5);\n}\n\n").concat((0,r.N)("vecX","\n  T min3(in T a, in T b, in T c) {\n    return min(min(a, b), c);\n  }\n"),"\n\n").concat((0,r.N)("vecX","\n  T min4(in T a, in T b, in T c, in T d) {\n    return min(min(a, b), min(c, d));\n  }\n"),"\n\n#endif // GLSL_UTILS\n")},10390:(e,t,n)=>{"use strict";n.d(t,{o:()=>u});var i=n(49797),r=n(9954),s=n(17775),o=n(5832),a=n(33589);let l=["gltf","glb"],c=["png","jpg","jpeg","hdr","exr"];class d{add(e){return this.listeners.add(e),{destroy:()=>this.listeners.delete(e)}}call(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let e of this.listeners)e.apply(null,t)}constructor(){this.listeners=new Set}}class u{static current(){var e;return null!=(e=this.instances[this.instances.length-1])?e:new u}static get(e){var t;return null!=(t=this.instances.find(t=>t.name===e))?t:new u({name:e})}setPath(e){this.path=e}onAfterLoad(e){return this._onAfterLoad.add(e)}async loadGltf(e){return new Promise((t,n)=>{this.loaders.gltf.load(e,e=>{t(e),this._onAfterLoad.call()},void 0,n)})}async loadRgbe(e){let t=(0,a.F)(this.loaders.rgbeLoader.load(e,e=>{t.resolve(),this._onAfterLoad.call()},void 0,()=>{console.log("Failed to load RGBE: ".concat(e))}));return t}async loadExr(e){let t=(0,a.F)(this.loaders.exrLoader.load(e,e=>{t.resolve(),this._onAfterLoad.call()},void 0,()=>{console.log("Failed to load EXR: ".concat(e))}));return t}loadTexture(e,t){let n=new URL(this.path+e,window.location.href).href;if(this.textureCache.has(n)){let e=this.textureCache.get(n);return null==t||t(e),e}let i=(0,a.F)(this.loaders.texture.load(n,e=>{this.textureCache.set(n,i),null==t||t(e),i.resolve(),this._onAfterLoad.call()},void 0,()=>{console.log("Failed to load texture: ".concat(n))}));return i}async load(e){let t=e.split(".").pop();if(l.includes(t))return this.loadGltf(e);if(c.includes(t))return new Promise((t,n)=>{this.loaders.texture.load(e,e=>{t(e),this._onAfterLoad.call()},void 0,n)});throw Error("Unsupported extension: ".concat(t))}constructor({name:e}={}){this.id=u.nextId++,this.loaders={gltf:new s.B,texture:new i.Tap,rgbeLoader:new o.Y,exrLoader:new r.H},this.path="",this._onAfterLoad=new d,this.textureCache=new Map,this.name=null!=e?e:"UnifiedLoader-".concat(this.id),u.instances.push(this)}}u.nextId=0,u.instances=[]},11281:e=>{e.exports={Client:"client_Client__Q3vhD"}},13160:(e,t,n)=>{"use strict";n.d(t,{Q:()=>s});var i=n(49797),r=n(94065);class s{static setColor(e,t){let n=e.attributes.position.count,r=new i.THS(new Float32Array(3*n),3),{r:s,g:o,b:a}=new i.Q1f(t);for(let e=0;e<n;e++)r.setXYZ(e,s,o,a);return e.setAttribute("color",r),e}static setAsBounds(e,t,n){let{x:s,y:o,z:a}=(0,r.jj)(t),{x:l,y:c,z:d}=(0,r.jj)(n),u=new Float32Array([s,o,a,l,o,a,l,o,a,l,c,a,l,c,a,s,c,a,s,c,a,s,o,a,s,o,d,l,o,d,l,o,d,l,c,d,l,c,d,s,c,d,s,c,d,s,o,d,s,o,a,s,o,d,l,o,a,l,o,d,l,c,a,l,c,d,s,c,a,s,c,d]);return null!=e||(e=new i.LoY),e.setAttribute("position",new i.THS(u,3)),e.computeBoundingBox(),e.computeBoundingSphere(),e}}},13565:(e,t,n)=>{"use strict";n.d(t,{q:()=>g});var i=n(28535),r=n(76999),s=n(57368),o=n(49797),a=n(94065),l=n(73446),c=n(8144),d=n(96122);let u=[3,5,7,9,11].map(e=>(function(e,t){let n=function(e,t){if(e%2==0)throw Error("Kernel size must be odd");let n=Math.floor(e/2);null!=t||(t=e/3);let i=2*t*t,r=[],s=0;for(let e=-n;e<=n;e++)for(let t=-n;t<=n;t++){let n=Math.exp(-(t*t+e*e)/i);r.push(n),s+=n}for(let e=0;e<r.length;e++)r[e]/=s;return r}(e,void 0),i=[];for(let t=0;t<e;t++){let r=n.slice(t*e,(t+1)*e).map(e=>"  ".concat(e.toFixed(5))).join(", ");i.push(r)}let r="kernel".concat(e,"x").concat(e),s="const float[".concat(e*e,"] ").concat(r," = float[").concat(e*e,"](\n").concat(i.join(",\n"),");"),o=Math.floor(e/2);return s+"\n\n"+(0,d.T)("\n    vec4 gaussianBlur".concat(e,"x").concat(e,"(vec2 uv, float scale) {\n      vec2 texelSize = scale / uTextureSize;\n      vec4 color = vec4(0.0);\n      for (int x = -").concat(o,"; x <= ").concat(o,"; x++) {\n        for (int y = -").concat(o,"; y <= ").concat(o,"; y++) {\n          vec2 offset = vec2(float(x), float(y)) * texelSize;\n          color += texture2D(uTexture, uv + offset) * ").concat(r,"[x + ").concat(o," + (y + ").concat(o,") * ").concat(e,"];\n        }\n      }\n      return color;\n    }\n\n    vec4 gaussianBlur").concat(e,"x").concat(e,"(vec2 uv) {\n      return gaussianBlur").concat(e,"x").concat(e,"(uv, 1.0);\n    }\n  "))})(e)).join("\n\n"),h={glsl_blending:l.x,glsl_blur_3_11:u,glsl_sdf_2d:"\n  // 2D SDF functions\n  float sdSegment(in vec2 p, in vec2 a, in vec2 b) {\n    vec2 pa = p-a, ba = b-a;\n    float h = clamp( dot(pa,ba)/dot(ba,ba), 0.0, 1.0 );\n    return length( pa - ba*h );\n  }\n\n  float sdRoundedSegment(in vec2 p, in vec2 a, in vec2 b, float r) {\n    return sdSegment(p, a, b) - r;\n  }\n",glsl_utils:c.H},p={fragmentTop:"",fragmentColor:"\n    gl_FragColor = vec4(vUv, 1., 1.);\n  ",texture:null,uniforms:{}};class f extends o.BKk{constructor(e,t){let n={...p,...t},i={...{uTexture:{value:null},uTextureSize:{value:new o.I9Y},uTime:{value:0},uDeltaTime:{value:0}},...n.uniforms},r=Array.from(e).map(e=>h[e]).filter(e=>!!e).join("\n\n");i.uTexture.value=n.texture,super({uniforms:i,vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = vec4(position, 1.);\n        }\n      ",fragmentShader:"\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform vec2 uTextureSize;\n        uniform float uTime;\n        uniform float uDeltaTime;\n\n        ".concat(r,"\n\n        ").concat(Object.entries(n.uniforms).map(e=>{let[t,{value:n}]=e,i=function e(t){if(Array.isArray(t)){if(0===t.length)throw Error("GpuCompute: cannot infer uniform type for empty array");let n=e(t[0]);for(let i=1;i<t.length;i++)if(e(t[i])!==n)throw Error("GpuCompute: cannot infer uniform type for array with mixed types");return"".concat(n,"[").concat(t.length,"]")}if("number"==typeof t)return"float";if(t instanceof o.I9Y)return"vec2";if(t instanceof o.Pq0)return"vec3";if(t instanceof o.IUQ)return"vec4";if(t instanceof o.Q1f)return"vec3";if(t instanceof o.gPd)return"sampler2D";throw Error("GpuCompute: cannot infer uniform type for value: ".concat(t))}(n);return"uniform ".concat(i," ").concat(t,";")}).join("\n"),"\n\n        ").concat(n.fragmentTop,"\n\n        void main() {\n          ").concat(n.fragmentColor,"\n        }\n      ")}),this.uniforms=i}}let x={size:1024,type:o.ix0,generateMipmaps:!1,filter:"nearest",wrap:o.GJx,wrapS:void 0,wrapT:void 0};var m=new WeakMap,v=new WeakMap;class g{get initialized(){return!!(0,i._)(this,m)}get renderer(){var e;return null==(e=(0,i._)(this,m))?void 0:e.renderer}get updateUniforms(){if(!this.state.updateMaterial)throw Error("GpuCompute: shaders not set");return this.state.updateMaterial.uniforms}setSize(e){let{width:t,height:n}=(0,a.wX)(e);return(this.state.size.x!==t||this.state.size.y!==n)&&(this.state.size.set(t,n),this.state.rtA.setSize(t,n),this.state.rtB.setSize(t,n)),this}enableGlslLib(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let e of t)h[e]?(0,i._)(this,v).add(e):console.warn("GpuCompute: unknown glsl lib: ".concat(e));return this}shaders(e){return this.state.initialMaterial=new f((0,i._)(this,v),e.initial),this.state.updateMaterial=new f((0,i._)(this,v),e.update),this}initialize(e){let{orthoCamera:t,plane:n}=this.parts,{rtA:i}=this.state;(0,s._)(this,m,{renderer:e});let{initialMaterial:r}=this.state;return r&&(r.uniforms.uTextureSize.value.copy(this.state.size),r.uniforms.uTexture.value=null,r.uniforms.uTime.value=0,r.uniforms.uDeltaTime.value=0,n.material=r),e.setRenderTarget(i),e.render(n,t),e.setRenderTarget(null),this.state.frame=0,this}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!(0,i._)(this,m))throw Error("GpuCompute: not initialized");let{renderer:t}=(0,i._)(this,m),{orthoCamera:n,plane:r}=this.parts,{rtA:s,rtB:o,time:a,frame:l,updateMaterial:c}=this.state;return this.state.time+=e,c&&(c.uniforms.uTextureSize.value.copy(this.state.size),c.uniforms.uTexture.value=l%2==0?s.texture:o.texture,c.uniforms.uTime.value=a,c.uniforms.uDeltaTime.value=e,c.needsUpdate=!0,r.material=c),t.setRenderTarget(l%2==0?o:s),t.render(r,n),t.setRenderTarget(null),this.state.frame+=1,this}currentTexture(){return this.state.frame%2==0?this.state.rtA.texture:this.state.rtB.texture}previousTexture(){return this.state.frame%2==0?this.state.rtB.texture:this.state.rtA.texture}constructor(e){(0,r._)(this,m,{writable:!0,value:void 0}),(0,r._)(this,v,{writable:!0,value:void 0}),this.parts={orthoCamera:new o.qUd(-1,1,1,-1,0,1),plane:new o.eaF(new o.bdM(2,2),void 0)},(0,s._)(this,v,new Set);let t={...this.constructor.defaultParams,...e};this.params=t;let{type:n,generateMipmaps:i,filter:l,wrap:c,wrapS:d=c,wrapT:u=c}=t,h="nearest"===l?o.hxR:i?o.NZq:o.k6q,p="nearest"===l?o.hxR:o.k6q,f=(0,a.wX)(t.size),x=new o.nWS(f.width,f.height,{minFilter:h,magFilter:p,generateMipmaps:i,format:o.GWd,wrapS:d,wrapT:u,type:n}),g=new o.nWS(f.width,f.height,{minFilter:h,magFilter:p,generateMipmaps:i,format:o.GWd,wrapS:d,wrapT:u,type:n});x.texture.name="GpuCompute.rtA",g.texture.name="GpuCompute.rtB",this.state={size:f,rtA:x,rtB:g,time:0,frame:0}}}g.defaultParams=x},13982:(e,t,n)=>{"use strict";n.d(t,{Client:()=>S});var i=n(70691),r=n(84303),s=n(25432),o=n(63106),a=n(31763),l=n(88575),c=n(79911),d=n(36508),u=n(33855),h=n(28737),p=n(49797),f=n(68955),x=n(15931),m=n(48181),v=n(16465),g=n(21277),w=n(72612),y=n(17099);function b(e,t,n,i,r){let s=i-e,o=r-t,a=Math.sqrt(s*s+o*o);return[e+s/a*n,t+o/a*n]}class j extends p.YJl{constructor(...e){super(...e),this.parts=(()=>{(0,c.mj)(new p.eaF(new p.UPV(10,.4,512,64),new v.Y),this),(0,c.mj)(new x.P,{parent:this,rotationX:"90deg"});let e=(0,c.mj)(new g.N,this),t=new p.Pq0,n=new p.Pq0;{let e=new f.AA(16);for(let{x:i,y:r,z:s}of(0,w.loop3)(16,16,16)){t.set(i,r,s);let[o,a]=b(8,8,16/3,i,s);n.set(o,16/6,a);let l=t.distanceTo(n)<16/6;e.getVoxelState(i,r,s).setUint8(0,+!!l)}(0,c.mj)(new p.eaF((0,f.Cx)(e.voxelFaces()),new v.Y({color:"#ffdd55"})),{parent:this,x:-16,z:-16})}{let e=new f.AA(16);for(let{x:i,y:r,z:s}of(0,w.loop3)(16,16,16)){t.set(i,r,s);let[o,a]=b(8,8,8,i,s);n.set(o,4,a);let l=4>t.distanceTo(n);e.getVoxelState(i,r,s).setUint8(0,+!!l)}(0,c.mj)(new p.eaF((0,f.Cx)(e.voxelFaces()),new v.Y({color:"#ff5566"})),{parent:this,x:0,z:-16})}{let e=new f.AA(16);for(let{x:n,y:i,z:r}of(0,w.loop3)(16,16,16)){let s=15>t.set(n,i,r).length();e.getVoxelState(n,i,r).setUint8(0,+!!s)}(0,c.mj)(new p.eaF((0,f.Cx)(e.voxelFaces()),new v.Y({color:"#55ff96"})),{parent:this,x:-32})}{let e=new f.AA(new p.Pq0(12,24,4),1);for(let{x:t,y:n,z:i}of(0,w.loop3)(e.size)){let r=.5>Math.random();e.getVoxelState(t,n,i).setUint8(0,+!!r)}(0,c.mj)(new p.eaF((0,f.Cx)(e.voxelFaces()),new v.Y({color:"#cfedff"})),{parent:this,position:[16,0,-12]})}{let e=new f.AA(16);for(let{x:t,y:n,z:i}of(0,w.loop3)(16,16,16)){let r=(0===t||0===n||0===i||15===t||15===n||15===i)&&y.c.chance(.66);e.getVoxelState(t,n,i).setUint8(0,+!!r)}console.log(e.computeBounds()),(0,c.mj)(new p.eaF((0,f.Cx)(e.voxelFaces()),new v.Y({color:"#9900ff"})),{parent:this,x:-16,z:-32})}{let e=new f.AA(16),t=new p.Pq0;for(let{x:n,y:i,z:r}of(0,w.loop3)(16,16,16)){t.set(n-8,i-8,r-8);let s=t.lengthSq()-16;y.c.chance(1-.05*s)&&e.getVoxelState(n,i,r).setUint8(0,1)}let n=(0,c.mj)(new p.eaF((0,f.Cx)(e.voxelFaces()),new v.Y({color:"#00ddff"})),{parent:this,x:-16,z:0});(0,c.mj)(new m.R,{parent:n}).box({box3:e.computeBounds(),asIntBox3:!0}).draw()}return{sky:e}})()}}var P=n(42824),z=n.n(P);function C(){return(0,u.yk)(function*(e){(0,h.O)({three:e});let t=new a.n({size:60,perspective:1,focus:[0,5,0],rotation:["-20deg","30deg",0]});yield t.start(e.renderer.domElement),d.Rv.get("three").set({minActiveDuration:60}),yield(0,d.xy)("three",n=>{let{aspect:i,camera:r}=e;t.update(r,i,n.deltaTime)}),yield(0,o.a)([[{code:"Space",modifiers:"shift"},()=>{document.body.requestFullscreen()}]]);let n=new s.F(e.scene,e.camera);n.updatePdMaterial({lumaPhi:10,depthPhi:2,normalPhi:3,radius:100,radiusExponent:2,rings:2,samples:16}),e.pipeline.addPass(n,{type:l.O0.PostProcessing})},[]),null}function T(){return(0,u.dB)("main",function*(e){(0,c.mj)(new j,e)},[]),null}function S(){return(0,i.jsx)("div",{children:(0,i.jsxs)(u.uB,{children:[(0,i.jsx)(C,{}),(0,i.jsx)(T,{}),(0,i.jsx)("div",{className:"layer thru flex flex-col p-4 gap-2",children:(0,i.jsx)(r.oz,{className:z().Markdown,children:"# Chunk demo\n\nPure chunk demo (no world).\n\n- Chunks are sized, when trying to access a voxel out of the chunk's bounds, an\n  error is thrown.\n- Chunk are not necessarily cubes, they can have different sizes in each dimension.\n"})})]})})}},14005:(e,t,n)=>{"use strict";n.d(t,{Client:()=>M});var i=n(70691),r=n(1253),s=n(67203),o=n(49797),a=n(30158),l=n(55551),c=n(24223),d=n(99332),u=n(21667),h=n(18479),p=n(81835),f=n(31763),x=n(28062),m=n(16465),v=n(79911),g=n(29717),w=n(17099),y=n(80425),b=n(36508),j=n(15931),P=n(21277),z=n(16008);class C extends o.YJl{onTick(e){this.parts.rings.rotation.y+=.123*e.deltaTime,this.parts.rings.rotation.x+=.435*e.deltaTime}constructor(...e){super(...e),this.internal={ringGeometry:new o.O3Y(3,.01,16,128)},this.parts=(()=>{let e=(0,v.mj)(new o.YJl,{parent:this}),t=(0,v.mj)(new o.eaF(this.internal.ringGeometry,new m.Y({color:"#eb1640",luminosity:.8})),{parent:e,name:"ring-x",rotationY:"90deg"}),n=(0,v.mj)(new o.eaF(this.internal.ringGeometry,new m.Y({color:"#00ff9d",luminosity:.8})),{parent:e,name:"ring-y",rotationX:"90deg"}),i=(0,v.mj)(new o.eaF(this.internal.ringGeometry,new m.Y({color:"#3b80e7",luminosity:.8})),{parent:e,name:"ring-z"});return{rings:e,ringX:t,ringY:n,ringZ:i,torusKnot:(0,v.mj)(new o.eaF(new o.UPV(3,.1,512,64),new m.Y({luminosity:.8})),{parent:this,name:"torus-knot"})}})()}}class T extends o.Z58{constructor(...e){super(...e),this.parts={sky:(0,v.mj)(new P.N({color:"#027bff"}),{parent:this}),thing:(0,v.mj)(new C,{parent:this}),gridZ:(0,v.mj)(new j.P({step:.5}),{parent:this}),widget:(0,v.mj)(new z.XI,{parent:this})}}}class S extends o.BKk{constructor(){super({uniforms:{uResolution:{value:new o.IUQ},uRect:{value:new o.IUQ},map:{value:null}},vertexShader:"\n        uniform vec4 uResolution;\n        uniform vec4 uRect;\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position.xy = ((position.xy * 2.0 + 1.0) * uRect.zw + uRect.xy * 2.0) / uResolution.xy - 1.0; \n          gl_Position.z = 0.0;\n          gl_Position.w = 1.0;\n          // gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:"\n        uniform sampler2D map;\n        varying vec2 vUv;\n        void main() {\n          gl_FragColor = texture2D(map, vUv);\n        }\n      ",transparent:!0,depthWrite:!1,depthTest:!1})}}class F extends o.eaF{*initialize(e,t){let{rt:n,scene:i,camera:r,vertigo:s,widget:a}=this.internal,l=this.material.uniforms.uResolution.value,c=this.material.uniforms.uRect.value,u=new o.I9Y,h=new o.I9Y(-1,-1),p=!1;yield(0,d.s)(e.domElement,{onDown:()=>{p=!0},onUp:()=>{p=!1},onChange:e=>{h.x=(e.localPosition.x-c.x)/c.z*2-1,h.y=-(e.localPosition.y/c.w*2-1)},onTap:()=>{switch(a.getPressed()){case z.KJ.BOX:t.actions.togglePerspective();break;case z.KJ.POSITIVE_X:t.actions.positiveXAlign();break;case z.KJ.NEGATIVE_X:t.actions.negativeXAlign();break;case z.KJ.POSITIVE_Y:t.actions.positiveYAlign();break;case z.KJ.NEGATIVE_Y:t.actions.negativeYAlign();break;case z.KJ.POSITIVE_Z:t.actions.positiveZAlign();break;case z.KJ.NEGATIVE_Z:t.actions.negativeZAlign()}}}),yield(0,b.xy)("three",{order:1},()=>{e.getSize(u),l.set(u.x,u.y,e.getPixelRatio(),0),c.x=u.x-c.z,c.y=u.y-c.w,s.rotation.copy(t.vertigo.rotation),s.perspective=t.vertigo.perspective,s.apply(r,1),a.widgetUpdate(h,p,r),h.x>=-1&&h.x<=1&&h.y>=-1&&h.y<=1&&(null!==a.getHovered()?document.body.style.cursor="pointer":document.body.style.removeProperty("cursor")),e.setRenderTarget(n),e.setClearColor("white",0),e.render(i,r),e.setRenderTarget(null)})}constructor({planeSize:e=120}={}){let t=new S;super(new o.bdM(1,1),t),this.vertigoControls=null;let n=2*e,i=new o.nWS(n,n,{format:o.GWd,colorSpace:"srgb"}),r=new o.Z58,s=new o.ubm,a=new p.B({perspective:1,size:[2.8,2.8]}),l=new z.XI;r.add(l),this.internal={rt:i,scene:r,camera:s,vertigo:a,widget:l},this.renderOrder=1,this.frustumCulled=!1,t.uniforms.map.value=this.internal.rt.texture,t.uniforms.uRect.value.set(10,10,e,e),this.position.x=2}}var A=n(56652),D=n.n(A);function k(e){let{vertigo:t}=e,{ref:n}=(0,h.useEffects)(function*(e){yield(0,b.xy)("three",{timeInterval:1/6},()=>{e.querySelector("pre").textContent=r.Ay.dump(t.toDeclaration(),{flowLevel:1}).replace(/-?\d+\.\d+/g,e=>(0,y.ZV)(Number.parseFloat(e),{maxDigits:6}))})},[]);return(0,i.jsx)("div",{ref:n,className:"self-start p-4 border border-white rounded text-xs ".concat(D().BgBlur),style:{minWidth:"24rem"},children:(0,i.jsx)("pre",{})})}class E extends o.YJl{onTick(e){for(let t of this.parts.cubes){let{angularVelocity:n}=t.userData;t.rotation.x+=n.x*e.deltaTime,t.rotation.y+=n.y*e.deltaTime,t.rotation.z+=n.z*e.deltaTime}}constructor(...e){super(...e),this.parts={knot:(0,v.mj)(new o.eaF(new o.UPV(1,.5,256,32),new m.Y),{parent:this}),knot2:(0,v.mj)(new o.eaF(new o.UPV(1.37,.05,256,32),new m.Y({color:z.Bn.xColor})),{parent:this}),cubes:Array.from({length:20},(e,t)=>{let n=w.c.between(-3,3),i=w.c.between(-1.5,1.5),r=w.c.between(-3,3),s=["".concat(w.c.between(0,360),"deg"),"".concat(w.c.between(0,360),"deg"),"".concat(w.c.between(0,360),"deg")],a=w.c.between(.5,1),c=(0,v.mj)(new o.eaF(new l.j(1),new m.Y({color:w.c.pick(Object.values(z.Bn))})),{parent:this,x:n,y:i,z:r,rotation:s,scaleScalar:a});return c.userData={angularVelocity:new o.O9p(w.c.between(-1,1),w.c.between(-1,1),w.c.between(-1,1))},c})}}}function M(){let e=(0,s.useMemo)(()=>{let e=new p.B({size:[4.2,4.2]}),t=new p.B({perspective:0,focus:[-10,3,0],size:[8,4],rotation:[0,"45deg",0]}),n=t.clone().set({perspective:1,size:t.size.clone().multiplyScalar(1.2)}),i=t.clone().set({perspective:1,size:t.size.clone().multiplyScalar(1.5),rotation:[0,"-15deg","-25deg"]}),r=new p.B({perspective:1,focus:[-4.5,1.8,10],size:[12,9],rotation:["-3deg","1deg","12deg"]}),s=new p.B({perspective:1,focus:[-4.5,1.8,14],size:r.size.clone().multiplyScalar(1.5),rotation:["-3deg","1deg","0deg"]}),o={main:e,a0:t,a1:n,a2:i,back:r,back2:s,zoom:new p.B({focus:[6,-4,0],size:[4,4],zoom:.25}),revert:new p.B({rotation:["12.6deg","145.3deg","0deg"],focus:[-5,-.5,3.6],size:[12,12],fov:"60deg"})},a=new f.n(o.main);return{vertigos:o,vertigoControls:a}},[]),{ref:t}=(0,h.useEffects)(function*(t){let{vertigoControls:n}=e,i=new a.WebGLRenderer({antialias:!0});i.outputColorSpace="srgb",t.prepend(i.domElement);let r=1;yield(0,u.G)(t,{onSize:()=>{i.setPixelRatio(window.devicePixelRatio),i.setSize(t.clientWidth,t.clientHeight),r=t.clientWidth/t.clientHeight}});let s=new o.ubm(75,1,.1,1e3);s.position.z=5,yield n.start(i.domElement);let l=new T,h=b.Rv.get("three");(0,c.O)(h.requestActivation);let p=new F;l.add(p),yield*p.initialize(i,n);let f=new o.I9Y,m=!1;for(let t of(yield h.onTick(e=>{e.propagate(l),l.parts.widget.widgetUpdate(f,m,s),null!==l.parts.widget.getHovered()?document.body.style.cursor="pointer":document.body.style.removeProperty("cursor"),n.update(s,r),i.render(l,s)}),yield(0,d.s)(i.domElement,{onChange:e=>{let{x:t,y:n}=e.relativeLocalPosition;f.set(2*t-1,-((2*n-1)*1))},onDown:()=>{m=!0},onUp:()=>{m=!1},onTap:()=>{let e=l.parts.widget.getPressed();switch(null!==e&&n.actions.focus([0,0,0]),e){case z.KJ.BOX:n.actions.togglePerspective();break;case z.KJ.POSITIVE_X:n.actions.positiveXAlign();break;case z.KJ.NEGATIVE_X:n.actions.negativeXAlign();break;case z.KJ.POSITIVE_Y:n.actions.positiveYAlign();break;case z.KJ.NEGATIVE_Y:n.actions.negativeYAlign();break;case z.KJ.POSITIVE_Z:n.actions.positiveZAlign();break;case z.KJ.NEGATIVE_Z:n.actions.negativeZAlign()}}}),Object.values(e.vertigos)))(0,v.mj)(new x.T(t),l);let g=new E;l.add(g),g.position.copy(e.vertigos.a0.focus),g.rotation.copy(e.vertigos.a0.rotation),yield()=>{i.dispose(),t.removeChild(i.domElement)}},[]),{vertigoControls:n}=e;return(0,i.jsx)("div",{ref:t,className:"".concat(D().VertigoWidgetClient," layer thru"),children:(0,i.jsxs)("div",{className:"layer thru p-4 flex flex-col gap-4 items-start",children:[(0,i.jsx)("h1",{className:"text-2xl self-start",children:"Vertigo-widget"}),(0,i.jsxs)("div",{className:"".concat(D().BgBlur," thru flex flex-col gap-1 items-start p-1 border border-white rounded"),style:{width:"min(200px, 30%)"},children:[(0,i.jsx)("h2",{children:"Actions:"}),(0,i.jsxs)("div",{className:"thru flex flex-row flex-wrap items-start gap-1",children:[(0,i.jsx)("button",{className:"".concat(D().BgBlur," px-2 py-1 border border-white rounded hover:bg-[#fff2]"),onClick:()=>{g.X5.tween({target:n.vertigo,duration:1,ease:"inOut2",to:{perspective:0}})},children:"ortho"}),(0,i.jsx)("button",{className:"".concat(D().BgBlur," px-2 py-1 border border-white rounded hover:bg-[#fff2]"),onClick:()=>{g.X5.tween({target:n.vertigo,duration:1,ease:"inOut2",to:{perspective:1}})},children:"pers:1"}),(0,i.jsx)("button",{className:"".concat(D().BgBlur," px-2 py-1 border border-white rounded hover:bg-[#fff2]"),onClick:()=>{g.X5.tween({target:n.vertigo,duration:1,ease:"inOut2",to:{perspective:1.5}})},children:"pers:1.5"}),(0,i.jsx)("button",{className:"".concat(D().BgBlur," px-2 py-1 border border-white rounded hover:bg-[#fff2]"),onClick:()=>{g.X5.tween({target:n.vertigo,duration:1,ease:"inOut2",to:{zoom:1}})},children:"zoom:1"}),(0,i.jsx)("button",{className:"".concat(D().BgBlur," px-2 py-1 border border-white rounded hover:bg-[#fff2]"),onClick:()=>{g.X5.tween({target:n.vertigo,duration:.75,ease:"inOut2",to:{focus:new o.Pq0}})},children:"focus:(0,0,0)"})]})]}),(0,i.jsxs)("div",{className:"".concat(D().BgBlur," thru flex flex-col gap-1 items-start p-1 border border-white rounded"),style:{width:"min(200px, 30%)"},children:[(0,i.jsx)("h2",{children:"Presets:"}),(0,i.jsx)("div",{className:"flex flex-row gap-1 flex-wrap",children:Object.entries(e.vertigos).map(t=>{let[n,r]=t;return(0,i.jsx)("button",{className:"".concat(D().BgBlur," px-2 py-1 border border-white rounded hover:bg-[#fff2]"),onClick:()=>{let t=e.vertigoControls.vertigo.clone();g.X5.during(1).onUpdate(n=>{let{progress:i}=n,s=g.X5.ease("inOut3")(i);e.vertigoControls.vertigo.lerpVertigos(t,r,s)})},children:n},n)})})]}),(0,i.jsx)("div",{className:"Space flex-1 pointer-events-none"}),(0,i.jsx)(k,{vertigo:n.vertigo})]})})}},14043:()=>{},14137:(e,t,n)=>{"use strict";n.d(t,{Client:()=>v});var i=n(70691),r=n(67203),s=n(49797),o=n(31763),a=n(40742),l=n(16465),c=n(79911),d=n(72612),u=n(36508),h=n(33855),p=n(28737),f=n(11281),x=n.n(f);function m(){let e=(0,r.useRef)(null);return(0,h.dB)("setup",function*(t,n){(0,c.mj)(new s.eaF(new s.WBB(20,10),new l.Y({wireframe:!0})),t);let i=(0,c.mj)(new s.eaF(new s.bdM,new l.Y({side:s.$EB})),t),r=(0,c.mj)(new s.YJl,{parent:t,rotation:["-70deg",0,0]}),h=Array.from({length:16},()=>(0,c.mj)(new s.eaF(new s.bdM(.5,.5),new l.Y({side:s.$EB})),{parent:r})),f=new o.n().initialize(n.renderer.domElement).start();Object.assign(window,{controls:f});let{camera:x}=n,m=u.Rv.get("three");if((0,p.O)({camera:x,controls:f,ticker:m}),e.current){let t=e.current,r=e.current.firstElementChild,s=[...e.current.querySelectorAll(".SmallPlane ")];i.updateWorldMatrix(!0,!1),x.updateMatrixWorld(!0),r.style.position="absolute",r.style.left="50%",r.style.top="50%",yield(0,u.xy)("three",e=>{f.update(n.camera,n.aspect,e.deltaTime),i.updateWorldMatrix(!0,!1),x.updateMatrixWorld(!0),t.style.perspective=(0,a.s5)(x,n.renderer.domElement),r.style.transform=(0,a.wZ)(x,i,n.renderer.domElement,100,0,0,!1),r.style.zIndex=(0,a.AF)(x,i);let o=(0,a.hD)(x,i);for(let t of(r.querySelector("span + span").textContent="(".concat(o?"front":"back",")"),r.style.color=o?"black":"#00f",(0,d.loop)(16))){let i=s[t.i],r=h[t.i];r.updateWorldMatrix(!0,!1),i.style.position="absolute",i.style.left="50%",i.style.top="50%",i.style.transform=(0,a.wZ)(x,r,n.renderer.domElement,100,0,0,!1),i.style.zIndex=(0,a.AF)(x,r);let o=2*Math.PI*t.t,l=2*Math.cos(o),c=2*Math.sin(o);r.position.set(l,c,0);let d=e.time+t.t*Math.PI;r.rotation.set(2*d,d,0)}i.rotation.y+=.5*e.deltaTime,i.rotation.x+=.1*e.deltaTime})}},[]),(0,i.jsxs)("div",{ref:e,className:"layer thru",children:[(0,i.jsxs)("div",{className:"w-[100px] h-[100px] border-solid border-[8px] bg-white border-[#fc3] text-black font-black flex flex-col justify-center items-center hover:border-[#00f]",style:{lineHeight:".5em"},children:[(0,i.jsx)("span",{className:"text-3xl",children:"CSS!"}),(0,i.jsx)("span",{children:"(front)"})]}),Array.from({length:16},(e,t)=>(0,i.jsx)("div",{className:"SmallPlane w-[50px] h-[50px] border-solid border-[2px] bg-white border-[#fc3] text-black font-black flex flex-col justify-center items-center hover:border-[#00f]",style:{lineHeight:".5em"},children:t},t))]})}function v(){return(0,i.jsx)("div",{className:"layer thru ".concat(x().Client),children:(0,i.jsx)(h.uB,{children:(0,i.jsx)(m,{})})})}},14203:(e,t,n)=>{"use strict";n.d(t,{O:()=>r});var i=n(1029);let r="\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex \n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : stegu\n//     Lastmod : 20201014 (stegu)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//               https://github.com/stegu/webgl-noise\n// \n\nfloat mod289(float x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0; \n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nfloat permute(float x) {\n  return mod289(((x*34.0)+10.0)*x);\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+10.0)*x);\n}\n\nvec4 permute(vec4 x) {\n  return mod289(((x*34.0)+10.0)*x);\n}\n\nfloat taylorInvSqrt(float r) {\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec4 taylorInvSqrt(vec4 r) {\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\n\n\n\n\n// 2D:\n\nfloat snoise(vec2 v) {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n		+ i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n\n// 3D: \n\nfloat snoise(vec3 v)\n{ \n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n  // First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n  // Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n  // Permutations\n  i = mod289(i); \n  vec4 p = permute( permute( permute( \n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) \n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n  // Gradients: 7x7 points over a square, mapped onto an octahedron.\n  // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n  //Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n  // Mix final noise value\n  vec4 m = max(0.5 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 105.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), \n                                dot(p2,x2), dot(p3,x3) ) );\n}\n\n\n\n// 4D:\n\nvec4 grad4(float j, vec4 ip)\n  {\n  const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\n  vec4 p,s;\n\n  p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\n  p.w = 1.5 - dot(abs(p.xyz), ones.xyz);\n  s = vec4(lessThan(p, vec4(0.0)));\n  p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www; \n\n  return p;\n}\n						\n// (sqrt(5) - 1)/4 = F4, used once below\n#define F4 0.309016994374947451\n\nfloat snoise(vec4 v) {\n  const vec4  C = vec4( 0.138196601125011,  // (5 - sqrt(5))/20  G4\n                        0.276393202250021,  // 2 * G4\n                        0.414589803375032,  // 3 * G4\n                       -0.447213595499958); // -1 + 4 * G4\n\n  // First corner\n  vec4 i  = floor(v + dot(v, vec4(F4)) );\n  vec4 x0 = v -   i + dot(i, C.xxxx);\n\n  // Other corners\n\n  // Rank sorting originally contributed by Bill Licea-Kane, AMD (formerly ATI)\n  vec4 i0;\n  vec3 isX = step( x0.yzw, x0.xxx );\n  vec3 isYZ = step( x0.zww, x0.yyz );\n  //  i0.x = dot( isX, vec3( 1.0 ) );\n  i0.x = isX.x + isX.y + isX.z;\n  i0.yzw = 1.0 - isX;\n  //  i0.y += dot( isYZ.xy, vec2( 1.0 ) );\n  i0.y += isYZ.x + isYZ.y;\n  i0.zw += 1.0 - isYZ.xy;\n  i0.z += isYZ.z;\n  i0.w += 1.0 - isYZ.z;\n\n  // i0 now contains the unique values 0,1,2,3 in each channel\n  vec4 i3 = clamp( i0, 0.0, 1.0 );\n  vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );\n  vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );\n\n  //  x0 = x0 - 0.0 + 0.0 * C.xxxx\n  //  x1 = x0 - i1  + 1.0 * C.xxxx\n  //  x2 = x0 - i2  + 2.0 * C.xxxx\n  //  x3 = x0 - i3  + 3.0 * C.xxxx\n  //  x4 = x0 - 1.0 + 4.0 * C.xxxx\n  vec4 x1 = x0 - i1 + C.xxxx;\n  vec4 x2 = x0 - i2 + C.yyyy;\n  vec4 x3 = x0 - i3 + C.zzzz;\n  vec4 x4 = x0 + C.wwww;\n\n  // Permutations\n  i = mod289(i); \n  float j0 = permute( permute( permute( permute(i.w) + i.z) + i.y) + i.x);\n  vec4 j1 = permute( permute( permute( permute (\n             i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))\n           + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))\n           + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))\n           + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));\n\n  // Gradients: 7x7x6 points over a cube, mapped onto a 4-cross polytope\n  // 7*7*6 = 294, which is close to the ring size 17*17 = 289.\n  vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\n\n  vec4 p0 = grad4(j0,   ip);\n  vec4 p1 = grad4(j1.x, ip);\n  vec4 p2 = grad4(j1.y, ip);\n  vec4 p3 = grad4(j1.z, ip);\n  vec4 p4 = grad4(j1.w, ip);\n\n  // Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n  p4 *= taylorInvSqrt(dot(p4,p4));\n\n  // Mix contributions from the five corners\n  vec3 m0 = max(0.57 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0);\n  vec2 m1 = max(0.57 - vec2(dot(x3,x3), dot(x4,x4)            ), 0.0);\n  m0 = m0 * m0;\n  m1 = m1 * m1;\n  return 60.1 * ( dot(m0*m0, vec3( dot( p0, x0 ), dot( p1, x1 ), dot( p2, x2 )))\n               + dot(m1*m1, vec2( dot( p3, x3 ), dot( p4, x4 ) ) ) ) ;\n\n}\n\n\n\n\n// addons:\n// Fractal noise, based on Stefan Gustavson's Simplex noise\n".concat((0,i.N)(["vec2","vec3","vec4"],"\n  float fnoise(T p, int octaves, float persistence) {\n    float total = 0.0;           // Final noise value\n    float amplitude = 1.0;       // Initial amplitude\n    float frequency = 1.0;       // Initial frequency\n    float maxValue = 0.0;        // Used for normalization\n\n    for (int i = 0; i < octaves; i++) {\n      total += snoise(p * frequency) * amplitude;\n\n      maxValue += amplitude;   // Keep track of max amplitude\n      amplitude *= persistence; // Reduce amplitude for next octave\n      frequency *= 2.0;        // Increase frequency for next octave\n    }\n\n    // Normalize the result to stay within the range [0, 1]\n    return total / maxValue;\n  }\n\n  float fnoise(T p, int octaves) {\n    return fnoise(p, octaves, 0.5);\n  }\n\n  float fnoise(T p) {\n    return fnoise(p, 4, 0.5);\n  }\n"),"\n\nfloat snoiseFast4D(vec4 p) {\n  const float SCALAR = 0.01;\n  float a = SCALAR * dot(p.xy * 0.3, vec2(-127.1, 311.7));\n  float b = SCALAR * dot(p.zw * 0.8, vec2(269.5, -183.3));\n  float c = SCALAR * dot(p.wx * 6.0, vec2(23.14069, 2.665157));\n  float d = SCALAR * dot(p.zy * 1.3, vec2(-12.9898, 78.233));\n  return (snoise(vec2(a, b)) + snoise(vec2(d, c))) * 0.5;\n}\n\nfloat fnoiseFast4D(vec4 p, int octaves, float persistence) {\n  float total = 0.0;           // Final noise value\n  float amplitude = 1.0;       // Initial amplitude\n  float frequency = 1.0;       // Initial frequency\n  float maxValue = 0.0;        // Used for normalization\n\n  for (int i = 0; i < octaves; i++) {\n    total += snoiseFast4D(p * frequency) * amplitude;\n\n    maxValue += amplitude;   // Keep track of max amplitude\n    amplitude *= persistence; // Reduce amplitude for next octave\n    frequency *= 2.0;        // Increase frequency for next octave\n  }\n\n  // Normalize the result to stay within the range [0, 1]\n  return total / maxValue;\n}\n")},15774:(e,t,n)=>{"use strict";n.d(t,{Client:()=>C});var i=n(70691),r=n(67203),s=n(49797),o=n(99332),a=n(21667),l=n(33540),c=n(18479),d=n(77794),u=n(16465),h=n(79911),p=n(67235),f=n(7147),x=n(14203),m=n(36508),v=n(16008);class g extends u.Y{constructor(e){super(e),this.onBeforeCompile=e=>f.bI.with(e).uniforms({uTime:m.Rv.get("three").uTime,uColor2:{value:new s.Q1f("#ff9ba5")}}).varying({vWorldPosition2:"vec3"}).vertex.mainAfterAll("\n        vWorldPosition2 = (modelMatrix * vec4(transformed, 1.0)).xyz;\n      ").fragment.top(x.O).fragment.after("map_fragment","\n        float noise = fnoise(vWorldPosition2 * vec3(1.0, 1.0, 10.0) * 0.1, 2);\n        noise = fract(noise * 5.0);\n        diffuseColor.rgb = mix(diffuseColor.rgb, uColor2, noise);\n      ")}}function w(){return(0,l.yk)(function*(e){e.scene.background=new s.Q1f("#68a5d4")},[]),null}function y(){return(0,l.dB)("pointer-handler",function*(e,t){let n=p.Q.send("VERTIGO_CONTROLS").assertPayload();n.inputConfig,Object.assign(window,{controls:n});let i=(0,h.mj)(new s.eaF(new s.O3Y(.06,.01,32,96),new u.Y({color:"#f03"})),e),r=(0,h.mj)(new s.eaF(new s.WBB(.02,4),new u.Y({color:"#f03"})),e),a=new s.Pq0,l=n.dampedVertigo;yield(0,o.s)(t.domContainer,{onTap:()=>{let[e]=t.pointer.raycast(t.scene);e&&(l.ndcToScreen(t.pointer.screenPosition,a),i.position.copy(e.point),n.vertigo.focus.copy(e.point))},onChange:e=>{let{x:n,y:i}=e.position,r=new s.I9Y(n/t.domContainer.clientWidth*2-1,-(2*(i/t.domContainer.clientHeight))+1);console.log(...l.ndcToScreen(r,new s.I9Y))}}),yield t.ticker.onTick(()=>{r.position.copy(n.dampedVertigo.focus),i.rotation.copy(n.dampedVertigo.rotation)})},[]),null}function b(){return(0,l.dB)("my-scene",function*(e){(0,h.mj)(new d.u,e).regularGrid({size:100,subdivisions:[10,10,4],color:"#ffffff",opacity:[1,.3,.1]}).circle({radius:5,quality:"ultra"},{color:"#ffffff"}),(0,h.mj)(new v.XI,e),(0,h.mj)(new s.eaF(new s.O3Y(3,.5,128,512),new g),e),(0,h.mj)(new s.eaF(new s.O3Y(10,.5,128,512),new g),e),(0,h.mj)(new s.eaF(new s.rKP(1,2,128),new g),e),(0,h.mj)(new s.eaF(new s.bdM(10,10),new g),e)},[]),null}function j(e){let{size:t=100,subdivisions:n=10,...r}=e,{ref:s}=(0,c.useEffects)(function*(e){let i=[...e.querySelectorAll("line")],r=t/n;for(let e=0;e<=n;e++){let s=e+n+1,o=e*r-t/2;i[e].setAttribute("x1","".concat(o)),i[e].setAttribute("x2","".concat(o)),i[e].setAttribute("y1","".concat(-t/2)),i[e].setAttribute("y2","".concat(t/2)),i[s].setAttribute("x1","".concat(-t/2)),i[s].setAttribute("x2","".concat(t/2)),i[s].setAttribute("y1","".concat(o)),i[s].setAttribute("y2","".concat(o))}},"always");return(0,i.jsx)("g",{ref:s,...r,children:Array.from({length:(n+1)*2},(e,t)=>(0,i.jsx)("line",{},t))})}function P(){let[e,t]=(0,r.useState)(100),{ref:n}=(0,c.useEffects)(function*(e){let n=(n,i)=>{e.setAttribute("width","".concat(n)),e.setAttribute("height","".concat(i));let r=n/2,s=i/2;e.setAttribute("viewBox","-".concat(r," -").concat(s," ").concat(n," ").concat(i));let o=Math.min(n,i),[,a,l]=e.querySelectorAll("circle");a.setAttribute("cx","".concat(3*o/10)),a.setAttribute("cy","".concat(-2*o/10)),l.setAttribute("cx","".concat(-3*o/10)),l.setAttribute("cy","".concat(o/10)),t(o)};yield(0,a.G)(window,{onSize:e=>{let{size:t}=e;n(t.x,t.y)}})},[]);return(0,i.jsx)("svg",{ref:n,xmlns:"http://www.w3.org/2000/svg",style:{pointerEvents:"none"},children:(0,i.jsxs)("g",{fill:"none",stroke:"#ffff00",strokeWidth:.75,children:[(0,i.jsx)("circle",{r:10}),(0,i.jsx)("circle",{r:10}),(0,i.jsx)("circle",{r:10}),(0,i.jsx)(j,{size:e})]})})}function z(){let{ref:e}=(0,c.useEffects)(function*(e){let t=e.querySelector("#screenOffset"),n=p.Q.send("VERTIGO_CONTROLS").assertPayload();yield m.Rv.get("three").onTick(()=>{t.textContent=n.vertigo.screenOffset.toArray().slice(0,2).join(", ")})},"always");return(0,i.jsxs)("div",{ref:e,className:"p-4 text-[#ff0] flex flex-col items-start gap-1",children:[(0,i.jsxs)("h1",{className:"text-3xl font-bold",children:["Vertigo Offset",(0,i.jsx)("br",{}),"Size: 10",(0,i.jsx)("br",{}),"Screen Offset: [",(0,i.jsx)("span",{id:"screenOffset",children:"3, 2"}),"]"]}),(0,i.jsx)("p",{children:"When the subject is not at the center..."}),(0,i.jsx)("button",{className:"border border-[#ff0] rounded px-2 py-1 mt-2 text-[#ff0]",onClick:()=>{let e=p.Q.send("VERTIGO_CONTROLS").assertPayload();e.vertigo.perspective=+(1!==e.vertigo.perspective)},children:"Toggle perspective"}),(0,i.jsx)("button",{className:"border border-[#ff0] rounded px-2 py-1 mt-2 text-[#ff0]",onClick:()=>{p.Q.send("VERTIGO_CONTROLS").assertPayload().vertigo.screenOffset.set(3,2,0)},children:"[3, 2]"}),(0,i.jsx)("button",{className:"border border-[#ff0] rounded px-2 py-1 mt-2 text-[#ff0]",onClick:()=>{p.Q.send("VERTIGO_CONTROLS").assertPayload().vertigo.screenOffset.set(0,0,0)},children:"[0, 0]"}),(0,i.jsx)("button",{className:"border border-[#ff0] rounded px-2 py-1 mt-2 text-[#ff0]",onClick:()=>{p.Q.send("VERTIGO_CONTROLS").assertPayload().vertigo.screenOffset.set(-3,-1,0)},children:"[-3, -1]"})]})}function C(){return(0,i.jsxs)(l.uB,{vertigoControls:{size:10,inputConfig:{wheel:"zoom"}},children:[(0,i.jsx)("div",{className:"layer thru flex flex-col items-start justify-start",children:(0,i.jsx)(z,{})}),(0,i.jsx)(w,{}),(0,i.jsx)(b,{}),(0,i.jsx)(y,{}),(0,i.jsx)(P,{})]})}},15931:(e,t,n)=>{"use strict";n.d(t,{P:()=>a});var i=n(49797),r=n(94065),s=n(7147);let o={color:"white",opacity:.5,plane:"XY",size:[8,8],step:1,frame:!0,depthOffset:0};class a extends i.DXC{set(e){let{color:t,opacity:n,size:s,step:a,frame:l,plane:c,depthOffset:d}={...o,...e},u=(0,r.wX)(s),h=(0,r.wX)(null!=a?a:u),p=[],f=(e,t)=>p.push(new i.Pq0(e,t,0));l&&(f(-u.x/2,u.y/2),f(u.x/2,u.y/2),f(u.x/2,u.y/2),f(u.x/2,-u.y/2),f(u.x/2,-u.y/2),f(-u.x/2,-u.y/2),f(-u.x/2,-u.y/2),f(-u.x/2,u.y/2));let x=Math.ceil(-u.x/2/h.x)*h.x;x===-u.x/2&&(x+=h.x);do f(x,-u.y/2),f(x,u.y/2),x+=h.x;while(x<u.x/2);let m=Math.ceil(-u.y/2/h.y)*h.y;m===-u.y/2&&(m+=h.y);do f(-u.x/2,m),f(u.x/2,m),m+=h.y;while(m<u.y/2);switch(this.geometry.setFromPoints(p),c){case"XZ":this.geometry.rotateX(Math.PI/2);break;case"YZ":this.geometry.rotateY(Math.PI/2)}return this.uniforms.uDepthOffset.value=d,this.material.color.set(t),this.material.opacity=n,this.material.transparent=n<1,this}constructor(e){let t=new i.mrM,n={uDepthOffset:{value:0}};t.onBeforeCompile=e=>s.bI.with(e).uniforms(n).vertex.mainAfterAll("\n        gl_Position.w += uDepthOffset;\n      "),super(void 0,t),this.uniforms=n,this.set(null!=e?e:o)}}},16008:(e,t,n)=>{"use strict";n.d(t,{Bn:()=>u,KJ:()=>a,XI:()=>f});var i=n(63126),r=n(49797),s=n(55551),o=n(38921),a=function(e){return e[e.BOX=0]="BOX",e[e.POSITIVE_X=1]="POSITIVE_X",e[e.NEGATIVE_X=2]="NEGATIVE_X",e[e.POSITIVE_Y=3]="POSITIVE_Y",e[e.NEGATIVE_Y=4]="NEGATIVE_Y",e[e.POSITIVE_Z=5]="POSITIVE_Z",e[e.NEGATIVE_Z=6]="NEGATIVE_Z",e}(a||{});function l(e,t){let n=new r.THS(new Int8Array(e.attributes.position.count).fill(t),1);e.setAttribute("aPartId",n)}function c(e,t,n){let i=new r.qFE(.2,.6000000000000001,e,n,!0).rotateZ(Math.PI).translate(0,.53,0),s=Array.from({length:t},(e,n)=>{let i=n/(t-1);return new r.I9Y(.2*i,-.05*(1-i**2))}),a=new r.nzx(s,e).rotateZ(Math.PI).translate(0,.2*3/2+.53,0);return(0,o.pP)([i,a],!1)}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"low",t="high"===e?(0,o.ec)(new s.j(.3,.3,.3,4,.05)):new r.iNn(.3,.3,.3);l(t,0);let n="high"===e?c(32,8,5):c(6,2,1);l(n,3);let i=n.clone().rotateX(Math.PI);l(i,4);let a=n.clone().rotateZ(-Math.PI/2);l(a,1);let d=n.clone().rotateZ(Math.PI/2);l(d,2);let u=n.clone().rotateX(Math.PI/2);l(u,5);let h=n.clone().rotateX(-Math.PI/2);return l(h,6),[t,a,d,n,i,u,h]}let u={defaultColor:"white",xColor:"#eb1640",yColor:"#00ffb7",zColor:"#3b80e7",hoverColor:"#fffc47"};function h(e){let{defaultColor:t,xColor:n,yColor:i,zColor:s,hoverColor:o}={...u,...e},a=new r.Q1f(t),l=new r.Q1f(n),c=new r.Q1f(i),d=new r.Q1f(s),h=new r.Q1f(o),p={uSunPosition:{value:new r.Pq0(.5,.7,.3)},uLuminosity:{value:.66},uColors:{value:[a,l,a,c,a,d,a]},uHoverColor:{value:h},uOpacity:{value:[1,1,1,1,1,1,1]},uHoverOpacity:{value:[0,0,0,0,0,0,0]}};return new r.BKk({uniforms:p,vertexShader:"\nuniform vec3 uColors[7];\nuniform float uOpacity[7];\nuniform vec3 uHoverColor;\nuniform float uHoverOpacity[7];\n\nattribute float aPartId;\n\nvarying vec3 vWorldNormal;\nvarying vec3 vPosition;\nvarying vec3 vColor;\nvarying float vOpacity;\nvarying float vHoverOpacity;\n\nvoid main() {\n  vWorldNormal = mat3(modelMatrix) * normal;\n  vPosition = position;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  vColor = uColors[int(aPartId)];\n  vOpacity = uOpacity[int(aPartId)];\n  vHoverOpacity = uHoverOpacity[int(aPartId)];\n}\n",fragmentShader:"\nvarying vec3 vWorldNormal;\nvarying vec3 vPosition;\nvarying vec3 vColor;\nvarying float vOpacity;\nvarying float vHoverOpacity;\n\nuniform vec3 uSunPosition;\nuniform float uLuminosity;\nuniform vec3 uHoverColor;\n\nfloat clamp01(float x) {\n  return x < 0.0 ? 0.0 : x > 1.0 ? 1.0 : x;\n}\n\nfloat inverseLerp(float a, float b, float x) {\n  return clamp01((x - a) / (b - a));\n}\n\nvoid main() {\n  vec3 lightDirection = normalize(uSunPosition);\n  float light = dot(vWorldNormal, lightDirection) * 0.5 + 0.5;\n  light = pow(light, 2.0);\n  \n  float minLuminosity = max(pow(vHoverOpacity, 1.0 / 3.0) * 0.85, uLuminosity);\n  light = mix(minLuminosity, 1.0, light);\n\n  vec3 color = vColor;\n  color = mix(color, uHoverColor, vHoverOpacity);\n  gl_FragColor = vec4(color * light, vOpacity);\n}\n",transparent:!0})}let p=new r.tBo;class f extends r.YJl{getHovered(){return this.internal.hovered}getPressed(){return this.internal.pressed}widgetUpdate(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/60,{lowMesh:o,material:a}=this.parts,l=new r.Pq0;n.getWorldDirection(l);let c=this.matrixWorld.elements,d=new r.Pq0(c[0],c[1],c[2]),u=new r.Pq0(c[4],c[5],c[6]),h=new r.Pq0(c[8],c[9],c[10]);{let e=a.uniforms.uOpacity.value,t=Math.abs(l.dot(d)),n=Math.abs(l.dot(u)),r=Math.abs(l.dot(h));e[1]=e[2]=(0,i.calculateExponentialDecay)(e[1],t<.98?1.05:-.05,1e-4,s),e[3]=e[4]=(0,i.calculateExponentialDecay)(e[3],n<.98?1.05:-.05,1e-4,s),e[5]=e[6]=(0,i.calculateExponentialDecay)(e[5],r<.98?1.05:-.05,1e-4,s)}{let e=a.uniforms.uHoverOpacity.value,t=+(0===this.internal.hovered),n=+(1===this.internal.hovered),r=+(2===this.internal.hovered),o=+(3===this.internal.hovered),l=+(4===this.internal.hovered),c=+(5===this.internal.hovered),d=+(6===this.internal.hovered);e[0]=(0,i.calculateExponentialDecay)(e[0],t,1e-4,s),e[1]=(0,i.calculateExponentialDecay)(e[1],n,1e-4,s),e[2]=(0,i.calculateExponentialDecay)(e[2],r,1e-4,s),e[3]=(0,i.calculateExponentialDecay)(e[3],o,1e-4,s),e[4]=(0,i.calculateExponentialDecay)(e[4],l,1e-4,s),e[5]=(0,i.calculateExponentialDecay)(e[5],c,1e-4,s),e[6]=(0,i.calculateExponentialDecay)(e[6],d,1e-4,s)}p.setFromCamera(e,n);let[f]=p.intersectObject(o,!0).map(e=>{let t=3*e.faceIndex;return o.geometry.groups.findIndex(e=>e.start<=t&&t<e.start+e.count)}).filter(e=>a.uniforms.uOpacity.value[e]>.5);t&&!1===this.internal.pointerDown&&(this.internal.pointerDown=!0,this.internal.pointerDownPosition.copy(e),this.internal.pressed=null!=f?f:null),t&&!1===this.internal.dragging&&this.internal.pointerDownPosition.distanceTo(e)>.01&&(this.internal.dragging=!0),!1===t&&this.internal.pointerDown&&(this.internal.pointerDown=!1,this.internal.dragging=!1,this.internal.pressed=null);let x=this.internal.dragging?null:null!=f?f:null;this.internal.hovered,this.internal.hovered=x}constructor(e){super(),this.internal={pointerPosition:new r.I9Y,pointerDownPosition:new r.I9Y,pointerDown:!1,dragging:!1,hovered:null,pressed:null};let t=h(null==e?void 0:e.material),n=d("high").map((e,n)=>{let i=new r.eaF(e,t);return i.name="vertigo-widget-mesh-".concat(n),this.add(i),i}),i=new r.eaF(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let i=d(...t);return(0,o.pP)(i,!0)}("low"),h(null==e?void 0:e.material));i.material.transparent=!1,i.name="vertigo-widget-low-mesh",i.visible=!1,this.add(i),this.parts={material:t,meshes:n,lowMesh:i}}}},17490:(e,t,n)=>{"use strict";n.d(t,{PageClient:()=>h});var i=n(70691),r=n(72612),s=n(79285),o=n(71936),a=n(80446),l=n(21984);let c=[-50,150],d={width:600,height:400,strokeWidth:2};function u(e){let{variable:t,...n}=e,{width:r,height:o,strokeWidth:a}={...d,...n},l=t.gaussianSmoothSamples(300,{sampleHistoryWidth:.2});return(0,i.jsx)("polyline",{points:l.map((e,t,n)=>{let i=(0,s.remap)(t,0,n.length-1,r,0),a=(0,s.remap)(e,-50,150,o,0);return"".concat(i,",").concat(a)}).join(" "),stroke:"orange",strokeWidth:1,fill:"none"})}function h(){let e=new o.k({name:"var1",historySize:8});return a.n.setRandom("parkmiller",456789),e.createHistory(e=>e<.25?0:100*a.n.random()),(0,i.jsxs)("div",{className:"p-16 flex flex-col gap-8 overflow-y-auto h-screen",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold",children:"Gaussian sample demo"}),(0,i.jsx)("p",{className:"max-w-prose",children:"but it looks weird for larger history width sampling... to be investigated."}),(0,i.jsxs)(l.T,{variable:e,yRange:c,width:600,height:400,curveMode:l.b.GaussianLine,children:[(0,r.loopArray)(8,e=>{let t=(0,s.remap)(e.i,0,7,0,600);return(0,i.jsx)("line",{x1:t,y1:0,x2:t,y2:400,stroke:"gray",strokeWidth:.5,strokeDasharray:"2 2"},e.i)}),(0,i.jsx)("line",{x1:0,y1:200,x2:600,y2:200,stroke:"red",strokeWidth:1,strokeDasharray:"4 4"}),(0,i.jsx)(u,{variable:e})]})]})}},18140:(e,t,n)=>{"use strict";n.d(t,{Client:()=>C});var i=n(70691),r=n(30158),s=n(49797),o=n(31763),a=n(4003),l=n(16465),c=n(79911),d=n(72612),u=n(79285),h=n(4941),p=n(17099),f=n(36508);(0,n(28737).O)({...r,THREE:r,textCloud:m,textRing:v,textGrid:function(e){let t=(0,c.mj)(new a.w({textCount:100,textSize:1,lineLength:12}),e);for(let e of(0,d.loop2)(10,10)){let n="".concat(e.i,"\n(").concat(e.x,", ").concat(e.y,")");t.setTextAt(e.i,n,{x:(e.px-.5)*20,y:(e.py-.5)*20})}return t},TextHelper:a.w});let x=[new s.Q1f("#ff4080"),new s.Q1f("#ffdd66"),new s.Q1f("#99ccff")];function m(e){let t=(0,c.mj)(new a.w({textSize:5,lineLength:50,lineCount:2,textCount:3e5}),e),n=new s.Pq0,i=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ"];for(let e=0;e<3e5;e++){let r=h.cz.transition.inOut(p.c.random(),1/4,.9),s=(0,u.lerp)(70,190,r)+20*p.c.boxMuller()[0],{x:o,y:a,z:l}=p.c.unitVector(n).multiplyScalar(s);t.setTextAt(e,"".concat(p.c.pick(i)).concat(p.c.pick(i)).concat(p.c.pick(i),"\n").concat(e),{x:o,y:a,z:l,color:p.c.pick(x)})}return t}function v(e){let t=(0,c.mj)(new a.w({textCount:3,lineLength:32,lineCount:4}),e);return t.setTextAt(0," Hello \n World \n !!! ",{y:0,size:1.5,textColor:x[0],textOpacity:0,backgroundColor:x[0],backgroundOpacity:1}),t.setTextAt(1,"\xc0 l’\xe2ge m\xfbr,\no\xf9 l’\xe9t\xe9 s’ach\xe8ve,\nil \xe9tait d\xe9j\xe0 pr\xeat.\nNo\xebl, s\xec! Se\xf1or",{y:-1.2,size:.6,textColor:x[1]}),t}async function*g(e){yield()=>e.scene.clear(),p.c.reset();let t=new s.Q1f("#09121b"),n=new s.cRK(t,.05);e.scene.fog=n,e.scene.background=t;let i=new o.n({size:7}).initialize(e.renderer.domElement).start();yield(0,f.xy)("three",t=>{i.update(e.camera,e.aspect,t.deltaTime),n.density=(0,u.remap)(i.vertigo.zoom,1,0,.05,0)});let r=0,d=v(e.scene);r+=d.count,document.body.append(d.atlas.canvas),d.atlas.canvas.style.position="fixed",d.atlas.canvas.style.bottom="10px",d.atlas.canvas.style.right="10px",d.atlas.canvas.style.width="".concat(Math.round(.2*document.body.clientWidth),"px"),d.atlas.canvas.onclick=()=>d.atlas.canvas.remove(),yield()=>d.atlas.canvas.remove(),r+=m(e.scene).count,r+=function(e){let{array:t,count:n}=(0,c.mj)(new s.eaF(new s.WBB(200,8),new s.V9B({wireframe:!0})),e).geometry.attributes.position,i=n/3,r=(0,c.mj)(new a.w({textCount:i,textSize:14}),e),o=new s.Pq0,l=new s.Pq0;for(let e=0;e<i;e++){let{x:n,y:i,z:s}=o.fromArray(t,9*e).add(l.fromArray(t,9*e+3)).add(l.fromArray(t,9*e+6)).divideScalar(3);r.setTextAt(e,"".concat(e),{x:n,y:i,z:s,color:"#fff",backgroundOpacity:1,textOpacity:0})}return r}(e.scene).count,d.setTextAt(2,"text count: ".concat(r),{y:1,size:.6,color:"#4080ff"}),(0,c.mj)(new s.eaF(new s.O3Y(3,.1,12,128),new l.Y({color:x[2]})),e.scene)}var w=n(88493),y=n(89294),b=n.n(y),j=n(90048),P=n.n(j);function z(){return(0,w.yk)(g,[]),null}function C(){return(0,i.jsx)("div",{className:"layer thru ".concat(P().Client),children:(0,i.jsxs)(w.uB,{children:[(0,i.jsx)(z,{}),(0,i.jsxs)("div",{className:"layer thru flex flex-col p-4 gap-4",children:[(0,i.jsx)("h1",{className:"text-2xl",children:"Text Helper"}),(0,i.jsx)("p",{className:"w-[400px]",children:"TextHelper is a utility for rendering text in 3D space. A lot of text, up to millions of characters, can be rendered with a single draw call. It is useful for visualizing large amounts of text data."}),(0,i.jsx)(b(),{href:"text-helper/hunger",children:"\uD83D\uDC49 Knut Hamsun — Hunger — Demo"})]})]})})}},18653:(e,t,n)=>{"use strict";n.d(t,{Client:()=>S});var i=n(70691),r=n(84303),s=n(25432),o=n(63106),a=n(31763),l=n(88575),c=n(79911),d=n(36508),u=n(33855),h=n(28737),p=n(49797),f=n(68955),x=n(15931),m=n(16465),v=n(21277),g=n(72612),w=n(17099),y=n(48181);let b=new p.tBo;class j extends p.YJl{createAllChunkMeshes(e){for(let{superChunkIndex:t,chunkIndex:n,chunk:i}of e.enumerateChunks()){let r=w.c.pick(["#ffdd55","#55ddff","#dd55ff","#55ffdd","#ff55dd","#ddff55","#ff5555"]),s=(0,f.Cx)(i.voxelFaces()),o=new m.Y({color:r}),{x:a,y:l,z:d}=e.metrics.fromIndexes(t,n,0);(0,c.mj)(new p.eaF(s,o),{parent:this,x:a,y:l,z:d})}let t=e.computeVoxelBounds();(0,c.mj)(new y.R,this).box({box3:t,asIntBox3:!0}).box({box3:e.computeChunkBounds(),asIntBox3:!0,color:"#ff0000"}).draw();{let t=e.computeVoxelBounds(),n=(0,f.Cx)(e.chunkVoxelFaces(t)),i=new m.Y({color:"#ffffff"});(0,c.mj)(new p.eaF(n,i),{parent:this,x:0,y:0,z:-32})}}createOneUniqueMesh(e){}constructor(...e){super(...e),this.parts=(()=>{w.c.reset();let e=(0,c.mj)(new p.eaF(new p.UPV(10,3,32,6),new m.Y({wireframe:!0,side:p.$EB})),this);e.visible=!1,(0,c.mj)(new x.P({size:24}),{parent:this,rotationX:"90deg"});let t=(0,c.mj)(new v.N,this),n=new f.HK;(0,h.O)({world:n});let i=new DataView(new ArrayBuffer(n.voxelStateByteSize));i.setUint8(0,1);let r=new p.Pq0;for(let{x:t,y:s,z:o}of(0,g.loop3)(24,24,24))t-=12,s-=12,o-=12,r.set(t+.5,s+.5,o+.5),b.set(r,new p.Pq0(1,0,0)),b.intersectObject(e,!0).length%2==1&&n.setVoxelState(t,s,o,i);return this.createAllChunkMeshes(n),{sky:t}})()}}var P=n(42824),z=n.n(P);function C(){return(0,u.yk)(function*(e){(0,h.O)({three:e});let t=new a.n({size:50,perspective:1,rotation:["-20deg","-45deg",0]});yield t.start(e.renderer.domElement),d.Rv.get("three").set({minActiveDuration:60}),yield(0,d.xy)("three",n=>{let{aspect:i,camera:r}=e;t.update(r,i,n.deltaTime)}),yield(0,o.a)([[{code:"Space",modifiers:"shift"},()=>{document.body.requestFullscreen()}]]);let n=new s.F(e.scene,e.camera);n.updatePdMaterial({lumaPhi:10,depthPhi:2,normalPhi:3,radius:100,radiusExponent:2,rings:2,samples:16}),e.pipeline.addPass(n,{type:l.O0.PostProcessing})},[]),null}function T(){return(0,u.dB)("main",function*(e){(0,c.mj)(new j,e)},[]),null}function S(){return(0,i.jsx)("div",{children:(0,i.jsxs)(u.uB,{children:[(0,i.jsx)(C,{}),(0,i.jsx)(T,{}),(0,i.jsx)("div",{className:"layer thru flex flex-col p-4 gap-2",children:(0,i.jsx)(r.oz,{className:z().Markdown,children:"# World\n\nWorld handles chunks under the hood.\n"})})]})})}},21277:(e,t,n)=>{"use strict";n.d(t,{N:()=>s});var i=n(49797);let r=new i.WBB(1,4);class s extends i.eaF{constructor(e){super(r,new i.V9B({color:"#0c529d",...e,side:i.hsX,depthWrite:!1,depthTest:!1})),this.renderOrder=-1,this.frustumCulled=!1,this.matrixAutoUpdate=!1,this.onBeforeRender=(e,t,n)=>{let i=(n.near+n.far)/2;this.position.copy(n.position),this.scale.setScalar(i),this.updateMatrix(),this.updateMatrixWorld()}}}},21984:(e,t,n)=>{"use strict";n.d(t,{T:()=>d,b:()=>a});var i=n(70691),r=n(67203),s=n(79285),o=n(49797),a=function(e){return e[e.Line=1]="Line",e[e.GaussianLine=2]="GaussianLine",e[e.Fill=4]="Fill",e[e.GaussianFill=8]="GaussianFill",e}({});let l={width:600,height:200,yRange:"auto",strokeWidth:2,curveMode:1,colors:["#56aaff","#ff56b6","#fffc56"]};function c(e){var t;let{variable:n,yRange:r,width:a,height:c,strokeWidth:d,curveMode:u,colors:h}={...l,...e},p=Array.isArray(n)?n[0]:n,f="auto"===r?(()=>{let e=p.historyInfo();return[e.min,e.max]})():r,x=10&u?p.gaussianSmoothSamples(100):null,m=null!=(t=null==x?void 0:x.map((e,t,n)=>{let i=(0,s.remap)(t,0,n.length-1,a,0),r=(0,s.remap)(e,f[0],f[1],c,0);return"".concat(i,",").concat(r)}))?t:null,v=Array.isArray(h)?h[0]:h;return(0,i.jsxs)(i.Fragment,{children:[8&u&&(0,i.jsx)("polygon",{fill:"#".concat(new o.Q1f(v).getHexString()),points:[...m,"".concat(0,",").concat(c),"".concat(a,",").concat(c)].join(" ")}),2&u&&(0,i.jsx)("polyline",{fill:"none",stroke:"#".concat(new o.Q1f(v).getHexString()),strokeWidth:d,points:m.join(" ")}),1&u&&(0,i.jsx)("path",{d:p.toSvgPathData({width:a,height:c,yRange:f}),fill:"none",stroke:"#".concat(new o.Q1f(v).getHexString()),strokeWidth:d})]})}function d(e){let{children:t,...n}=e,{variable:s,yRange:o,width:a,height:d,strokeWidth:u}={...l,...n},[h,p]=(0,r.useState)(o),f=Array.isArray(s)?s:[s];return(0,i.jsx)("div",{onClick:()=>{"auto"!==o&&p(e=>"auto"===e?o:"auto")},children:(0,i.jsxs)("svg",{width:a,height:d,style:{backgroundColor:"#111"},children:[f.map((e,t)=>{var r;return(0,i.jsxs)("g",{children:[(0,i.jsx)(c,{...n,yRange:h}),e.derivative&&(0,i.jsx)("path",{d:e.derivative.toSvgPathData({width:a,height:d,yRange:h}),fill:"none",stroke:"#ff56b6",strokeWidth:u}),(null==(r=e.derivative)?void 0:r.derivative)&&(0,i.jsx)("path",{d:e.derivative.derivative.toSvgPathData({width:a,height:d,yRange:h}),fill:"none",stroke:"#fffc56",strokeWidth:u,opacity:.1})]},t)}),t,(0,i.jsx)("text",{x:10,y:24,fill:"white",fontSize:16,children:f.map(e=>e.props.name).join(", ")}),(0,i.jsxs)("text",{x:10,y:41,fill:"white",fontSize:11,opacity:.2,children:[f[0].count,":",f[0].props.historySize," (",f.map(e=>e.get().toFixed(1)).join(", "),")"]}),"auto"!==o&&(0,i.jsxs)("text",{x:10,y:56,fill:"white",fontSize:11,opacity:.2,children:["(click to ","auto"===h?"fix":"auto-adjust"," Y range)"]})]})})}},22899:(e,t,n)=>{"use strict";n.d(t,{I:()=>s});var i=n(65927);let r=["linear"];for(let e=1;e<=10;e++)r.push("easeIn".concat(e)),r.push("easeOut".concat(e)),r.push("easeInOut".concat(e)),r.push("easeOutIn".concat(e));let s="\n#ifndef GLSL_EASING\n#define GLSL_EASING\n\n".concat(i.S,"\n\nfloat easePow1(float x) {\n  return x;\n}\n\nfloat easePow2(float x) {\n  return x * x;\n}\n\nfloat easePow3(float x) {\n  return x * x * x;\n}\n\nfloat easePow4(float x) {\n  x *= x;\n  return x *= x;\n}\n\nfloat easePow5(float x) {\n  float x0 = x;\n  x *= x;\n  x *= x;\n  return x0 * x;\n}\n\nfloat easePow6(float x) {\n  x *= x * x;\n  return x *= x;\n}\n\nfloat easePow7(float x) {\n  float x0 = x;\n  x *= x * x;\n  x *= x;\n  return x0 * x;\n}\n\nfloat easePow8(float x) {\n  x *= x;\n  x *= x;\n  return x *= x;\n}\n\nfloat easePow9(float x) {\n  x *= x * x;\n  return x *= x * x;\n}\n\nfloat easePow10(float x) {\n  float x0 = x;\n  x *= x * x;\n  x *= x * x;\n  return x0 * x;\n}\n\nfloat linear(float x) {\n  return clamp01(x);\n}\n\n").concat(Array.from({length:10},(e,t)=>{let n=t+1;return"\n\n  float easeIn".concat(n," (float x) {\n    return easePow").concat(n,"(clamp01(x));\n  }\n  float easeOut").concat(n," (float x) {\n    return 1.0 - easePow").concat(n,"(clamp01(1.0 - x));\n  }\n  float easeInOut").concat(n," (float x) {\n    return x < 0.5 \n      ? 0.5 * easePow").concat(n,"(2.0 * x) \n      : 1.0 - 0.5 * easePow").concat(n,"(2.0 * (1.0 - x));\n  }\n  float easeOutIn").concat(n," (float x) {\n    return x < 0.5\n      ? 0.5 * (1.0 - easePow").concat(n,"(1.0 - x * 2.0))\n      : 1.0 - 0.5 * (1.0 - easePow").concat(n,"(2.0 * x - 1.0));\n  }\n\n").trim()}).join("\n\n"),"\n\n\n// https://www.desmos.com/calculator/mqou4lf9zc?lang=fr\nfloat easeInOut(float x, float p, float i) {\n  return  x <= 0.0 ? 0.0 :\n          x >= 1.0 ? 1.0 :\n          x <= i ? 1.0 / pow(i, p - 1.0) * pow(x, p) :\n          1.0 - 1.0 / pow(1.0 - i, p - 1.0) * pow(1.0 - x, p);\n}\n\n// https://www.desmos.com/calculator/nrjlezusdv\nfloat easeInThenOut(float x, float p) {\n  return 1.0 - pow(abs(2.0 * x - 1.0), p);\n}\n\n#endif\n")},25710:(e,t,n)=>{"use strict";n.d(t,{RangeClient:()=>m});var i,r=n(70691),s=n(99332),o=n(18479),a=n(40074);function l(e,t,n){let{start0:i,start1:r,end1:s,end0:o}=t;if(e<=i||e>=o)return 0;if(e>=r&&e<=s)return 1;let l=e<r?(e-i)/(r-i):(o-e)/(o-s);if(Array.isArray(n)){let[t,i]=n;return e<r?(0,a.KJ)(t)(l):(0,a.KJ)(i)(l)}return n?(0,a.KJ)(n)(l):l}!function(e){e[e.Inside=0]="Inside",e[e.Before=1]="Before",e[e.BeforeFade=3]="BeforeFade",e[e.After=4]="After",e[e.AfterFade=12]="AfterFade"}(i||(i={}));let c={start0:0,start1:0,end1:0,end0:0};function d(e,t){if(null!=t||(t=c),Array.isArray(e)){if(4===e.length)return t.start0=e[0],t.start1=e[1],t.end1=e[2],t.end0=e[3],t;if(3===e.length){let[n,i,r]=e;return t.start0=n-r,t.start1=n,t.end1=i,t.end0=i+r,t}throw Error("Invalid fuzzy range array length")}if(e&&"object"==typeof e){if(e&&"start0"in e&&"start1"in e&&"end1"in e&&"end0"in e)return Object.assign(t,e),t;if("center"in e&&"length"in e){if("fade"in e){let{center:n,length:i,fade:r}=e;return t.start0=n-i/2-r,t.start1=n-i/2,t.end1=n+i/2,t.end0=n+i/2+r,t}if("outerLength"in e){let{center:n,length:i,outerLength:r}=e,s=(r-i)/2;return t.start0=n-i/2-s,t.start1=n-i/2,t.end1=n+i/2,t.end0=n+i/2+s,t}}}throw Error("Invalid fuzzy range declaration")}class u{static evaluate(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(n.length>=4){let[t,i,r,s,o]=n;return c.start0=t,c.start1=i,c.end1=r,c.end0=s,l(e,c,o)}let[r,s]=n;return d(r,c),l(e,c,s)}get length(){return this.end1-this.start1}get outerLength(){return this.end0-this.start0}copy(e){return this.start0=e.start0,this.start1=e.start1,this.end1=e.end1,this.end0=e.end0,this}clone(){return new this.constructor().copy(this)}set(e,t,n,i){return this.start0=e,this.start1=t,this.end1=n,this.end0=i,this}from(e){return d(e,this),this}evaluate(e,t){return l(e,this,t)}computePosition(e){let{start0:t,start1:n,end1:r,end0:s}=this;return e<t?i.BeforeFade:e<n?i.Before:e<=r?i.Inside:e<=s?i.After:i.AfterFade}offset(e){return this.start0+=e,this.start1+=e,this.end1+=e,this.end0+=e,this}scale(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.start0=t+(this.start0-t)*e,this.start1=t+(this.start1-t)*e,this.end1=t+(this.end1-t)*e,this.end0=t+(this.end0-t)*e,this}constructor(e){this.start0=0,this.start1=0,this.end1=0,this.end0=0,e&&d(e,this)}}u.dummy=new u;var h=n(20487),p=n(79285);let f={length:1,range:{center:.5,length:.5,fade:.2},ease:"linear"},x={width:300,height:200,padding:20};function m(e){let{ref:t}=(0,o.useEffects)(function*(t){let{width:n,height:i,padding:r}=x,o={...f,...e},a=t.ownerSVGElement,l=a.querySelector("circle");yield(0,s.s)(a,{onChange:e=>{let t=h.M_.from(a.getBoundingClientRect()).shrink(r).toRelativePoint(e.position);t.x=(0,p.saturate)(t.x),t.y=1-t.y;let s=u.dummy.from(o.range).evaluate(t.x*o.length,o.ease);l.setAttribute("cx",(t.x*n).toString()),l.setAttribute("cy",((1-s)*i).toString())}})},[]);return(0,r.jsx)("path",{ref:t})}},28737:(e,t,n)=>{"use strict";n.d(t,{Leak:()=>h,O:()=>u});var i={};n.r(i),n.d(i,{distribute:()=>s.mn,every:()=>s.Si,findMaxBy:()=>s.vj,pairwise:()=>s.Ju,recordBy:()=>s.VY,some:()=>s.zN,split:()=>s.mn,uniqueBy:()=>s.pD});var r=n(30158),s=n(43107),o=n(38062),a=n(85795),l=n(17099),c=n(96122),d=n(36508);function u(e){Object.assign(window,{...r,...a,...i,...e,PRNG:l.c,waveform:o.o,dedent:c.T,Ticker:d.Rv})}function h(e){return u(e),null}},33540:(e,t,n)=>{"use strict";n.d(t,{q:()=>r.ThreeInstance,uB:()=>r.ThreeProvider,dB:()=>i.useGroup,yk:()=>i.useThree,Fw:()=>i.useThreeWebGL});var i=n(87548),r=n(42436),s=n(63106);n(18479);var o=n(79911),a=n(67235);let l={hotkey:"g",show:void 0,hide:void 0,isHelper:e=>!0===e.userData.helper};class c{*initialize(){let{hotkey:e}=this.safeParams;yield(0,s.a)([[{key:e,keyCaseInsensitive:!0},()=>this.toggle()]])}toggle(){return this.currentShowHelpers=!this.currentShowHelpers,this.updateHelpers(),this.currentShowHelpers}updateHelpers(){let{isHelper:e}=this.safeParams;for(let t of(0,o.$z)(this.root))e(t)&&(t.visible=this.currentShowHelpers);a.Q.send("TOGGLE_HELPERS",this.currentShowHelpers?"SHOW":"HIDE")}set showHelpers(e){this.currentShowHelpers=null!=e?e:this.currentShowHelpers,this.updateHelpers()}constructor(e,t){var n;c.instances.set(e,this),this.safeParams={...l,...t},this.root=e.scene,this.currentShowHelpers=null!=(n=null==t?void 0:t.show)?n:(null==t?void 0:t.hide)!==!1,this.updateHelpers()}}c.instances=new Map},33583:(e,t,n)=>{"use strict";n.d(t,{Client:()=>w});var i=n(70691),r=n(49797),s=n(31763),o=n(16465),a=n(79911),l=n(36508),c=n(67203),d=n(18479),u=n(88575);n(61249);let h=(0,c.createContext)(null),p={className:"",assetsPath:"/"};function f(e){let{children:t,className:n,assetsPath:r}={...p,...e},s=(0,c.useMemo)(()=>new u.XW,[]);s.loader.setPath(r);let{ref:o}=(0,d.IZ)({debounce:!0},function*(e,t){yield s.initialize(e),t.triggerRender(),Object.assign(window,{three:s})},[]);return(0,i.jsx)("div",{ref:o,className:n,style:{position:"absolute",inset:0},children:(0,i.jsx)(h.Provider,{value:s,children:s.initialized&&t})})}function x(e){return function(){let[e,t]=(0,c.useState)(!1);return(0,c.useLayoutEffect)(()=>{t(!0)},[]),e}()&&(0,i.jsx)(f,{...e})}var m=n(95645),v=n.n(m);function g(){return function(e,t){let n=(0,c.useContext)(h);(0,d.useEffects)(async function*(t,i){if(e){let t=e(n,i);if(t&&"function"==typeof t.next)do{let{value:e,done:n}=await t.next();if(n)break;yield e}while(i.mounted)}},null!=t?t:"always")}(function*(e){let t=(0,a.mj)(new r.eaF(new r.WBB,new o.Y),e.scene);yield()=>t.removeFromParent();let n=new s.n;n.initialize(e.renderer.domElement).start(),yield(0,l.xy)("three",t=>{n.update(e.camera,e.aspect,t.deltaTime)})},[]),null}function w(){return(0,i.jsx)("div",{className:"layer thru ".concat(v().Client),children:(0,i.jsx)(x,{children:(0,i.jsx)(g,{})})})}},33589:(e,t,n)=>{"use strict";n.d(t,{F:()=>s});let i={resolved:!1},r=Symbol("promisify");function s(e,t){if(r in e)return e;let{resolved:n=!1}={...i,...t},s={resolve:()=>e,reject:e=>{}},o=new Promise((t,n)=>{s.resolve=()=>(a(),t(e),e),s.reject=e=>{a(),n(Error(e))}}),a=()=>{delete s.resolve,delete s.reject,delete e.then,delete e.catch,delete e.finally,delete e.resolve,delete e.reject,delete e[r]};return Object.assign(e,{then:(e,t)=>(n&&(s.resolve(),n=!1),o.then(e,t)),catch:e=>o.catch(e),finally:e=>o.finally(e),resolve:()=>s.resolve(),reject:()=>s.reject(),[r]:!0}),e}},33925:(e,t,n)=>{"use strict";n.d(t,{PageClient:()=>w});var i=n(70691),r=n(49797),s=n(99332),o=n(98839),a=n(33540),l=n(55227),c=n(13565);let d={...c.q.defaultParams,colors:["#ffcc00","#00ffcc","#00ccff"]};class u extends c.q{penAt(e,t,n){let{uPen:i,uPenLast:r}=this.updateUniforms;i.value.set(e,t,n),r.value.copy(i.value)}penMove(e,t,n){let{uPen:i,uPenLast:r}=this.updateUniforms;r.value.copy(i.value),i.value.set(e,t,n)}constructor(e){super(e),this.enableGlslLib("glsl_blending","glsl_blur_3_11","glsl_sdf_2d"),this.shaders({initial:{fragmentColor:"\n          gl_FragColor.rgb = vec3(0.0);\n          gl_FragColor.a = 1.0;\n        "},update:{uniforms:{uPenLast:{value:new r.Pq0(.5,.5,.02)},uPen:{value:new r.Pq0(.5,.5,.02)},uColors:{value:this.params.colors.map(e=>new r.Q1f(e))}},fragmentTop:l.M,fragmentColor:"\n          vec2 uv = vUv;\n          vec2 center = uPen.xy;\n          float radius = uPen.z * 0.5;\n          \n          // Draw single circle:\n          // float dist = distance(uv, center) - radius;\n          // Draw rounded line (enabled via glsl_sdf_2d):\n          float dist = sdRoundedSegment(uv, uPenLast.xy, uPen.xy, radius);\n\n          float strength = smoothstep(0.005, -0.005, dist);\n          \n          float decay = 0.995;\n          // No blur:\n          // vec3 prev = texture2D(uTexture, uv).rgb * decay;\n          // With blur (enabled via glsl_blur_3_11):\n          vec3 prev = gaussianBlur11x11(uv, 2.0).rgb * decay;\n\n          Vec3Ramp r = ramp(mod(uTime, 1.0), uColors[0], uColors[1], uColors[2], uColors[0]);\n          vec3 color = mix(r.a, r.b, r.t);\n\n          vec3 pen = color * strength;\n          // gl_FragColor.rgb = max(prev, pen);\n          gl_FragColor.rgb = screenBlending(prev, pen * 0.1);\n        "}})}}u.defaultParams=d;var h=n(77794),p=n(79911),f=n(79285),x=n(36508),m=n(28737),v=n(88352);function g(){let e=(0,a.Fw)();return(0,a.dB)("my-scene",function*(t){e.pipeline.basicPasses.fxaa.enabled=!1;let n=(0,p.mj)(new r.eaF(new r.bdM,new r.V9B),t);n.scale.setScalar(10),(0,p.mj)(new h.u,t).regularGrid({size:10,subdivisions:[2,5]}).onTop();let i=new u({size:2048}).initialize(e.renderer),o=new r.I9Y,a=new r.I9Y,l=!0,c=.2,d=()=>{let t=e.pointer.intersectPlane("xy");if(t.intersected){a.set((0,f.inverseLerp)(-5,5,t.point.x),(0,f.inverseLerp)(-5,5,t.point.y));let e=a.distanceTo(o),n=(0,f.lerp)(.15,.5,100*e);c=(0,f.lerp)(c,n,.01),o.copy(a)}};yield(0,x.xy)("three",e=>{l&&(d(),i.penMove(a.x,a.y,c),i.update(e.deltaTime),n.material.map=i.currentTexture(),n.material.needsUpdate=!0)}),yield(0,s.s)(e.domElement,{onTap:()=>{(l=!l)&&(d(),i.penAt(a.x,a.y,c))}})},[]),null}function w(){return(0,m.O)(),(0,i.jsxs)(a.uB,{vertigoControls:{fixed:!0,size:10,frame:"cover",eventTarget:"canvas"},fullscreenKey:{key:"f",modifiers:"shift"},children:[(0,i.jsxs)("div",{className:"layer thru flex flex-col p-12",children:[(0,i.jsx)("h1",{className:"text-4xl font-bold",children:"GPU Compute - Pen Demo"}),(0,i.jsx)("p",{children:'Simple demo of a "pen" drawing on a canvas using GPU compute shaders.'}),(0,i.jsx)("p",{children:'Currently using a heavy non-optimized (one-pass) kernel 11x11 gaussian blur for the pen "diffuse" effect.'}),(0,i.jsx)(v.A,{}),(0,i.jsx)(o.l,{})]}),(0,i.jsx)(g,{})]})}},34011:(e,t,n)=>{"use strict";n.d(t,{e:()=>l,k:()=>d});var i=n(49797),r=n(38921);let s={axis:"x",length:1,radialSegments:12,radius:.01,coneRatio:.1,radiusScale:1,vertexColor:!0,baseCap:"flat",color:"white",align:0,heightSegments:1},o=new i.Q1f;function a(e){let{axis:t,length:n,radius:a,radialSegments:l,heightSegments:c,coneRatio:d,radiusScale:u,vertexColor:h,baseCap:p,color:f,align:x}={...s,...e},m=a*u,v=n*d,g=Math.max(1,Math.ceil(c*d)),w=Math.max(1,Math.ceil(c*(1-d))),y=new i.qFE(3*m,v,l,g),b=new i.Ho_(m,m,1,l,w,!0),j=n-v,P=n-.5*v;y.rotateZ(-Math.PI/2).translate(P,0,0),b.scale(1,j,1).rotateZ(-Math.PI/2).translate(.5*j,0,0);let z="none"===p?new i.LoY:"flat"===p?new i.tcD(m,l).rotateY(-Math.PI/2):new i.Gu$(m,l,3,0,2*Math.PI,0,.5*Math.PI).rotateZ(Math.PI/2).rotateX(Math.PI/2),C=(0,r.pP)([y,b,z]);switch(0!==x&&C.translate(-n*x,0,0),t){case"y":C.rotateZ(Math.PI/2);break;case"z":C.rotateY(-Math.PI/2)}if(h){let e=C.attributes.position.count,t=new i.THS(new Float32Array(3*e),3);C.setAttribute("color",t),o.set(f);for(let n=0;n<e;n++)t.setXYZ(n,o.r,o.g,o.b)}return C}class l extends i.LoY{constructor(e){super();let t=a(e);this.copy(t),t.dispose()}}let c={xColor:"#ff3333",yColor:"#33cc66",zColor:"#3366ff"};class d extends i.LoY{static get defaultOptions(){return{...c}}constructor(e){super();let{xColor:t,yColor:n,zColor:i,...s}={...c,...e},o=a({...s,axis:"x",color:t}),l=a({...s,axis:"y",color:n}),d=a({...s,axis:"z",color:i}),u=(0,r.pP)([o,l,d]);this.copy(u),u.dispose()}}},34242:(e,t,n)=>{"use strict";n.d(t,{Client:()=>y});var i=n(70691),r=n(49797),s=n(31763),o=n(16465),a=n(79911),l=n(36508),c=n(34011),d=n(72612),u=n(80446),h=n(67203),p=n(18479),f=n(88575);n(61249);let x=(0,h.createContext)(null),m={className:"",assetsPath:"/"};function v(e){let{children:t,className:n,assetsPath:r}={...m,...e},s=(0,h.useMemo)(()=>new f.XW,[]);s.loader.setPath(r);let{ref:o}=(0,p.IZ)({debounce:!0},function*(e,t){yield s.initialize(e),t.triggerRender(),Object.assign(window,{three:s})},[]);return(0,i.jsx)("div",{ref:o,className:n,style:{position:"absolute",inset:0},children:(0,i.jsx)(x.Provider,{value:s,children:s.initialized&&t})})}function g(e){return function(){let[e,t]=(0,h.useState)(!1);return(0,h.useLayoutEffect)(()=>{t(!0)},[]),e}()&&(0,i.jsx)(v,{...e})}function w(){return function(e,t){let n=(0,h.useContext)(x);(0,p.useEffects)(async function*(t,i){if(e){let t=e(n,i);if(t&&"function"==typeof t.next)do{let{value:e,done:n}=await t.next();if(n)break;yield e}while(i.mounted)}},null!=t?t:"always")}(function*(e){let t=new c.k;for(let n of(0,d.loop2Array)(5,5)){let i=(0,a.mj)(new r.eaF(t,new o.Y({vertexColors:!0})),e.scene);i.position.set(n.x-2,n.y-2,0),i.rotation.setFromQuaternion(u.n.quaternion(new r.PTz)),i.scale.setScalar(.5),yield()=>i.removeFromParent()}let n=new s.n;n.initialize(e.renderer.domElement).start(),yield(0,l.xy)("three",t=>{n.update(e.camera,e.aspect,t.deltaTime)})},[]),null}function y(){return(0,i.jsx)("div",{className:"layer thru",children:(0,i.jsx)(g,{children:(0,i.jsx)(w,{})})})}},35315:(e,t,n)=>{"use strict";n.d(t,{h:()=>d,x:()=>u});var i=n(70691),r=n(18479),s=n(19069),o=n(17099),a=n(36508),l=n(35477),c=n(48647);function d(e,t){let n=new s.$x({direction:s.OP.Horizontal,size:[e,t],spacing:10,userData:{color:c.Tj.blue}}).add(new s.$x({direction:s.OP.Vertical,size:"1part",spacing:10,userData:{color:c.Tj.paleGreen}}).populate(5,{spacing:10}),new s.$x({direction:s.OP.Vertical,size:"2sh",userData:{color:c.Tj.magenta},spacing:10}),new s.$x({direction:s.OP.Vertical,size:"1part",spacing:10}).add(new s.$x().setSize("40"),new s.$x().setSize("1part"),new s.$x().setSize("40"),new s.$x().setSize("1part").setSpacing(10).add(new s.$x({direction:"vertical",size:"1part"}),new s.$x({direction:"vertical",size:"1part"}),new s.$x({direction:"vertical",size:"1part"})),new s.$x().setSize("40")),new s.$x().setPositioning("detached").setUserData({skipPaint:!0}).setPadding(20).setSize("1rel").add(new s.$x({positioning:s.EU.Detached,offset:["0rel","1rel"],size:".7sm"})));n.get(0,3).populate(3),n.get(1).add(new s.$x({positioning:s.EU.Detached,direction:s.OP.Vertical,size:90,spacing:10}).populate(4),new s.$x({positioning:s.EU.Detached,alignSelf:0,offset:[0,0],size:70,spacing:10}).populate(3),new s.$x({positioning:s.EU.Detached,alignSelf:[0,1],size:30,spacing:10}).populate(1),new s.$x({positioning:s.EU.Detached,alignSelf:1,size:50,spacing:10}).populate(2));let i=new s.$x({positioning:s.EU.Detached,size:30}).populate(3).addTo(n.get(0,3));for(let e of n.allDescendants({includeSelf:!0}))e.positioning===s.EU.Detached&&e.set({userData:{color:c.Tj.yellow}});return n.computeLayout(),{root:n,updateOnTick:e=>{n.get([0]).sizeX.value=e.lerpCos01Time(2,1,{frequency:1/6}),n.get([1]).sizeX.value=e.lerpCos01Time(0,4,{frequency:1/6}),i.set({alignSelf:e.sin01Time({frequency:1/3})})}}}function u(){let{ref:e}=(0,r.useEffects)(function*(e){let t=new l.Q(e.querySelector("canvas"));o.c.reset();let n=d(t.width,t.height);yield(0,a.xy)("layout",e=>{n.updateOnTick(e),t.paint(n.root)})},[]);return(0,i.jsxs)("div",{ref:e,className:"flex flex-col justify-center gap-4",style:{flex:"0 0 800px"},children:[(0,i.jsx)("canvas",{style:{border:"solid 2px #fff1"}}),(0,i.jsx)("div",{className:"text-center",children:(0,i.jsxs)("p",{children:["When positioning is set to ",(0,i.jsx)("code",{style:{color:c.Tj.yellow},children:"detached"}),", spaces are not affected by their parent's size."]})})]})}},35477:(e,t,n)=>{"use strict";n.d(t,{Q:()=>r});var i=n(56905);class r{paint(e){let{ctx:t,pixelRatio:n}=this;t.clearRect(0,0,t.canvas.width,t.canvas.height),e.computeLayout();let r=e=>{let t=0;for(let n of e.allAncestors({includeSelf:!0}))t+=n.positioning===i.EU.Detached?100:1;return t};for(let i of[...e.allDescendants({includeSelf:!1})].filter(e=>!e.userData.skipPaint).sort((e,t)=>r(e)-r(t))){let e=i.rect.clone().multiplyScalar(n),r=function(e){let t;for(;!t&&e;){if(void 0!==(t=e.userData.color))return t;e=e.parent}return"#ffffff"}(i);i.userData.plain?(t.strokeStyle="",t.fillStyle=r,t.fillRect(e.x,e.y,e.width,e.height)):(t.lineWidth=2*n,t.strokeStyle=r,t.fillStyle="rgba(0, 0, 0, .5)",t.fillRect(e.x,e.y,e.width,e.height),t.strokeRect(e.x,e.y,e.width,e.height))}}constructor(e,{pixelRatio:t=window.devicePixelRatio,width:n=800,height:i=600}={}){e.width=n*t,e.height=i*t,e.style.width="".concat(n,"px"),e.style.height="".concat(i,"px"),this.ctx=e.getContext("2d"),this.pixelRatio=t,this.width=n,this.height=i}}},35484:(e,t,n)=>{"use strict";n.d(t,{Client:()=>P});var i=n(70691),r=n(49797),s=n(33540),o=n(66066),a=n(15940),l=n(99332),c=n(77794),d=n(79911),u=n(22899),h=n(14203),p=new WeakSet,f=new WeakSet,x=new WeakSet,m=new WeakSet;class v extends r.YJl{*onInitialize(){yield(0,l.s)(document.body,{onDown:e=>{this.pointerState.down=!0,this.pointerState.shift=e.event.shiftKey},onUp:()=>{this.pointerState.down=!1}})}onTick(e){let{down:t,shift:n}=this.pointerState;this.uTime.value+=e.deltaTime*(t?n?.1:10:1),this.uTime2.value+=!t*e.deltaTime}constructor(){super(),(0,a._)(this,p),(0,a._)(this,f),(0,a._)(this,x),(0,a._)(this,m),this.debugHelper=(0,d.mj)(new c.u,this),this.uTime={value:0},this.uTime2={value:0},this.pointerState={down:!1,shift:!1},(0,o._)(this,f,w).call(this),(0,o._)(this,x,y).call(this),(0,o._)(this,m,b).call(this),(0,d.mj)(this,{position:[0,4,0]})}}function g(e,t){this.debugHelper.text(e,t,{size:.25,textColor:"white",backgroundColor:"black"})}function w(){let e=new r.BKk({uniforms:{uTime:this.uTime,uTime2:this.uTime2},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:"\n        ".concat(h.O,"\n        varying vec2 vUv;\n        uniform float uTime, uTime2;\n        void main() {\n          vec3 p = vec3(vUv * 10.0, uTime * 0.1) * 0.5;\n          vec3 warp = vec3(\n            fnoise(p * 0.1, 2, 0.5), \n            fnoise(p * 0.1 + 100.0, 2, 0.5), \n            fnoise(p * 0.1 - 230.1, 2, 0.5));\n          p += warp * 5.2;\n          p *= 0.5;\n          float noise = fnoise(p, 4, 0.5);\n          vec3 color = \n            mod(uTime2 * 0.5, 2.0) < 1.0\n              ? vec3(0.5 + 0.5 * noise)\n              : vec3(mod((0.5 + 0.5 * noise) * 5.0, 1.0));\n          gl_FragColor = vec4(color, 1.0);\n        }\n      ")});(0,d.mj)(new r.eaF(new r.bdM(2,2),e),{parent:this,position:[0,0,0]}),(0,o._)(this,p,g).call(this,[0,0,.666],"warp in noise3D")}function y(){let e=new r.BKk({uniforms:{uTime:this.uTime,uTime2:this.uTime2},vertexShader:"\n        varying vec2 vUv;\n        varying vec3 vWorldPosition;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n        }\n      ",fragmentShader:"\n        ".concat(h.O,"\n        ").concat(u.I,"\n\n        varying vec2 vUv;\n        varying vec3 vWorldPosition;\n        uniform float uTime, uTime2;\n\n        float remap1101(in float x) {\n          return (x + 1.0) * 0.5;\n        }\n\n        float noiseA() {\n          vec4 p = vec4(vWorldPosition * 0.5, uTime * 0.1);\n          return easeInOut(remap1101(fnoise(p, 8, 0.5)), 4.0, 0.666);\n        }\n\n        float noiseB() {\n          vec4 p = vec4(vWorldPosition * 0.5 + 100.0, uTime * 0.01);\n          return mod(remap1101(fnoise(p, 8, 0.5)) * 10.0, 1.0);\n        }\n\n        void main() {\n          float noise = mod(uTime2 * 0.5, 2.0) < 1.0\n            ? noiseA()\n            : noiseB();\n          vec3 color = vec3(noise);\n          gl_FragColor = vec4(color, 1.0);\n        }\n      ")});(0,d.mj)(new r.eaF(new r.UPV(.5,.3,256,64),e),{parent:this,position:[0,2,0]}),(0,o._)(this,p,g).call(this,[0,2,.666],"noise4D")}function b(){let e=new r.BKk({uniforms:{uTime:this.uTime,uTime2:this.uTime2},vertexShader:"\n        varying vec2 vUv;\n        varying vec3 vWorldPosition;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n        }\n      ",fragmentShader:"\n        ".concat(h.O,"\n        ").concat(u.I,"\n\n        varying vec2 vUv;\n        varying vec3 vWorldPosition;\n        uniform float uTime, uTime2;\n\n        float remap1101(in float x) {\n          return (x + 1.0) * 0.5;\n        }\n\n        float noiseA() {\n          vec4 p = vec4(vWorldPosition * 0.5, uTime * 0.1);\n          return easeInOut(remap1101(fnoiseFast4D(p, 8, 0.5)), 4.0, 0.666);\n        }\n\n        float noiseB() {\n          vec4 p = vec4(vWorldPosition * 0.5 + 100.0, uTime * 0.01);\n          return mod(remap1101(fnoiseFast4D(p, 8, 0.5)) * 10.0, 1.0);\n        }\n\n        void main() {\n          float noise = mod(uTime2 * 0.5, 2.0) < 1.0\n            ? noiseA()\n            : noiseB();\n          vec3 color = vec3(noise);\n          gl_FragColor = vec4(color, 1.0);\n        }\n      ")});(0,d.mj)(new r.eaF(new r.UPV(.5,.3,256,64),e),{parent:this,position:[2,0,0]}),(0,o._)(this,p,g).call(this,[2,0,.666],"snoiseFast4D\n(hash. 4D into noise2D)")}class j extends r.YJl{*onInitialize(e){e.scene.background=new r.Q1f("#555")}}function P(){return(0,i.jsx)("div",{className:"layer thru",children:(0,i.jsxs)(s.uB,{vertigoControls:{size:7,focus:[0,0,0]},children:[(0,i.jsx)(s.q,{value:j}),(0,i.jsx)(s.q,{value:v})]})})}},37821:(e,t,n)=>{"use strict";n.d(t,{D:()=>r});var i=n(67203);function r(){let[e,t]=(0,i.useState)(!1);return(0,i.useLayoutEffect)(()=>{t(!0)},[]),e}},38062:(e,t,n)=>{"use strict";n.d(t,{o:()=>i});let i={triangle:function(e){let{frequency:t=1,phase:n=0,f:i=t,p:r=n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=e*i+r,o=2*s-Math.floor(2*s);return s-Math.floor(s)<.5?o:1-o}}},40643:(e,t,n)=>{"use strict";n.d(t,{PageClient:()=>u});var i=n(70691),r=n(33540),s=n(31763),o=n(77794),a=n(15931),l=n(79911),c=n(67235);function d(){let e=(0,r.Fw)();return(0,r.dB)("my-scene",function*(t){e.pipeline.basicPasses.fxaa.enabled=!1,(0,l.mj)(new a.P,t);let n=(0,l.mj)(new o.u,t),i=c.Q.send(s.n).assertPayload();yield e.ticker.onTick(t=>{n.clear();{let t=e.pointer.intersectPlane("xy");t.intersected&&(n.point(t.point,{color:"red"}),n.circle({center:t.point},{color:"red"}))}{let t=i.dampedVertigo.computeFocusPlane(),r=e.pointer.intersectPlane(t);if(r.intersected){let e="cyan";n.point(r.point,{color:e}),n.circle({center:r.point,axis:t.normal},{color:e}),n.text(r.point,"focus plane\nintersection",{color:e,size:.4,offset:[0,-.2,0]})}}}),document.body.style.backgroundColor="#222222"}),null}function u(){return(0,i.jsxs)(r.uB,{vertigoControls:{rotation:"-20deg, -30deg, 0",size:10},children:[(0,i.jsxs)("div",{className:"PageClient p-16",children:[(0,i.jsx)("h1",{className:"mb-4 text-3xl font-bold",children:"Pointer Test"}),(0,i.jsx)("p",{children:"Move the mouse to see the intersection points with the XY plane and with the vertigo focus plane."})]}),(0,i.jsx)(d,{})]})}},40742:(e,t,n)=>{"use strict";n.d(t,{AF:()=>h,EF:()=>f,hD:()=>u,s5:()=>o,wZ:()=>p});var i=n(49797),r=n(79285),s=n(20537);function o(e,t){if(0!==e.projectionMatrix.elements[15])return"none";{let n=e.projectionMatrix.elements[5],i=t.clientHeight*n/2;return"".concat(i,"px")}}let a=new i.kn4,l=new i.kn4,c=new i.Pq0,d=new i.Pq0;function u(e,t){if(c.setFromMatrixColumn(e.matrixWorld,2),(0,s.Th)(t))d.setFromMatrixColumn(t.matrixWorld,2);else if((0,s.MR)(t))d.setFromMatrixColumn(t,2);else if((0,s.Zz)(t))d.copy(t);else throw Error("Invalid object type.");return c.dot(d)>0}function h(e,t){return c.set(e.matrixWorld.elements[12],e.matrixWorld.elements[13],e.matrixWorld.elements[14]),!function(e,t){if((0,s.Th)(e))return t.setFromMatrixPosition(e.matrixWorld);if((0,s.MR)(e))return t.setFromMatrixPosition(e);if((0,s.Zz)(e))t.copy(e);else throw Error("Invalid object type.")}(t,d),Math.round(1e4/(1+c.distanceTo(d))).toString()}function p(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],h=e.projectionMatrix.elements[5],p=n.clientHeight*h/2,f=p/i,x=function(e,t){if((0,s.Th)(e))return e.matrixWorld;if((0,s.MR)(e))return e;if((0,s.Zz)(e))return t.makeTranslation(e.x,e.y,e.z);throw Error("Invalid object type.")}(t,l);a.multiplyMatrices(e.matrixWorldInverse,x);let m=a.elements;m[4]*=-1,m[5]*=-1,m[6]*=-1,m[8]*=-1,m[9]*=-1,m[10]*=-1;let v=m[14];return m[14]+=u?-1:1,m[0]*=f,m[1]*=f,m[2]*=f,m[4]*=f,m[5]*=f,m[6]*=f,m[8]*=f,m[9]*=f,m[10]*=f,m[12]*=p,m[13]*=p,m[14]*=p,m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,u&&(m[2]*=-1,m[6]*=-1,m[10]*=-1,m[14]*=-1),o>0&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e.elements;c.set(n[0],n[1],n[2]);let i=c.length();n[0]=(0,r.lerp)(n[0],i,t),n[1]=(0,r.lerp)(n[1],0,t),n[2]=(0,r.lerp)(n[2],0,t),c.set(n[4],n[5],n[6]);let s=c.length();n[4]=(0,r.lerp)(n[4],0,t),n[5]=(0,r.lerp)(n[5],s,t),n[6]=(0,r.lerp)(n[6],0,t),c.set(n[8],n[9],n[10]);let o=c.length();n[8]=(0,r.lerp)(n[8],0,t),n[9]=(0,r.lerp)(n[9],0,t),n[10]=(0,r.lerp)(n[10],o,t)}(a,o),d>0&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=e.elements;c.set(i[0],i[1],i[2]);let s=(0,r.lerp)(1,t/c.length(),n);i[0]*=s,i[1]*=s,i[2]*=s,c.set(i[4],i[5],i[6]);let o=(0,r.lerp)(1,t/c.length(),n);i[4]*=o,i[5]*=o,i[6]*=o,c.set(i[8],i[9],i[10]);let a=(0,r.lerp)(1,t/c.length(),n);i[8]*=a,i[9]*=a,i[10]*=a}(a,u?v:-v,d),"translate(-50%, -50%) matrix3d(".concat(a.elements.map(e=>1e-6*Math.round(e/1e-6)).join(","),")")}function f(e,t,n,i){let{pixelPerUnit:r=100,resetRotation:s=0,resetScale:a=0,leftHanded:l=!1}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};e.style.perspective=o(n,e),t.style.position="absolute",t.style.left="50%",t.style.top="50%",t.style.transform=p(n,i,e,r,s,a,l),t.style.zIndex=h(n,i)}},42220:(e,t,n)=>{"use strict";n.d(t,{Client:()=>S});var i=n(70691),r=n(49797),s=n(33540),o=n(77794),a=n(79911),l=n(2210),c=n(34011),d=n(13160),u=n(16465),h=n(79285),p=n(4941),f=n(38062),x=n(80446);n(18479);var m=n(31763),v=n(67235);n(36508);class g extends r.YJl{constructor(e="white"){super();let{torusKnotGeometry:t,axesGeometry:n,autoLitVertexColorsMaterial:i,cubeGeometry:s}=g.shared;(0,a.mj)(new r.eaF(t,new u.Y({color:e})),this),(0,a.mj)(new r.eaF(n,i),this),(0,a.mj)(new r.DXC(s,new r.mrM({color:e})),this)}}function w(e){let{children:t}=e;return(0,i.jsx)("div",{className:"ui layer thru p-8 flex flex-col gap-4 items-start",children:(0,i.jsx)("div",{className:"max-w-md flex flex-col gap-2 items-start p-4 backdrop-blur rounded-xl border border-white/10 bg-white/2",children:t})})}function y(e){let{label:t="Button",onClick:n=()=>{}}=e;return(0,i.jsx)("button",{className:"btn border rounded px-2 py-1 hover:bg-white/10 active:bg-white/20",onClick:n,children:t})}function b(){return(0,i.jsxs)(w,{children:[(0,i.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Matrix with Shear"}),(0,i.jsx)("p",{children:"Transform interpolation (lerp) between two random transforms using TransformWithShear (some-utils-three/experimental/transform-with-shear)."}),(0,i.jsxs)("p",{children:[(0,i.jsx)("span",{className:"text-[#ff99ff]",children:"Pink color"})," indicates that the two transforms are not both direct or both indirect (reflection)."]}),(0,i.jsx)("p",{children:"Based on research here:"}),(0,i.jsxs)("ul",{className:"list-disc list-inside",children:[(0,i.jsx)("li",{children:(0,i.jsx)("a",{className:"underline hover:text-[cyan]",href:"/l/transform-with-shear/0-intro",children:"0-intro"})}),(0,i.jsx)("li",{children:(0,i.jsx)("a",{className:"underline hover:text-[cyan]",href:"/l/transform-with-shear/1-shear",children:"1-shear"})}),(0,i.jsx)("li",{children:(0,i.jsx)("a",{className:"underline hover:text-[cyan]",href:"/l/transform-with-shear/2-decompose",children:"2-decompose"})}),(0,i.jsx)("li",{children:(0,i.jsx)("a",{className:"underline hover:text-[cyan]",href:"/l/transform-with-shear/3-transform-with-shear",children:"3-transform-with-shear"})})]}),(0,i.jsx)("div",{className:"basis-2"}),(0,i.jsx)(y,{label:"Orthographic (reset)",onClick:()=>{v.Q.send(m.n).assertPayload().vertigo.set({perspective:0,zoom:.98,focus:0,rotation:0})}}),(0,i.jsx)(y,{label:"Perspective",onClick:()=>{v.Q.send(m.n).assertPayload().vertigo.set({perspective:1})}})]})}g.shared={torusKnotGeometry:new r.UPV(.15,.07,256,64),axesGeometry:new c.k,cubeGeometry:d.Q.setAsBounds(new r.LoY,0,1),autoLitVertexColorsMaterial:new u.Y({vertexColors:!0})},r.YJl;class j extends r.YJl{setColor(e){return this.box.material.color.set(e),this.axes.material.color.set(e),this.knot.material.color.set(e),this}setTransform(e){return this.matrixAutoUpdate=!1,this.transform.setTransform(e).toMatrix(this.matrix),this}constructor(e){super(),this.box=(0,a.mj)(new r.DXC(d.Q.setAsBounds(null,-1,1),new r.mrM),this),this.axes=(0,a.mj)(new r.eaF(j.shared.axesGeometry,new u.Y({vertexColors:!0})),this),this.knot=(0,a.mj)(new r.eaF(j.shared.knotGeometry,new u.Y),this),this.transform=new l.d,e&&this.setColor(e)}}j.shared={axesGeometry:new c.k({radius:.04,coneRatio:.2,length:1}),knotGeometry:new r.UPV(.3,.1,512,64)};class P extends r.YJl{onTick(e){let t=p.kY.inOut3((0,h.inverseLerp)(.05,.95,f.o.triangle(e.time,{f:.2})));this.objC.matrixAutoUpdate=!1,this.useMatrixInterpolation?l.d.lerpMatrixes(this.objA.matrix,this.objB.matrix,t,this.objC.matrix):this.objC.transform.lerpTransforms(this.objA.transform,this.objB.transform,t).toMatrix(this.objC.matrix),this.objC.setColor(this.objA.transform.isDirect()===this.objB.transform.isDirect()?"white":"#ff99ff")}constructor(){super(),this.useMatrixInterpolation=!0,this.objA=(0,a.mj)(new j("yellow"),this),this.objB=(0,a.mj)(new j("cyan"),this),this.objC=(0,a.mj)(new j,this),this.objA.setTransform({position:[-2,0,0]}),this.objB.setTransform({position:[2,0,0]})}}function z(){return(0,s.dB)("demo-1",function*(e){(0,a.mj)(new o.u,e).regularGrid({size:8,subdivisions:[2,4],opacity:[1,.1]}).text(0,"matrix-to-matrix",{color:"white"});let t=(0,a.mj)(new P,e);t.objA.setTransform({rotation:["9deg","0deg","20deg"],shear:[1,0,0]}),t.objB.setTransform({scale:[1,-2,.5],rotation:["-10deg","70deg",0],shear:[0,1,0]}),x.n.setRandom("parkmiller",1234);for(let t=0;t<3;t++)for(let n of[-1,1]){let i=(0,a.mj)(new P,e);i.position.y=4*(t+1)*n,i.objA.setTransform({position:[x.n.number(-3,-1),x.n.number(-1,1),x.n.number(-1,1)],scale:[x.n.number(-1,1),x.n.number(-1,1),x.n.number(-1,1)],rotation:x.n.quaternion(),shear:[x.n.number(-1,1),x.n.number(-1,1),x.n.number(-1,1)]}),i.objB.setTransform({position:[x.n.number(1,3),x.n.number(-1,1),x.n.number(-1,1)],scale:[x.n.number(-1,1),x.n.number(-1,1),x.n.number(-1,1)],rotation:x.n.quaternion(),shear:[x.n.number(-1,1),x.n.number(-1,1),x.n.number(-1,1)]})}},[]),null}function C(){return(0,s.dB)("demo-2",function*(e){(0,a.mj)(e,{x:12}),(0,a.mj)(new o.u,e).regularGrid({size:8,subdivisions:[2,4],opacity:[1,.1]}).text(0,"scaleFactor",{color:"white"});let t=(0,a.mj)(new P,e);t.objA.setTransform({rotation:[0,"-90deg",0]}),t.objB.setTransform({rotation:[0,"90deg",0],shear:[1,1,0],scaleFactor:1.5})},[]),null}function T(){return(0,s.Fw)(function*(e){e.pipeline.basicPasses.fxaa.enabled=!1}),(0,s.dB)("my-scene",function*(e,t){},[]),null}function S(){return(0,i.jsxs)(s.uB,{vertigoControls:{eventTarget:"canvas",size:8,zoom:.75,rotation:["-5deg","10deg",0],focus:[0,0,1.5]},children:[(0,i.jsx)(b,{}),(0,i.jsx)(T,{}),(0,i.jsx)(z,{}),(0,i.jsx)(C,{})]})}},42436:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ThreeInstance:()=>g,ThreeProvider:()=>b});var i=n(70691),r=n(67203),s=n(30158),o=n(24223),a=n(63106),l=n(18479),c=n(37821),d=n(31763),u=n(40951),h=n(29338),p=n(82143),f=n(83628),x=n(67235),m=n(68571),v=n(87548);function g(e){return(0,v.useInstance)(e),null}let w={type:void 0,webgl:void 0,webgpu:void 0,className:"",assetsPath:"/",vertigoControls:!1,minActiveDuration:30,fullscreenKey:null};function y(e){var t;let n={...w,...e},{children:c,className:v,vertigoControls:g}=n,y=null!=(t=n.type)?t:n.webgpu?"webgpu":"webgl",b=(0,r.useRef)(void 0);b.current&&b.current!==y&&console.warn('ThreeProvider: the prop "type" is not intended to change after the component is mounted.'),b.current=y;let j=(0,r.useMemo)(()=>"webgl"===y?new p.XW:new f.K,[y]);j.ticker.set({minActiveDuration:n.minActiveDuration});let{ref:P}=(0,l.IZ)({debounce:!0},function*(e,t){let n=e.querySelector("#three-wrapper-canvas");yield j.initialize(n,document.body),j.pointer.setEventIgnore(u.K6.Type.Tap,e=>{let{downTarget:t}=e;return!1===(n===t||n.contains(t))}),t.triggerRender(),Object.assign(window,{three:j,THREE:s})},[]);(0,l.useEffects)(function*(){yield x.Q.on("THREE",e=>{e.setPayload(j)}),yield(0,o.O)(j.ticker.requestActivation);let e=()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()};if(n.fullscreenKey&&(yield(0,a.a)([[n.fullscreenKey,e]])),yield x.Q.on("TOGGLE_FULLSCREEN",e),g){var t,i,r;let e="object"==typeof g?g:{},n=new d.n(e).initialize("canvas"===e.eventTarget?j.domElement:P.current);Object.assign(n.inputConfig,e.inputConfig),n.parsePanInputs(null!=(t=e.panInput)?t:""),n.parseOrbitInputs(null!=(i=e.orbitInput)?i:""),n.focusPlane=null!=(r=e.focusPlane)?r:null,j.scene.add(n.group),e.fixed||n.start(),yield(0,a.a)([[{code:"Tab",modifiers:"alt"},e=>{e.event.preventDefault(),n.actions.toggleAlternative()}]]),yield n.destroy;let s=e=>{"SET"===e.type?n.vertigo.set(e.payload):e.setPayload(n)};yield x.Q.on("VERTIGO_CONTROLS",s),yield x.Q.on(d.n,s),yield x.Q.on([j,d.n],s),yield j.ticker.onTick({name:"VertigoControls",phase:h.z.BeforeRender,order:-1},e=>{n.update(j.camera,j.aspect,e.deltaTime)})}},[g]);let z={position:"absolute",inset:0};return(0,i.jsx)("div",{ref:P,className:v,style:z,children:(0,i.jsxs)(m.h.Provider,{value:j,children:[(0,i.jsx)("div",{id:"three-wrapper-canvas",style:z}),(0,i.jsx)("div",{id:"three-wrapper-hud",style:z,className:"thru",children:j.initialized&&c})]})})}function b(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,c.D)()&&(0,i.jsx)(y,{...t[0]})}},42824:e=>{e.exports={Markdown:"md_Markdown__RP0EZ"}},43969:(e,t,n)=>{"use strict";n.d(t,{E:()=>h});var i=n(49797),r=n(7147),s=n(94065);let o=new i.kn4;function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,n=e/2,r=[new i.Pq0(-n,0,0),new i.Pq0(+n,0,0)];for(let e of((0,s.vl)(null!=t?t:{},o),r))e.applyMatrix4(o);return r}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,n=e/2,r=[new i.Pq0(-n,0,0),new i.Pq0(+n,0,0),new i.Pq0(0,-n,0),new i.Pq0(0,+n,0)];for(let e of((0,s.vl)(null!=t?t:{},o),r))e.applyMatrix4(o);return r}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,n=e/2;return(0,s.vl)(null!=t?t:{},o),[new i.Pq0(-n,-n,0),new i.Pq0(+n,+n,0),new i.Pq0(+n,-n,0),new i.Pq0(-n,+n,0)].map(e=>e.applyMatrix4(o))}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,n=e/2;return(0,s.vl)(null!=t?t:{},o),[new i.Pq0(-n,+n,0).applyMatrix4(o),new i.Pq0(0,0,0).applyMatrix4(o),new i.Pq0(0,0,0).applyMatrix4(o),new i.Pq0(+n,+n,0).applyMatrix4(o),new i.Pq0(0,0,0).applyMatrix4(o),new i.Pq0(0,-n,0).applyMatrix4(o)]}function u(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,n=e/2;return(0,s.vl)(null!=t?t:{},o),[new i.Pq0(-n,+n,0).applyMatrix4(o),new i.Pq0(+n,+n,0).applyMatrix4(o),new i.Pq0(+n,+n,0).applyMatrix4(o),new i.Pq0(-n,-n,0).applyMatrix4(o),new i.Pq0(-n,-n,0).applyMatrix4(o),new i.Pq0(+n,-n,0).applyMatrix4(o)]}class h extends i.DXC{constructor(e){let{divisions:t=10,interiorOpacity:n=.2,letters:h=!1}=null!=e?e:{},p=(e,t,n)=>Array.from({length:n},(r,s)=>[new i.Pq0().lerpVectors(e,t,s/n),new i.Pq0().lerpVectors(e,t,(s+1)/n)]).flat(),f=[...p(new i.Pq0(-1,-1,-1),new i.Pq0(1,-1,-1),t),...p(new i.Pq0(-1,1,-1),new i.Pq0(1,1,-1),t),...p(new i.Pq0(-1,1,1),new i.Pq0(1,1,1),t),...p(new i.Pq0(-1,-1,1),new i.Pq0(1,-1,1),t),...p(new i.Pq0(-1,-1,-1),new i.Pq0(-1,1,-1),t),...p(new i.Pq0(1,-1,-1),new i.Pq0(1,1,-1),t),...p(new i.Pq0(1,-1,1),new i.Pq0(1,1,1),t),...p(new i.Pq0(-1,-1,1),new i.Pq0(-1,1,1),t),...p(new i.Pq0(-1,-1,-1),new i.Pq0(-1,-1,1),t),...p(new i.Pq0(1,-1,-1),new i.Pq0(1,-1,1),t),...p(new i.Pq0(1,1,-1),new i.Pq0(1,1,1),t),...p(new i.Pq0(-1,1,-1),new i.Pq0(-1,1,1),t)],x=h?[...function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,n=[...l(e/2,{x:-(.375*e)}),...c(e,{x:.375*e})];for(let e of((0,s.vl)(null!=t?t:{},o),n))e.applyMatrix4(o);return n}(.1,{x:1.1}),...function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,n=[...l(e/2,{x:-(.375*e)}),...d(e,{x:.375*e})];for(let e of((0,s.vl)(null!=t?t:{},o),n))e.applyMatrix4(o);return n}(.1,{y:1.1}),...function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,n=[...l(e/2,{x:-(.375*e)}),...u(e,{x:.375*e})];for(let e of((0,s.vl)(null!=t?t:{},o),n))e.applyMatrix4(o);return n}(.1,{z:1.1}),...function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,n=[...a(e/2,{x:-(.375*e)}),...c(e,{x:.375*e})];for(let e of((0,s.vl)(null!=t?t:{},o),n))e.applyMatrix4(o);return n}(.1,{x:-1.1}),...function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,n=[...a(e/2,{x:-(.375*e)}),...d(e,{x:.375*e})];for(let e of((0,s.vl)(null!=t?t:{},o),n))e.applyMatrix4(o);return n}(.1,{y:-1.1}),...function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,n=[...a(e/2,{x:-(.375*e)}),...u(e,{x:.375*e})];for(let e of((0,s.vl)(null!=t?t:{},o),n))e.applyMatrix4(o);return n}(.1,{z:-1.1})]:[],m=[...p(new i.Pq0(-1,-1,0),new i.Pq0(1,-1,0),t),...p(new i.Pq0(-1,1,0),new i.Pq0(1,1,0),t),...p(new i.Pq0(-1,0,-1),new i.Pq0(1,0,-1),t),...p(new i.Pq0(-1,0,1),new i.Pq0(1,0,1),t),...p(new i.Pq0(0,-1,-1),new i.Pq0(0,1,-1),t),...p(new i.Pq0(0,-1,1),new i.Pq0(0,1,1),t),...p(new i.Pq0(-1,-1,0),new i.Pq0(-1,1,0),t),...p(new i.Pq0(1,-1,0),new i.Pq0(1,1,0),t),...p(new i.Pq0(-1,0,-1),new i.Pq0(-1,0,1),t),...p(new i.Pq0(1,0,-1),new i.Pq0(1,0,1),t),...p(new i.Pq0(0,-1,-1),new i.Pq0(0,-1,1),t),...p(new i.Pq0(0,1,-1),new i.Pq0(0,1,1),t)],v=new i.LoY().setFromPoints([...f,...x,...m]),g=new i.THS(new Float32Array(v.getAttribute("position").count),1),w=f.length+x.length;g.array.fill(1,0,w),g.array.fill(n,w),v.setAttribute("aOpacity",g);let y=new i.mrM({color:"#ff0",transparent:!0});y.onBeforeCompile=t=>{var n;r.bI.with(t).varying({vOpacity:"float"}).vertex.top("\n          attribute float aOpacity;\n        ").vertex.mainAfterAll("\n          vOpacity = aOpacity;\n        ").fragment.after("map_fragment","\n          diffuseColor.a *= vOpacity;\n        "),null==e||null==(n=e.onBeforeCompile)||n.call(e,t)},super(v,y)}}},45553:(e,t,n)=>{"use strict";n.d(t,{z:()=>l});var i=n(49797);let r=new i.Pq0,s=new i.Pq0,o=new i.Pq0,a=new i.Pq0;function l(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a;o.crossVectors(e,t),1e-6>o.lengthSq()&&(o.set(1,0,0).cross(e),1e-6>o.lengthSq()&&o.set(0,1,0).cross(e));let l=e.length(),c=t.length();r.copy(e).divideScalar(l),s.copy(t).divideScalar(c);let d=Math.acos(Math.min(Math.max(r.dot(s),-1),1));if(1e-6>Math.abs(d))i.lerpVectors(e,t,n);else{o.normalize();let e=d*n,t=Math.cos(e),a=Math.sin(e);i.copy(r).multiplyScalar(t).addScaledVector(s.copy(o).cross(r),a).multiplyScalar((1-n)*l+n*c)}return i}},48181:(e,t,n)=>{"use strict";n.d(t,{R:()=>h});var i=n(49797),r=n(20487),s=n(72612),o=n(94065);let a=new i.I9Y,l=new i.Pq0,c=new i.kn4;function*d(e){let t=new WeakSet;for(let n of e)t.has(n)||(t.add(n),yield n)}function u(e,t,n,i,r){if(null==n?void 0:n.transform)for(let e of((0,o.vl)(n.transform,c),d(t)))e.applyMatrix4(c);if((null==n?void 0:n.color)!==void 0&&e.color(n.color),i){for(let n=0;n<t.length-1;n++)e.points.push(t[n],t[n+1]);r&&e.points.push(t[t.length-1],t[0])}else e.points.push(...t)}class h extends i.DXC{addTo(e){return e?e.add(this):this.removeFromParent(),this}*uniquePoints(){yield*d(this.points)}opacity(e){return this.material.opacity=e,this.material.transparent=this.state.forceTransparent||e<1,this.material.depthWrite=e>=1,this.material.needsUpdate=!0,this}color(e){return this.colors.set(this.points.length,new i.Q1f(e)),this}forceTransparent(){return this.state.forceTransparent=!0,this.material.transparent=!0,this}translate(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[i,r,s]=1===t.length?(0,o.jj)(t[0],l):t;for(let e of this.uniquePoints())e.x+=i,e.y+=r,e.z+=s;return this}rescale(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[i,r,s]=1===t.length?(0,o.jj)(t[0],l):t;for(let e of this.uniquePoints())e.x*=i,e.y*=r,e.z*=s;return this}showOccludedLines(){let{opacity:e=.2}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new i.mrM({color:this.material.color,transparent:!0,depthFunc:i.K52,opacity:e}),n=new i.DXC(this.geometry,t);return this.add(n),this}clear(){return this.points.length=0,this.colors.clear(),this.geometry.setDrawRange(0,0),this}draw(){if(!1===this.state.hasAlreadyBeenRendered&&-1===this.state.reservePoints)this.geometry.setFromPoints(this.points),this.geometry.setDrawRange(0,this.points.length),this.state.reservePoints=this.points.length;else{let{position:e}=this.geometry.attributes;e||(e=new i.THS(new Float32Array(3*this.state.reservePoints),3),this.geometry.setAttribute("position",e));let t=this.points.length;t>e.count&&(console.warn("LineHelper: The number of points (".concat(t,") is greater than the reserved points (").concat(e.count,").")),t=e.count),this.geometry.setDrawRange(0,t);for(let n=0;n<t;n++){let{x:t,y:i,z:r}=this.points[n];e.setXYZ(n,t,i,r)}e.needsUpdate=!0}if(this.geometry.computeBoundingSphere(),this.material.vertexColors=this.colors.size>0,this.material.needsUpdate=!0,this.colors.size>0){var e;let{color:t}=this.geometry.attributes;t||(t=new i.THS(new Float32Array(3*this.geometry.attributes.position.count),3),this.geometry.setAttribute("color",t));let n=new i.Q1f(null!=(e=this.colors.get(0))?e:"white"),r=this.points.length;for(let e=0;e<r;e++){let i=this.colors.get(e);i&&n.copy(i),t.setXYZ(e,n.r,n.g,n.b)}t.needsUpdate=!0}return this}line(e,t,n){return u(this,[(0,o.jj)(e),(0,o.jj)(t)],n),this}capsule2(e,t,n,r){let a=(0,o.jj)(e),l=(0,o.jj)(t),c=new i.Pq0().subVectors(l,a),d=c.length(),h=c.clone().divideScalar(d),p=new i.Pq0(-h.y,h.x);return u(this,[...(0,s.loopArray)(24,e=>{let t=e.p*Math.PI;return a.clone().addScaledVector(p,n*Math.cos(t)).addScaledVector(h,-n*Math.sin(t))}),...(0,s.loopArray)(24,e=>{let t=e.p*Math.PI;return l.clone().addScaledVector(p,-n*Math.cos(t)).addScaledVector(h,n*Math.sin(t))})],r,!0,!0),this}polygon(e,t){let n=e.map(e=>(0,o.jj)(e)),i=[];for(let e=0;e<n.length;e++)i.push(n[e],n[(e+1)%n.length]);return u(this,i,t),this}polyline(e,t){let n=e.map(e=>(0,o.jj)(e)),i=[];for(let e=0;e<n.length-1;e++)i.push(n[e],n[e+1]);return u(this,i,t),this}circle(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let{x:r,y:s,z:l,radius:c,segments:d,plane:p,...f}={...h.circleDefaultOptions,...(()=>{if(t.length>1){let[e,n,i]=t,{x:r,y:s}=(0,o.wX)(e,a);return{x:r,y:s,radius:n,...i}}return t[0]})()},x=new i.Pq0(1,0,0),m=new i.Pq0(0,1,0),v=[];for(let e=0;e<d;e++){let t=e/d*Math.PI*2,n=(e+1)/d*Math.PI*2,o=Math.cos(t)*c,a=Math.sin(t)*c,u=Math.cos(n)*c,h=Math.sin(n)*c,p=new i.Pq0(r,s,l).addScaledVector(x,o).addScaledVector(m,a),f=new i.Pq0(r,s,l).addScaledVector(x,u).addScaledVector(m,h);v.push(p,f)}if("XZ"===p)for(let e of v)e.set(e.x,0,e.y);if("YZ"===p)for(let e of v)e.set(0,e.x,e.y);return u(this,v,f),this}sphere(e){return this.circle({...e,plane:"XY"}).circle({...e,plane:"XZ"}).circle({...e,plane:"YZ"})}rectangle(e,t){let{centerX:n,centerY:s,width:o,height:a}=r.M_.from(e),l=o/2,c=a/2,d=new i.Pq0(n-l,s-c,0),h=new i.Pq0(n+l,s-c,0),p=new i.Pq0(n+l,s+c,0),f=new i.Pq0(n-l,s+c,0);return u(this,[d,h,h,p,p,f,f,d],t),this}placeholder(e,t){let n=r.M_.from(e);return this.rectangle(n,t).line(n.fromRelativePoint(0,0),n.fromRelativePoint(1,1),t).line(n.fromRelativePoint(1,0),n.fromRelativePoint(0,1),t)}grid2(e){let{plane:t,x:n,y:r,z:s,size:l,subdivisions:c,width:d,height:p,widthSubdivisions:f,heightSubdivisions:x,...m}={...h.grid2DefaultOptions,...e},{x:v,y:g}=(0,o.wX)(l,a),{x:w,y:y}=(0,o.wX)(null!=c?c:l);d&&(v=d),p&&(g=p),f&&(w=f),x&&(y=x);let b=v/2,j=g/2,P=[];for(let e=0;e<=w;e++){let t=e/w*v-b;P.push(new i.Pq0(t,-j,0),new i.Pq0(t,j,0))}for(let e=0;e<=y;e++){let t=e/y*g-j;P.push(new i.Pq0(-b,t,0),new i.Pq0(b,t,0))}let z=new i.Pq0(n,r,s);for(let e of P)e.add(z);if("XZ"===t)for(let e of P)e.set(e.x,0,e.y);if("YZ"===t)for(let e of P)e.set(0,e.x,e.y);return u(this,P,m),this}box(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=0,n=0,r=0,s=1,a=1,c=1,{center:d,size:u,box3:h}=e;if(void 0!==d&&({x:t,y:n,z:r}=(0,o.jj)(d,l)),void 0!==u&&({x:s,y:a,z:c}=(0,o.jj)(u,l)),void 0!==h){let{min:i,max:o}=h,{x:l,y:d,z:u}=i,{x:p,y:f,z:x}=o;e.asIntBox3&&(p+=1,f+=1,x+=1),t=(l+p)/2,n=(d+f)/2,r=(u+x)/2,s=p-l,a=f-d,c=x-u}let p=s/2,f=a/2,x=c/2,m=new i.Pq0(t-p,n-f,r-x),v=new i.Pq0(t+p,n-f,r-x),g=new i.Pq0(t+p,n+f,r-x),w=new i.Pq0(t-p,n+f,r-x),y=new i.Pq0(t-p,n-f,r+x),b=new i.Pq0(t+p,n-f,r+x),j=new i.Pq0(t+p,n+f,r+x),P=new i.Pq0(t-p,n+f,r+x);return this.points.push(m,v,v,g,g,w,w,m),this.points.push(y,b,b,j,j,P,P,y),this.points.push(m,y,v,b,g,j,w,P),this}plus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=t/2,{x:s,y:l}=(0,o.wX)(e,a),c=new i.Pq0(s-r,l,0),d=new i.Pq0(s+r,l,0);return u(this,[c,d,new i.Pq0(s,l-r,0),new i.Pq0(s,l+r,0)],n),this}cross(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=t/2,{x:s,y:l}=(0,o.wX)(e,a),c=new i.Pq0(s-r,l-r,0),d=new i.Pq0(s+r,l+r,0);return u(this,[c,d,new i.Pq0(s-r,l+r,0),new i.Pq0(s+r,l-r,0)],n),this}constructor(e=-1,t=new i.mrM({vertexColors:!0})){super(new i.LoY,t),this.points=[],this.colors=new Map,this.state={forceTransparent:!1,hasAlreadyBeenRendered:!1,reservePoints:-1},this.state.reservePoints=e,this.onBeforeRender=()=>{this.state.hasAlreadyBeenRendered=!0}}}h.circleDefaultOptions={plane:"XY",x:0,y:0,z:0,radius:.5,segments:96},h.grid2DefaultOptions={plane:"XY",x:0,y:0,z:0,size:8,width:void 0,height:void 0,subdivisions:void 0,widthSubdivisions:void 0,heightSubdivisions:void 0}},48647:(e,t,n)=>{"use strict";n.d(t,{I0:()=>r,Tj:()=>i});let i={yellow:"#ffcc00",blue:"#00ccff",magenta:"#cc00ff",paleGreen:"#00ffcc",vibrantBlue:"#1c55ff",pink:"#ffccff",white:"#ffffff"},r=Object.values(i)},53281:(e,t,n)=>{"use strict";n.d(t,{PageClient:()=>h});var i=n(70691),r=n(67203),s=n(24223),o=n(99332),a=n(18479),l=n(31623),c=n(71936),d=n(36508),u=n(21984);function h(){let e=(0,r.useMemo)(()=>(function(){let{historySize:e=100}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new c.k({name:"X",historySize:e,derivativeCount:2});for(let n=0;n<2*e;n++){let i=2*Math.PI/(e-1),r=n*i;t.push(Math.sin(r),i)}let n=new c.k({name:"power-2",historySize:e,derivativeCount:2});for(let t=0;t<2*e;t++){let i=1/(2*e),r=(t*i-.5)*4;n.push(Math.pow(r,2),4*i)}let i=new c.k({name:"wheel",historySize:e,derivativeCount:2}),r=new c.k({name:"pointerY",historySize:e,derivativeCount:0});return{sinVar:t,powVar:n,wheelVar:i,pointerXVar:new c.k({name:"pointerX",historySize:e,derivativeCount:0}),pointerYVar:r}})({historySize:200}),[]),t=(0,l.A)(),{ref:n}=(0,a.useEffects)(function*(n){let i=0,r=0,a={x:0,y:0};yield(0,o.s)(n,{onChange:e=>{a.x=e.position.x,a.y=e.position.y},onWheel:e=>{i+=e.delta.y}}),yield(0,s.O)(d.Rv.current().requestActivation),yield(0,d.xy)(n=>{r+=i,i=0,e.wheelVar.push(r,n.deltaTime),e.pointerXVar.push(a.x,n.deltaTime),e.pointerYVar.push(a.y,n.deltaTime),t()})},[]);return(0,i.jsxs)("div",{ref:n,className:"p-16 flex flex-col gap-8 overflow-y-auto h-screen",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold",children:"Variable Demo Page"}),(0,i.jsx)("p",{className:"max-w-prose",children:"Float32Variable is a time-series variable that keeps a history of pushed values, and can compute derivatives. Click on the graphs to toggle Y range auto-adjustment."}),(0,i.jsxs)("div",{className:"flex flex-row flex-wrap gap-2",children:[(0,i.jsx)(u.T,{variable:e.sinVar,yRange:[-1.5,1.5]}),(0,i.jsx)(u.T,{variable:e.powVar,yRange:[0,4],height:400}),(0,i.jsx)(u.T,{variable:e.wheelVar,height:400,yRange:[-8e3,8e3]}),(0,i.jsx)(u.T,{variable:[e.pointerXVar,e.pointerYVar],height:400,yRange:[0,Math.max(window.innerWidth,window.innerHeight)]})]})]})}},54167:e=>{e.exports={FlexibleLayout:"flexible-layout_FlexibleLayout__yX36z",Container:"flexible-layout_Container__m1z5G"}},54956:e=>{e.exports={ShaderXplr:"style_ShaderXplr__ui5Wo",Selectors:"style_Selectors__q_Gtx",Include:"style_Include__P24wx",Hover:"style_Hover__KfJWT",Base:"style_Base___m7UK",Dim:"style_Dim__SFNyL",BaseContentWrapper:"style_BaseContentWrapper__nBKWd",OverlayContentWrapper:"style_OverlayContentWrapper___G7Tu",IncludeHighlight:"style_IncludeHighlight__2NZpu",Overlay:"style_Overlay__33OtX",TitleBar:"style_TitleBar__vfcXx"}},55227:(e,t,n)=>{"use strict";n.d(t,{M:()=>o});var i=n(22899),r=n(1029);let s="\n\nstruct FloatRamp {\n  float a;\n  float b;\n  float t;\n};\n\nstruct Vec2Ramp {\n  vec2 a;\n  vec2 b;\n  float t;\n};\n\nstruct Vec3Ramp {\n  vec3 a;\n  vec3 b;\n  float t;\n};\n\nstruct Vec4Ramp {\n  vec4 a;\n  vec4 b;\n  float t;\n};\n\n".concat((0,r.N)("vecX",e=>{let t=e[0].toUpperCase()+e.slice(1)+"Ramp";return"\n\n// 1 stop (simple linear interpolation)\n".concat(t," ramp(float t, T a, T b) {\n  return ").concat(t,"(a, b, t);\n}\n\n// 2 stops\n").concat(t," ramp(float t, T a, T b, T c) {\n  if (t < 0.5) {\n    return ").concat(t,"(a, b, t * 2.0);\n  } else {\n    return ").concat(t,"(b, c, t * 2.0 - 1.0);\n  }\n}\n\n// 4 stops\n").concat(t," ramp(float t, T a, T b, T c, T d) {\n  if (t < 0.333) {\n    return ").concat(t,"(a, b, t * 3.0);\n  } else if (t < 0.666) {\n    return ").concat(t,"(b, c, t * 3.0 - 1.0);\n  } else {\n    return ").concat(t,"(c, d, t * 3.0 - 2.0);\n  }\n}\n\n// 5 stops\n").concat(t," ramp(float t, T a, T b, T c, T d, T e) {\n  if (t < 0.25) {\n    return ").concat(t,"(a, b, t * 4.0);\n  } else if (t < 0.5) {\n    return ").concat(t,"(b, c, t * 4.0 - 1.0);\n  } else if (t < 0.75) {\n    return ").concat(t,"(c, d, t * 4.0 - 2.0);\n  } else {\n    return ").concat(t,"(d, e, t * 4.0 - 3.0);\n  }\n}\n\n").slice(1,-1)})),o="\n#ifndef GLSL_RAMP\n#define GLSL_RAMP\n".concat(i.I,"\n").concat(s,"\n#endif\n")},56652:e=>{e.exports={VertigoWidgetClient:"vertigo_VertigoWidgetClient__UIsqY",BgBlur:"vertigo_BgBlur__om6v3"}},56704:(e,t,n)=>{"use strict";n.d(t,{Client:()=>p});var i=n(70691),r=n(49797),s=n(33540),o=n(15931),a=n(16465),l=n(79911),c=n(2218),d=n.n(c);function u(){return(0,s.dB)("my-scene",function*(e){(0,l.mj)(new r.eaF(new r.UPV(1,.5,512,64),new a.Y),e),(0,l.mj)(new o.P({size:8}),e)},[]),null}function h(){return(0,i.jsxs)("div",{className:"layer thru ".concat(d().Client," p-8 flex flex-col gap-1 items-start"),children:[(0,i.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Template-2"}),(0,i.jsx)("button",{className:"btn border rounded px-2 py-1",onClick:()=>{alert("Action")},children:"Action"}),(0,i.jsx)("button",{className:"btn border rounded px-2 py-1",onClick:()=>{alert("Another Action")},children:"Another Action"})]})}function p(){return(0,i.jsxs)(s.uB,{vertigoControls:{size:8},children:[(0,i.jsx)(u,{}),(0,i.jsx)(h,{})]})}},61572:(e,t,n)=>{"use strict";n.d(t,{S:()=>o});var i=n(49797),r=n(13565);let s={...r.q.defaultParams,size:512,viscosity:.98,cellScale:1,damping:.98};class o extends r.q{get viscosity(){return this.updateUniforms.uViscosity.value}set viscosity(e){this.updateUniforms.uViscosity.value=e}get cellScale(){return this.updateUniforms.uCellScale.value}set cellScale(e){this.updateUniforms.uCellScale.value=e}get damping(){return this.updateUniforms.uDamping.value}set damping(e){this.updateUniforms.uDamping.value=e}pointer(e,t,n,i){let{uPointer:r}=this.updateUniforms;r.value.set(e,t,n,i)}constructor(e){super({filter:"linear",...e}),this.shaders({initial:{fragmentColor:"\n          gl_FragColor.rgb = vec3(0.0);\n          gl_FragColor.a = 1.0;\n        "},update:{uniforms:{uViscosity:{value:this.params.viscosity},uCellScale:{value:this.params.cellScale},uDamping:{value:this.params.damping},uPointer:{value:new i.IUQ(.5,.5,.1,1)}},fragmentTop:"\n          vec4 fetch(vec2 uv) {\n            if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {\n              return vec4(0.0);\n            }\n            float margin = 0.2;\n            float edgeDist = min(min(uv.x, 1.0 - uv.x), min(uv.y, 1.0 - uv.y));\n            edgeDist = 1.0 - pow(1.0 - edgeDist, 15.0);\n            float edgeFade = smoothstep(0.0, margin, edgeDist);\n            return texture2D(uTexture, uv) * edgeFade;\n          }\n        ",fragmentColor:"\n          vec2 uv = vUv;\n          float viscosity = uViscosity;\n          vec2 cellSize = uCellScale / uTextureSize;\n\n          vec4 center = fetch(uv);\n          vec4 north = fetch(uv + vec2(0.0, cellSize.y));\n          vec4 south = fetch(uv - vec2(0.0, cellSize.y));\n          vec4 east = fetch(uv + vec2(cellSize.x, 0.0));\n          vec4 west = fetch(uv - vec2(cellSize.x, 0.0));\n\n          // x: previous height\n          // y: penultimate height\n          // z: unused\n          // w: unused\n\n          float newHeight = ((north.x + south.x + east.x + west.x) * 0.5 - center.y) * viscosity;\n\n          // Pointer influence\n          float radius = uPointer.z;\n          float strength = uPointer.w;\n          float dist = distance(uv * uTextureSize, uPointer.xy * uTextureSize) - radius;\n          float cellLength = length(cellSize);\n          float influence = smoothstep(cellLength * 0.5, -cellLength * 0.5, dist);\n          newHeight += influence * strength;\n\n          // Damping\n          newHeight *= uDamping;\n          center.x *= uDamping;\n\n          gl_FragColor = vec4(newHeight, center.x, 0.0, 1.0);\n        "}})}}o.defaultParams=s},61830:(e,t,n)=>{"use strict";n.d(t,{ClientPage:()=>d});var i=n(70691),r=n(24223),s=n(18479),o=n(36508);function a(e){let{name:t="default",progress:n=0,className:r=""}=e;return(0,i.jsxs)("div",{className:"".concat(r," ProgressBar relative w-full h-5 bg-[#fff6] rounded-lg overflow-hidden"),children:[(0,i.jsx)("div",{className:"ProgressBarFill w-1/2 h-full bg-[white]",style:{width:"".concat((100*n).toFixed(2),"%")}}),(0,i.jsx)("div",{className:"absolute inset-0 flex flex-row px-2 text-black text-xs items-center justify-between",children:t})]})}function l(e){let{className:t="",...n}=e;return(0,i.jsx)("button",{className:"text-xs border border-white/20 rounded px-2 py-1 hover:bg-white/10 ".concat(t),...n})}function c(e){let{name:t="default",ticker:n={}}=e,r=o.Rv.get(t).set(n),{ref:c}=(0,s.useEffects)(function*(e){let t=e.querySelector(".TickerInfo"),n=e.querySelector(".InactivityProgress .ProgressBarFill"),i=e.querySelector(".InactivityTimeScale .ProgressBarFill");yield r.onTick(e=>{t.textContent="f: ".concat(e.frame," t: ").concat(e.time.toFixed(2),"s dt: ").concat(e.deltaTime.toFixed(4),"s"),n.style.width="".concat((100*e.inactivityProgress).toFixed(2),"%"),i.style.width="".concat((100*e.inactivityTimeScale).toFixed(2),"%")})},[]);return(0,i.jsxs)("div",{ref:c,className:"w-[280px] p-4 border border-white/20 rounded flex flex-col gap-2",children:[(0,i.jsxs)("h2",{children:["Ticker: ",t]}),(0,i.jsxs)("div",{className:"TickerInfo text-xs font-mono pre",children:["f: ",o.Rv.get(t).frame]}),(0,i.jsx)(a,{className:"InactivityProgress",name:"Inactivity Progress"}),(0,i.jsx)(a,{className:"InactivityTimeScale",name:"Inactivity TimeScale"}),(0,i.jsx)(l,{onClick:()=>{r.requestActivation()},children:"Request Activation"})]})}function d(){return(0,s.useEffects)(function*(){yield(0,r.O)(()=>{o.Rv.get("AnyUserInteraction").requestActivation()})},[]),(0,i.jsxs)("div",{className:"layer thru p-16",children:[(0,i.jsx)("h1",{className:"text-4xl font-bold",children:"Ticker - Basic"}),(0,i.jsx)("p",{className:"mt-4 max-w-md",children:"A simple demonstration of the Ticker utility for managing time-based updates in applications."}),(0,i.jsxs)("div",{className:"flex flex-row flex-wrap items-start gap-4 mt-8",children:[(0,i.jsx)(c,{name:"default"}),(0,i.jsx)(c,{name:"short",ticker:{inactivityWaitDuration:2,inactivityFadeDuration:1}}),(0,i.jsx)(c,{name:"Infinity!",ticker:{inactivityWaitDuration:1/0}}),(0,i.jsx)(c,{name:"AnyUserInteraction"})]})]})}},63046:(e,t,n)=>{"use strict";n.d(t,{PageClient:()=>o});var i=n(70691),r=n(19069),s=n(71323);function o(){return(0,i.jsxs)("div",{className:"FlexLayoutDemo p-16 h-screen overflow-auto",children:[(0,i.jsx)("h1",{className:"text-3xl text-center font-bold",children:"Aspect Size Mode Demo"}),(0,i.jsx)(s.O,{root:new r.$x({offset:[100,100],size:[600,400],padding:10,gap:10}).populate(3,{aspect:1}),title:(0,i.jsxs)("h2",{children:[(0,i.jsx)("pre",{children:"childrenAspectSizeMode: undefined"})," (default)"]})}),(0,i.jsx)(s.O,{root:new r.$x({offset:[100,100],size:[600,400],padding:10,gap:10,childrenAspectSizeMode:"fill-normal-space"}).populate(3,{aspect:1}),title:(0,i.jsx)("h2",{children:(0,i.jsx)("pre",{children:'childrenAspectSizeMode: "fill-normal-space"'})})}),(0,i.jsx)(s.O,{root:new r.$x({offset:[100,100],size:[600,400],padding:10,gap:10,childrenAspectSizeMode:"fill-tangent-space"}).populate(3,{aspect:1}),title:(0,i.jsx)("h2",{children:(0,i.jsx)("pre",{children:'childrenAspectSizeMode: "fill-tangent-space"'})})}),(0,i.jsx)(s.O,{root:new r.$x({offset:[100,100],size:[600,400],padding:10,gap:10,childrenAspectSizeMode:"fill-tangent-space"}).add(new r.$x({aspect:1}),new r.$x({aspect:1,sizeX:"2fr"}),new r.$x({aspect:1})),title:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h2",{children:(0,i.jsx)("pre",{children:'"fill-tangent-space"'})}),(0,i.jsx)("div",{children:(0,i.jsx)("strong",{className:"warning",children:"⚠️ Expect breaking changes in future versions"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:'❌ Edge case: The middle child has sizeX="2fr"'}),(0,i.jsxs)("ul",{className:"pl-8 list-disc",children:[(0,i.jsx)("li",{children:"✅ Other proportions are ok"}),(0,i.jsx)("li",{children:"⚠️ but overflow occurs in X direction."})]})]})]})}),(0,i.jsx)(s.O,{root:new r.$x({offset:[100,100],size:[600,400],padding:10,gap:10,childrenAspectSizeMode:"fill-tangent-space"}).add(new r.$x({aspect:1}),new r.$x({aspect:1}),new r.$x({aspect:1,selfAspectSizeMode:"fill-normal-space"})),title:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h2",{children:(0,i.jsx)("pre",{children:'"fill-tangent-space"'})}),(0,i.jsx)("div",{children:(0,i.jsx)("strong",{className:"warning",children:"⚠️ Expect breaking changes in future versions"})}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("h3",{children:["❌ Edge case: The last child has ",(0,i.jsx)("pre",{children:'selfAspectSizeMode="fill-normal-space"'})]}),(0,i.jsxs)("ul",{className:"pl-8 list-disc",children:[(0,i.jsx)("li",{children:"✅ Other proportions are ok"}),(0,i.jsx)("li",{children:"⚠️ but overflow occurs in X direction."})]})]})]})})]})}n(14043)},63106:(e,t,n)=>{"use strict";function i(e,t){return"*"===t||("string"==typeof t?t===e:t instanceof RegExp?t.test(e):"function"==typeof t&&t(e))}n.d(t,{a:()=>a});let r={preventDefault:!1,strictTarget:void 0},s={key:"*",keyCaseInsensitive:!0,code:"*",noModifiers:!1,modifiers:"",phase:"down"},o=0;function a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let a=o++,[l,c,d]=1===t.length?[document.body,{},t[0]]:2===t.length?[t[0],{},t[1]]:t,{preventDefault:u}={...r,...c},h=null,p=e=>{var t;if((null!=(t=c.strictTarget)?!!t:l===document.body)&&e.target!==l)return;"keydown"===e.type&&(h=e);let{ctrlKey:n=!1,altKey:r=!1,shiftKey:o=!1,metaKey:p=!1}=null!=h?h:{},f={id:a,event:e,downEvent:h,modifiers:{ctrl:n,alt:r,shift:o,meta:p}};for(let t=0,a=d.length;t<a;t++){let[a,l]=d[t],{key:c,keyCaseInsensitive:x,code:m,noModifiers:v,modifiers:g,phase:w="down"}=function(e){let t="string"==typeof e?{...s,key:e}:{...s,...e};return t.keyCaseInsensitive&&"string"==typeof t.key&&(t.key=t.key.toLowerCase()),t}(a);switch(e.type){case"keydown":if("down"!==w)continue;break;case"keyup":if("up"!==w)continue}Object.values({key:i(x?e.key.toLowerCase():e.key,c),code:i(e.code,m),noModifiers:!v||!1===n&&!1===r&&!1===o&&!1===p,modifiers:function(e,t){let{ctrlKey:n,altKey:i,shiftKey:r,metaKey:s}=e;if("function"==typeof t)return t({ctrl:n,alt:i,shift:r,meta:s});let{ctrl:o=!1,alt:a=!1,shift:l=!1,meta:c=!1}=Object.fromEntries(t.split("-").map(e=>[e,!0]));return o===n&&a===i&&l===r&&c===s}(h,g)}).every(Boolean)&&(u&&e.preventDefault(),l(f))}};return l.addEventListener("keydown",p,{passive:!1}),l.addEventListener("keyup",p,{passive:!1}),{destroy:()=>{l.removeEventListener("keydown",p),l.removeEventListener("keyup",p)}}}},63201:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,89294,23)),Promise.resolve().then(n.bind(n,14137)),Promise.resolve().then(n.bind(n,6688)),Promise.resolve().then(n.bind(n,25710)),Promise.resolve().then(n.bind(n,71555)),Promise.resolve().then(n.bind(n,33925)),Promise.resolve().then(n.bind(n,3261)),Promise.resolve().then(n.bind(n,68551)),Promise.resolve().then(n.bind(n,63046)),Promise.resolve().then(n.bind(n,86946)),Promise.resolve().then(n.bind(n,158)),Promise.resolve().then(n.bind(n,74279)),Promise.resolve().then(n.bind(n,35484)),Promise.resolve().then(n.bind(n,34242)),Promise.resolve().then(n.bind(n,86543)),Promise.resolve().then(n.bind(n,79299)),Promise.resolve().then(n.bind(n,71796)),Promise.resolve().then(n.bind(n,56704)),Promise.resolve().then(n.bind(n,33583)),Promise.resolve().then(n.bind(n,18140)),Promise.resolve().then(n.bind(n,84469)),Promise.resolve().then(n.bind(n,70643)),Promise.resolve().then(n.bind(n,40643)),Promise.resolve().then(n.bind(n,61830)),Promise.resolve().then(n.bind(n,42220)),Promise.resolve().then(n.bind(n,53281)),Promise.resolve().then(n.bind(n,17490)),Promise.resolve().then(n.bind(n,84822)),Promise.resolve().then(n.bind(n,99656)),Promise.resolve().then(n.bind(n,14005)),Promise.resolve().then(n.bind(n,15774)),Promise.resolve().then(n.bind(n,65897)),Promise.resolve().then(n.bind(n,13982)),Promise.resolve().then(n.bind(n,18653))},65897:(e,t,n)=>{"use strict";n.d(t,{Client:()=>d});var i=n(70691),r=n(49797),s=n(61098),o=n(16465),a=n(79911),l=n(16008);function c(){return(0,s.yk)(function*(e){(0,a.mj)(new r.eaF(new r.WBB(1,0),new o.Y),{parent:e.scene,x:-4}),(0,a.mj)(new l.XI,{parent:e.scene})},[]),null}function d(){return(0,i.jsx)(s.uB,{children:(0,i.jsxs)(s.zz,{children:[(0,i.jsx)("div",{className:"layer thru p-4",children:(0,i.jsx)("h1",{children:"Vertigo Widget"})}),(0,i.jsx)(c,{})]})})}},65927:(e,t,n)=>{"use strict";n.d(t,{S:()=>i});let i="\n#ifndef GLSL_BASIC\n#define GLSL_BASIC\n\nfloat clamp01(float x) {\n  return x < 0.0 ? 0.0 : x > 1.0 ? 1.0 : x;\n}\n\nvec2 clamp01(vec2 x) {\n  return vec2(clamp01(x.x), clamp01(x.y));\n}\n\nvec3 clamp01(vec3 x) {\n  return vec3(clamp01(x.x), clamp01(x.y), clamp01(x.z));\n}\n\nvec4 clamp01(vec4 x) {\n  return vec4(clamp01(x.x), clamp01(x.y), clamp01(x.z), clamp01(x.w));\n}\n\n#endif\n"},68571:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});let i=(0,n(67203).createContext)(null)},69965:e=>{e.exports={Copyable:"Copyable_Copyable__KjEYk",Overlay:"Copyable_Overlay__CzDNx"}},70261:e=>{e.exports={IconButton:"IconButton_IconButton__QPZgi"}},70643:(e,t,n)=>{"use strict";n.d(t,{PageClient:()=>d});var i=n(70691),r=n(49797),s=n(33540),o=n(15931),a=n(16465),l=n(79911);function c(){return(0,s.dB)("my-scene",function*(e){(0,l.mj)(new r.eaF(new r.UPV,new a.Y),e),(0,l.mj)(new o.P,e)}),null}function d(){return(0,i.jsxs)(s.uB,{vertigoControls:{rotation:"10deg, 30deg, 20deg"},children:[(0,i.jsxs)("div",{className:"PageClient p-16",children:[(0,i.jsx)("h1",{className:"mb-4 text-3xl font-bold",children:"Free Vertigo!"}),(0,i.jsx)("p",{children:'Press [alt + Tab] to enable the "free" vertigo control mode.'})]}),(0,i.jsx)(c,{})]})}},71323:(e,t,n)=>{"use strict";n.d(t,{O:()=>c});var i=n(70691),r=n(18479),s=n(24223),o=n(19069),a=n(36508),l=n(48647);function c(e){let{root:t,size:n=[800,600],title:c,description:d,directionArrow:u,computeLayout:h=e=>e.computeLayout(),colorRule:p=e=>l.I0[e.depth()%l.I0.length],onStart:f,tickDisabled:x=!1,onTick:m}=e,{ref:v}=(0,r.useEffects)(function*(e){let[i,r]=n,l=function(e){let{width:t=800,height:n=600,scale:i=.75}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.querySelector("canvas"),s=window.devicePixelRatio;r.width=t*s,r.height=n*s,r.style.width="".concat(t*i,"px"),r.style.height="".concat(n*i,"px"),r.style.border="1px solid #444";let a=r.getContext("2d");a.scale(s,s);let l=function(e){var t;let{x:n=0,y:i=0,width:r=1,height:s=1}=e,{arrow:l,stroke:d,lineWidth:u,fill:h}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a.fillStyle=null!=(t=null!=d?d:h)?t:"",a.beginPath(),a.arc(n,i,3,0,2*Math.PI),a.fill(),(r>0||s>0)&&(a.strokeStyle=null!=d?d:"",a.lineWidth=null!=u?u:2,a.fillStyle=null!=h?h:"",a.beginPath(),a.rect(n,i,r,s),h&&a.fill(),d&&a.stroke(),l&&c(l===o.OP.Horizontal,{x:n,y:i,width:r,height:s})),a.globalCompositeOperation="destination-over"},c=(e,t)=>{let{x:n=0,y:i=0,width:r=1,height:s=1}=t;if(e){let e=n+r-5,t=i+s/2;a.beginPath(),a.moveTo(e-8,t-8),a.lineTo(e,t),a.lineTo(e-8,t+8),a.stroke()}else{let e=n+r/2,t=i+s-5;a.beginPath(),a.moveTo(e-8,t-8),a.lineTo(e,t),a.lineTo(e+8,t-8),a.stroke()}};return{canvas:r,ctx:a,ctxSpace:(e,t)=>{var n,i;l(e.rect,t),a.font="16px sans-serif",a.textBaseline="top",a.fillStyle=null!=(i=null!=(n=null==t?void 0:t.stroke)?n:null==t?void 0:t.fill)?i:"red",null!==e.aspect&&a.fillText("A",e.rect.x+4,e.rect.y+4)},ctxClear:()=>{a.clearRect(0,0,t,n)},ctxRect:l}}(e,{width:i,height:r}),c=Array.isArray(t)?t:[t],d=()=>{for(let t of(l.ctxClear(),c))for(let n of(h(t),t.allDescendants({includeSelf:!0}))){var e;if(!1===n.enabled)continue;let t=null!=(e=n.userData.color)?e:p(n),i=u?n.direction:void 0;l.ctxSpace(n,{stroke:t,arrow:i})}};d(),null==f||f(c),m&&!x&&(yield(0,s.O)(a.Rv.get("three").set({inactivityWaitDurationMinimum:20}).requestActivation),yield(0,a.xy)("three",e=>{m(c,e),d()}))},"always");return(0,i.jsxs)("div",{ref:v,className:"flex flex-col items-center mt-32",children:[(0,i.jsx)("div",{children:(0,i.jsx)("canvas",{})}),(0,i.jsx)("div",{className:"mt-4 flex flex-col items-center gap-2",children:c}),d&&(0,i.jsx)("div",{className:"text-sm opacity-70 text-center",children:d})]})}},71555:(e,t,n)=>{"use strict";n.d(t,{PageClient:()=>p});var i=n(70691),r=n(49797),s=n(99332),o=n(33540),a=n(13565);class l extends a.q{constructor(e){super(e),this.enableGlslLib("glsl_utils"),this.shaders({initial:{fragmentColor:"\n          vec2 uv = vUv;\n          float r = step(0.9, hash(uv));\n          float g = step(0.9, hash(uv + vec2(1.0, 0.0)));\n          float b = step(0.9, hash(uv + vec2(0.0, 1.0)));\n          gl_FragColor = vec4(r, g, b, 1.0);\n        "},update:{fragmentTop:"\n          // Conway's Game of Life rules\n          float gameOfLife(float current, float sum) {\n            if (current > 0.5) {\n              if (sum < 1.5 || sum > 3.5) {\n                return 0.0; // Cell dies\n              } else {\n                return 1.0; // Cell lives\n              }\n            } else {\n              if (sum == 3.0) {\n                return 1.0; // Cell becomes alive\n              }\n            }\n            return current;\n          }\n          ",fragmentColor:'\n          vec2 uv = vUv;\n          vec2 uv0 = uv + vec2(0.0, 1.0) / uTextureSize;\n          vec2 uv1 = uv + vec2(1.0, 1.0) / uTextureSize;\n          vec2 uv2 = uv + vec2(1.0, 0.0) / uTextureSize;\n          vec2 uv3 = uv + vec2(1.0, -1.0) / uTextureSize;\n          vec2 uv4 = uv + vec2(0.0, -1.0) / uTextureSize;\n          vec2 uv5 = uv + vec2(-1.0, -1.0) / uTextureSize;\n          vec2 uv6 = uv + vec2(-1.0, 0.0) / uTextureSize;\n          vec2 uv7 = uv + vec2(-1.0, 1.0) / uTextureSize;\n          vec3 sum =\n            texture2D(uTexture, uv0).rgb +\n            texture2D(uTexture, uv1).rgb +\n            texture2D(uTexture, uv2).rgb +\n            texture2D(uTexture, uv3).rgb +\n            texture2D(uTexture, uv4).rgb +\n            texture2D(uTexture, uv5).rgb +\n            texture2D(uTexture, uv6).rgb +\n            texture2D(uTexture, uv7).rgb;\n    \n          vec3 current = texture2D(uTexture, uv).rgb;\n          vec3 next = vec3(\n            gameOfLife(current.r, sum.r),\n            gameOfLife(current.g, sum.g),\n            gameOfLife(current.b, sum.b));\n          \n          // Add some random "glitches" based on time and position\n          vec3 uvt = vec3(uv, uTime);\n          vec3 extra = vec3(\n            step(0.995, hash(uvt.xyz)), \n            step(0.995, hash(uvt.yzx)), \n            step(0.995, hash(uvt.zxy)));\n    \n          gl_FragColor.rgb = max(next, extra);\n        '}})}}var c=n(77794),d=n(79911),u=n(36508);function h(){let e=(0,o.Fw)();return(0,o.dB)("my-scene",function*(t){e.pipeline.basicPasses.fxaa.enabled=!1;let n=(0,d.mj)(new r.eaF(new r.bdM,new r.V9B),t);n.scale.setScalar(10),(0,d.mj)(new c.u,t).regularGrid({size:10,subdivisions:[2,5],opacity:[1,.25]}).onTop();let i=new l({size:256}).initialize(e.renderer),o=!0;yield(0,u.xy)("three",{timeInterval:.1},e=>{n.material.map=i.currentTexture(),n.material.needsUpdate=!0,o&&i.update(e.deltaTime)}),yield(0,s.s)(document.body,{onTap:()=>{o=!o}})},[]),null}function p(){return(0,i.jsxs)(o.uB,{vertigoControls:{size:9,frame:"cover",eventTarget:"canvas"},children:[(0,i.jsx)("div",{className:"layer thru flex flex-col p-12",children:(0,i.jsx)("h1",{className:"text-4xl font-bold",children:"GPU Compute - Game of Life Demo"})}),(0,i.jsx)(h,{})]})}},71796:(e,t,n)=>{"use strict";n.d(t,{ClientPage:()=>f});var i=n(70691),r=n(49797),s=n(33540),o=n(94065),a=n(34011),l=n(77794),c=n(16465),d=n(45553),u=n(79911),h=n(72612);function p(){let e=(0,s.Fw)();return(0,s.dB)("slerp-scene",function*(t){e.pipeline.basicPasses.fxaa.enabled=!1;let n=(0,u.mj)(new l.u,t).regularGrid(),i=(()=>{let e=new r.Pq0,n=new r.Pq0,i=new r.kn4,s=new r.Pq0,l=new r.Pq0,d=new r.Pq0;return function(h,p){let{useBasis:f=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,o.jj)(h,e),(0,o.jj)(p,n),s.copy(n).normalize(),l.set(-s.y,s.x,s.z),d.crossVectors(s,l).normalize(),i.makeBasis(s,l,d).setPosition(e);let x=n.length(),m=f?new a.k({length:x}).applyMatrix4(i):new a.e({axis:"x",length:x}).applyMatrix4(i),v=new c.Y({vertexColors:!0});return(0,u.mj)(new r.eaF(m,v),t)}})(),s=new r.Pq0,p=new r.Pq0,f=new r.Pq0,x=new r.Pq0,m={color:"white",offset:[0,-.25,0]};for(let e of(s.set(-2,0,0),f.set(1,1,0),x.set(-1,1,0),n.text(s,"lerp",m),(0,h.loop)(10)))i(s,p.lerpVectors(f,x,e.p));for(let e of(s.set(0,0,0),f.set(1,1,0),x.set(-1,1,0),n.text(s,"slerp",m),(0,h.loop)(10)))i(s,(0,d.z)(f,x,e.p,p));for(let e of(s.set(3,0,0),f.set(.5,.5,.5),x.set(-1,3,-1),n.text(s,"slerp",m),n.box({min:s,max:s.clone().add(f)}),n.box({min:s.clone().add(x),max:s}),(0,h.loop)(10)))i(s,(0,d.z)(f,x,e.p,p));for(let e of(s.set(5,0,0),f.set(1,0,0),x.set(-1,0,0),n.text(s,"slerp 180",m),(0,h.loop)(10)))i(s,(0,d.z)(f,x,e.p,p));for(let e of(s.set(5,-2,0),f.set(.25,1,.5),x.copy(f).negate(),n.text(s,"slerp 180",m),n.box({min:s,max:s.clone().add(f)}),n.box({min:s.clone().add(x),max:s}),(0,h.loop)(10)))i(s,(0,d.z)(f,x,e.p,p))},[]),null}function f(){return(0,i.jsx)(s.uB,{vertigoControls:{size:10},children:(0,i.jsx)(p,{})})}},71936:(e,t,n)=>{"use strict";n.d(t,{k:()=>r});let i={name:"unnamed",initialValue:0,historySize:100,derivativeCount:0};class r{get name(){return this.props.name}get count(){return this.state.count}get actualCount(){return Math.min(this.state.count,this.props.historySize)}reset(e){var t;return this.state.index=0,this.state.count=1,this.historyNumber.fill(e),null==(t=this.derivative)||t.reset(0),this}push(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(n<=0)return console.warn("deltaTime must be positive. Ignoring push."),this;let{historySize:i}=this.props,{index:r}=this.state;return this.historyNumber[r]=e,this.state.index=(r+1)%i,this.state.count++,null==(t=this.derivative)||t.push((e-this.get(1))/n,n),this}createHistory(e){let{historySize:t}=this.props;this.reset(e(-1/(t-1)));for(let n=0;n<t;n++){let i=n/(t-1);this.push(e(i),1/(t-1))}return this}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,{historySize:t}=this.props;e<0&&(e=0),e>=t&&(e=t-1);let n=this.state.index-1-e;return n<0&&(n+=t),this.historyNumber[n]}linearSample(e){let t=e-Math.floor(e),n=Math.floor(e);return this.get(n)*(1-t)+this.get(n+1)*t}linearSamples(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=Array(e);for(let n=0;n<e;n++){let i=n/(e-1);t[n]=this.linearSample(i*(this.props.historySize-1))}return t}gaussianSmoothSample(e){let{stdDev:t=1,sampleCount:n=10,sampleHistoryWidth:i=.1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i*this.props.historySize*.5,s=0,o=0;for(let i=0;i<n;i++){let a=r*(i/(n-1)*2-1),l=e-a,c=this.linearSample(l),d=Math.exp(-(a*a*.5)/(t*t));s+=c*d,o+=d}return s/o}gaussianSmoothSamples(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1?arguments[1]:void 0,n=Array(e);for(let i=0;i<e;i++){let r=i/(e-1);n[i]=this.gaussianSmoothSample(r*(this.props.historySize-1),t)}return n}*history(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.historySize,{wrapMode:t="end"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{historySize:n}=this.props,{count:i}=this.state;e=Math.min(e,n);for(let n=0;n<e&&(!(n>=i)||"end"!==t);n++)yield this.get(n)}historyInfo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.historySize,{wrapMode:t="end"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=1/0,i=-1/0,r=0,s=0;for(let o of this.history(e,{wrapMode:t}))s++,r+=o,o<n&&(n=o),o>i&&(i=o);return{actualCount:s,min:n,max:i,sum:r,average:r/s}}toSvgPathData(){let{offsetX:e=0,offsetY:t=0,width:n=100,height:i=100,yRange:r="auto"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[s,o]=(()=>{if("auto"===r){let e=this.historyInfo();return[e.min,e.max]}return r})();if(0==o-s)return"";let{historySize:a}=this.props,{count:l}=this.state,c=Math.min(a,l);if(c<2)return"";let d=e=>e.toFixed(2).replace(/\.?0+$/,""),u=[];for(let r=0;r<c;r++){let a=r/(c-1),l=(this.get(c-1-r)-s)/(o-s),h=e+a*n,p=t+(1-l)*i,f=0===r?"M":"L";isNaN(p)||isFinite(p),u.push("".concat(f).concat(d(h),",").concat(d(p)))}return u.join(" ")}constructor(e,t){var n,s;this.state={index:0,count:1},this.derivative=null,this.antiderivative=null;let o=null!=(s=null!=(n=null==e?void 0:e.name)?n:(null==t?void 0:t.props.name)&&"".concat(t.props.name,"'"))?s:"unnamed";if(this.props={...i,...e,name:o},this.props.historySize<1)throw Error("historySize must be at least 1");this.historyNumber=new Float32Array(this.props.historySize),this.reset(this.props.initialValue),this.props.derivativeCount>0&&(this.derivative=new r({historySize:this.props.historySize,derivativeCount:this.props.derivativeCount-1},this))}}},71978:(e,t,n)=>{"use strict";n.d(t,{Q:()=>r});var i=n(67203);function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",[t,n]=(0,i.useState)(e);return(0,i.useEffect)(()=>{n(window.location.hash)},[]),[t,function(e){console.log("setHash",{newHash:e}),window.location.hash=null!=e?e:"",window.history.replaceState(null,"",null!=e?e:""),n(null!=e?e:"")}]}},72612:(e,t,n)=>{"use strict";function*i(e){let t=0,n={get i(){return t},get t(){return t/e},get p(){return t/(e-1)},get size(){return e},clone(){return{...this}}};for(t=0;t<e;t++)yield n}function r(e,t){let n=[];for(let r of i(e)){let e=r.clone();n.push(t?t(e):e)}return n}function*s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let i=0,r=0;2===t.length?(i=t[0],r=t[1]):Array.isArray(t[0])?(i=t[0][0],r=t[0][1]):(i=t[0].x,r=t[0].y);let s=0,o=0,a=0,l={get i(){return s},get x(){return o},get y(){return a},get tx(){return o/i},get ty(){return a/r},get px(){return o/(i-1)},get py(){return a/(r-1)},get sizeX(){return i},get sizeY(){return r},clone(){return{...this}}};for(a=0;a<r;a++)for(o=0;o<i;o++)yield l,s++}function o(){let e;for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];let r=0,o=0;"number"==typeof n[0]?(r=n[0],o=n[1],e=n[2]):(Array.isArray(n[0])?(r=n[0][0],o=n[0][1]):(r=n[0].x,o=n[0].y),e=n[1]);let a=[];for(let t of s(r,o)){let n=t.clone();a.push(e?e(n):n)}return a}function*a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let i=0,r=0,s=0;3===t.length?(i=t[0],r=t[1],s=t[2]):Array.isArray(t[0])?(i=t[0][0],r=t[0][1],s=t[0][2]):(i=t[0].x,r=t[0].y,s=t[0].z);let o=0,a=0,l=0,c=0,d={get i(){return o},get x(){return a},get y(){return l},get z(){return c},get tx(){return a/i},get ty(){return l/r},get tz(){return c/s},get px(){return a/(i-1)},get py(){return l/(r-1)},get pz(){return c/(s-1)},clone(){return{...this}}};for(c=0;c<s;c++)for(l=0;l<r;l++)for(a=0;a<i;a++)yield d,o++}function l(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let i=[];for(let e of a(...t))i.push(e.clone());return i}n.r(t),n.d(t,{loop:()=>i,loop2:()=>s,loop2Array:()=>o,loop3:()=>a,loop3Array:()=>l,loopArray:()=>r})},73446:(e,t,n)=>{"use strict";n.d(t,{x:()=>r});var i=n(1029);let r="\n#ifndef BLENDING\n#define BLENDING\n\n".concat((0,i.N)("vecX","\n  T multiplyBlending(in T a, in T b) {\n    return a * b;\n  }\n"),"\n\n").concat((0,i.N)("vecX","\n  T screenBlending(in T a, in T b) {\n    return 1.0 - (1.0 - a) * (1.0 - b);\n  }\n"),"\n\nfloat overlayBlending(in float a, in float b) {\n  return a < 0.5 ? (2.0 * a * b) : (1.0 - 2.0 * (1.0 - a) * (1.0 - b));\n}\n\nvec2 overlayBlending(in vec2 a, in vec2 b) {\n  return vec2(\n    overlayBlending(a.x, b.x),\n    overlayBlending(a.y, b.y));\n}\n\nvec3 overlayBlending(in vec3 a, in vec3 b) {\n  return vec3(\n    overlayBlending(a.x, b.x),\n    overlayBlending(a.y, b.y),\n    overlayBlending(a.z, b.z));\n}\n\nvec4 overlayBlending(in vec4 a, in vec4 b) {\n  return vec4(\n    overlayBlending(a.x, b.x),\n    overlayBlending(a.y, b.y),\n    overlayBlending(a.z, b.z),\n    overlayBlending(a.w, b.w));\n}\n\n").concat((0,i.N)("vecX","\n  T darkenBlending(in T a, in T b) {\n    return max(a, b);\n  }\n"),"\n\n").concat((0,i.N)("vecX","\n  T lightenBlending(in T a, in T b) {\n    return max(a, b);\n  }\n"),"\n\n").concat((0,i.N)("vecX","\n  T differenceBlending(in T a, in T b) {\n    return abs(a - b);\n  }\n"),"\n\n#endif\n")},74279:(e,t,n)=>{"use strict";n.d(t,{PageClient:()=>P});var i=n(70691),r=n(24223),s=n(18479),o=n(36508),a=n(19069),l=n(48647);function c(){let{ref:e}=(0,s.useEffects)(function*(e){let t=e.querySelector("canvas"),n=new a.$x({direction:a.OP.Horizontal,offset:[100,100],size:[600,400],padding:10,gap:10,userData:{color:l.Tj.yellow}});n.add(new a.$x({direction:a.OP.Vertical,size:[".25rel","1rel"],spacing:10,userData:{color:l.Tj.vibrantBlue}}),new a.$x({direction:a.OP.Vertical,size:[".25rel","1rel"],spacing:10,userData:{color:l.Tj.vibrantBlue}}),new a.$x({direction:a.OP.Vertical,size:[".25rel","1rel"],spacing:10,userData:{color:l.Tj.vibrantBlue}}));for(let e=0;e<3;e++)n.get(0).add(new a.$x({size:"".concat(e+1,"fr"),spacing:10,userData:{color:l.Tj.paleGreen}}));n.computeLayout();let i=window.devicePixelRatio;t.width=800*i,t.height=600*i,t.style.width="800px",t.style.height="600px";let r=t.getContext("2d");for(let e of n.allDescendants({includeSelf:!0})){var s;r.lineWidth=2*i,r.strokeStyle=null!=(s=e.userData.color)?s:"#fff",r.strokeRect(...e.rect.tupple(i))}},[]);return(0,i.jsxs)("div",{ref:e,className:"flex flex-col justify-center gap-4",style:{flex:"0 0 800px"},children:[(0,i.jsx)("canvas",{style:{border:"solid 2px #fff1"}}),(0,i.jsx)("div",{className:"text-center"})]})}var d=n(35477);function u(){let e=[10,30,90,0],t=[10,80],{ref:n}=(0,s.useEffects)(function*(n){let i=new d.Q(n.querySelector("canvas")),r=new a.$x({direction:a.OP.Horizontal,size:[i.width,i.height],spacing:10,alignChildren:1}).add(new a.$x({userData:{color:l.Tj.yellow}}).add(new a.$x({margin:e,userData:{color:l.Tj.yellow}}).add(new a.$x({margin:e,userData:{color:l.Tj.yellow}}).add(new a.$x({margin:e,userData:{color:l.Tj.yellow}}).add(new a.$x({margin:e,userData:{color:l.Tj.yellow}}).add(new a.$x({margin:e,userData:{color:l.Tj.yellow}})))))),new a.$x({userData:{color:l.Tj.paleGreen}}).add(new a.$x({margin:t,userData:{color:l.Tj.paleGreen}})),new a.$x({padding:10,userData:{color:l.Tj.magenta}}).add(new a.$x({margin:[0,60],marginRight:0,userData:{color:l.Tj.magenta}}),new a.$x({margin:[0,60],marginLeft:0,userData:{color:l.Tj.magenta}})));yield(0,o.xy)("layout",e=>{var t;null==(t=r.get(2))||t.set({padding:10+40*e.sin01Time({frequency:.2})}),i.paint(r)})},[]);return(0,i.jsxs)("div",{ref:n,className:"flex flex-col justify-center gap-4",style:{flex:"0 0 800px"},children:[(0,i.jsx)("canvas",{style:{border:"solid 2px #fff1"}}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("h1",{children:"css-like margins:"}),(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{style:{color:l.Tj.yellow},children:["4 values (",e.join(", "),") (top, right, bottom, left)"]}),(0,i.jsxs)("li",{style:{color:l.Tj.paleGreen},children:["2 values (",t.join(", "),") (vertical, horizontal)"]}),(0,i.jsxs)("li",{style:{color:l.Tj.magenta},children:["specific overrides: ",(0,i.jsx)("code",{children:"marginLeft"}),' overrides "2 values" declaration']})]})]})]})}var h=n(56905);function p(){let e=e=>{switch(e){case 40:return l.Tj.magenta;case 120:return l.Tj.paleGreen;default:return l.Tj.yellow}},{ref:t}=(0,s.useEffects)(function*(t){var n,i;let r=new d.Q(t.querySelector("canvas"));function s(t){return{userData:{color:e(t)},margin:t}}let o=new a.$x({direction:a.OP.Horizontal,size:[r.width,r.height],spacing:10,alignChildren:1}).add(new a.$x({spacing:10,userData:{color:"#fff2"}}).add(new a.$x({...s(0)}),new a.$x({...s(0)}),new a.$x({...s(40)}),new a.$x({...s(40)}),new a.$x({...s(120)}),new a.$x({...s(0)})));null==(n=o.get(0,2))||n.add(new a.$x({positioning:h.EU.Detached,alignSelf:0,size:[38,38],offset:[-39,-39],userData:{color:"#fff2",plain:!0}})),null==(i=o.get(0,4))||i.add(new a.$x({positioning:h.EU.Detached,alignSelf:0,size:[118,118],offset:[-119,-119],userData:{color:"#fff2",plain:!0}})),r.paint(o)},[]);return(0,i.jsxs)("div",{ref:t,className:"flex flex-col justify-center gap-4",style:{flex:"0 0 800px"},children:[(0,i.jsx)("canvas",{style:{border:"solid 2px #fff1"}}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("p",{children:'Margins "collapse" when they are adjacent to each other or to the edge (padding) of the container.'}),(0,i.jsx)("p",{style:{color:e(0)},children:"margin: 0"}),(0,i.jsx)("p",{style:{color:e(40)},children:"margin: 40"}),(0,i.jsx)("p",{style:{color:e(120)},children:"margin: 120"})]})]})}var f=n(67203),x=n(36575),m=n(85795);let v=[{direction:a.OP.Horizontal,aspect:1},{direction:a.OP.Vertical,aspect:2},{direction:a.OP.Vertical,aspect:8},{direction:a.OP.Vertical,aspect:.5},{direction:a.OP.Horizontal,aspect:.5},{direction:a.OP.Horizontal,aspect:1/4}];function g(){let e=(0,f.useMemo)(()=>new m.ObservableNumber(0),[]),{ref:t}=(0,s.useEffects)(function*(t){let n=new d.Q(t.querySelector("canvas")),{direction:i,aspect:r}=v[e.value],s=new a.$x({direction:i,size:[n.width,n.height],spacing:10,alignChildren:1,childrenAspectSizeMode:"fill-tangent-space"}).add(new a.$x({alignChildren:.5,aspect:r,spacing:10,userData:{color:l.Tj.yellow}}).add(new a.$x({size:["50%","50%"]}),new a.$x({size:["10%","10%"]})),new a.$x({aspect:r,spacing:10,userData:{color:l.Tj.paleGreen}}).add(new a.$x,new a.$x),new a.$x({aspect:r,userData:{color:l.Tj.magenta}}));yield e.onChange(e=>{let{direction:t,aspect:n}=v[e];for(let e of(s.set({direction:t}),s.children))e.set({aspect:n})}),yield(0,o.xy)("layout",e=>{s.set({alignChildren:e.cos01Time({frequency:.1})}),s.get(2).set({alignSelf:e.cos01Time({frequency:.3})}),n.paint(s)})},[]),n=()=>{e.value=(e.value+1)%v.length};return(0,i.jsxs)("div",{ref:t,className:"flex flex-col justify-center gap-4",style:{flex:"0 0 800px"},children:[(0,i.jsx)("canvas",{style:{border:"solid 2px #fff1",cursor:"pointer"},onClick:n}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{children:(0,i.jsxs)("button",{className:"border border-white rounded px-2 py-1",onClick:n,children:[(0,i.jsxs)("span",{children:["Direction: ",a.OP[v[(0,x.A)(e)].direction],","]}),"\xa0",(0,i.jsxs)("span",{children:["Aspect: ",v[(0,x.A)(e)].aspect]})]})}),(0,i.jsxs)("p",{style:{color:l.Tj.magenta},children:[(0,i.jsx)("code",{children:"alignSelf"})," allows the children to override the parent's ",(0,i.jsx)("code",{children:"alignChildren"}),"."]})]})]})}var w=n(35315);function y(){let{ref:e}=(0,s.useEffects)(function*(e){let t=e.querySelector("canvas"),n=new a.$x({direction:"vertical",size:[800,600],gap:12}).add(new a.$x({name:"header",size:["1rel",64],gap:12}),new a.$x({size:["1rel",10]}),new a.$x({name:"bottom",size:["1rel","1fr"],gap:12}).add(new a.$x({name:"left",size:["1fr","1rel"]}),new a.$x({size:[10,"1rel"]}),new a.$x({size:["1fr","1rel"]})));n.computeLayout();let i=window.devicePixelRatio;t.width=800*i,t.height=600*i,t.style.width="800px",t.style.height="600px";let r=t.getContext("2d"),s=function(e){let t=0,n=e.length;return()=>e[t++%n]}(Object.values(l.Tj));for(let e of n.allLeaves()){var o;r.lineWidth=2*i,r.strokeStyle=null!=(o=e.userData.color)?o:s(),r.strokeRect(...e.rect.tupple(i))}},[]);return(0,i.jsxs)("div",{ref:e,className:"flex flex-col items-center gap-4",style:{flex:"0 0 800px"},children:[(0,i.jsx)("canvas",{style:{border:"solid 2px #fff1"}}),(0,i.jsx)("div",{className:"text-center",children:(0,i.jsxs)("p",{children:["\n            A test of layouting spaces inside a fraction unit. Everything is ok. I was\n            looking for a bug that was coming from another part of the code.\n          ",(0,i.jsx)("br",{}),"The test is still there, not very useful now, but can't be reused for something else."]})})]})}var b=n(81482),j=n.n(b);function P(){let{ref:e}=(0,s.useEffects)(function*(e){let[t,...n]=e.children;t.style.flex="0 0 ".concat((n.length-1)*800,"px");let i=o.Rv.get("layout").set({minActiveDuration:4});yield(0,r.O)(i.requestActivation)},[]);return(0,i.jsxs)("div",{ref:e,className:"".concat(j().Client," page overflow-scroll"),children:[(0,i.jsx)("div",{}),(0,i.jsx)(c,{}),(0,i.jsx)(u,{}),(0,i.jsx)(p,{}),(0,i.jsx)(g,{}),(0,i.jsx)(w.x,{}),(0,i.jsx)(y,{})]})}},77515:(e,t,n)=>{"use strict";n.d(t,{e:()=>w});var i=n(28535),r=n(76999),s=n(57368),o=n(49797),a=n(5832),l=n(33589),c=new WeakMap;class d extends o.Nv2{dispose(){!(0,i._)(this,c)&&(super.dispose(),(0,s._)(this,c,!0),this.video&&(this.video.pause(),this.video.src="",this.video.parentNode&&this.video.parentNode.removeChild(this.video),this.video=null))}static fromUrl(e){let{loop:t=!0,autoplay:n=!0,muted:i=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=document.createElement("video");return r.src=e,r.loop=t,r.autoplay=n,r.muted=i,r.playsInline=!0,r.crossOrigin="anonymous",r.play(),new d(r)}constructor(e){super(e),(0,r._)(this,c,{writable:!0,value:void 0}),this.video=e,(0,s._)(this,c,!1)}}let u={video:["mp4","webm"],srgb:["jpg","jpeg","png","webp"],linear:["hdr","exr"]},h=e=>u.srgb.includes(e),p=e=>u.linear.includes(e),f=e=>u.video.includes(e),x=e=>h(e)||p(e);var m=new WeakMap,v=new WeakMap;class g{loadTexture(e,t){var n,r,c;let u,h,x=new URL(e,window.location.href).pathname.split("/").pop()||"unknown",g=null==(n=x.match(/[^.]+$/))?void 0:n[0];if(void 0===g)throw Error("No extension found in url: ".concat(e));if(f(g)){let t=(0,l.F)(d.fromUrl(e));return t.video.onloadedmetadata=()=>{t.image.width=t.video.videoWidth,t.image.height=t.video.videoHeight,t.resolve()},t.name=x,t}let w=(p(g)?(0,s._)(this,v,null!=(r=(0,i._)(this,v))?r:new a.Y):(0,s._)(this,m,null!=(c=(0,i._)(this,m))?c:new o.Tap)).load(e,e=>{var n,i;e.name=x,e.colorSpace=null!=(n=null==t?void 0:t.colorSpace)?n:p(g)?o.Zr2:o.er$,e.generateMipmaps=null==(i=null==t?void 0:t.generateMipmaps)||i,b(),u(e)},void 0,()=>{b();let t=Error("Cannot load texture (NOT FOUND?): ".concat(e));h(t)}),y=new Promise((e,t)=>{u=e,h=t});Object.assign(w,{then:y.then.bind(y),catch:y.catch.bind(y),finally:y.finally.bind(y)});let b=()=>{delete w.then,delete w.catch,delete w.finally};return w}load(e){var t;let n=null==(t=e.match(/[^.]+$/))?void 0:t[0];if(void 0===n)throw Error("No extension found in url: ".concat(e));if(x(n))return this.loadTexture(e);throw Error("Unsupported extension: ".concat(e))}constructor(){(0,r._)(this,m,{writable:!0,value:void 0}),(0,r._)(this,v,{writable:!0,value:void 0}),(0,s._)(this,m,null),(0,s._)(this,v,null)}}let w=new g},79299:(e,t,n)=>{"use strict";n.d(t,{Client:()=>S});var i,r=n(70691),s=n(67203),o=n(95509),a=n(37722),l=n(30158),c=n(99332),d=n(18479),u=n(33999),h=n(20487),p=n(14277),f=["title","titleId"];function x(){return(x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(null,arguments)}let m=function(e){var t=e.title,n=e.titleId,r=function(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if(({}).hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],-1===t.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,f);return s.createElement("svg",x({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 16 16","aria-labelledby":n},r),t?s.createElement("title",{id:n},t):null,i||(i=s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M11.25 4.25v-2.5h-9.5v9.5h2.5m.5-6.5v9.5h9.5v-9.5z"})))};var v=n(70261),g=n.n(v);function w(e){let{label:t,className:n,children:i=(0,r.jsx)(m,{})}=e;return(0,r.jsxs)("button",{className:"".concat(g().IconButton," ").concat(n),...e,children:[t&&(0,r.jsx)("span",{className:g().Label,children:t}),i]})}var y=n(69965),b=n.n(y);function j(e){let t=(0,s.useRef)(null);return(0,r.jsxs)("div",{ref:t,className:b().Copyable,children:[(0,r.jsx)("div",{children:e.children}),(0,r.jsx)("div",{className:"".concat(b().Overlay," layer thru p-2"),children:(0,r.jsx)(w,{onClick:()=>{let e=t.current.firstChild.textContent;navigator.clipboard.writeText(e)},children:(0,r.jsx)(m,{})})})]})}var P=n(54956),z=n.n(P);let C=["vertexShader","fragmentShader"];function T(){let e=function(){let[e,t,n]=window.location.hash.slice(1).split(",");return void 0!==e&&e in l.ShaderLib||(e="basic"),void 0!==t&&C.includes(t)||(t=C[0]),void 0!==n&&(!n||n in l.ShaderChunk)||(n=null),{libName:e,shaderProgram:t,chunkName:n}}(),[t,n]=(0,s.useState)(e.libName),[i,p]=(0,s.useState)(e.shaderProgram),[[f,x],v]=(0,s.useState)([e.chunkName,new h.M_]),[g,y]=(0,s.useState)(!1);window.location.hash=[t,i,f].filter(e=>!!e).join(",");let{ref:b}=(0,d.useEffects)(function*(e){for(let{spans:t,chunkName:n}of[...e.querySelectorAll("span")].filter(e=>"include"===e.textContent).map(e=>{let t=e.nextElementSibling,n=t.nextElementSibling,i=n.textContent.slice(1,-1);return{spans:[e.previousElementSibling,e,t,n],chunkName:i}})){let e=e=>{for(let n of(e.stopPropagation(),t))n.classList.add(z().Hover)},i=e=>{for(let n of(e.stopPropagation(),t))n.classList.remove(z().Hover)},r=e=>{e.stopPropagation();let i=h.M_.from(t[0].getBoundingClientRect()).union(h.M_.from(t[t.length-1].getBoundingClientRect()));window.requestAnimationFrame(()=>{v([n,i])})};for(let n of t)n.classList.add(z().Include),n.addEventListener("pointerenter",e),n.addEventListener("pointerleave",i),n.addEventListener("click",r)}yield(0,c.s)(e,{onTap:t=>{let n=e.querySelector(".".concat(z().OverlayContentWrapper));n&&!1===n.contains(t.orignalDownEvent.target)&&v([null,new h.M_])}})},[t,i]),P=l.ShaderLib[t][i];g&&(P=P.replace(/#include <(.*)>/g,(e,t)=>{let n=l.ShaderChunk[t];if(!n)throw Error('Shader chunk "'.concat(t,'" not found'));return n}));let T=0===x.area?x:x.clone().applyPadding([2,6],"grow");return(0,r.jsxs)("div",{ref:b,className:(0,u.S)(z().ShaderXplr,"absolute-through p-4 flex flex-col gap-4"),children:[(0,r.jsx)("h1",{children:"ShaderXplr"}),(0,r.jsxs)("div",{className:(0,u.S)(z().Base,null!==f&&z().Dim),style:{background:a.A.hljs.background},children:[(0,r.jsxs)("div",{className:z().Selectors,children:[(0,r.jsx)("select",{name:"shaderlib",id:"shaderlib",onChange:e=>n(e.target.value),children:Object.keys(l.ShaderLib).map(e=>(0,r.jsx)("option",{children:e},e))}),(0,r.jsx)("select",{name:"shaderprogram",id:"shaderprogram",onChange:e=>p(e.target.value),children:C.map(e=>(0,r.jsx)("option",{children:e},e))}),(0,r.jsxs)("div",{className:"flex flex-row items-center gap-3 px-2 bg-[#fff1] rounded-[.25em]",children:[(0,r.jsx)("label",{htmlFor:"showFinalProgram",children:"Show final program"}),(0,r.jsx)("input",{type:"checkbox",id:"showFinalProgram",checked:g,onChange:e=>y(e.target.checked)})]}),(0,r.jsx)("div",{children:(0,r.jsx)(w,{label:"Copy program",onClick:()=>{navigator.clipboard.writeText(P)},children:(0,r.jsx)(m,{})})})]}),(0,r.jsx)("div",{className:z().BaseContentWrapper,children:(0,r.jsx)(o.A,{language:"cpp",style:a.A,children:P})})]}),(0,r.jsxs)("div",{className:"absolute-through",children:[(0,r.jsx)("div",{className:z().IncludeHighlight,style:{top:"".concat(T.top,"px"),left:"".concat(T.left,"px"),width:"".concat(T.width,"px"),height:"".concat(T.height,"px")}}),f&&(0,r.jsxs)("div",{className:z().Overlay,children:[(0,r.jsx)("div",{style:{height:"".concat(Math.max(x.top,110),"px"),pointerEvents:"none"}}),(0,r.jsxs)("div",{className:z().OverlayContentWrapper,style:{background:a.A.hljs.background},children:[(0,r.jsxs)("div",{className:z().TitleBar,children:[(0,r.jsx)("h1",{children:f}),(0,r.jsx)(w,{onClick:()=>{navigator.clipboard.writeText(f)},children:(0,r.jsx)(m,{})})]}),(0,r.jsx)(j,{children:(0,r.jsx)(o.A,{language:"cpp",style:a.A,children:l.ShaderChunk[f]})})]})]})]})]})}function S(){return(0,p.D)()&&(0,r.jsx)(T,{})}},81482:e=>{e.exports={Client:"client_Client__8IuAI"}},81835:(e,t,n)=>{"use strict";n.d(t,{B:()=>i.B});var i=n(55362)},82143:(e,t,n)=>{"use strict";n.d(t,{O0:()=>i,XW:()=>E});var i,r=n(49797),s=n(99613),o=n(50373),a=n(64416),l=n(27491),c=n(27146),d=n(71591),u=n(28334);!function(e){e[e.Render=0]="Render",e[e.PostProcessing=1e3]="PostProcessing",e[e.GizmoRender=2e3]="GizmoRender",e[e.Outline=3e3]="Outline",e[e.Output=4e3]="Output",e[e.Antialiasing=5e3]="Antialiasing"}(i||(i={}));class h{get passes(){return this.composer.passes}sortPasses(){let e=[...this.passMap];for(let[t]of e)this.composer.removePass(t);for(let[t]of(e.sort((e,t)=>{let n=e[1],i=t[1];return n.type!==i.type?n.type-i.type:n.insertOrder-i.insertOrder}),e))this.composer.addPass(t);return this}*getPassesByType(e){for(let[t,n]of this.passMap)n.type===e&&(yield[t,n])}addPass(e){let{type:t=i.Render,insertOrder:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===n){var r,s,o;n=(null!=(o=null==(s=[...this.getPassesByType(t)].at(-1))||null==(r=s[1])?void 0:r.insertOrder)?o:-1)+1}return this.passMap.set(e,{type:t,insertOrder:n}),this.sortPasses(),{destroy:()=>this.removePass(e)}}removePass(e){return this.passMap.has(e)?(this.passMap.delete(e),this.composer.removePass(e),!0):(console.warn("The pass is not in the pipeline."),!1)}setSize(e,t,n){this.composer.setSize(e,t),this.composer.setPixelRatio(n),this.basicPasses.fxaa.uniforms.resolution.value.set(1/n/e,1/n/t),this.basicPasses.smaa.setSize(e*n,t*n)}setScene(e){let t=this.basicPasses.mainRender.scene;for(let n of this.composer.passes)n instanceof l.A&&n.scene===t&&(n.scene=e)}render(e){this.composer.render(e.deltaTime)}getPassesInfo(){let e=["".concat(this.constructor.name," passes info:")],{composer:t,passMap:n}=this;for(let[r,s]of t.passes.entries()){let t=n.get(s);if(t){let n=s.enabled?"✅":"❌";e.push("- ".concat(r,": ").concat(n," ").concat(i[t.type]," (insertOrder: ").concat(t.insertOrder,") ").concat(s.constructor.name))}else e.push("- ".concat(r,": NO METADATA for ").concat(s.constructor.name))}return e.join("\n")}constructor(e,t,n,h){let p=new s.s(e),f=new Map,x=new l.A(t,h);x.clearAlpha=0,f.set(x,{type:i.Render,insertOrder:0}),p.addPass(x);let m=new l.A(n,h);f.set(m,{type:i.GizmoRender,insertOrder:0}),m.clear=!1,m.clearDepth=!1,p.addPass(m);let v=new o.G(new r.I9Y,t,h);f.set(v,{type:i.GizmoRender,insertOrder:0}),p.addPass(v);let g=new a.X;f.set(g,{type:i.Output,insertOrder:0}),p.addPass(g);let w=new c.p(u.o);f.set(w,{type:i.Antialiasing,insertOrder:0}),p.addPass(w);let y=new d.I;y.enabled=!1,f.set(y,{type:i.Antialiasing,insertOrder:0}),p.addPass(y),this.composer=p,this.basicPasses={mainRender:x,gizmoRender:m,outline:v,output:g,fxaa:w,smaa:y},this.passMap=f}}var p=n(28535),f=n(76999),x=n(57368),m=n(30158),v=n(17223),g=n(24223),w=n(79285);let y=JSON.parse('[{"name":"Lavender","hex":"E6E6FA"},{"name":"Thistle","hex":"D8BFD8"},{"name":"Plum","hex":"DDA0DD"},{"name":"Violet","hex":"EE82EE"},{"name":"Orchid","hex":"DA70D6"},{"name":"Fuchsia","hex":"FF00FF"},{"name":"Magenta","hex":"FF00FF"},{"name":"MediumOrchid","hex":"BA55D3"},{"name":"MediumPurple","hex":"9370DB"},{"name":"BlueViolet","hex":"8A2BE2"},{"name":"DarkViolet","hex":"9400D3"},{"name":"DarkOrchid","hex":"9932CC"},{"name":"DarkMagenta","hex":"8B008B"},{"name":"Purple","hex":"800080"},{"name":"Indigo","hex":"4B0082"},{"name":"DarkSlateBlue","hex":"483D8B"},{"name":"SlateBlue","hex":"6A5ACD"},{"name":"MediumSlateBlue","hex":"7B68EE"},{"name":"Pink","hex":"FFC0CB"},{"name":"LightPink","hex":"FFB6C1"},{"name":"HotPink","hex":"FF69B4"},{"name":"DeepPink","hex":"FF1493"},{"name":"PaleVioletRed","hex":"DB7093"},{"name":"MediumVioletRed","hex":"C71585"},{"name":"LightSalmon","hex":"FFA07A"},{"name":"Salmon","hex":"FA8072"},{"name":"DarkSalmon","hex":"E9967A"},{"name":"LightCoral","hex":"F08080"},{"name":"IndianRed","hex":"CD5C5C"},{"name":"Crimson","hex":"DC143C"},{"name":"FireBrick","hex":"B22222"},{"name":"DarkRed","hex":"8B0000"},{"name":"Red","hex":"FF0000"},{"name":"OrangeRed","hex":"FF4500"},{"name":"Tomato","hex":"FF6347"},{"name":"Coral","hex":"FF7F50"},{"name":"DarkOrange","hex":"FF8C00"},{"name":"Orange","hex":"FFA500"},{"name":"Yellow","hex":"FFFF00"},{"name":"LightYellow","hex":"FFFFE0"},{"name":"LemonChiffon","hex":"FFFACD"},{"name":"LightGoldenrodYellow","hex":"FAFAD2"},{"name":"PapayaWhip","hex":"FFEFD5"},{"name":"Moccasin","hex":"FFE4B5"},{"name":"PeachPuff","hex":"FFDAB9"},{"name":"PaleGoldenrod","hex":"EEE8AA"},{"name":"Khaki","hex":"F0E68C"},{"name":"DarkKhaki","hex":"BDB76B"},{"name":"Gold","hex":"FFD700"},{"name":"Cornsilk","hex":"FFF8DC"},{"name":"BlanchedAlmond","hex":"FFEBCD"},{"name":"Bisque","hex":"FFE4C4"},{"name":"NavajoWhite","hex":"FFDEAD"},{"name":"Wheat","hex":"F5DEB3"},{"name":"BurlyWood","hex":"DEB887"},{"name":"Tan","hex":"D2B48C"},{"name":"RosyBrown","hex":"BC8F8F"},{"name":"SandyBrown","hex":"F4A460"},{"name":"Goldenrod","hex":"DAA520"},{"name":"DarkGoldenrod","hex":"B8860B"},{"name":"Peru","hex":"CD853F"},{"name":"Chocolate","hex":"D2691E"},{"name":"SaddleBrown","hex":"8B4513"},{"name":"Sienna","hex":"A0522D"},{"name":"Brown","hex":"A52A2A"},{"name":"Maroon","hex":"800000"},{"name":"DarkOliveGreen","hex":"556B2F"},{"name":"Olive","hex":"808000"},{"name":"OliveDrab","hex":"6B8E23"},{"name":"YellowGreen","hex":"9ACD32"},{"name":"LimeGreen","hex":"32CD32"},{"name":"Lime","hex":"00FF00"},{"name":"LawnGreen","hex":"7CFC00"},{"name":"Chartreuse","hex":"7FFF00"},{"name":"GreenYellow","hex":"ADFF2F"},{"name":"SpringGreen","hex":"00FF7F"},{"name":"MediumSpringGreen","hex":"00FA9A"},{"name":"LightGreen","hex":"90EE90"},{"name":"PaleGreen","hex":"98FB98"},{"name":"DarkSeaGreen","hex":"8FBC8F"},{"name":"MediumSeaGreen","hex":"3CB371"},{"name":"SeaGreen","hex":"2E8B57"},{"name":"ForestGreen","hex":"228B22"},{"name":"Green","hex":"008000"},{"name":"DarkGreen","hex":"006400"},{"name":"MediumAquamarine","hex":"66CDAA"},{"name":"Aqua","hex":"00FFFF"},{"name":"Cyan","hex":"00FFFF"},{"name":"LightCyan","hex":"E0FFFF"},{"name":"PaleTurquoise","hex":"AFEEEE"},{"name":"Aquamarine","hex":"7FFFD4"},{"name":"Turquoise","hex":"40E0D0"},{"name":"MediumTurquoise","hex":"48D1CC"},{"name":"DarkTurquoise","hex":"00CED1"},{"name":"LightSeaGreen","hex":"20B2AA"},{"name":"CadetBlue","hex":"5F9EA0"},{"name":"DarkCyan","hex":"008B8B"},{"name":"Teal","hex":"008080"},{"name":"LightSteelBlue","hex":"B0C4DE"},{"name":"PowderBlue","hex":"B0E0E6"},{"name":"LightBlue","hex":"ADD8E6"},{"name":"SkyBlue","hex":"87CEEB"},{"name":"LightSkyBlue","hex":"87CEFA"},{"name":"DeepSkyBlue","hex":"00BFFF"},{"name":"DodgerBlue","hex":"1E90FF"},{"name":"CornflowerBlue","hex":"6495ED"},{"name":"SteelBlue","hex":"4682B4"},{"name":"RoyalBlue","hex":"4169E1"},{"name":"Blue","hex":"0000FF"},{"name":"MediumBlue","hex":"0000CD"},{"name":"DarkBlue","hex":"00008B"},{"name":"Navy","hex":"000080"},{"name":"MidnightBlue","hex":"191970"},{"name":"White","hex":"FFFFFF"},{"name":"Snow","hex":"FFFAFA"},{"name":"Honeydew","hex":"F0FFF0"},{"name":"MintCream","hex":"F5FFFA"},{"name":"Azure","hex":"F0FFFF"},{"name":"AliceBlue","hex":"F0F8FF"},{"name":"GhostWhite","hex":"F8F8FF"},{"name":"WhiteSmoke","hex":"F5F5F5"},{"name":"Seashell","hex":"FFF5EE"},{"name":"Beige","hex":"F5F5DC"},{"name":"OldLace","hex":"FDF5E6"},{"name":"FloralWhite","hex":"FFFAF0"},{"name":"Ivory","hex":"FFFFF0"},{"name":"AntiqueWhite","hex":"FAEBD7"},{"name":"Linen","hex":"FAF0E6"},{"name":"LavenderBlush","hex":"FFF0F5"},{"name":"MistyRose","hex":"FFE4E1"},{"name":"Gainsboro","hex":"DCDCDC"},{"name":"LightGray","hex":"D3D3D3"},{"name":"Silver","hex":"C0C0C0"},{"name":"DarkGray","hex":"A9A9A9"},{"name":"Gray","hex":"808080"},{"name":"DimGray","hex":"696969"},{"name":"LightSlateGray","hex":"778899"},{"name":"SlateGray","hex":"708090"},{"name":"DarkSlateGray","hex":"2F4F4F"},{"name":"Black","hex":"000000"}]');function b(e){return(0,w.toff)(e).toString(16).padStart(2,"0")}function j(e,t){return null!=t||(t={r:1,g:1,b:1,a:1}),t.r=(e>>16&255)/255,t.g=(e>>8&255)/255,t.b=(255&e)/255,t}function P(e,t){switch(null!=t||(t={r:1,g:1,b:1,a:1}),typeof e){case"number":return j(e,t);case"string":if(e.startsWith("#"))return function(e,t){if(null!=t||(t={r:1,g:1,b:1,a:1}),e.startsWith("#")&&(e=e.slice(1)),3===e.length||4===e.length){let[n,i,r,s="f"]=e;return t.r=Number.parseInt(n+n,16)/255,t.g=Number.parseInt(i+i,16)/255,t.b=Number.parseInt(r+r,16)/255,t.a=Number.parseInt(s+s,16)/255,t}if(6===e.length||8===e.length){let n=e.slice(0,2),i=e.slice(2,4),r=e.slice(4,6),s=e.slice(6,8)||"ff";return t.r=Number.parseInt(n,16)/255,t.g=Number.parseInt(i,16)/255,t.b=Number.parseInt(r,16)/255,t.a=Number.parseInt(s,16)/255,t}throw Error("Invalid hex string")}(e,t);if(e.startsWith("rgb")||e.startsWith("hsl"))throw Error("Not implemented");try{return j(function(e){let t=RegExp("^".concat(e.toLowerCase(),"$"),"i"),n=y.find(e=>e.name.match(t));if(n)return Number.parseInt(n.hex,16);throw Error("Invalid web color")}(e),t)}catch(e){throw Error("Invalid color string")}case"object":if(Array.isArray(e)){let[n,i,r,s=1]=e;return t.r=n,t.g=i,t.b=r,t.a=s,t}if("object"==typeof e&&"r"in e&&"g"in e&&"b"in e&&"a"in e)return t.r=e.r,t.g=e.g,t.b=e.b,t.a=e.a,t}throw Error("Invalid color declaration")}class z{static from(e){return P(e,new z)}static lerpColors(e,t,n){return new z().lerpColors(e,t,n)}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b,yield this.a}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}clone(){return new this.constructor().copy(this)}set(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return this.r=e,this.g=t,this.b=n,this.a=i,this}lerpColors(e,t,n){return this.r=(0,w.lerp)(e.r,t.r,n),this.g=(0,w.lerp)(e.g,t.g,n),this.b=(0,w.lerp)(e.b,t.b,n),this.a=(0,w.lerp)(e.a,t.a,n),this}toCSS(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"hex";switch(e){case"hex":return"#".concat(b(this.r)).concat(b(this.g)).concat(b(this.b)).concat(b(this.a));case"rgba":return"rgba(".concat((0,w.toff)(this.r),", ").concat((0,w.toff)(this.g),", ").concat((0,w.toff)(this.b),", ").concat(this.a.toFixed(2),")")}throw Error("Invalid format")}constructor(e){this.r=1,this.g=1,this.b=1,this.a=1,e&&P(e,this)}}var C=n(39787),T=n(94065),S=n(10390),F=n(79911),A=n(52489),D=n(29338),k=new WeakMap;class E extends A.${static current(){return this.instances[this.instances.length-1]}_onSetScene(){this.pipeline.setScene(this.scene)}useOrbitControls(){var e,t;let{position:n=null,target:i=null,element:r=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"string"==typeof r&&(r=document.querySelector(r)),null!=(e=this.internal).orbitControls||(e.orbitControls=new v.N(this.camera,r)),r&&r!==this.internal.orbitControls.domElement&&(this.internal.orbitControls.dispose(),this.internal.orbitControls=new v.N(this.camera,r)),n&&(0,T.jj)(n,this.internal.orbitControls.object.position),i&&(0,T.jj)(i,this.internal.orbitControls.target),this.internal.orbitControls.update(),this.internal.orbitControls}initialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(this.initialized)return console.warn("ThreeWebGLContext is already initialized."),this;Object.defineProperty(this,"initialized",{value:!0,writable:!1,configurable:!1,enumerable:!1});let{onDestroy:n}=this,{domElement:i}=this.renderer;e.appendChild(i),n(()=>{e.removeChild(i)});let r=()=>{this.setSize({width:e.clientWidth,height:e.clientHeight,pixelRatio:window.devicePixelRatio})},s=new ResizeObserver(r);return s.observe(e),n(()=>{s.disconnect()}),r(),n(this.pointer.initialize(i,t,this.camera,this.ticker)),n((0,g.O)(this.ticker.requestActivation),this.ticker.onTick({phase:D.z.Render,name:"WebGL:Render"},e=>this.renderFrame(e))),n(()=>{var e;null==(e=this.internal.orbitControls)||e.dispose()}),this.domContainer=e,this.domElement=i,this}_onSetSize(){let{size:{x:e,y:t},pixelRatio:n}=this,{renderer:i,perspectiveCamera:r,pipeline:s}=this;i.setSize(e,t),i.setPixelRatio(n),s.setSize(e,t,n),r.aspect=e/t,r.updateProjectionMatrix()}renderFrame(e,t){var n;(!1!==this._enabled||(null==t?void 0:t.force)===!0)&&(null==(n=this.internal.orbitControls)||n.update(e.deltaTime),super.renderFrame(e,t),!1===this.skipRender&&this.pipeline.render(e))}*findAll(e,t){yield*(0,F.wV)(this.scene,e,t)}find(e){for(let t of this.findAll(e))return t;return null}isPartOfScene(e){let t=e;for(;t;){if(t===this.scene)return!0;t=t.parent}return!1}pixelColor(e,t){if(this.pipeline.composer.readBuffer.texture.type===r.ix0){let{uint16:n,color:i}=(0,p._)(this,k);this.renderer.readRenderTargetPixels(this.pipeline.composer.readBuffer,e,t,1,1,n),i.r=r.GxU.fromHalfFloat(n[0]),i.g=r.GxU.fromHalfFloat(n[1]),i.b=r.GxU.fromHalfFloat(n[2]),i.a=r.GxU.fromHalfFloat(n[3])}else throw Error("Unsupported texture type: ".concat(this.pipeline.composer.readBuffer.texture.type));return(0,p._)(this,k).color}pixelColorNdc(e){let{x:t,y:n}=e;return t=Math.floor((t+1)/2*this.fullSize.x),n=Math.floor((n+1)/2*this.fullSize.y),this.pixelColor(t,n)}pointerPixelColor(){return this.pixelColorNdc(this.pointer.screenPosition)}constructor(){super(D.s.WebGL),(0,f._)(this,k,{writable:!0,value:void 0}),this.renderer=new m.WebGLRenderer,this.perspectiveCamera=new r.ubm,this.orthographicCamera=new r.qUd,this.camera=this.perspectiveCamera,this.gizmoScene=new r.Z58,this.pipeline=new h(this.renderer,this.scene,this.gizmoScene,this.perspectiveCamera),this.internal={destroyables:[],orbitControls:null},this.onTick=this.ticker.onTick.bind(this.ticker),this.onDestroy=this.internal.destroyables.push.bind(this.internal.destroyables),this.loader=S.o.get("three"),this.initialized=!1,this.destroyed=!1,this.destroy=()=>{if(this.destroyed)return void console.warn("ThreeWebGLContext is already destroyed.");Object.defineProperty(this,"destroyed",{value:!0,writable:!1,configurable:!1,enumerable:!1}),(0,C.zr)(this.internal.destroyables),this.internal.destroyables=[],this.renderer.dispose()},(0,x._)(this,k,{uint16:new Uint16Array(4),color:new z}),this.camera.position.set(0,1,10),this.camera.lookAt(0,0,0),E.instances.push(this)}}E.instances=[]},83628:(e,t,n)=>{"use strict";n.d(t,{K:()=>c});var i=n(17953),r=n(81074),s=n(49797),o=n(24223),a=n(52489),l=n(29338);class c extends a.${_onSetSize(){let{size:{x:e,y:t},pixelRatio:n}=this,{renderer:i,perspectiveCamera:r,orthographicCamera:s}=this;i.setSize(e,t),i.setPixelRatio(n);let o=e/t;r.aspect=o,r.updateProjectionMatrix(),s.left=-o,s.right=o,s.top=1,s.bottom=-1,s.updateProjectionMatrix()}initialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(this.initialized)return console.warn("ThreeWebGLContext is already initialized."),this;Object.defineProperty(this,"initialized",{value:!0,writable:!1,configurable:!1,enumerable:!1});let n=this.scenePass.getTextureNode("output");this.postProcessing.outputNode=n,new ResizeObserver(()=>{this.setSize({width:e.clientWidth,height:e.clientHeight,pixelRatio:window.devicePixelRatio})}).observe(e);let{domElement:i}=this.renderer;return i.style.display="block",i.style.width="100%",i.style.height="100%",e.appendChild(i),this.setSize({width:i.clientWidth,height:i.clientHeight,pixelRatio:window.devicePixelRatio}),this.internal.cancelTick=this.ticker.onTick({name:"WebGPU:Render",phase:l.z.Render},e=>{this.renderFrame(e)}).destroy,this.internal.cancelRequestActivation=(0,o.O)(document.body,this.ticker.requestActivation).destroy,this.internal.cancelPointer=this.pointer.initialize(this.renderer.domElement,t,this.camera,this.ticker),this.domContainer=e,this.domElement=i,this}renderFrame(e,t){(!1!==this._enabled||(null==t?void 0:t.force)===!0)&&(super.renderFrame(e,t),!1===this.skipRender&&this.postProcessing.renderAsync())}constructor(){super(l.s.WebGPU),this.renderer=new r.uV1({antialias:!0}),this.perspectiveCamera=new s.ubm,this.orthographicCamera=new s.qUd,this.camera=this.perspectiveCamera,this.postProcessing=new r.io7(this.renderer),this.scenePass=(0,i.IXH)(this.scene,this.perspectiveCamera),this.internal={observer:null,cancelRequestActivation:null,cancelTick:null,cancelPointer:null},this.initialized=!1,this.destroyed=!1,this.destroy=()=>{var e,t,n,i,r,s,o;if(this.destroyed)return void console.warn("ThreeWebGLContext is already destroyed.");Object.defineProperty(this,"destroyed",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.renderer.dispose(),null==(e=this.internal.observer)||e.disconnect(),null==(t=(n=this.internal).cancelTick)||t.call(n),null==(i=(r=this.internal).cancelRequestActivation)||i.call(r),null==(s=(o=this.internal).cancelPointer)||s.call(o)},this.camera.position.set(0,1,10),this.camera.lookAt(0,0,0),this.pointer.updatePosition(this.camera,{x:0,y:0},this.renderer.domElement.getBoundingClientRect())}}},84469:(e,t,n)=>{"use strict";n.d(t,{PageClient:()=>d});var i=n(70691),r=n(49797),s=n(33540),o=n(15931),a=n(77515),l=n(79911);function c(){return(0,s.dB)("my-scene",function*(e){(0,l.mj)(new r.eaF(new r.Gu$(100,32,16),new r.V9B({color:"#242424",side:r.hsX})),{parent:e}),(0,l.mj)(new o.P,e),(0,l.mj)(new r.eaF(new r.iNn(1,1,.2),new r.V9B({map:a.e.loadTexture("/assets/textures/color-debug.png")})),e),(0,l.mj)(new r.eaF(new r.iNn(1,1,.2),new r.V9B({map:a.e.loadTexture("/assets/textures/Card-Verso-MB-Test.jpg")})),{parent:e,position:[1.2,0,0]}),document.body.style.backgroundColor="#222222"}),null}function d(){return(0,i.jsxs)(s.uB,{vertigoControls:{},children:[(0,i.jsxs)("div",{className:"PageClient p-16",children:[(0,i.jsx)("h1",{className:"mb-4 text-3xl font-bold",children:"Color test"}),(0,i.jsx)("p",{children:"Looks like the textures are correctly interpreted."})]}),(0,i.jsx)(c,{})]})}},84822:(e,t,n)=>{"use strict";n.d(t,{ClientPage:()=>g});var i=n(70691),r=n(49797),s=n(38921),o=n(33540),a=n(34011),l=n(3009),c=n(43969),d=n(77794),u=n(16465),h=n(3293),p=n(79911);function f(e,t){return s.pP(Array.from({length:e},(e,n)=>t.clone().translate(n,0,0)))}class x extends r.YJl{*initialize(e){return yield e.ticker.onTick(e=>{this.uniforms.uBendFactor.value=.5+.5*Math.sin(1.5*e.time),this.uniforms2.uBendFactor.value=Math.PI/4}),this}constructor(){super(),this.transform={x:2,rotationY:"-30deg"},this.uniforms=(0,l.Zt)((0,h.wy)(this.transform)),this.uniforms2=(0,l.Zt)((0,h.wy)({x:-2}));let e=new u.Y({vertexColors:!0,onBeforeCompile:e=>(0,l.QS)(e,this.uniforms)});(0,p.mj)(new r.eaF(f(15,new a.k({heightSegments:16})),e),this),(0,p.mj)(new c.E({divisions:20,onBeforeCompile:e=>(0,l.QS)(e,this.uniforms)}),{parent:this,...this.transform})}}class m extends r.YJl{*initialize(e){return yield e.ticker.onTick(e=>{this.uniforms.uBendFactor.value=Math.sin(1.5*e.time)}),this}constructor(){super(),this.transform={x:-2,rotationY:"20deg"},this.uniforms=(0,l.Zt)((0,h.wy)(this.transform));let e=s.pP([new r.WBB(.25,3),new r.O3Y(.5,.25,16,32).rotateY(Math.PI/2).translate(.5,0,0).toNonIndexed()]),t=new u.Y({wireframe:!0,onBeforeCompile:e=>(0,l.QS)(e,this.uniforms)});(0,p.mj)(new r.eaF(f(5,e),t),{parent:this,x:-5}),(0,p.mj)(new r.eaF(f(5,e),t),{parent:this,x:-5,z:-2}),(0,p.mj)(new c.E({divisions:20,onBeforeCompile:e=>(0,l.QS)(e,this.uniforms)}),{parent:this,...this.transform})}}function v(){let e=(0,o.Fw)();return(0,o.dB)("slerp-scene",function*(t){e.pipeline.basicPasses.fxaa.enabled=!1,(0,p.mj)(new d.u,t).regularGrid(),(0,p.mj)((yield*new x().initialize(e)),t),(0,p.mj)((yield*new m().initialize(e)),t)},"always"),null}function g(){return(0,i.jsxs)(o.uB,{vertigoControls:{size:10},children:[(0,i.jsxs)("div",{className:"layer thru p-16",children:[(0,i.jsx)("h1",{className:"text-4xl font-bold",children:"Vertex Shader - Bend"}),(0,i.jsx)("p",{children:"Demonstration of a vertex bend transformation using Shader Forge."})]}),(0,i.jsx)(v,{})]})}},86543:(e,t,n)=>{"use strict";n.d(t,{ClientPage:()=>u});var i=n(70691),r=n(49797),s=n(33540),o=n(77794),a=n(7147),l=n(79911);class c extends r.YJl{constructor(){super();let e=(e,t)=>(a.bI.with(e).uniforms({uMyColor:{value:new r.Q1f(t)}}).varying({vMyColor:"vec3"}).vertex.mainAfterAll("\n          vMyColor = uMyColor;\n        ").fragment.after("map_fragment","\n          diffuseColor.rgb = vMyColor;\n        "),e),t=new r.V9B;t.onBeforeCompile=t=>e(t,"red"),(0,l.mj)(new r.eaF(new r.iNn,t),{parent:this,x:-2});let n=new r.V9B;n.onBeforeCompile=t=>e(t,"blue"),(0,l.mj)(new r.eaF(new r.iNn,n),{parent:this,x:2})}}function d(){let e=(0,s.Fw)();return(0,s.dB)("slerp-scene",function*(t){e.pipeline.basicPasses.fxaa.enabled=!1,(0,l.mj)(new o.u,t).regularGrid(),(0,l.mj)(new c,t)},"always"),null}function u(){return(0,i.jsxs)(s.uB,{vertigoControls:{size:10},children:[(0,i.jsx)(d,{}),(0,i.jsxs)("div",{className:"layer thru p-16",children:[(0,i.jsx)("h1",{className:"text-4xl font-bold",children:"Shader Forge - Instance"}),(0,i.jsx)("p",{children:"Simple check, everything is fine."})]})]})}},86946:(e,t,n)=>{"use strict";n.d(t,{PageClient:()=>P});var i=n(70691),r=n(19069),s=n(48647),o=n(71323),a=n(71978),l=n(98054),c=n(87524),d=n(56905);class u{setSize(e,t){if(this.sizeComputed)throw Error("Implementation Error: Size already computed for node s".concat(this.id));this.sx=e,this.sy=t,this.sizeComputed=!0}depth(){let e=0,t=this.parent;for(;null!==t;)e++,t=t.parent;return e}isLastChild(){if(null===this.parent)return!0;let e=this.parent.children;return e[e.length-1]===this}*allDescendants(){for(let e of(yield this,this.children))yield*e.allDescendants()}*allAncestors(){let e=this.parent;for(;null!==e;)yield e,e=e.parent}toTreeString(){return function(e){let t=[],n=0;for(let i of e.allDescendants()){let e=i.allAncestors().map(e=>null===e.parent||e.isLastChild()?"   ":"│  ").toArray().reverse().join(""),r=0===i.depth()?"->":!1===i.isLastChild()?"├─":"└─",s="".concat(e).concat(r," ").concat(h(i));t.push(s),n++}return t.unshift("Tree: (".concat(n,")")),t.join("\n")}(this)}toString(){return h(this)}constructor(e,t=null){var n;this.uid=u.nextUid++,this.id=u.nextId++,this.px=0,this.py=0,this.sx=0,this.sy=0,this.pr=0,this.pl=0,this.pt=0,this.pb=0,this.gap=0,this.inner_sx=0,this.inner_sy=0,this.tgt_free=0,this.parent=null,this.sizeComputed=!1,this.childrenSizesComputed=!1,this.space=e,this.parent=t,this.is_h=e.direction===d.OP.Horizontal;let i=null==(n=null==t?void 0:t.is_h)||n;this.fractionalInTangentSpace=i?p(e.sizeX.type,e.sizeXFitChildren):p(e.sizeY.type,e.sizeYFitChildren),this.fractionalInNormalSpace=i?p(e.sizeY.type,e.sizeYFitChildren):p(e.sizeX.type,e.sizeXFitChildren),this.children=e.children.filter(e=>e.enabled).map(e=>new u(e,this))}}function h(e){let t=e=>e.toFixed(2).replace(/\.?0+$/,""),n=e.children.length>0?"(".concat(e.children.length,") "):"",i="r(".concat(t(e.px),", ").concat(t(e.py),", ").concat(t(e.sx),", ").concat(t(e.sy),")"),r="tgt_free(".concat(t(e.tgt_free),")"),s="inner(".concat(t(e.inner_sx),", ").concat(t(e.inner_sy),")");return"s".concat(e.id," ").concat(n).concat(i," ").concat(r," ").concat(s)}function p(e,t){return e===c.LN.Fraction||e===c.LN.Auto&&!1===t}function f(e){e.pr=e.space.padding[1].compute(e.sx,e.sy),e.pl=e.space.padding[3].compute(e.sx,e.sy),e.pt=e.space.padding[0].compute(e.sy,e.sx),e.pb=e.space.padding[2].compute(e.sy,e.sx),e.inner_sx=e.sx-e.pl-e.pr,e.inner_sy=e.sy-e.pt-e.pb,e.gap=e.is_h?e.space.gap.compute(e.sx,e.sy):e.space.gap.compute(e.sy,e.sx)}function*x(e){for(let t of e.children)!1===t.fractionalInTangentSpace&&(yield t)}function*m(e){for(let t of e.children)!0===t.fractionalInTangentSpace&&(yield t)}function v(e){let t=[e];for(;t.length>0;){let e=t.shift();if(e.childrenSizesComputed)continue;f(e);let n=e.inner_sx,i=e.inner_sy,r=e.is_h?n:i;if(e.is_h){for(let t of x(e)){if(!1===t.sizeComputed){let e=t.space.sizeX.compute(n,i),r=t.space.sizeY.compute(i,n);t.setSize(e,r)}r-=t.sx}r-=e.gap*Math.max(0,e.children.length-1);let t=0;for(let n of m(e))t+=n.space.sizeX.value;let s=Math.max(0,r);for(let o of m(e)){let e=s*(o.space.sizeX.value/t),a=null!==o.space.aspect?e/o.space.aspect:o.space.sizeY.compute(i,n);o.setSize(e,a),r=0}}else{for(let t of x(e)){if(!1===t.sizeComputed){let e=t.space.sizeX.compute(n,i),r=t.space.sizeY.compute(i,n);t.setSize(e,r)}r-=t.sy}r-=e.gap*Math.max(0,e.children.length-1);let t=0;for(let n of m(e))t+=n.space.sizeY.value;let s=Math.max(0,r);for(let o of m(e)){let e=s*(o.space.sizeY.value/t),a=null!==o.space.aspect?e*o.space.aspect:o.space.sizeX.compute(n,i);o.setSize(a,e),r=0}}e.tgt_free=r,e.childrenSizesComputed=!0,t.push(...e.children)}}function g(e){u.nextId=0;let t=new u(e);t.px=e.offsetX.value,t.py=e.offsetY.value,t.sx=t.space.sizeX.compute(0,0),t.sy=t.space.sizeY.compute(0,0),f(t);for(let e of function* e(t){for(let n of t.children)yield*e(n);(t.is_h?t.space.sizeXFitChildren:t.space.sizeYFitChildren)&&(yield t)}(t))!function(e){for(let t of e.children){if(!1===t.sizeComputed){let e=t.space.sizeX.compute(0,0),n=t.space.sizeY.compute(0,0);t.setSize(e,n)}v(t)}f(e);let{is_h:t}=e;if(t){let t=0,n=0;for(let i of e.children)t+=i.sx,i.sy>n&&(n=i.sy);let i=(t+=e.gap*Math.max(0,e.children.length-1))+e.pl+e.pr,r=n+e.pt+e.pb;e.setSize(i,r),f(e)}else{let t=0,n=0;for(let i of e.children)n+=i.sy,i.sx>t&&(t=i.sx);n+=e.gap*Math.max(0,e.children.length-1);let i=t+e.pl+e.pr,r=n+e.pt+e.pb;e.setSize(i,r),f(e)}e.childrenSizesComputed=!0}(e);v(t),function(e){let t=[e];for(;t.length>0;){let e=t.shift(),r=e.px+e.pl,s=e.py+e.pt;for(let o of e.children){var n,i;let a=null!=(n=o.space.alignSelfX)?n:e.space.alignChildrenX,l=null!=(i=o.space.alignSelfY)?i:e.space.alignChildrenX;e.is_h?(o.px=r+e.tgt_free*a,o.py=s+(e.inner_sy-o.sy)*l,r+=o.sx+e.gap):(o.px=r+(e.inner_sx-o.sx)*a,o.py=s+e.tgt_free*l,s+=o.sy+e.gap),t.push(o)}}}(t);let n=[t];for(;n.length>0;){let e=n.shift();e.space.rect.set(e.px,e.py,e.sx,e.sy),n.push(...e.children)}return t}function w(){return(0,i.jsx)(o.O,{size:[800,600],colorRule:l.Y,directionArrow:!0,root:[new r.$x({size:[600,200],offset:[100,100],spacing:10}).add(new r.$x({size:100}),new r.$x({size:50}),new r.$x({size:50})),new r.$x({size:[600,200],offset:[100,320],spacing:10}).add(new r.$x({aspect:2}),new r.$x({size:"2fr"}),new r.$x({aspect:.5}))],computeLayout:e=>g(e),title:(0,i.jsx)("h2",{children:"Basic"})})}function y(){return(0,i.jsx)(o.O,{size:[800,600],colorRule:l.Y,directionArrow:!0,root:new r.$x({size:[700,500],offset:[50,50],spacing:10,direction:"vertical"}).add(new r.$x({spacing:10}).add(new r.$x({size:[100,50]}),new r.$x({aspect:1}),new r.$x({size:"3fr"}),new r.$x({size:50}),new r.$x({sizeX:50})),new r.$x({spacing:10}).add(new r.$x({aspect:1,alignSelf:1}),new r.$x({aspect:1}),new r.$x({aspect:.5,direction:"vertical",spacing:10}).populate(6),new r.$x({aspect:.5,direction:"vertical",spacing:10}).populate(6),new r.$x({aspect:1}),new r.$x({aspect:1,alignSelfY:0}))),computeLayout:e=>g(e),title:(0,i.jsx)("h2",{children:"(D1) Aspect"})})}function b(){return(0,i.jsx)(o.O,{size:[800,600],colorRule:l.Y,directionArrow:!0,root:new r.$x({size:[700,500],offset:[50,50],spacing:10,direction:"vertical"}).add(new r.$x({spacing:10}).add(new r.$x({spacing:10,size:"fit-children"}),new r.$x({spacing:10,size:"fit-children"}),new r.$x({spacing:10,size:"fit-children"}),new r.$x({spacing:10,size:"fit-children"}).add(new r.$x({size:[100,50]}),new r.$x({size:[50,100]}),new r.$x({size:[100,50]})),new r.$x({aspect:1}),new r.$x({sizeY:"20%"}),new r.$x({spacing:10,size:"fit-children",direction:"vertical"}).add(new r.$x({size:[100,50]}),new r.$x({size:[50,50]}),new r.$x({size:[100,50]}))),new r.$x({spacing:10,direction:"vertical"}).add(new r.$x({spacing:10,size:"fit-children"}),new r.$x({spacing:10,size:"fit-children"}).add(new r.$x({size:100}),new r.$x({size:100}),new r.$x({size:100})))),computeLayout:e=>g(e),title:(0,i.jsx)("h2",{children:'(D2) "fit-children"'}),description:'flat spaces with size "fit-children"'})}function j(){return(0,i.jsx)(o.O,{size:[800,600],colorRule:l.Y,directionArrow:!0,root:new r.$x({size:[700,500],offset:[50,50],spacing:10}).add(new r.$x({spacing:10,enabled:!1}).add(new r.$x({spacing:10,size:"fit-children"}),new r.$x({spacing:10,size:"fit-children"}).add(new r.$x({size:50}),new r.$x({size:50}),new r.$x({size:50}))),new r.$x({spacing:10}).add(new r.$x({spacing:10,size:"fit-children"}).add(new r.$x({spacing:10,size:"fit-children"}),new r.$x({spacing:10,size:"fit-children"}).add(new r.$x({size:50}),new r.$x({size:[50,100]}),new r.$x({size:50})),new r.$x({userData:{color:s.Tj.yellow,comment:"must be shrunk: no available space for expansion"}}),new r.$x({size:50}),new r.$x({spacing:10,size:"fit-children",direction:"vertical"}).add(new r.$x({size:50}),new r.$x({size:[100,50]}),new r.$x({size:50}))))),computeLayout:e=>g(e),title:(0,i.jsx)("h2",{children:'(D2) "fit-children"'}),description:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h2",{children:"Seems good:"}),(0,i.jsxs)("ul",{children:[(0,i.jsx)("li",{children:"disabled spaces are ignored"}),(0,i.jsx)("li",{children:'nested "fit-children" spaces work'})]})]})})}function P(){let[e,t]=(0,a.Q)(),n=parseInt(e.replace("#demo-","")||"-1"),r=[w,y,b,j].filter((e,t)=>-1===n||n===t);return(0,i.jsxs)("div",{className:"FlexLayoutDemo p-16 h-screen overflow-auto",children:[(0,i.jsx)("h1",{className:"text-3xl text-center font-bold",children:"computeLayout3()"}),r.map((e,r)=>(0,i.jsx)("div",{className:"my-8",onClick:()=>t(-1===n?"#demo-".concat(r):null),children:(0,i.jsx)(e,{})},r))]})}u.nextId=0,u.nextUid=0,n(14043)},87548:(e,t,n)=>{"use strict";n.r(t),n.d(t,{useGroup:()=>h,useInstance:()=>p,useThree:()=>c,useThreeWebGL:()=>d,useThreeWebGPU:()=>u});var i=n(67203),r=n(49797),s=n(18479),o=n(29338),a=n(79911),l=n(68571);function c(e,t){let n=(0,i.useContext)(l.h);return(0,s.useEffects)(async function*(t,i){if(e){let t=e(n,i);if(t&&"function"==typeof t.next)do{let{value:e,done:n}=await t.next();if(n)break;yield e}while(i.mounted)}},null!=t?t:"always"),n}function d(e,t){let n=c(async function*(t,n){if(t.type===o.s.WebGL&&e){let i=e(t,n);if(i&&"function"==typeof i.next)for(;;){let{value:e,done:t}=await i.next();if(t)break;yield e}}},t);if(n.type===o.s.WebGL)return n;throw Error("No WebGL context available")}function u(e,t){let n=c(async function*(t,n){if(t.type===o.s.WebGPU&&e){let i=e(t,n);if(i&&"function"==typeof i.next)for(;;){let{value:e,done:t}=await i.next();if(t)break;yield e}}},t);return n.type===o.s.WebGPU?n:null}function h(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[s,o,l,d]=function(e){if(e.length>=3&&"function"==typeof e[2])return e;{let[t,n=function*(){},i]=e;return[t,{},n,i]}}(t),u=(0,i.useMemo)(()=>new r.YJl,[]);return u.name=s,(0,a.mj)(u,o),c(async function*(e,t){if((0,a.mj)(u,{parent:e.scene,...o}),yield()=>{u.clear(),u.removeFromParent()},l){let n=l(u,e,t);if(n&&"function"==typeof n.next)do{let{value:e,done:t}=await n.next();if(t)break;yield e}while(t.mounted)}},d),u}function p(e){c(async function*(t){let{value:n,args:i=[],hidden:s}=e;if(!n)return;let o="function"==typeof n&&n.prototype&&r.B69.prototype.isPrototypeOf(n.prototype)?new n(...i):n;for(let n of((0,a.mj)(o,{parent:t.scene,...e.transform}),s&&(o.visible=!1),(0,a.$z)(o,{includeSelf:!0})))if("onInitialize"in n){let e=n.onInitialize(t);if(e&&"function"==typeof e.next)for(;;){let{value:t,done:n}=await e.next();if(n)break;yield t}}yield()=>{for(let t of(o.removeFromParent(),(0,a.$z)(o,{includeSelf:!0})))if("onDestroy"in t){var e;null==(e=t.onDestroy)||e.call(t)}}},"always")}},88352:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(70691),r=n(33540);function s(){let e=(0,r.yk)();return(0,i.jsx)("button",{className:"absolute top-12 right-12 z-10 border border-white/50 hover:bg-black/10 hover:border-white text-white px-2 py-1 rounded transition",onClick:()=>e.setFullscreen("canvas"),children:"Fullscreen"})}},88493:(e,t,n)=>{"use strict";n.d(t,{uB:()=>u,yk:()=>l});var i=n(70691),r=n(67203),s=n(18479),o=n(88575);n(61249);let a=(0,r.createContext)(null);function l(e,t){let n=(0,r.useContext)(a);return(0,s.useEffects)(async function*(t,i){if(e){let t=e(n,i);if(t&&"function"==typeof t.next)do{let{value:e,done:n}=await t.next();if(n)break;yield e}while(i.mounted)}},null!=t?t:"always"),n}let c={className:"",assetsPath:"/"};function d(e){let{children:t,className:n,assetsPath:l}={...c,...e},d=(0,r.useMemo)(()=>new o.XW,[]);d.loader.setPath(l);let{ref:u}=(0,s.IZ)({debounce:!0},function*(e,t){yield d.initialize(e.firstElementChild),t.triggerRender(),Object.assign(window,{three:d})},[]);return(0,i.jsx)("div",{ref:u,className:n,style:{position:"absolute",inset:0},children:(0,i.jsxs)(a.Provider,{value:d,children:[(0,i.jsx)("div",{style:{position:"absolute",inset:"0"}}),(0,i.jsx)("div",{style:{position:"absolute",inset:"0"},className:"thru",children:d.initialized&&t})]})})}function u(e){return function(){let[e,t]=(0,r.useState)(!1);return(0,r.useLayoutEffect)(()=>{t(!0)},[]),e}()&&(0,i.jsx)(d,{...e})}},90048:e=>{e.exports={Client:"client_Client__koMgZ"}},95645:e=>{e.exports={Client:"page_client_Client__Sqjc_"}},96122:(e,t,n)=>{"use strict";function i(e){let{removePaddingEmptyLines:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.split("\n"),i=0;for(;t&&n.length>0&&""===n[0].trim();)n.shift();for(;t&&n.length>0&&""===n[n.length-1].trim();)n.pop();for(let e of n){let t=e.match(/^(\s*)\S/);if(t){i=t[1].length;break}}return n.map(e=>e.slice(Math.min(e.length,i))).join("\n")}n.d(t,{T:()=>i})},98054:(e,t,n)=>{"use strict";n.d(t,{Y:()=>s});var i=n(19069),r=n(48647);function s(e){var t;if(e.isRoot())return r.Tj.yellow;let n=(null==(t=e.parent)?void 0:t.direction)!==i.OP.Horizontal?e.sizeY.type:e.sizeX.type;return(e.direction===i.OP.Horizontal?e.sizeXFitChildren:e.sizeYFitChildren)?r.Tj.paleGreen:n===i.LN.Fraction||n===i.LN.Auto?r.Tj.blue:r.Tj.magenta}},98114:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FpsMeter:()=>a});var i=n(70691),r=n(18479),s=n(36508);let o={frequency:3,tickerName:"three",precision:1};function a(e){let{frequency:t,tickerName:n,precision:a,...l}={...o,...e},{ref:c}=(0,r.useEffects)(function*(){let e=s.Rv.get("three");yield e.onTick({timeInterval:1/3},()=>{c.current.innerText="".concat(e.averageFps.toFixed(a)," fps")})},[t,n,a]);return(0,i.jsx)("div",{ref:c,...l,children:"-- fps"})}},98839:(e,t,n)=>{"use strict";n.d(t,{l:()=>i.FpsMeter});var i=n(98114)},99332:(e,t,n)=>{"use strict";n.d(t,{m:()=>a,s:()=>A});class i{clone(){let e=Object.create(this);for(let[t,n]of Object.entries(this))e[t]=function e(t){if("object"!=typeof t)return t;if(Array.isArray(t))return t.map(e);switch(t.constructor){case DOMPoint:return DOMPoint.fromPoint(t);case DOMRect:return DOMRect.fromRect(t);case Object:{let n=Object.create(t);for(let i of Object.keys(t))n[i]=e(t[i]);return n}}throw Error("Unsupported value type: ".concat(t.constructor))}(n);return Object.freeze(e)}}class r{get targetElement(){throw Error("Not implemented")}get button(){throw Error("Not implemented")}getLocalPosition(e){let t=this.targetElement.getBoundingClientRect(),{x:n,y:i}=this.position;return null!=e||(e={}),e.x=n-t.x,e.y=i-t.y,e}get localPosition(){return this.getLocalPosition(new DOMPoint)}getRelativeLocalPosition(e){let{x:t,y:n}=this.localPosition,i=this.targetElement.getBoundingClientRect();return null!=e||(e={}),e.x=(t-i.x)/i.width,e.y=(n-i.y)/i.height,e}get relativeLocalPosition(){return this.getRelativeLocalPosition(new DOMPoint)}constructor(){this.position=new DOMPoint}}class s extends r{get targetElement(){let e=this.event.target;if(e instanceof Element)return e;throw Error("targetElement is not an Element")}get button(){return this.event instanceof MouseEvent||this.event instanceof PointerEvent?this.event.button:0}get localPosition(){let e=this.targetElement.getBoundingClientRect(),{x:t,y:n}=this.position;return new DOMPoint(t-e.x,n-e.y)}constructor(e=!1,t=!1,n=new DOMPoint,i=new DOMPoint,r=null){super(),this.entered=e,this.pressed=t,this.downPosition=n,this.upPosition=i,this.event=r}}let o=["onDown","onUp","onChange","onEnter","onLeave"];var a,l=n(36508);!function(e){e[e.Main=0]="Main",e[e.Aux=1]="Aux",e[e.Second=2]="Second",e[e.Fourth=3]="Fourth",e[e.Fifth=4]="Fifth",e[e.DoubleTouch=5]="DoubleTouch",e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right"}(a||(a={}));class c extends r{get button(){return this._button}get targetElement(){return this.downTargetElement}constructor(...e){super(...e),this.direction="horizontal",this.startPosition=new DOMPoint,this.position=new DOMPoint,this.positionOld=new DOMPoint,this.movement=new DOMPoint,this.delta=new DOMPoint,this.deltaTime=1/60,this.shiftKey=!1,this.metaKey=!1,this.altKey=!1,this.ctrlKey=!1,this.touchCount=0,this.downTargetElement=null,this._button=0}}let d={dragDistanceThreshold:10,dragSnapToInitialPosition:!1,dragPreventDefault:!1,dragButton:1<<a.Main,dragEaseFactor:1,dragTickOrder:void 0},u=["onDragStart","onDragStop","onDrag","onVerticalDragStart","onVerticalDragStop","onVerticalDrag","onHorizontalDragStart","onHorizontalDragStop","onHorizontalDrag"],h={},p=["onFocusEnter","onFocusLeave"];class f{}let x=["onDownOutside"];var m=n(20487);let v=["onPressStart","onPressStop","onPressFrame"];class g extends r{get targetElement(){return this.tapTarget}get button(){return this.orignalDownEvent.button}getLocalDownPosition(e){let{x:t,y:n}=this.localPosition;return null!=e||(e={}),e.x=t,e.y=n,e}get localDownPosition(){return this.localPosition}constructor(e,t,n,i,r){super(),this.originalUpEvent=null,this.timestamp=e,this.tapTarget=t,this.downTarget=n,this.downPosition=i,this.orignalDownEvent=r,this.position=i}}let w={maxDistance:10,maxDuration:.3},y=["onTap"];var b=n(79285);class j extends i{constructor(...e){super(...e),this.time=-1,this.rawDeltaTime=-1,this.deltaTime=-1,this.delta=new DOMPoint,this.phase="start",this.event=null}}let P={wheelPreventDefault:!1},z=["onWheel","onWheelStart","onWheelEnd"];class C extends i{constructor(e=0,t=0,n=new DOMPoint,i="start"){super(),this.time=e,this.deltaTime=t,this.delta=n,this.phase=i}}let T={preventDefault:!1,wheelFrameTickOrder:void 0},S=["onWheelFrame","onWheelFrameStart","onWheelFrameEnd"];class F{add(e){if(this.data.length===this.capacity){let e=this.data.shift();this.sum.x-=e.x,this.sum.y-=e.y,this.sum.z-=e.z}this.data.push(e),this.sum.x+=e.x,this.sum.y+=e.y,this.sum.z+=e.z;let t=this.data.length;this.average.x=this.sum.x/t,this.average.y=this.sum.y/t,this.average.z=this.sum.z/t}constructor(e=5){this.data=[],this.sum=new DOMPoint,this.average=new DOMPoint,this.capacity=e}}function A(e,t){let n=[];for(let i of"length"in e?Array.from(e):[e])(function(e){return o.some(t=>t in e)})(t)&&n.push(function(e,t){let n={touchStarted:!1,touchTimestamp:-1};function i(){return n.touchStarted||n.touchTimestamp>Date.now()-1e3}let r=new s,o=(e,n,i)=>{var s;r.pressed=!0,r.downPosition.x=n,r.downPosition.y=i,l(e,n,i),null==(s=t.onDown)||s.call(t,r)},a=(e,n,i)=>{var s;r.pressed=!1,r.upPosition.x=n,r.upPosition.y=i,l(e,n,i),null==(s=t.onUp)||s.call(t,r),r.position.x=-1,r.position.y=-1},l=(e,n,i)=>{if(r.position.x!==n||r.position.y!==i){var s;r.event=e,r.position.x=n,r.position.y=i,null==(s=t.onChange)||s.call(t,r)}},c=e=>{!1===i()&&o(e,e.clientX,e.clientY)},d=e=>{!1===i()&&a(e,e.clientX,e.clientY)},u=e=>{!1===i()&&l(e,e.clientX,e.clientY)},h=()=>{document.body.addEventListener("mouseup",f),x()},p=()=>{m()},f=()=>{r.pressed=!1,m(),document.documentElement.removeEventListener("mouseup",f)},x=()=>{if(!1===r.entered){var e;r.entered=!0,null==(e=t.onEnter)||e.call(t,r)}},m=()=>{if(r.entered&&!1===r.pressed){var e;r.entered=!1,null==(e=t.onLeave)||e.call(t,r)}},v=e=>{1===e.touches.length&&(n.touchStarted=!0,n.touchTimestamp=Date.now(),o(e,e.touches[0].clientX,e.touches[0].clientY))},g=e=>{0===e.touches.length&&(n.touchStarted=!1,n.touchTimestamp=Date.now(),a(e,e.changedTouches[0].clientX,e.changedTouches[0].clientY))},w=e=>{1===e.touches.length&&(n.touchTimestamp=Date.now(),l(e,e.touches[0].clientX,e.touches[0].clientY))};return e.addEventListener("mouseover",h),e.addEventListener("mouseout",p),e.addEventListener("mousedown",c),e.addEventListener("mouseup",d),e.addEventListener("mousemove",u),e.addEventListener("touchstart",v,{passive:!1}),e.addEventListener("touchend",g,{passive:!1}),e.addEventListener("touchmove",w,{passive:!1}),()=>{e.removeEventListener("mouseover",h),e.removeEventListener("mouseout",p),e.removeEventListener("mousedown",c),e.removeEventListener("mouseup",d),e.removeEventListener("mousemove",u),e.removeEventListener("touchstart",v),e.removeEventListener("touchend",g),e.removeEventListener("touchmove",w),document.body.removeEventListener("mouseup",f)}}(i,t)),function(e){return u.some(t=>t in e)}(t)&&n.push(function(e,t){let{dragDistanceThreshold:n,dragSnapToInitialPosition:i,dragPreventDefault:r,dragButton:s,dragEaseFactor:o,dragTickOrder:u,onDragStart:h,onDragStop:p,onDrag:f,onVerticalDragStart:x,onVerticalDragStop:m,onVerticalDrag:v,onHorizontalDragStart:g,onHorizontalDragStop:w,onHorizontalDrag:y}={...d,...t},b=!1,j=!1,P=!1,z=-1,C=new DOMPoint(0,0),T=new c,{startPosition:S,position:F,positionOld:A,movement:D,delta:k}=T,E=()=>{z=void 0===u?window.requestAnimationFrame(_):l.Rv.current().requestAnimationFrame(_,{order:u})},M=()=>{void 0===u?window.cancelAnimationFrame(z):l.Rv.current().cancelAnimationFrame(z)},B=(e,t)=>{E(),b=!0,S.x=e,S.y=t,C.x=e,C.y=t},O=()=>{switch(j=!0,k.x=0,k.y=0,D.x=0,D.y=0,F.x=S.x,F.y=S.y,null==h||h(T),T.direction){case"horizontal":null==g||g(T);break;case"vertical":null==x||x(T)}},L=()=>{switch(j=!1,null==p||p(T),T.direction){case"horizontal":null==w||w(T);break;case"vertical":null==m||m(T)}},q=(e,t)=>{A.x=F.x,A.y=F.y,F.x+=(e-F.x)*o,F.y+=(t-F.y)*o,k.x=F.x-A.x,k.y=F.y-A.y,D.x=F.x-S.x,D.y=F.y-S.y},N=()=>{switch(i&&!1===P?q(S.x,S.y):q(C.x,C.y),null==f||f(T),T.direction){case"horizontal":null==y||y(T);break;case"vertical":null==v||v(T)}},I=0,_=e=>{if(T.deltaTime=(e-I)/1e3,I=e,b){E();let e=S.x-C.x,t=S.y-C.y;P=Math.sqrt(e*e+t*t)>n,!1===j&&P&&(T.direction=Math.abs(e/t)>=1?"horizontal":"vertical",O()),j&&N()}},R=e=>{T._button=e.button,T.downTargetElement=e.target,s&1<<e.button&&(window.addEventListener("mousemove",Y,{passive:!1}),window.addEventListener("mouseup",$),B(e.clientX,e.clientY))},Y=e=>{C.x=e.clientX,C.y=e.clientY,T.shiftKey=e.shiftKey,T.metaKey=e.metaKey,T.altKey=e.altKey,T.ctrlKey=e.ctrlKey,j&&r&&e.preventDefault()},$=()=>{window.removeEventListener("mousemove",Y),window.addEventListener("mouseup",$),j&&L(),b=!1},V=null,G=e=>{if(T.touchCount=e.touches.length,s&1<<a.Main){let t=e.changedTouches[0];null===V&&(V=t,window.addEventListener("touchmove",W,{passive:!1}),window.addEventListener("touchend",X),E(),b=!0,T.downTargetElement=e.target,k.x=0,k.y=0,D.x=0,D.y=0,S.x=t.clientX,S.y=t.clientY,F.x=t.clientX,F.y=t.clientY,C.x=t.clientX,C.y=t.clientY)}},W=e=>{let t=e.changedTouches[0];T.touchCount=e.touches.length,t.identifier===V.identifier&&(C.x=t.clientX,C.y=t.clientY,T.shiftKey=e.shiftKey,T.metaKey=e.metaKey,T.altKey=e.altKey,T.ctrlKey=e.ctrlKey,j&&r&&e.preventDefault())},X=e=>{let t=e.changedTouches[0];T.touchCount=e.touches.length,t.identifier===V.identifier&&(window.removeEventListener("touchmove",W),window.removeEventListener("touchend",X),j&&L(),b=!1,V=null)};return e.addEventListener("mousedown",R,{passive:!1}),e.addEventListener("touchstart",G,{passive:!1}),()=>{e.removeEventListener("mousedown",R),e.removeEventListener("touchstart",G),window.removeEventListener("mousemove",Y),window.removeEventListener("mouseup",$),window.removeEventListener("touchmove",W),window.removeEventListener("touchend",X),M()}}(i,t)),function(e){return p.some(t=>t in e)}(t)&&n.push(function(e,t){let{onFocusEnter:n,onFocusLeave:i}={...h,...t},r=()=>{e.addEventListener("blur",s),null==n||n({})},s=()=>{e.removeEventListener("blur",s),null==i||i({})};return e.addEventListener("focus",r),()=>{e.removeEventListener("focus",r),e.removeEventListener("blur",s)}}(i,t)),function(e){return v.some(t=>t in e)}(t)&&n.push(function(e,t){let{onPressStart:n,onPressStop:i,onPressFrame:r}=t,s=!1,o=-1,a=new DOMPoint(0,0),l=new DOMPoint(0,0),c=new DOMPoint(0,0),d={position:l,delta:c,target:e,targetRectOnDown:new m.M_,get pointerIsInside(){return d.targetRectOnDown.contains(a.x,a.y)}},u=()=>{s&&(o=window.requestAnimationFrame(u),c.x=a.x-l.x,c.y=a.y-l.y,l.x+=c.x,l.y+=c.y,null==r||r(d))},h=t=>{window.addEventListener("mousemove",p),window.addEventListener("mouseup",f),o=window.requestAnimationFrame(u),s=!0,d.targetRectOnDown.copy(e.getBoundingClientRect()),c.x=0,c.y=0,l.x=t.clientX,l.y=t.clientY,a.x=t.clientX,a.y=t.clientY,null==n||n(d)},p=e=>{a.x=e.clientX,a.y=e.clientY},f=()=>{window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",f),s=!1,null==i||i(d)},x=t=>{t.preventDefault();let i=t.touches[0];i&&(window.addEventListener("touchmove",v),window.addEventListener("touchend",g),o=window.requestAnimationFrame(u),s=!0,d.targetRectOnDown.copy(e.getBoundingClientRect()),c.x=0,c.y=0,l.x=i.clientX,l.y=i.clientY,a.x=i.clientX,a.y=i.clientY,null==n||n(d))},v=e=>{let t=e.touches[0];t&&(a.x=t.clientX,a.y=t.clientY)},g=e=>{window.removeEventListener("touchmove",v),window.removeEventListener("touchend",g),s=!1,null==i||i(d)};return e.addEventListener("mousedown",h,{passive:!1}),e.addEventListener("touchstart",x,{passive:!1}),()=>{e.removeEventListener("mousedown",h),e.removeEventListener("touchstart",x),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",f),window.removeEventListener("touchmove",v),window.removeEventListener("touchend",g),window.cancelAnimationFrame(o)}}(i,t)),function(e){return y.some(t=>t in e)}(t)&&n.push(function(e,t){let{maxDistance:n,maxDuration:i,onTap:r}={...w,...t},s=null,o=t=>{s=new g(Date.now(),e,t.target,new DOMPoint(t.clientX,t.clientY),t),window.addEventListener("pointerup",a)},a=e=>{window.removeEventListener("pointerup",a),function(e,t){if(!e)return!1;let n=t;for(;n;){if(n===e)return!0;n=n.parentElement}return!1}(s.downTarget,e.target)&&(Date.now()-s.timestamp)/1e3<=i&&Math.hypot(e.clientX-s.downPosition.x,e.clientY-s.downPosition.y)<=n&&(s.originalUpEvent=e,window.requestAnimationFrame(()=>{null==r||r(s)}))};return e.addEventListener("pointerdown",o),()=>{e.removeEventListener("pointerdown",o),window.removeEventListener("pointerup",a)}}(i,t)),function(e){return z.some(t=>t in e)}(t)&&n.push(function(e,t){let{wheelPreventDefault:n,onWheel:i,onWheelStart:r,onWheelEnd:s}={...P,...t},o={start:!1,timeout:-1,time:-1},a=new j,l=e=>{n&&e.preventDefault();let t=!1===o.start?"start":"continue",l=e.timeStamp/1e3,c="start"===t?1/60:l-o.time;o.time=l,a.event=e,a.phase=t,a.time=l;let d=function(e){switch(e){default:case 0:return 1;case 1:return 16;case 2:return 1e3}}(e.deltaMode);a.delta.x=e.deltaX*d,a.delta.y=e.deltaY*d,a.delta.z=e.deltaZ*d;let u=(0,b.clamp)(c,1/240,1/30);a.rawDeltaTime=c,a.deltaTime=u,"start"===t&&(o.start=!0,null==r||r(a)),null==i||i(a),window.clearTimeout(o.timeout),o.timeout=window.setTimeout(()=>{o.start=!1,a.phase="end",a.deltaTime=.1,a.time=l+.1,a.delta.x=0,a.delta.y=0,a.delta.z=0,null==s||s(a)},100)};return e.addEventListener("wheel",l,{passive:!n}),()=>{e.removeEventListener("wheel",l)}}(i,t)),function(e){return S.some(t=>t in e)}(t)&&n.push(function(e,t){let{preventDefault:n,wheelFrameTickOrder:i,onWheelFrame:r,onWheelFrameStart:s,onWheelFrameEnd:o}={...T,...t},a={msOld:0,frame:0,frameID:0,deltaTime:0,time:0,position:new DOMPoint,positionOld:new DOMPoint,eventCount:0,eventCountOld:0,eventFrame:0,eventMsOld:0,eventPosition:new DOMPoint,eventVelocities:new F(5),eventVelocity:new DOMPoint},c=e=>{n&&e.preventDefault();let t=0===a.eventCount?1/60:(e.timeStamp-a.eventMsOld)/1e3;0===a.eventCount&&d(),a.eventPosition.x+=e.deltaX,a.eventPosition.y+=e.deltaY,a.eventPosition.z+=e.deltaZ;let i=new DOMPoint;i.x=e.deltaX/t,i.y=e.deltaY/t,i.z=e.deltaZ/t,a.eventVelocities.add(i),a.eventCount++,a.eventFrame=a.frame,a.eventMsOld=e.timeStamp},d=()=>{u(),a.frameID=void 0===i?window.requestAnimationFrame(h):l.Rv.current().requestAnimationFrame(h,{order:i})},u=()=>{void 0===i?window.cancelAnimationFrame(a.frameID):l.Rv.current().cancelAnimationFrame(a.frameID)},h=e=>{let t=0===a.eventCountOld?"start":a.frame===a.eventFrame+8?"end":"continue";console.log(t);let n=(e-a.msOld)/1e3,i="start"===t?1/60:(0,b.clamp)(n,1/240,1/30);if(a.deltaTime=i,a.msOld=e,"end"!==t?d():u(),a.time+=i,"end"===t)a.position.x=a.eventPosition.x,a.position.y=a.eventPosition.y,a.position.z=a.eventPosition.z;else{let{x:e,y:t,z:n}=a.eventVelocities.average;a.position.x+=e*i*8,a.position.y+=t*i*8,a.position.z+=n*i*8;let r=10000000000000017e-46**i;a.position.x+=(a.eventPosition.x-a.position.x)*r,a.position.y+=(a.eventPosition.y-a.position.y)*r,a.position.z+=(a.eventPosition.z-a.position.z)*r}let l=new DOMPoint;l.x=a.position.x-a.positionOld.x,l.y=a.position.y-a.positionOld.y,l.z=a.position.z-a.positionOld.z;let c=new C(a.time,i,l,t);"start"===t&&(null==s||s(c)),null==r||r(c),"end"!==t?(a.eventCountOld=a.eventCount,a.frame++,a.positionOld.x=a.position.x,a.positionOld.y=a.position.y,a.positionOld.z=a.position.z):(a.eventCount=0,a.eventCountOld=0,a.frame=0,null==o||o(c))};return e.addEventListener("wheel",c,{passive:!n}),()=>{e.removeEventListener("wheel",c),u()}}(i,t)),function(e){return x.some(t=>t in e)}(t)&&n.push(function(e,t){let n=n=>{if(n.target!==e&&!1===e.contains(n.target)&&t.onDownOutside){let e=new f;t.onDownOutside(e)}};return document.body.addEventListener("pointerdown",n,{passive:!0}),()=>{document.body.removeEventListener("pointerdown",n)}}(i,t));return()=>{for(let e of n)e()}}},99656:(e,t,n)=>{"use strict";n.d(t,{ClientPage:()=>C});var i=n(70691),r=n(33540),s=n(3009),o=n(43969),a=n(77794),l=n(79911),c=n(77674),d=n(49797),u=n(74740),h=n(30123),p=n(74842),f=n(44019),x=n(45553),m=n(7147),v=n(3293),g=n(44694),w=n(14203),y=n(80446);class b{get length(){return this.getLength()}set length(e){this.setLength(e)}*positions(){yield this.start.x,yield this.start.y,yield this.start.z,yield this.end.x,yield this.end.y,yield this.end.z}*colors(){yield this.startColor.r,yield this.startColor.g,yield this.startColor.b,yield this.endColor.r,yield this.endColor.g,yield this.endColor.b}getChild(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let i=this;for(let e of t)i=i.children[e];return i}getLength(){return this.start.distanceTo(this.end)}setLength(e){let{_v:t}=(0,c._)(b,b,j),n=t.subVectors(this.end,this.start).normalize();return this.end.copy(this.start).addScaledVector(n,e),this}mulLength(e){let{_v:t}=(0,c._)(b,b,j);return t.subVectors(this.end,this.start).multiplyScalar(e),this.end.copy(this.start).add(t),this}isRoot(){return null===this.parent}isLeaf(){return 0===this.children.length}allDescendantsCount(){let e=1;for(let t of this.children)e+=t.allDescendantsCount();return e}*allDescendantsColors(){for(let e of this.allDescendants({includeSelf:!0}))yield*e.colors()}*allDescendantsPositions(){for(let e of this.allDescendants({includeSelf:!0}))yield*e.positions()}*allDescendants(){let{includeSelf:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(let t of(e&&(yield this),this.children))yield*t.allDescendants({includeSelf:!0})}*allLeaves(){let{includeSelf:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(let t of this.allDescendants({includeSelf:e}))t.isLeaf()&&(yield t)}split(e){let{angle:t="45deg",length:n=1,lengthVariationFactor:i=1,altDir:r,altDirWeight:s=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=new d.Pq0().subVectors(this.end,this.start),a=o.length();if(o.divideScalar(a),r){let e=(0,f.jj)(r).normalize();(0,x.z)(o,e,s,o)}let l=(0,g.ey)(t);for(let t=0;t<e;t++){let r=n*Math.pow(i,y.n.number(-1,1)),s=new b(this.end,new d.Pq0().addVectors(this.end,o.clone().applyAxisAngle(this.normal,l).applyAxisAngle(o,2*Math.PI*t/e).multiplyScalar(r)),this.normal);s.parent=this,this.children.push(s)}return this}constructor(e,t,n){this.start=e,this.end=t,this.normal=n,this.parent=null,this.children=[],this.startColor=new d.Q1f("white"),this.endColor=new d.Q1f("white")}}var j={writable:!0,value:{_v:new d.Pq0}};class P extends d.YJl{get noiseAmplitude(){return this.uNoiseAmplitude.value}set noiseAmplitude(e){this.uNoiseAmplitude.value=e}setPositionOnScene(e){return this.positionOnScene=e,this}enableBend(){let e={rotationZ:"90deg",rotationY:"20deg"},t=(0,s.Zt)((0,v.wy)(e));return this.material.onBeforeCompile=e=>{m.bI.with(e).uniforms({...t,uTime:this.uTime,uNoiseAmplitude:this.uNoiseAmplitude}).vertex.top(s.zf,w.O);let n=e.vertexShader,i=e.vertexShader.indexOf("vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );"),r=e.vertexShader.indexOf("vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );");e.vertexShader=n.substring(0,i)+"\n          vec4 start = vec4( instanceStart, 1.0 );\n          vec4 end = vec4( instanceEnd, 1.0 );\n\n          start = modelMatrix * start;\n          end = modelMatrix * end;\n\n          start = applyBend(start, uBendFactor, uBendMatrix, uBendMatrixInverse);\n          end = applyBend(end, uBendFactor, uBendMatrix, uBendMatrixInverse);\n\n          float time = uTime * 0.15;\n          float noiseScale = 0.825;\n          float startNoise = snoise(vec4(start.xyz * noiseScale, time)) * instanceStart.y;\n          float endNoise = snoise(vec4(end.xyz * noiseScale, time)) * instanceEnd.y;\n\n          start.xz += vec2(1.0, -1.0) * startNoise * uNoiseAmplitude * 0.01;\n          end.xz += vec2(1.0, -1.0) * endNoise * uNoiseAmplitude * 0.01;\n\n          start = viewMatrix * start;\n          end = viewMatrix * end;\n        "+n.substring(r+54)},this.bendUniforms=t,this.bendTransform=e,this}updateBendTransform(e){return this.bendUniforms&&((0,v.wy)(e,this.bendUniforms.uBendMatrix.value),this.bendUniforms.uBendMatrixInverse.value.copy(this.bendUniforms.uBendMatrix.value).invert()),this}update(e){if(this.uTime.value+=e,this.bendUniforms){let e=this.uTime.value;this.bendUniforms.uBendFactor.value=.33*this.bendAmplitude*(.1*Math.sin(1.5*e)+.03*Math.sin(3.34*e)+.01*Math.sin(4.732*e))}return this}constructor(e=256789,{splitIndices:t=[[2]]}={}){super(),this.uTime={value:0},this.uNoiseAmplitude={value:1},this.bendAmplitude=1,this.bendUniforms=null,this.bendTransform=null;let n=new b(new d.Pq0(0,0,0),new d.Pq0(0,1,0),new d.Pq0(1,0,0));for(let i of(y.n.setRandom("parkmiller",e),n.split(3,{angle:"15deg",lengthVariationFactor:1.8}),t))n.getChild(...i).mulLength(1.2).split(3,{angle:"20deg",lengthVariationFactor:1.4});for(let e of[...n.allLeaves()])e.split(6,{angle:"70deg",length:.28,altDir:[0,1,1],altDirWeight:.5}),e.split(1,{angle:"0deg",length:.17,altDir:[0,1,1],altDirWeight:.5});for(let e of[...n.allLeaves()])e.split(11,{angle:"70deg",length:.12,altDir:[0,1,0],altDirWeight:.5});for(let e of[...n.allLeaves()])e.split(13,{angle:"70deg",length:.04,altDir:[0,1,0],altDirWeight:.75});{let e=new d.Q1f("#ecde0d"),t=new d.Q1f("#fff"),i=0,r=new Set(n.allLeaves()),s=new Set,o=()=>{[r,s]=[s,r]},a=e=>Math.min(1,Math.max(0,e));for(;r.size>0;){for(let n of r)n.endColor.lerpColors(e,t,a(i/3)),n.startColor.lerpColors(e,t,a((i+1)/3)),n.parent&&s.add(n.parent);r.clear(),o(),i++}}let i=new u.n;i.setPositions([...n.allDescendantsPositions()]),i.setColors([...n.allDescendantsColors()]);let r=new h.G({color:"white",worldUnits:!0,linewidth:.0015,vertexColors:!0});(0,l.mj)(new p.b(i,r),this),this.scale.setScalar(.25),this.material=r}}function z(){let e=(0,r.Fw)();return(0,r.dB)("slerp-scene",function*(t){e.pipeline.basicPasses.fxaa.enabled=!1,(0,l.mj)(new a.u,t).regularGrid({size:4});let n=(0,l.mj)(new P,t);n.bendAmplitude=2,n.noiseAmplitude=2,n.enableBend(),yield e.ticker.onTick(e=>{n.update(e.deltaTime)}),(0,l.mj)(new o.E({letters:!0,onBeforeCompile:e=>{(0,s.QS)(e,n.bendUniforms)}}),{parent:t,...n.bendTransform})},"always"),null}function C(){return(0,i.jsxs)(r.uB,{vertigoControls:{perspective:.5,size:1.4,focus:[0,.6,0]},children:[(0,i.jsx)("div",{className:"layer thru p-16",children:(0,i.jsx)("h1",{className:"text-4xl font-bold",children:"Umbellifer"})}),(0,i.jsx)(z,{})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[3476,1818,8636,2193,3947,5611,7190,6564,7962,9635,8921,7953,4512,7775,7436,7706,9294,5438,7833,4842,4303,8907,950,146,487,3445,3414,9717,1763,1450,358,5033,8551,1319,6852,7358],()=>t(63201)),_N_E=e.O()}]);