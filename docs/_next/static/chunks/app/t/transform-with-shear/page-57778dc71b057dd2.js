(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9561],{2210:(t,e,r)=>{"use strict";r.d(e,{d:()=>N});var n=r(28535),o=r(76999),s=r(57368),i=r(66066),a=r(15940),l=r(77674),h=r(49797),c=r(94065);let u=new h.kn4;function f(t,e){let{scale:{x:r,y:n,z:o},scaleFactor:s,shear:{x:i,y:a,z:l}}=t;e.makeRotationFromQuaternion(t.quaternion),e.multiply(u.set(1,i,a,0,0,1,l,0,0,0,1,0,0,0,0,1)),e.elements[0]*=r*s,e.elements[1]*=r*s,e.elements[2]*=r*s,e.elements[4]*=n*s,e.elements[5]*=n*s,e.elements[6]*=n*s,e.elements[8]*=o*s,e.elements[9]*=o*s,e.elements[10]*=o*s,e.setPosition(t.position)}let m=new h.Pq0,d=new h.Pq0,p=new h.Pq0,w=new h.Pq0,x=new h.Pq0,b=new h.Pq0,g=new h.Pq0;function v(t,e){let r=t.elements;e.position.set(r[12],r[13],r[14]),m.set(r[0],r[1],r[2]),d.set(r[4],r[5],r[6]),p.set(r[8],r[9],r[10]);let n=0>m.dot(w.crossVectors(d,p))?-1:1,o=m.length();x.copy(m).divideScalar(o);let s=x.dot(d);b.copy(d).addScaledVector(x,-s);let i=b.length();b.divideScalar(i);let a=x.dot(p),l=b.dot(p);g.copy(p).addScaledVector(x,-a).addScaledVector(b,-l);let h=g.length();g.divideScalar(h),n<0&&x.negate(),e.quaternion.setFromRotationMatrix(u.makeBasis(x,b,g)),e.scale.set(n*o,i,h),e.scaleFactor=1,e.shear.set(n*s/i,n*a/h,l/h)}function j(t,e){let{resetMissing:r=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return void 0!==t.position?(0,c.jj)(t.position,e.position):r&&e.position.set(0,0,0),void 0!==t.quaternion?(0,c.EC)(t.quaternion,e.quaternion):void 0!==t.rotation?e.quaternion.setFromEuler((0,c.if)(t.rotation)):r&&e.quaternion.set(0,0,0,1),void 0!==t.scale?(0,c.jj)(t.scale,e.scale):r&&e.scale.set(1,1,1),void 0!==t.scaleFactor?e.scaleFactor=t.scaleFactor:r&&(e.scaleFactor=1),void 0!==t.shear?(0,c.jj)(t.shear,e.shear):r&&e.shear.set(0,0,0),e}function y(t,e,r,n){n.position.lerpVectors(t.position,e.position,r),n.quaternion.slerpQuaternions(t.quaternion,e.quaternion,r),n.scale.lerpVectors(t.scale,e.scale,r),n.scaleFactor=t.scaleFactor+(e.scaleFactor-t.scaleFactor)*r,n.shear.lerpVectors(t.shear,e.shear,r)}function M(){return{position:new h.Pq0,quaternion:new h.PTz,scale:new h.Pq0(1,1,1),scaleFactor:1,shear:new h.Pq0}}let P=new h.kn4,q=M(),C=M(),k=M();var A=new WeakMap,F=new WeakSet;class N{static lerp(t,e,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(0,l._)(N,N,S);return j(t,q),j(e,C),y(q,C,r,n),n}static from(t){return new this().from(t)}get rotation(){return(0,i._)(this,F,z).call(this)}copy(t){return this.position.copy(t.position),this.scale.copy(t.scale),this.quaternion.copy(t.quaternion),this.shear.copy(t.shear),this}clone(){return(new this.constructor).copy(this)}toMatrix(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new h.kn4;return f(this,t),t}from(t){return t instanceof h.kn4?v(t,this):j(t,this),this}setTransform(t){let{partial:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return j(t,this,{resetMissing:!e}),this}lerpTransforms(t,e,r){return y(t,e,r,this),this}lerp(t,e){return y(this,t,e,this),this}identity(){return this.position.set(0,0,0),this.quaternion.set(0,0,0,1),this.scale.set(1,1,1),this.shear.set(0,0,0),this}isIdentity(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e-6;return this.position.lengthSq()<=t&&Math.abs(this.quaternion.x)<=t&&Math.abs(this.quaternion.y)<=t&&Math.abs(this.quaternion.z)<=t&&Math.abs(this.quaternion.w-1)<=t&&Math.abs(this.scale.x-1)<=t&&Math.abs(this.scale.y-1)<=t&&Math.abs(this.scale.z-1)<=t&&Math.abs(this.shear.x)<=t&&Math.abs(this.shear.y)<=t&&Math.abs(this.shear.z)<=t}isDirect(){let{x:t,y:e,z:r}=this.scale;return t*e*r>=0}toInfoString(){let{x:t,y:e,z:r}=this.position,{x:n,y:o,z:s}=this.scale,{x:i,y:a,z:l}=this.shear,h=this.scaleFactor,c=t=>t.toFixed(2).replace(/\.?0+$/,"");return"Position: (".concat(c(t),", ").concat(c(e),", ").concat(c(r),"), Scale: (").concat(c(n),", ").concat(c(o),", ").concat(c(s),")x(").concat(c(h),"), Shear: (").concat(c(i),", ").concat(c(a),", ").concat(c(l),")")}constructor(){(0,a._)(this,F),(0,o._)(this,A,{writable:!0,value:void 0}),this.position=new h.Pq0,this.scale=new h.Pq0(1,1,1),this.scaleFactor=1,this.quaternion=new h.PTz,this.shear=new h.Pq0,(0,s._)(this,A,null)}}N.lerpMatrixes=function(t,e,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:P;return v(t,q),v(e,C),y(q,C,r,k),f(k,n),n};var S={writable:!0,value:new N};function z(){if(null===(0,n._)(this,A)){let t=new h.O9p().setFromQuaternion(this.quaternion);return t._onChangeCallback=()=>{this.quaternion.setFromEuler(t)},(0,s._)(this,A,t)}return(0,n._)(this,A)}},4941:(t,e,r)=>{"use strict";r.d(e,{_5:()=>o.ol,YN:()=>o.o8,cz:()=>s,kY:()=>o.kY});var n=r(37197),o=r(40074);let s={transition:o.kY,bump:n.$p}},13160:(t,e,r)=>{"use strict";r.d(e,{Q:()=>s});var n=r(49797),o=r(94065);class s{static setColor(t,e){let r=t.attributes.position.count,o=new n.THS(new Float32Array(3*r),3),{r:s,g:i,b:a}=new n.Q1f(e);for(let t=0;t<r;t++)o.setXYZ(t,s,i,a);return t.setAttribute("color",o),t}static setAsBounds(t,e,r){let{x:s,y:i,z:a}=(0,o.jj)(e),{x:l,y:h,z:c}=(0,o.jj)(r),u=new Float32Array([s,i,a,l,i,a,l,i,a,l,h,a,l,h,a,s,h,a,s,h,a,s,i,a,s,i,c,l,i,c,l,i,c,l,h,c,l,h,c,s,h,c,s,h,c,s,i,c,s,i,a,s,i,c,l,i,a,l,i,c,l,h,a,l,h,c,s,h,a,s,h,c]);return null!=t||(t=new n.LoY),t.setAttribute("position",new n.THS(u,3)),t.computeBoundingBox(),t.computeBoundingSphere(),t}}},16465:(t,e,r)=>{"use strict";r.d(e,{Y:()=>i});var n=r(49797),o=r(7147);let s={shadowColor:"#808080",luminosity:1,rampPower:1,onBeforeCompile:void 0};class i extends n.V9B{constructor(t){let{rampPower:e,shadowColor:r,luminosity:i,onBeforeCompile:a,...l}={...s,...t},h={uSunPosition:{value:new n.Pq0(.5,.7,.3)},uShadowColor:{value:new n.Q1f(r)},uRampPower:{value:e},uLuminosity:{value:i}};super(l),this.onBeforeCompile=t=>{o.bI.with(t).uniforms(h).varying({vAutoLitWorldNormal:"vec3"}).vertex.mainAfterAll("\n          vAutoLitWorldNormal = mat3(modelMatrix) * normal;\n          #ifdef USE_INSTANCING\n            vAutoLitWorldNormal = mat3(instanceMatrix) * vAutoLitWorldNormal;\n          #endif\n        ").fragment.after("map_fragment","\n          vec3 normal = normalize(vAutoLitWorldNormal);\n          vec3 lightDirection = normalize(uSunPosition);\n          float light = dot(normal, lightDirection) * 0.5 + 0.5;\n          light = pow(light, uRampPower);\n          diffuseColor.rgb *= mix(uShadowColor * uLuminosity, vec3(1.0), light);\n        "),null==a||a(t)},this.sunPosition=h.uSunPosition.value}}},34011:(t,e,r)=>{"use strict";r.d(e,{e:()=>l,k:()=>c});var n=r(49797),o=r(38921);let s={axis:"x",length:1,radialSegments:12,radius:.01,coneRatio:.1,radiusScale:1,vertexColor:!0,baseCap:"flat",color:"white",align:0,heightSegments:1},i=new n.Q1f;function a(t){let{axis:e,length:r,radius:a,radialSegments:l,heightSegments:h,coneRatio:c,radiusScale:u,vertexColor:f,baseCap:m,color:d,align:p}={...s,...t},w=a*u,x=r*c,b=Math.max(1,Math.ceil(h*c)),g=Math.max(1,Math.ceil(h*(1-c))),v=new n.qFE(3*w,x,l,b),j=new n.Ho_(w,w,1,l,g,!0),y=r-x,M=r-.5*x;v.rotateZ(-Math.PI/2).translate(M,0,0),j.scale(1,y,1).rotateZ(-Math.PI/2).translate(.5*y,0,0);let P="none"===m?new n.LoY:"flat"===m?new n.tcD(w,l).rotateY(-Math.PI/2):new n.Gu$(w,l,3,0,2*Math.PI,0,.5*Math.PI).rotateZ(Math.PI/2).rotateX(Math.PI/2),q=(0,o.pP)([v,j,P]);switch(0!==p&&q.translate(-r*p,0,0),e){case"y":q.rotateZ(Math.PI/2);break;case"z":q.rotateY(-Math.PI/2)}if(f){let t=q.attributes.position.count,e=new n.THS(new Float32Array(3*t),3);q.setAttribute("color",e),i.set(d);for(let r=0;r<t;r++)e.setXYZ(r,i.r,i.g,i.b)}return q}class l extends n.LoY{constructor(t){super();let e=a(t);this.copy(e),e.dispose()}}let h={xColor:"#ff3333",yColor:"#33cc66",zColor:"#3366ff"};class c extends n.LoY{static get defaultOptions(){return{...h}}constructor(t){super();let{xColor:e,yColor:r,zColor:n,...s}={...h,...t},i=a({...s,axis:"x",color:e}),l=a({...s,axis:"y",color:r}),c=a({...s,axis:"z",color:n}),u=(0,o.pP)([i,l,c]);this.copy(u),u.dispose()}}},38062:(t,e,r)=>{"use strict";r.d(e,{o:()=>n});let n={triangle:function(t){let{frequency:e=1,phase:r=0,f:n=e,p:o=r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t*n+o,i=2*s-Math.floor(2*s);return s-Math.floor(s)<.5?i:1-i}}},42220:(t,e,r)=>{"use strict";r.d(e,{Client:()=>k});var n=r(70691),o=r(49797),s=r(33540),i=r(77794),a=r(79911),l=r(2210),h=r(34011),c=r(13160),u=r(16465),f=r(79285),m=r(4941),d=r(38062),p=r(80446);r(18479);var w=r(31763),x=r(67235);r(36508);class b extends o.YJl{constructor(t="white"){super();let{torusKnotGeometry:e,axesGeometry:r,autoLitVertexColorsMaterial:n,cubeGeometry:s}=b.shared;(0,a.mj)(new o.eaF(e,new u.Y({color:t})),this),(0,a.mj)(new o.eaF(r,n),this),(0,a.mj)(new o.DXC(s,new o.mrM({color:t})),this)}}function g(t){let{children:e}=t;return(0,n.jsx)("div",{className:"ui layer thru p-8 flex flex-col gap-4 items-start",children:(0,n.jsx)("div",{className:"max-w-md flex flex-col gap-2 items-start p-4 backdrop-blur rounded-xl border border-white/10 bg-white/2",children:e})})}function v(t){let{label:e="Button",onClick:r=()=>{}}=t;return(0,n.jsx)("button",{className:"btn border rounded px-2 py-1 hover:bg-white/10 active:bg-white/20",onClick:r,children:e})}function j(){return(0,n.jsxs)(g,{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Matrix with Shear"}),(0,n.jsx)("p",{children:"Transform interpolation (lerp) between two random transforms using TransformWithShear (some-utils-three/experimental/transform-with-shear)."}),(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:"text-[#ff99ff]",children:"Pink color"})," indicates that the two transforms are not both direct or both indirect (reflection)."]}),(0,n.jsx)("p",{children:"Based on research here:"}),(0,n.jsxs)("ul",{className:"list-disc list-inside",children:[(0,n.jsx)("li",{children:(0,n.jsx)("a",{className:"underline hover:text-[cyan]",href:"/l/transform-with-shear/0-intro",children:"0-intro"})}),(0,n.jsx)("li",{children:(0,n.jsx)("a",{className:"underline hover:text-[cyan]",href:"/l/transform-with-shear/1-shear",children:"1-shear"})}),(0,n.jsx)("li",{children:(0,n.jsx)("a",{className:"underline hover:text-[cyan]",href:"/l/transform-with-shear/2-decompose",children:"2-decompose"})}),(0,n.jsx)("li",{children:(0,n.jsx)("a",{className:"underline hover:text-[cyan]",href:"/l/transform-with-shear/3-transform-with-shear",children:"3-transform-with-shear"})})]}),(0,n.jsx)("div",{className:"basis-2"}),(0,n.jsx)(v,{label:"Orthographic (reset)",onClick:()=>{x.Q.send(w.n).assertPayload().vertigo.set({perspective:0,zoom:.98,focus:0,rotation:0})}}),(0,n.jsx)(v,{label:"Perspective",onClick:()=>{x.Q.send(w.n).assertPayload().vertigo.set({perspective:1})}})]})}b.shared={torusKnotGeometry:new o.UPV(.15,.07,256,64),axesGeometry:new h.k,cubeGeometry:c.Q.setAsBounds(new o.LoY,0,1),autoLitVertexColorsMaterial:new u.Y({vertexColors:!0})},o.YJl;class y extends o.YJl{setColor(t){return this.box.material.color.set(t),this.axes.material.color.set(t),this.knot.material.color.set(t),this}setTransform(t){return this.matrixAutoUpdate=!1,this.transform.setTransform(t).toMatrix(this.matrix),this}constructor(t){super(),this.box=(0,a.mj)(new o.DXC(c.Q.setAsBounds(null,-1,1),new o.mrM),this),this.axes=(0,a.mj)(new o.eaF(y.shared.axesGeometry,new u.Y({vertexColors:!0})),this),this.knot=(0,a.mj)(new o.eaF(y.shared.knotGeometry,new u.Y),this),this.transform=new l.d,t&&this.setColor(t)}}y.shared={axesGeometry:new h.k({radius:.04,coneRatio:.2,length:1}),knotGeometry:new o.UPV(.3,.1,512,64)};class M extends o.YJl{onTick(t){let e=m.kY.inOut3((0,f.inverseLerp)(.05,.95,d.o.triangle(t.time,{f:.2})));this.objC.matrixAutoUpdate=!1,this.useMatrixInterpolation?l.d.lerpMatrixes(this.objA.matrix,this.objB.matrix,e,this.objC.matrix):this.objC.transform.lerpTransforms(this.objA.transform,this.objB.transform,e).toMatrix(this.objC.matrix),this.objC.setColor(this.objA.transform.isDirect()===this.objB.transform.isDirect()?"white":"#ff99ff")}constructor(){super(),this.useMatrixInterpolation=!0,this.objA=(0,a.mj)(new y("yellow"),this),this.objB=(0,a.mj)(new y("cyan"),this),this.objC=(0,a.mj)(new y,this),this.objA.setTransform({position:[-2,0,0]}),this.objB.setTransform({position:[2,0,0]})}}function P(){return(0,s.dB)("demo-1",function*(t){(0,a.mj)(new i.u,t).regularGrid({size:8,subdivisions:[2,4],opacity:[1,.1]}).text(0,"matrix-to-matrix",{color:"white"});let e=(0,a.mj)(new M,t);e.objA.setTransform({rotation:["9deg","0deg","20deg"],shear:[1,0,0]}),e.objB.setTransform({scale:[1,-2,.5],rotation:["-10deg","70deg",0],shear:[0,1,0]}),p.n.setRandom("parkmiller",1234);for(let e=0;e<3;e++)for(let r of[-1,1]){let n=(0,a.mj)(new M,t);n.position.y=4*(e+1)*r,n.objA.setTransform({position:[p.n.number(-3,-1),p.n.number(-1,1),p.n.number(-1,1)],scale:[p.n.number(-1,1),p.n.number(-1,1),p.n.number(-1,1)],rotation:p.n.quaternion(),shear:[p.n.number(-1,1),p.n.number(-1,1),p.n.number(-1,1)]}),n.objB.setTransform({position:[p.n.number(1,3),p.n.number(-1,1),p.n.number(-1,1)],scale:[p.n.number(-1,1),p.n.number(-1,1),p.n.number(-1,1)],rotation:p.n.quaternion(),shear:[p.n.number(-1,1),p.n.number(-1,1),p.n.number(-1,1)]})}},[]),null}function q(){return(0,s.dB)("demo-2",function*(t){(0,a.mj)(t,{x:12}),(0,a.mj)(new i.u,t).regularGrid({size:8,subdivisions:[2,4],opacity:[1,.1]}).text(0,"scaleFactor",{color:"white"});let e=(0,a.mj)(new M,t);e.objA.setTransform({rotation:[0,"-90deg",0]}),e.objB.setTransform({rotation:[0,"90deg",0],shear:[1,1,0],scaleFactor:1.5})},[]),null}function C(){return(0,s.Fw)(function*(t){t.pipeline.basicPasses.fxaa.enabled=!1}),(0,s.dB)("my-scene",function*(t,e){},[]),null}function k(){return(0,n.jsxs)(s.uB,{vertigoControls:{eventTarget:"canvas",size:8,zoom:.75,rotation:["-5deg","10deg",0],focus:[0,0,1.5]},children:[(0,n.jsx)(j,{}),(0,n.jsx)(C,{}),(0,n.jsx)(P,{}),(0,n.jsx)(q,{})]})}},66489:(t,e,r)=>{Promise.resolve().then(r.bind(r,42220))},66620:(t,e,r)=>{"use strict";r.d(e,{_:()=>s});var n=r(89868),o=r(44138);function s(t,e){var r=(0,o._)(t,e,"update");return(0,n._)(t,r)}},79105:(t,e,r)=>{"use strict";r.d(e,{K2:()=>i,KP:()=>o,Tj:()=>a,Ts:()=>s,Zu:()=>n});let n=0x7fffffff,o=123456,s=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;if(Number.isNaN(t))throw Error("NaN is not a valid seed.");let e=t;if(10>Math.abs(e)&&(e*=1e6),e%=n,(e=e<0?e+n:e)>1)return e&n;if(0===e)return o;throw Error("Impossible. ".concat(e))},i=t=>t=Math.imul(t,48271)&n,a=t=>(t-1)/(n-1)},80446:(t,e,r)=>{"use strict";r.d(e,{n:()=>o});var n=r(79105);let o=function t(){let e=Math.random,r=()=>{};function o(t){let e=0;for(let r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r)|0;return e}function s(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];if(0===r.length)return e();if(1===r.length)return e()*r[0];if(2===r.length)return e()*(r[1]-r[0])+r[0];throw Error("Invalid arguments")}function i(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];if(1===r.length)return Math.floor(e()*r[0]);if(2===r.length)return Math.floor(e()*(r[1]-r[0]))+r[0];throw Error("Invalid arguments")}function a(t){let{weightsAreNormalized:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===t.length)throw Error("Weights array is empty");if(!1===r){let r=t.reduce((t,e)=>t+e,0),n=e()*r,o=0;for(let e=0;e<t.length;e++)if(n<(o+=t[e]))return e;return t.length-1}{let r=e(),n=0;for(let e=0;e<t.length;e++)if(r<(n+=t[e]))return e;return t.length-1}}let l={new:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return t().setRandom(...r)},setRandom:function(){for(var t=arguments.length,s=Array(t),i=0;i<t;i++)s[i]=arguments[i];let[a,h=0]=s,c="string"==typeof h?o(h):h;if("parkmiller"===a){let t=n.Ts(c);e=()=>(t=n.K2(t),n.Tj(t)),r=e=>{t=n.Ts(e)}}else{if(void 0!==a&&"function"!=typeof a)throw Error("Invalid random function");e=null!=a?a:Math.random,r=()=>{}}return r(c),l},seed:function(t){return r("string"==typeof t?o(t):null!=t?t:0),l},get random(){return e},chance:function(t){return e()<t},number:s,float:s,f:s,sign:function(){return .5>e()?-1:1},int:i,i:i,hexColor:function(){let t=Math.floor(0xffffff*e());return"#".concat(t.toString(16).padStart(6,"0"))},pickIndex:a,pick:function(t,r){if(0===t.length)throw Error("Array is empty");if(r)return t[a(r)];let n=Math.floor(e()*t.length);return t[n]},createPicker:function(t){let e=t.map(t=>t[0]),r=t.map(t=>t[1]),n=e.reduce((t,e)=>t+e,0);for(let t=0;t<e.length;t++)e[t]/=n;return()=>r[a(e,{weightsAreNormalized:!0})]},direction2:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},r=e()*Math.PI*2;return t.x=Math.cos(r),t.y=Math.sin(r),t},direction3:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0},r=e(),n=e(),o=2*Math.PI*r,s=Math.acos(1-2*n);return t.x=Math.sin(s)*Math.cos(o),t.y=Math.sin(s)*Math.sin(o),t.z=Math.cos(s),t},quaternion:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0,w:1},r=e(),n=e(),o=e(),s=Math.sqrt(1-r),i=Math.sqrt(r);return t.x=s*Math.sin(2*Math.PI*n),t.y=s*Math.cos(2*Math.PI*n),t.z=i*Math.sin(2*Math.PI*o),t.w=i*Math.cos(2*Math.PI*o),t},shuffleIndexes:function*(t){if(t<=0)throw Error("N must be greater than 0");let r=0,n=Math.floor((2+2*e())*t);for(;1!==function(t,e){for(;0!==e;)[t,e]=[e,t%e];return t}(t,n);){if(++r>1e3)throw Error("Failed to find a suitable a value after 1000 attempts");n=t+Math.floor(e()*t)}let o=Math.floor(e()*t);for(let e=0;e<t;e++)yield(o+e*n)%t}};return l}()}},t=>{var e=e=>t(t.s=e);t.O(0,[5611,7190,6564,7962,9635,8921,7953,4512,7775,7436,146,6726,3445,9332,3414,9717,1763,9215,3540,1319,6852,7358],()=>e(66489)),_N_E=t.O()}]);