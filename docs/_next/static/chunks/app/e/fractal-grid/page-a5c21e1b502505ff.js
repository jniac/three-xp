(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4487],{4003:(t,e,o)=>{"use strict";o.d(e,{w:()=>r.w});var r=o(3461)},8597:(t,e,o)=>{"use strict";o.d(e,{Bg:()=>n,Dm:()=>a,NP:()=>i,OZ:()=>s,RY:()=>p,gc:()=>g,mj:()=>f,rU:()=>l,uJ:()=>u,xO:()=>w});var r=o(49797);let i=6,n=4,s=new r.Pq0(i,n,i+n-1),l=[new r.Pq0(0,0,n),new r.Pq0(0,n,0),new r.Pq0(i,0,n+i-1),new r.Pq0(i,n,i)],a=new r.Pq0(0,-2*n,2*n),c=new r.Pq0(1,0,1).normalize(),h=new r.Pq0(0,1,-1).normalize(),d=new r.Pq0().crossVectors(c,h).normalize();h.crossVectors(d,c).normalize();let u={U:c,V:h,W:d},p=new r.kn4().makeBasis(c,h,d).setPosition(a),f=new r.kn4().copy(p).invert(),w=new r.O9p().setFromRotationMatrix(p),g=new r.Zcv().setFromNormalAndCoplanarPoint(d,a)},21277:(t,e,o)=>{"use strict";o.d(e,{N:()=>n});var r=o(49797);let i=new r.WBB(1,4);class n extends r.eaF{constructor(t){super(i,new r.V9B({color:"#0c529d",...t,side:r.hsX,depthWrite:!1,depthTest:!1})),this.renderOrder=-1,this.frustumCulled=!1,this.matrixAutoUpdate=!1,this.onBeforeRender=(t,e,o)=>{let r=(o.near+o.far)/2;this.position.copy(o.position),this.scale.setScalar(r),this.updateMatrix(),this.updateMatrixWorld()}}}},23120:(t,e,o)=>{"use strict";o.d(e,{hB:()=>p,hf:()=>y});var r=o(49797),i=o(93432),n=o(68955),s=o(16465),l=o(3293),a=o(79911),c=o(72612),h=o(17099),d=o(8597);function u(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new r.Pq0;return o.set(t,e,t-e)}function p(){let t;for(var e,o,i=arguments.length,n=Array(i),s=0;s<i;s++)n[s]=arguments[s];let l=0,a=0;if("number"==typeof n[0])[l,a]=n,t=null!=(e=n[3])?e:new r.I9Y;else{let[e]=n;l=e.x,a=e.y,t=null!=(o=n[1])?o:new r.I9Y}let c=-Math.log2((a/d.Bg+1)/2)-1,h=.5**c,u=l/(d.NP*h);return t.set(u,c)}function f(t,e,o){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,{x:i,y:n,z:s}=e,l=i+o,a=n+o,c=s+o;for(let e=s;e<c;e++)for(let o=n;o<a;o++)for(let n=i;n<l;n++)t.getVoxelState(n,o,e+4*d.Bg).setInt8(0,r)}function w(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,o=d.OZ.clone().multiplyScalar(4/e),i=[];for(let n of(0,c.loop3)(o)){let o=n.x*e,s=n.y*e,l=n.z*e;(function(t,e,o,r){var i,n,s,l,a,c;let h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return!!(t.getVoxelState(e,o,r).getInt8(0)>0)&&!((null!=(l=null==(i=t.tryGetVoxelState(e-h,o,r))?void 0:i.getInt8(0))?l:0)>0)&&!((null!=(a=null==(n=t.tryGetVoxelState(e,o+h,r))?void 0:n.getInt8(0))?a:0)>0)&&!((null!=(c=null==(s=t.tryGetVoxelState(e,o,r+h))?void 0:s.getInt8(0))?c:0)>0)})(t,o,s,l,e)&&h.c.chance(1-n.py)&&i.push(new r.Pq0(o,s,l))}return i}function g(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,o=d.OZ.clone().multiplyScalar(4/e),i=[];for(let n of(0,c.loop3)(o)){let o=n.x*e,s=n.y*e,l=n.z*e;(function(t,e,o,r){var i,n,s,l,a,c;let h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return!(t.getVoxelState(e,o,r).getInt8(0)>0)&&!!((null!=(l=null==(i=t.tryGetVoxelState(e+h,o,r))?void 0:i.getInt8(0))?l:0)>0)&&!!((null!=(a=null==(n=t.tryGetVoxelState(e,o-h,r))?void 0:n.getInt8(0))?a:0)>0)&&!!((null!=(c=null==(s=t.tryGetVoxelState(e,o,r-h))?void 0:s.getInt8(0))?c:0)>0)})(t,o,s,l,e)&&h.c.chance(1-n.py)&&i.push(new r.Pq0(o,s,l))}return i}let m=new r.Pq0;new r.Pq0;class y extends r.eaF{createDots(){let t=new r.ZLX(new r.WBB(.1,8),new s.Y,4);for(let[e,o]of((0,a.mj)(t,this),d.rU.entries()))t.setMatrixAt(e,(0,l.w)({position:o})),t.setColorAt(e,(0,l._)("#ffffff"));return this.dots=t,this}updateDots(t){this.dots||this.createDots();let e=this.dots;for(let[o,r]of d.rU.entries()){e.setMatrixAt(o,(0,l.w)({position:r}));let i=t.isWithin(r)?"#00ffa6":"#ff0000";e.setColorAt(o,(0,l._)(i))}e.instanceMatrix.needsUpdate=!0,e.instanceColor.needsUpdate=!0}get gridCoords(){return this._gridCoords}setGridCoords(t){(0,i.wX)(t,this._gridCoords);let{x:e,y:o}=this._gridCoords;this.scale.setScalar(.5**o),function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new r.Pq0,i=.5**e,n=t*d.NP*i,s=d.Bg*(.5*i*2-1),l=t*d.NP*i+2*d.Bg*(1-i);o.set(n,s,l)}(e,o,this.position)}toWhite(){this.material.color.set(0xffffff)}toColor(){this.material.color.set(this.color)}constructor({world:t=null,color:e=0xffffff*h.c.random()}={}){let o=Math.ceil(d.NP*d.Bg*4.8),i=new n.AA(o,1);for(let{x:t,y:e}of(0,c.loop2)(d.NP,d.Bg))u(t,e,m).multiplyScalar(4),f(i,m,4);for(let t=0;t<d.NP;t+=2)u(t,d.Bg-1,m).add(new r.Pq0(1,0,0)).multiplyScalar(4),f(i,m,4),h.c.chance(.8)&&(u(t,d.Bg-1,m).add(new r.Pq0(1,1,0)).multiplyScalar(4),f(i,m,4));{let t=g(i,2),e=w(i,2);for(let e of t)f(i,e,2,1);for(let t of e)f(i,t,2,0)}{let t=g(i,1),e=w(i,1);for(let e of t)h.c.chance(.25)&&f(i,e,1,1);for(let t of e)h.c.chance(.25)&&f(i,t,1,0)}console.time("geometry");let l=(0,n.Cx)(i.voxelFaces());console.timeEnd("geometry");l.scale(.25,.25,.25);let p=new s.Y({color:e});super(l,new s.Y({color:e,side:r.$EB})),this._gridCoords=new r.I9Y,this.world=null,this.dots=null,(0,a.mj)(new r.eaF(l,p),this),(0,a.mj)(new r.IzY,this),this.chunk=i,this.color=e,this.world=t}}},28737:(t,e,o)=>{"use strict";o.d(e,{Leak:()=>d,O:()=>h});var r={};o.r(r),o.d(r,{distribute:()=>n.mn,every:()=>n.Si,findMaxBy:()=>n.vj,pairwise:()=>n.Ju,recordBy:()=>n.VY,some:()=>n.zN,split:()=>n.mn,uniqueBy:()=>n.pD});var i=o(30158),n=o(43107),s=o(38062),l=o(85795),a=o(17099),c=o(96122);function h(t){Object.assign(window,{...i,...l,...r,...t,PRNG:a.c,waveform:s.o,dedent:c.T})}function d(t){return h(t),null}},34011:(t,e,o)=>{"use strict";o.d(e,{k:()=>c});var r=o(49797),i=o(38921);let n={axis:"x",length:1,radialSegments:12,radius:.01,coneRatio:.1,radiusScale:1,vertexColor:!0,baseCap:"flat",color:"white",align:0},s=new r.Q1f;function l(t){let{axis:e,length:o,radius:l,radialSegments:a,coneRatio:c,radiusScale:h,vertexColor:d,baseCap:u,color:p,align:f}={...n,...t},w=l*h,g=o*c,m=new r.qFE(3*w,g,a),y=new r.Ho_(w,w,1,a,1,!0),x=o-g,C=o-.5*g;m.rotateZ(-Math.PI/2).translate(C,0,0),y.scale(1,x,1).rotateZ(-Math.PI/2).translate(.5*x,0,0);let v="none"===u?new r.LoY:"flat"===u?new r.tcD(w,a).rotateY(-Math.PI/2):new r.Gu$(w,a,3,0,2*Math.PI,0,.5*Math.PI).rotateZ(Math.PI/2).rotateX(Math.PI/2),P=(0,i.pP)([m,y,v]);switch(0!==f&&P.translate(-o*f,0,0),e){case"y":P.rotateZ(Math.PI/2);break;case"z":P.rotateY(-Math.PI/2)}if(d){let t=P.attributes.position.count,e=new r.THS(new Float32Array(3*t),3);P.setAttribute("color",e),s.set(p);for(let o=0;o<t;o++)e.setXYZ(o,s.r,s.g,s.b)}return P}r.LoY;let a={xColor:"#ff3333",yColor:"#33cc66",zColor:"#3366ff"};class c extends r.LoY{static get defaultOptions(){return{...a}}constructor(t){super();let{xColor:e,yColor:o,zColor:r,...n}={...a,...t},s=l({...n,axis:"x",color:e}),c=l({...n,axis:"y",color:o}),h=l({...n,axis:"z",color:r}),d=(0,i.pP)([s,c,h]);this.copy(d),d.dispose()}}},38062:(t,e,o)=>{"use strict";o.d(e,{o:()=>r});let r={triangle:function(t){let{frequency:e=1,phase:o=0,f:r=e,p:i=o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t*r+i,s=2*n-Math.floor(2*n);return n-Math.floor(n)<.5?s:1-s}}},43107:(t,e,o)=>{"use strict";function r(t,e){for(let o of t)if(e(o))return!0;return!1}function i(t,e){for(let o of t)if(!e(o))return!1;return!0}function n(t,e,o){let r=[];function i(t){let e=[];return r[t]=e,e}if(void 0!==o)for(let t=0;t<o;t++)i(t);for(let o of t){var n;let t=e(o);(null!=(n=r[t])?n:i(t)).push(o)}return r}function*s(t){let e;for(let o of t)void 0!==e&&(yield[e,o]),e=o}function l(t,e){let o,r=-1/0;for(let i of t){let t=e(i);t>r&&(r=t,o=i)}return o}function a(t){let e=new Set;return o=>{let r=t(o);return!e.has(r)&&(e.add(r),!0)}}function c(t){return(e,o)=>{if(null!==e&&"object"!=typeof e)throw Error("Accumulator must be an object");let r=null===e?{}:e,i=t(o);return r[i]||(r[i]=[]),r[i].push(o),r}}o.d(e,{Ju:()=>s,Si:()=>i,VY:()=>c,mn:()=>n,pD:()=>a,vj:()=>l,zN:()=>r})},50411:(t,e,o)=>{"use strict";o.d(e,{Main:()=>T});var r,i=o(70691),n=o(25432),s=o(88575),l=o(4003),a=o(72612),c=o(79285),h=o(63126),d=o(28737),u=o(49797),p=o(99332),f=o(31763),w=o(39787),g=o(36508),m=o(7693),y=o(48181),x=o(79911),C=o(44694),v=o(8597);class P extends u.YJl{static current(){if(0===this.instances.length)throw Error("No Scope!");return this.instances[this.instances.length-1]}updateScope(){let{aspect:t=1,size:e=4}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t>1?e:e*t,r=o/t;(o!==this.state.width||r!==this.state.height)&&(this.parts.lines.clear().circle({radius:1}).rectangle([-o/2,-r/2,o,r]).plus([0,0],.2).draw(),this.parts.lines.geometry.computeBoundingSphere(),this.state.width=o,this.state.height=r)}isWithin(t){let{x:e,y:o}=t.clone().applyMatrix4(this.matrixWorldInverse),{width:r,height:i}=this.state;return e>=-r/2&&e<=r/2&&o>=-i/2&&o<=i/2}chunkIntersects(t){this.updateMatrixWorld(),t.updateMatrixWorld();let e=!0,o=!0,r=!0,i=!0,n=this.state.width/2,s=this.state.height/2;for(let l=0;l<4;l++){let{x:a,y:c,z:h}=P._chunkIntersectsVectors[l].copy(v.rU[l]).applyMatrix4(t.matrixWorld).applyMatrix4(this.matrixWorldInverse);if(e&&(e=a<-n),r&&(r=a>n),o&&(o=c<-s),i&&(i=c>s),!1===(e||o||r||i))return!0}return!1}toVertigoProps(){let{width:t,height:e}=this.state;return{perspective:.5,size:[t,e],focus:this.position,rotation:this.rotation}}constructor(){super(),this.parts={lines:(0,x.mj)(new y.R,this),debugLines:(0,x.mj)(new y.R,this)},this.state={width:4,height:4},this.matrixWorldInverse=new u.kn4,this.destroy=()=>{let t=P.instances.indexOf(this);if(-1===t)throw Error("Scope instance not found");P.instances.splice(t,1)},P.instances.push(this),this.position.set(0,0,6),this.rotation.setFromRotationMatrix(v.RY,m.B.default.rotation.order),this.rotation.x+=(0,C.ey)("20deg"),this.updateMatrix(),this.updateMatrixWorld(),this.matrixWorldInverse.copy(this.matrixWorld).invert()}}P.instances=[],P._chunkIntersectsVectors=[new u.Pq0,new u.Pq0,new u.Pq0,new u.Pq0];var k=o(34011),S=o(16465),M=o(23120);function j(t,e){if(t<-32768||t>=32768||e<-32768||e>=32768)throw RangeError("x and y must be in the range -0x8000 to 0x7fff, received: ".concat(t," (0x").concat(t.toString(16),"), ").concat(e," (0x").concat(e.toString(16),")"));return(t+=32768)<<16|(e+=32768)}let Y=new u.I9Y;function*b(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];let[r,i]=(()=>{if(1!==e.length)return e;{let{x:t,y:o}=(0,C.wX)(e[0]);return[t,o]}})();yield Y.set(Math.floor((r-1)/2),i-1),yield Y.set(Math.floor((r+1)/2),i-1),yield Y.set(r-1,i),yield Y.set(r+1,i),yield Y.set(2*r-1,i+1),yield Y.set(2*r,i+1),yield Y.set(2*r+1,i+1),yield Y.set(2*r+2,i+1)}class I extends u.YJl{drawCircles(){let{count:t=1,step:e=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(let o=1;o<t;o++){let t=1+o*e;(0,x.mj)(new u.DXC(this.parts.circles.geometry,this.parts.circles.material),{parent:this,scaleScalar:t})}return this}constructor(...t){super(...t),this.parts=(()=>{let t=new y.R;t.circle({radius:1,color:k.k.defaultOptions.zColor}).circle({radius:1,color:k.k.defaultOptions.xColor,transform:{rotationY:"90deg"}}).circle({radius:1,color:k.k.defaultOptions.yColor,transform:{rotationX:"90deg"}}).draw();let e=new u.eaF(new k.k,new S.Y({vertexColors:!0}));return{axes:(0,x.mj)(e,this),circles:(0,x.mj)(t,this)}})()}}class N extends u.YJl{static current(){if(0===this.instances.length)throw Error("No World!");return this.instances[this.instances.length-1]}scopeUpdate(t){let e=(0,h.calculateExponentialDecayLerpRatio)(1e-4,t);this.dampedScopeCoordinates.lerp(this.scopeCoordinates,e);let{x:o,y:r}=this.dampedScopeCoordinates;this.scope.position.set(0,0,6).addScaledVector(v.uJ.U,o),this.worldScale=2**(.33*r),this.setChunkGroupScale(this.worldScale)}getChunk(t,e){var o;return null!=(o=this.chunks.get(j(t,e)))?o:null}ensureChunk(t,e){let o=j(t,e),r=this.chunks.get(o);if(r)return r;{let o=(0,x.mj)(new M.hf({world:this}),this.chunkGroup);return this.chunks.set(j(t,e),o),o.setGridCoords([t,e]),o}}ensureChunkNeighbors(t,e){for(let o of(this.ensureChunk(t,e),b(t,e)))this.ensureChunk(o.x,o.y)}ensureScopeChunks(){let t=new Set([j(0,0)]),e=[this.ensureChunk(0,0)],o=0;for(;e.length>0;){if(o++>100){console.error("Exceeded maximum chunk count of ".concat(100));break}let r=e.pop();if(this.scope.chunkIntersects(r))for(let o of b(r.gridCoords)){let r=j(o.x,o.y);t.has(r)||(t.add(r),e.push(this.ensureChunk(o.x,o.y)))}}}toWhite(){for(let t of this.chunks.values())t.toWhite()}toColor(){for(let t of this.chunks.values())t.toColor()}constructor(){super(),this.origin=(0,x.mj)(new u.IzY,{parent:this,position:v.Dm,rotation:v.xO}),this.chunkGroup=(0,x.mj)(new u.YJl,{parent:this}),this.scopeCoordinates=new u.I9Y,this.dampedScopeCoordinates=new u.I9Y,this.worldScale=1,this.scopeOriginPoint=new u.Pq0,this.scopeCenterChunkPoint=new u.Pq0,this.scope=(0,x.mj)(new P,this),this.XXX=(0,x.mj)(new I,this.chunkGroup),this.YYY=new u.I9Y,this.setChunkGroupScale=(()=>{let t=new u.kn4;return e=>{var o;this.scopeCenterChunkPoint.copy(this.scope.position).applyMatrix4(v.mj),this.scopeOriginPoint.set(this.scopeCenterChunkPoint.x,0,0).applyMatrix4(v.RY),this.chunkGroup.position.copy(this.scopeOriginPoint).addScaledVector(this.scopeOriginPoint,-e),this.chunkGroup.scale.setScalar(e),this.chunkGroup.updateMatrix(),this.XXX.position.copy(this.scope.position).applyMatrix4(v.mj),this.XXX.position.z=0,this.XXX.position.applyMatrix4(v.RY).applyMatrix4(t.copy(this.chunkGroup.matrix).invert());let{x:r,y:i}=(0,M.hB)(this.XXX.position,this.YYY);r=Math.round(r-.5),i=Math.round(i+.5),this.toWhite(),null==(o=this.getChunk(r,i))||o.toColor()}})(),this.chunks=new Map,this.destroy=()=>{this.scope.destroy(),this.chunks.clear(),this.clear();let t=N.instances.indexOf(this);if(-1===t)throw Error("World instance not found");N.instances.splice(t,1)},N.instances.push(this)}}N.instances=[];var B=function(t){return t[t.Free=0]="Free",t[t.Scope=1]="Scope",t}(B||{});class V{initialize(t){return this.element=t,this}*doStart(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!=(r=this.element)?r:document.body;yield(0,p.s)(t,{onDrag:t=>{let e=N.current();e.scopeCoordinates.x+=-(.005*t.delta.x)/e.worldScale,e.scopeCoordinates.y+=-(.01*t.delta.y)}}),yield(0,g.xy)("three",t=>{let e=N.current();e.scopeUpdate(t.deltaTime);let o=e.scope.position;this.vertigoControls.vertigo.set({focus:o}),this.vertigoControls.dampedVertigo.set({focus:o})})}start(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];this._started||(this._destroyables.collect(this.doStart(...e)),this._started=!0)}stop(){this._started&&(this._destroyables.destroy(),this._started=!1)}toggle(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this._started;t?this.start():this.stop()}update(t,e,o){this.vertigoControls.update(t,e,o)}constructor(){this.position=new u.I9Y,this.dampedPosition=new u.I9Y,this.scale=1,this._destroyables=new w.el,this.vertigoControls=new f.n({perspective:.5}),this._started=!1,this.destroy=()=>{this._destroyables.destroy()}}}class O{get mode(){return this._mode}set mode(t){this.setMode(t)}initialize(t,e){this.camera=t,this.freeVertigoControls.initialize(e).toggle(0===this._mode),this.scopeCameraHandler.initialize(e).toggle(1===this._mode);let o=P.current().toVertigoProps();return this.scopeCameraHandler.vertigoControls.vertigo.set(o),this.scopeCameraHandler.vertigoControls.dampedVertigo.set(o),this}setMode(t){if(t%=2,this._mode!==t)switch(this._mode=t,this.freeVertigoControls.toggle(0===t),this.scopeCameraHandler.toggle(1===t),t){case 0:this.mode=O.Mode.Free,this.freeVertigoControls.dampedVertigo.copy(this.scopeCameraHandler.vertigoControls.dampedVertigo);break;case 1:this.mode=O.Mode.Scope,this.scopeCameraHandler.vertigoControls.dampedVertigo.copy(this.freeVertigoControls.dampedVertigo),this.scopeCameraHandler.vertigoControls.vertigo.set(P.current().toVertigoProps())}}onTick(t,e){switch(this._mode){case 0:this.freeVertigoControls.update(this.camera,e,t.deltaTime),console.log();break;case 1:this.scopeCameraHandler.update(this.camera,e,t.deltaTime)}}constructor(){this._mode=0,this.freeVertigoControls=new f.n({size:24,perspective:1}),this.scopeCameraHandler=new V,this.destroy=()=>{this.freeVertigoControls.destroy(),this.scopeCameraHandler.destroy();let t=O.instances.indexOf(this);if(-1===t)throw Error("CameraHandler instance not found");O.instances.splice(t,1)},O.instances.push(this)}}O.Mode=B,O.instances=[];var q=o(21277),_=o(17099);function z(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new u.IUQ,r=2**e,i=2*(1-1/r),n=1/r;return o.x=t*v.NP*n,o.y=-v.Bg*i,o.z=v.Bg*i+t*v.NP*n,o.w=n,o}class W extends u.YJl{updatePointer(t){let e=t.intersectPlane(v.gc,new u.Pq0);if(!e)return;let{text:o,pointerText:r}=this.internal,i=function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new u.I9Y;return o.y=Math.floor(-Math.log2(1- -e/v.Bg/2)),o.x=Math.floor(t/v.NP*2**o.y),o}(e.x,e.y);if(Number.isNaN(i.x)||Number.isNaN(i.y))return;let n=1/2**function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new u.I9Y,r=1- -e/v.Bg/2;return o.y=-Math.log2(r),o.x=t/(v.NP*r),o}(e.x,e.y,new u.I9Y).y;for(let t of this.internal.positions){let e=t.x===i.x&&t.y===i.y?"#ffff66":"white";o.data.setColorAt(t.i+1,{backgroundColor:e})}o.material.needsUpdate=!0,r.setTextAt(0,"".concat(i.x,",").concat(i.y),{textColor:"#ffff66",textOpacity:0,backgroundColor:"#ffff66",backgroundOpacity:1,position:e,size:3*n});let s=z(i.x,i.y);this.internal.pointerLine.clear().line(e,[s.x,s.y,s.z],{color:"#ffff66"}).draw()}constructor(...t){super(...t),this.internal=(()=>{let t=[new u.Pq0(0,0,0),new u.Pq0(0,-v.Bg,v.Bg),new u.Pq0(v.NP,-v.Bg,v.NP+v.Bg),new u.Pq0(v.NP,0,v.NP)],e=(0,x.mj)(new y.R,this);for(let o=0;o<12;o++){let r=2**o,i=2*(1-1/r),n=1/r,s=new u.Pq0(0,-v.Bg*i,v.Bg*i);e.polygon(t.map(t=>t.clone().multiplyScalar(n).add(s)))}e.polyline([[0,0,0],v.Dm]),e.draw(),(0,x.mj)(new u.eaF(new k.k,new S.Y({vertexColors:!0})),{parent:this,position:v.Dm,rotation:v.xO});let o=(0,a.loop2Array)(4,8),r=(0,x.mj)(new l.w({lineCount:1,lineLength:14}),this),i=(0,x.mj)(new y.R(100),this);for(let t of o){let{x:e,y:o,z:i,w:n}=z(t.x,t.y);r.setTextAt(t.i+1,"".concat(t.x,",").concat(t.y),{textColor:"white",textOpacity:0,backgroundColor:"white",backgroundOpacity:1,position:[e,o,i],size:2*n})}return{positions:o,text:r,pointerText:(0,x.mj)(new l.w({lineCount:2,lineLength:16}),this),pointerLine:i}})()}}var X=o(67203),E=o(18479);o(61249);let R=(0,X.createContext)(null);function F(t,e){let o=(0,X.useContext)(R);return(0,E.C7)(async function*(e,r){if(t){let e=t(o,r);if(e&&"function"==typeof e.next)do{let{value:t,done:o}=await e.next();if(o)break;yield t}while(r.mounted)}},null!=e?e:"always"),o}let G={className:"",assetsPath:"/"};function A(t){let{children:e,className:o,assetsPath:r}={...G,...t},n=(0,X.useMemo)(()=>new s.XW,[]);n.loader.setPath(r);let{ref:l}=(0,E.IZ)({debounce:!0},function*(t,e){yield n.initialize(t.firstElementChild),e.triggerRender(),Object.assign(window,{three:n})},[]);return(0,i.jsx)("div",{ref:l,className:o,style:{position:"absolute",inset:0},children:(0,i.jsxs)(R.Provider,{value:n,children:[(0,i.jsx)("div",{style:{position:"absolute",inset:"0"}}),(0,i.jsx)("div",{style:{position:"absolute",inset:"0"},className:"thru",children:n.initialized&&e})]})})}function D(t){return function(){let[t,e]=(0,X.useState)(!1);return(0,X.useLayoutEffect)(()=>{e(!0)},[]),t}()&&(0,i.jsx)(A,{...t})}function L(){return!function(t,e,o){let r=(0,X.useMemo)(()=>new u.YJl,[]);r.name=t,F(async function*(t,o){if(t.scene.add(r),yield()=>{r.clear(),r.removeFromParent()},e){let i=e(r,t,o);if(i&&"function"==typeof i.next)do{let{value:t,done:e}=await i.next();if(e)break;yield t}while(o.mounted)}},o)}("fractal-grid",function*(t,e){var o;(0,x.mj)(new q.N({color:"#110512"}),t),(0,x.mj)(new y.R,t).grid2().draw();let r=(0,x.mj)(new W,t);(0,x.mj)(new u.eaF(new u.UPV(2.5,.025,512,32),new S.Y({color:"#0cf"})),t).visible=!1,_.c.seed(98763);let i=(0,x.mj)(new N,t);yield i.destroy,i.visible=!1,i.scope.updateScope({aspect:e.aspect}),i.ensureScopeChunks();let n=new O().initialize(e.camera,e.renderer.domElement),s=new u.Pq0,l=(0,x.mj)(new u.eaF(new u.WBB(.1),new S.Y({color:"#f0f"})),t);yield(0,g.xy)("three",t=>{n.onTick(t,e.aspect),i.scope.updateScope({aspect:e.aspect}),e.pointer.ray.intersectPlane(v.gc,s),l.position.copy(s),r.updatePointer(e.pointer.ray)}),i.toColor(),null==(o=i.getChunk(0,0))||o.toWhite(),Object.assign(window,{world:i,cameraHandler:n}),(0,x.mj)(new u.eaF(new k.k,new S.Y({vertexColors:!0})),t)},[]),null}function H(){return F(function*(t){let e=new n.F(t.scene,t.camera);e.updatePdMaterial({lumaPhi:10,depthPhi:2,normalPhi:3,radius:2,radiusExponent:2,rings:2,samples:24}),yield t.pipeline.addPass(e,{type:s.O0.PostProcessing}),(0,d.O)({three:t,...a,TextHelper:l.w,calculateExponentialDecayLerpRatio:h.calculateExponentialDecayLerpRatio,calculateExponentialDecayLerpRatio2:h.calculateExponentialDecayLerpRatio2,lerp:c.lerp})},[]),null}function T(){return(0,i.jsx)("div",{className:"FractalGrid",children:(0,i.jsxs)(D,{children:[(0,i.jsxs)("div",{className:"layer thru flex flex-col p-4 gap-2 items-start",children:[(0,i.jsx)("h1",{className:"text-2xl",children:"FractalGrid"}),(0,i.jsx)("button",{className:"border border-white px-2 py-1 rounded",onClick:()=>O.instances[0].mode++,children:"Switch camera"})]}),(0,i.jsx)(H,{}),(0,i.jsx)(L,{})]})})}},52484:(t,e,o)=>{Promise.resolve().then(o.bind(o,50411))},88575:(t,e,o)=>{"use strict";o.d(e,{O0:()=>r.O0,XW:()=>r.XW});var r=o(82143)},96122:(t,e,o)=>{"use strict";function r(t){let e=t.split("\n"),o=0;for(let t of e){let e=t.match(/^(\s*)\S/);if(e){o=e[1].length;break}}return e.map(t=>t.slice(Math.min(t.length,o))).join("\n")}o.d(e,{T:()=>r})}},t=>{var e=e=>t(t.s=e);t.O(0,[5611,7190,6564,7962,9635,8921,7953,4512,7775,7436,5438,7833,146,6726,3445,9332,3414,9717,1763,2143,8181,5033,1319,6852,7358],()=>e(52484)),_N_E=t.O()}]);