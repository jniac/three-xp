(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2143,3382,8181,9332],{3589:(e,t,n)=>{"use strict";n.d(t,{Main:()=>b});var i=n(70691),r=n(67203),a=n(18479),o=n(67235),s=n(30158),l=n(49797),c=n(17223),d=n(99613),u=n(64416),h=n(27491),f=n(27146),p=n(28334),m=n(36508),v=n(24223),g=n(58087),x=n(5832);class w extends h.A{render(e,t,n,i,r){var a;if(null==(a=this.onBeforeRender)||a.call(this),this.disableBackground){let a=this.scene.background;this.scene.background=null,super.render(e,t,n,i,r),this.scene.background=a}else super.render(e,t,n,i,r)}constructor(...e){super(...e),this.onBeforeRender=null,this.disableBackground=!1}}function y(){let{ref:e}=(0,a.useEffects)(function*(e){let t=function(e){let{width:t=window.innerWidth,height:n=window.innerHeight}=e,i=new s.WebGLRenderer({});i.setSize(t,n),i.setPixelRatio(window.devicePixelRatio);let r=new l.ubm(75,t/n,.1,1e3);r.position.z=8,new c.N(r,i.domElement);let a=new m.Rv().set({activeDuration:30}),h=(0,v.O)(()=>a.requestActivation()),y=function(e){let t=new l.Z58;{let e=new l.ZyN(0xffffff,1);e.position.set(0,3,1),t.add(e);let n=new l.dth("#afdbf5","#845244",1);t.add(n)}new x.Y().setPath("https://threejs.org/examples/textures/equirectangular/").loadAsync("pedestrian_overpass_1k.hdr").then(e=>{e.mapping=l.wfO,t.environmentIntensity=.1,t.environment=e,t.backgroundBlurriness=.5,t.background=e});let n=new l.eaF(new l.UPV(2,1,512,64),new l.uSd);t.add(n);let i=new l.eaF(new l.iNn(10,1,3),new l.uSd);t.add(i);let r=new l.eaF(new l.iNn(1,10,3),new l.uSd);r.position.set(5,0,0),t.add(r);let a=new l.eaF(new l.bdM(10,10),new l.uSd({color:"#d1ddff",transmission:1,roughness:0,dispersion:.1,ior:2.5,opacity:1}));return a.layers.set(1),t.add(a),e.onTick(e=>{n.rotation.x+=.5*e.deltaTime,n.rotation.y+=.5*e.deltaTime}),t}(a),b=new d.s(i),P=new w(y,r);P.onBeforeRender=()=>{r.layers.enableAll()},b.addPass(P);let F=new g.F(y,r,t,n);b.addPass(F);let C=new u.X;b.addPass(C);let M=new f.p(p.o);M.material.uniforms.resolution.value.set(1/t,1/n),b.addPass(M),a.onTick(()=>{b.render()}),o.Q.on("REQUIRE:THREE",e=>{e.payload={three:S}});let S={renderer:i,camera:r,scene:y,ticker:a,passes:{render:P,ao:F,output:C},destroy:()=>{i.domElement.remove(),a.destroy(),h.destroy()}};return S}({width:e.clientWidth,height:e.clientHeight});yield t,Object.assign(window,{three:t}),e.appendChild(t.renderer.domElement)},[]);return(0,i.jsx)("div",{ref:e,className:"absolute inset-0"})}function b(){let[e,t]=(0,r.useState)(!0);return(0,i.jsxs)("div",{className:"page",children:[(0,i.jsx)(y,{}),(0,i.jsxs)("div",{className:"absolute inset-0 p-8 flex flex-col items-start justify-start pointer-through",children:[(0,i.jsxs)("div",{className:"flex flex-col items-start justify-start pointer-through max-w-[480px]",children:[(0,i.jsx)("h1",{className:"text-4xl uppercase",children:"ao-transparent"}),(0,i.jsx)("div",{className:"mt-4"}),(0,i.jsx)("p",{children:"Handling Ambient Occlusion and transparent objects"}),(0,i.jsx)("p",{children:"The glass does not generate AO"}),(0,i.jsx)("div",{className:"mt-4"}),(0,i.jsxs)("p",{children:["This is achieved by using a fork of the ",(0,i.jsx)("a",{href:"https://github.com/mrdoob/three.js/blob/master/examples/jsm/postprocessing/GTAOPass.js",children:"GTAOPass"}),"\xa0where the camera layer mask is set to 0 (default layer) and the glass object is set to layer 1 (transparent objects)."]}),(0,i.jsx)("div",{className:"mt-4"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-xl",children:"Pros:"}),(0,i.jsx)("ul",{children:(0,i.jsx)("li",{children:"Simple (layer based)"})})]}),(0,i.jsx)("div",{className:"mt-4"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-xl",children:"Cons:"}),(0,i.jsx)("ul",{children:(0,i.jsx)("li",{children:"AO is still rendered on top of transparent objects. For semi-opaque objects, this is could be a problem."})})]})]}),(0,i.jsx)("div",{className:"mt-4"}),(0,i.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,i.jsx)("label",{htmlFor:"ao-enabled",className:"select-none",children:"Enable AO"}),(0,i.jsx)("input",{type:"checkbox",name:"ao-enabled",id:"ao-enabled",checked:e,onChange:()=>{let{payload:e}=o.Q.send("REQUIRE:THREE");if(e){let{three:n}=e,{passes:i}=n,{ao:r}=i;r.enabled=!r.enabled,t(r.enabled)}}})]})]})]})}},4003:(e,t,n)=>{"use strict";n.d(t,{w:()=>i.w});var i=n(3461)},4941:(e,t,n)=>{"use strict";n.d(t,{_5:()=>r.ol,YN:()=>r.o8,cz:()=>a,kY:()=>r.kY});var i=n(37197),r=n(40074);let a={transition:r.kY,bump:i.$p}},5868:(e,t,n)=>{"use strict";n.d(t,{PageClient:()=>u});var i=n(70691),r=n(49797),a=n(33540),o=n(77794),s=n(16465),l=n(79911);class c extends r.YJl{constructor(){super();let e=new r.Ho_(.5,.5,1,32,32,!0);(0,l.mj)(new r.eaF(e,new s.Y),this);{let e=new r.jGm;e.add(new r.VnP(new r.Pq0,new r.Pq0(0,2,0))),e.add(new r.VnP(new r.Pq0(0,2,0),new r.Pq0(1,4,0))),(0,l.mj)(new o.u,this).polyline(e.getSpacedPoints(20))}}}function d(){return(0,a.dB)("my-scene",function*(e){(0,l.mj)(new o.u,e).regularGrid({plane:"xz"}),(0,l.mj)(new c,e)},[]),null}function u(){return(0,i.jsxs)(a.uB,{vertigoControls:{rotation:"-45deg, 0, 0",size:10},children:[(0,i.jsx)("div",{className:"p-16",children:(0,i.jsx)("h1",{children:"Procedural Tree"})}),(0,i.jsx)(d,{})]})}},8597:(e,t,n)=>{"use strict";n.d(t,{Bg:()=>a,Dm:()=>l,NP:()=>r,OZ:()=>o,RY:()=>f,gc:()=>v,mj:()=>p,rU:()=>s,uJ:()=>h,xO:()=>m});var i=n(49797);let r=6,a=4,o=new i.Pq0(r,a,r+a-1),s=[new i.Pq0(0,0,a),new i.Pq0(0,a,0),new i.Pq0(r,0,a+r-1),new i.Pq0(r,a,r)],l=new i.Pq0(0,-2*a,2*a),c=new i.Pq0(1,0,1).normalize(),d=new i.Pq0(0,1,-1).normalize(),u=new i.Pq0().crossVectors(c,d).normalize();d.crossVectors(u,c).normalize();let h={U:c,V:d,W:u},f=new i.kn4().makeBasis(c,d,u).setPosition(l),p=new i.kn4().copy(f).invert(),m=new i.O9p().setFromRotationMatrix(f),v=new i.Zcv().setFromNormalAndCoplanarPoint(u,l)},10390:(e,t,n)=>{"use strict";n.d(t,{o:()=>u});var i=n(49797),r=n(9954),a=n(17775),o=n(5832),s=n(33589);let l=["gltf","glb"],c=["png","jpg","jpeg","hdr","exr"];class d{add(e){return this.listeners.add(e),{destroy:()=>this.listeners.delete(e)}}call(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let e of this.listeners)e.apply(null,t)}constructor(){this.listeners=new Set}}class u{static current(){var e;return null!=(e=this.instances[this.instances.length-1])?e:new u}static get(e){var t;return null!=(t=this.instances.find(t=>t.name===e))?t:new u({name:e})}setPath(e){this.path=e}onAfterLoad(e){return this._onAfterLoad.add(e)}async loadGltf(e){return new Promise((t,n)=>{this.loaders.gltf.load(e,e=>{t(e),this._onAfterLoad.call()},void 0,n)})}async loadRgbe(e){let t=(0,s.F)(this.loaders.rgbeLoader.load(e,e=>{t.resolve(),this._onAfterLoad.call()},void 0,()=>{console.log("Failed to load RGBE: ".concat(e))}));return t}async loadExr(e){let t=(0,s.F)(this.loaders.exrLoader.load(e,e=>{t.resolve(),this._onAfterLoad.call()},void 0,()=>{console.log("Failed to load EXR: ".concat(e))}));return t}loadTexture(e,t){let n=new URL(this.path+e,window.location.href).href;if(this.textureCache.has(n)){let e=this.textureCache.get(n);return null==t||t(e),e}let i=(0,s.F)(this.loaders.texture.load(n,e=>{this.textureCache.set(n,i),null==t||t(e),i.resolve(),this._onAfterLoad.call()},void 0,()=>{console.log("Failed to load texture: ".concat(n))}));return i}async load(e){let t=e.split(".").pop();if(l.includes(t))return this.loadGltf(e);if(c.includes(t))return new Promise((t,n)=>{this.loaders.texture.load(e,e=>{t(e),this._onAfterLoad.call()},void 0,n)});throw Error("Unsupported extension: ".concat(t))}constructor({name:e}={}){this.id=u.nextId++,this.loaders={gltf:new a.B,texture:new i.Tap,rgbeLoader:new o.Y,exrLoader:new r.H},this.path="",this._onAfterLoad=new d,this.textureCache=new Map,this.name=null!=e?e:"UnifiedLoader-".concat(this.id),u.instances.push(this)}}u.nextId=0,u.instances=[]},13565:(e,t,n)=>{"use strict";n.d(t,{q:()=>x});var i=n(28535),r=n(76999),a=n(57368),o=n(49797),s=n(93432),l=n(73446),c=n(8144),d=n(96122);let u=[3,5,7,9,11].map(e=>(function(e,t){let n=function(e,t){if(e%2==0)throw Error("Kernel size must be odd");let n=Math.floor(e/2);null!=t||(t=e/3);let i=2*t*t,r=[],a=0;for(let e=-n;e<=n;e++)for(let t=-n;t<=n;t++){let n=Math.exp(-(t*t+e*e)/i);r.push(n),a+=n}for(let e=0;e<r.length;e++)r[e]/=a;return r}(e,void 0),i=[];for(let t=0;t<e;t++){let r=n.slice(t*e,(t+1)*e).map(e=>"  ".concat(e.toFixed(5))).join(", ");i.push(r)}let r="kernel".concat(e,"x").concat(e),a="const float[".concat(e*e,"] ").concat(r," = float[").concat(e*e,"](\n").concat(i.join(",\n"),");"),o=Math.floor(e/2);return a+"\n\n"+(0,d.T)("\n    vec4 gaussianBlur".concat(e,"x").concat(e,"(vec2 uv, float scale) {\n      vec2 texelSize = scale / uTextureSize;\n      vec4 color = vec4(0.0);\n      for (int x = -").concat(o,"; x <= ").concat(o,"; x++) {\n        for (int y = -").concat(o,"; y <= ").concat(o,"; y++) {\n          vec2 offset = vec2(float(x), float(y)) * texelSize;\n          color += texture2D(uTexture, uv + offset) * ").concat(r,"[x + ").concat(o," + (y + ").concat(o,") * ").concat(e,"];\n        }\n      }\n      return color;\n    }\n\n    vec4 gaussianBlur").concat(e,"x").concat(e,"(vec2 uv) {\n      return gaussianBlur").concat(e,"x").concat(e,"(uv, 1.0);\n    }\n  "))})(e)).join("\n\n"),h={glsl_blending:l.x,glsl_blur_3_11:u,glsl_sdf_2d:"\n  // 2D SDF functions\n  float sdSegment(in vec2 p, in vec2 a, in vec2 b) {\n    vec2 pa = p-a, ba = b-a;\n    float h = clamp( dot(pa,ba)/dot(ba,ba), 0.0, 1.0 );\n    return length( pa - ba*h );\n  }\n\n  float sdRoundedSegment(in vec2 p, in vec2 a, in vec2 b, float r) {\n    return sdSegment(p, a, b) - r;\n  }\n",glsl_utils:c.H},f={fragmentTop:"",fragmentColor:"\n    gl_FragColor = vec4(vUv, 1., 1.);\n  ",texture:null,uniforms:{}};class p extends o.BKk{constructor(e,t){let n={...f,...t},i={...{uTexture:{value:null},uTextureSize:{value:new o.I9Y},uTime:{value:0},uDeltaTime:{value:0}},...n.uniforms},r=Array.from(e).map(e=>h[e]).filter(e=>!!e).join("\n\n");i.uTexture.value=n.texture,super({uniforms:i,vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = vec4(position, 1.);\n        }\n      ",fragmentShader:"\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform vec2 uTextureSize;\n        uniform float uTime;\n        uniform float uDeltaTime;\n\n        ".concat(r,"\n\n        ").concat(Object.entries(n.uniforms).map(e=>{let[t,{value:n}]=e,i=function e(t){if(Array.isArray(t)){if(0===t.length)throw Error("GpuCompute: cannot infer uniform type for empty array");let n=e(t[0]);for(let i=1;i<t.length;i++)if(e(t[i])!==n)throw Error("GpuCompute: cannot infer uniform type for array with mixed types");return"".concat(n,"[").concat(t.length,"]")}if("number"==typeof t)return"float";if(t instanceof o.I9Y)return"vec2";if(t instanceof o.Pq0)return"vec3";if(t instanceof o.IUQ)return"vec4";if(t instanceof o.Q1f)return"vec3";if(t instanceof o.gPd)return"sampler2D";throw Error("GpuCompute: cannot infer uniform type for value: ".concat(t))}(n);return"uniform ".concat(i," ").concat(t,";")}).join("\n"),"\n\n        ").concat(n.fragmentTop,"\n\n        void main() {\n          ").concat(n.fragmentColor,"\n        }\n      ")}),this.uniforms=i}}let m={size:1024,type:o.ix0,generateMipmaps:!1,filter:"nearest"};var v=new WeakMap,g=new WeakMap;class x{get initialized(){return!!(0,i._)(this,v)}get renderer(){var e;return null==(e=(0,i._)(this,v))?void 0:e.renderer}get updateUniforms(){if(!this.state.updateMaterial)throw Error("GpuCompute: shaders not set");return this.state.updateMaterial.uniforms}setSize(e){let{width:t,height:n}=(0,s.wX)(e);return(this.state.size.x!==t||this.state.size.y!==n)&&(this.state.size.set(t,n),this.state.rtA.setSize(t,n),this.state.rtB.setSize(t,n)),this}enableGlslLib(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let e of t)h[e]?(0,i._)(this,g).add(e):console.warn("GpuCompute: unknown glsl lib: ".concat(e));return this}shaders(e){return this.state.initialMaterial=new p((0,i._)(this,g),e.initial),this.state.updateMaterial=new p((0,i._)(this,g),e.update),this}initialize(e){let{orthoCamera:t,plane:n}=this.parts,{rtA:i}=this.state;(0,a._)(this,v,{renderer:e});let{initialMaterial:r}=this.state;return r&&(r.uniforms.uTextureSize.value.copy(this.state.size),r.uniforms.uTexture.value=null,r.uniforms.uTime.value=0,r.uniforms.uDeltaTime.value=0,n.material=r),e.setRenderTarget(i),e.render(n,t),e.setRenderTarget(null),this.state.frame=0,this}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!(0,i._)(this,v))throw Error("GpuCompute: not initialized");let{renderer:t}=(0,i._)(this,v),{orthoCamera:n,plane:r}=this.parts,{rtA:a,rtB:o,time:s,frame:l,updateMaterial:c}=this.state;return this.state.time+=e,c&&(c.uniforms.uTextureSize.value.copy(this.state.size),c.uniforms.uTexture.value=l%2==0?a.texture:o.texture,c.uniforms.uTime.value=s,c.uniforms.uDeltaTime.value=e,c.needsUpdate=!0,r.material=c),t.setRenderTarget(l%2==0?o:a),t.render(r,n),t.setRenderTarget(null),this.state.frame+=1,this}currentTexture(){return this.state.frame%2==0?this.state.rtA.texture:this.state.rtB.texture}constructor(e){(0,r._)(this,v,{writable:!0,value:void 0}),(0,r._)(this,g,{writable:!0,value:void 0}),this.parts={orthoCamera:new o.qUd(-1,1,1,-1,0,1),plane:new o.eaF(new o.bdM(2,2),void 0)},(0,a._)(this,g,new Set);let t={...this.constructor.defaultParams,...e};this.params=t;let{type:n,generateMipmaps:i,filter:l}=t,c="nearest"===l?o.hxR:i?o.NZq:o.k6q,d="nearest"===l?o.hxR:o.k6q,u=(0,s.wX)(t.size),h=new o.nWS(u.width,u.height,{minFilter:c,magFilter:d,generateMipmaps:i,format:o.GWd,type:n}),f=new o.nWS(u.width,u.height,{minFilter:c,magFilter:d,generateMipmaps:i,format:o.GWd,type:n});h.texture.name="GpuCompute.rtA",f.texture.name="GpuCompute.rtB",this.state={size:u,rtA:h,rtB:f,time:0,frame:0}}}x.defaultParams=m},13580:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,8166,23)),Promise.resolve().then(n.t.bind(n,20571,23)),Promise.resolve().then(n.t.bind(n,89294,23)),Promise.resolve().then(n.bind(n,3589)),Promise.resolve().then(n.bind(n,88452)),Promise.resolve().then(n.bind(n,61277)),Promise.resolve().then(n.bind(n,30851)),Promise.resolve().then(n.bind(n,84059)),Promise.resolve().then(n.bind(n,23200)),Promise.resolve().then(n.bind(n,50411)),Promise.resolve().then(n.bind(n,8610)),Promise.resolve().then(n.bind(n,18715)),Promise.resolve().then(n.bind(n,52753)),Promise.resolve().then(n.bind(n,4834)),Promise.resolve().then(n.t.bind(n,52288,23)),Promise.resolve().then(n.bind(n,85193)),Promise.resolve().then(n.bind(n,19264)),Promise.resolve().then(n.bind(n,53733)),Promise.resolve().then(n.bind(n,32595)),Promise.resolve().then(n.bind(n,5868)),Promise.resolve().then(n.bind(n,56969)),Promise.resolve().then(n.bind(n,55672)),Promise.resolve().then(n.t.bind(n,13196,23)),Promise.resolve().then(n.bind(n,28737)),Promise.resolve().then(n.bind(n,98114)),Promise.resolve().then(n.bind(n,68571)),Promise.resolve().then(n.bind(n,42436)),Promise.resolve().then(n.bind(n,18479))},18715:(e,t,n)=>{"use strict";let i;n.d(t,{Main:()=>B});var r=n(70691),a=n(49797),o=n(17953),s=n(81074),l=n(33540),c=n(48181),d=n(93432);let u={emissive:.2,shadowColor:"#808080",power:2,sunDirection:[1,3,-1]},h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"white",t=arguments.length>1?arguments[1]:void 0;return(0,o.Fn)(()=>{let{emissive:n,shadowColor:i,power:r,sunDirection:a}={...u,...t},s=(0,d.jj)(a).negate().normalize(),l=o.O7c.normalize().dot((0,o.eR5)(s)).add(1).mul(.5).pow(r).oneMinus(),c=(0,o.jhA)(n,1,l);return(0,o.jhA)((0,o.yWT)(i),(0,o.yWT)(e),c.mul(1))})()};(0,o.Fn)(e=>{let[t,n=1]=e,i=t.length().max(n);return t.mul((0,o.fVC)(n).div(i))}),(0,o.Fn)(e=>{let[t,n]=e;return(0,o.fVC)(t).sign().mul((0,o.fVC)(t).abs().pow(n))}),(0,o.Fn)(e=>{let[t,n]=e;return(0,o.fVC)(1).sub((0,o.fVC)(2).mul(t).sub(1).abs().pow(n))}),(0,o.Fn)(e=>{let[t]=e,n=(0,o.eR5)(t),i=n.length(),r=(0,o.lnd)().toVar();return(0,o.If)(i.greaterThan(o.p8E),()=>{r.assign((0,o.lnd)(n.div(i),i))}),r}),(0,o.Fn)(e=>{let[t,n]=e,i=(0,o.ZcS)(t);(0,o.fVC)(n);let r=(0,o.fVC)(n).cos(),a=(0,o.fVC)(n).sin();return(0,o.ZcS)(i.x.mul(r).sub(i.y.mul(a)),i.x.mul(a).add(i.y.mul(r)))}),(0,o.Fn)(e=>{let[t,n,i]=e,r=(0,o.ZcS)(t),a=(0,o.ZcS)(n),s=(0,o.ZcS)(i);return r.sub(s).mul(a).add(s)}),(0,o.Fn)(e=>{let[t,n]=e,i=n.cos(),r=n.sin(),a=i.oneMinus(),s=t.x,l=t.y,c=t.z;return(0,o.w00)(i.add(s.mul(s).mul(a)),s.mul(l).mul(a).sub(c.mul(r)),s.mul(c).mul(a).add(l.mul(r)),s.mul(l).mul(a).add(c.mul(r)),i.add(l.mul(l).mul(a)),l.mul(c).mul(a).sub(s.mul(r)),s.mul(c).mul(a).sub(l.mul(r)),l.mul(c).mul(a).add(s.mul(r)),i.add(c.mul(c).mul(a)))}),(0,o.Fn)(e=>{let[t,n=0,i=437]=e,r=(0,o.tWU)(t.add(n).mul(i)),a=(0,o.tWU)(t.add(n).add(1).mul(i)),s=(0,o.tWU)(t.add(n).add(2).mul(i));return(0,o.eR5)(r,a,s)}),(0,o.Fn)(e=>{let[t,n=0,i=437]=e,r=(0,o.tWU)(t.add(n).mul(i)),a=(0,o.tWU)(t.add(n).add(1).mul(i)),s=(0,o.tWU)(t.add(n).add(2).mul(i)),l=(0,o.tWU)(t.add(n).add(3).mul(i));return(0,o.lnd)(r,a,s,l)}),(0,o.Fn)(e=>{let[t]=e,n=(0,o.tWU)(t.add(17).mul(437)),i=(0,o.tWU)(t.add(23).mul(439)),r=n.mul(2*Math.PI),a=i.mul(2).sub(1),s=a.mul(a).oneMinus().sqrt();return(0,o.eR5)(s.mul(r.cos()),s.mul(r.sin()),a)});var f=n(79911),p=n(72612),m=n(44694),v=n(96555);async function g(){return i||(i=await (0,v.A)()),i}let x=new a.Pq0,w=new a.O9p,y=new a.PTz;var b=function(e){return e[e.STATIC=0]="STATIC",e[e.KINEMATIC=1]="KINEMATIC",e[e.DYNAMIC=2]="DYNAMIC",e}({}),P=function(e){return e[e.All=63]="All",e[e.Plane2D=35]="Plane2D",e[e.RotationX=8]="RotationX",e[e.RotationY=16]="RotationY",e[e.RotationZ=32]="RotationZ",e[e.TranslationX=1]="TranslationX",e[e.TranslationY=2]="TranslationY",e[e.TranslationZ=4]="TranslationZ",e}({}),F=function(e){return e[e.STATIC=0]="STATIC",e[e.MOVING=1]="MOVING",e}({});let C=Object.keys(F).length/2;class M{toJoltShape(){throw Error("Not implemented")}toMesh(){throw Error("Not implemented")}}M.Sphere=class extends M{toJoltShape(){return new i.SphereShape(this.radius)}toMesh(){return new a.eaF(new a.WBB(this.radius,8))}constructor(e){super(),this.radius=e}},M.Box=class extends M{toJoltShape(){let e=function(e,t){let{x:n,y:i,z:r}=(0,m.jj)(e,x);return t.SetX(n),t.SetY(i),t.SetZ(r),t}(this.halfExtents,new i.Vec3);return new i.BoxShape(e)}toMesh(){let{x:e,y:t,z:n}=(0,m.jj)(this.halfExtents);return new a.eaF(new a.iNn(2*e,2*t,2*n))}constructor(e){super(),this.halfExtents=e}};class S{}async function D(e){await g();let t=new i.JoltSettings;t.mMaxWorkerThreads=3;let n=new i.ObjectLayerPairFilterTable(C);n.EnableCollision(0,1),n.EnableCollision(1,1);let r=new i.BroadPhaseLayer(0),o=new i.BroadPhaseLayer(1),s=new i.BroadPhaseLayerInterfaceTable(C,2);s.MapObjectToBroadPhaseLayer(0,r),s.MapObjectToBroadPhaseLayer(1,o),t.mObjectLayerPairFilter=n,t.mBroadPhaseLayerInterface=s,t.mObjectVsBroadPhaseLayerFilter=new i.ObjectVsBroadPhaseLayerFilterTable(s,2,n,C);let l=new i.JoltInterface(t);i.destroy(t);let c={moving:[]},u=l.GetPhysicsSystem(),h=u.GetBodyInterface(),f=e=>{for(let{mesh:t,body:n}of(l.Step(e,e>1/55?2:1),c.moving))!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new a.Pq0;t.set(e.GetX(),e.GetY(),e.GetZ())}(n.GetPosition(),t.position),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new a.PTz;t.set(e.GetX(),e.GetY(),e.GetZ(),e.GetW())}(n.GetRotation(),t.quaternion)};return e.ticker.onTick(e=>{f(e.deltaTime)}),{jolt:l,physicsSystem:u,bodyInterface:h,createBody:function(){let{shape:t=new M.Sphere(.5),type:n=2,allowedDOFs:r=63,mesh:a=null,position:o=[0,0,0],rotation:s=[0,0,0],parent:l=e.scene}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=new i.BodyCreationSettings(t.toJoltShape(),function(e,t){let{x:n,y:i,z:r}=(0,m.jj)(e,x);return t.SetX(n),t.SetY(i),t.SetZ(r),t}(o,new i.RVec3),function(e,t){(0,d.if)(e,w);let{x:n,y:i,z:r,w:a}=y.setFromEuler(w);return t.SetX(n),t.SetY(i),t.SetZ(r),t.SetW(a),t}(s,new i.Quat),n,1);u.mAllowedDOFs=r;let f=h.CreateBody(u);i.destroy(u),h.AddBody(f.GetID(),i.EActivation_Activate),null!=a||(a=t.toMesh()),l.add(a);let p={body:f,mesh:a};return(1===n||2===n)&&c.moving.push(p),p}}}S.MotionType=b,S.AllowedDOF=P,S.Layers=F,S.Shape=M;class E extends a.YJl{onDestroy(){}constructor(...e){super(...e),this.parts=(()=>{let e=(0,f.mj)(new c.R,this).rectangle([1,1]);for(let t of(e.line([.05,.5],[.3,.5]),e.line([.95,.5],[.7,.5]),e.polyline([[.4,.05],[.6,.05]]),e.polyline([[.4,.95],[.6,.95]]),(0,p.loop)(10))){let n=.05+.2*t.p;e.line([n,.05],[n,.25]),e.line([n,.75],[n,.95]),e.line([1-n,.05],[1-n,.25]),e.line([1-n,.75],[1-n,.95])}return e.circle([.5,.5],.2),e.circle([.5,.5],.22),e.capsule2([.67,.67],[.32999999999999996,.32999999999999996],.05),e.capsule2([.67,.32999999999999996],[.32999999999999996,.67],.05),e.cross([.5,.5],.05),e.draw(),{line:e}})()}}class A extends a.YJl{onInitialize(e){D(e).then(e=>{var t=this;let n=e.createBody({parent:this,position:[-.3,0,0]});n.mesh.material=new s.P8l({colorNode:h().mul((0,o.eR5)((0,o.uv)().mul((0,o.ZcS)(15,10)).fract(),1))}),!function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;e.createBody({parent:t,position:[i+a/2,r+o/2,0],shape:new S.Shape.Box([a/2,o/2,.1]),type:S.MotionType.KINEMATIC}).mesh.material=n.mesh.material}(-2,-2,8,1),e.createBody({parent:this,position:[.1,-2,0],type:S.MotionType.KINEMATIC}).mesh.material=n.mesh.material,e.createBody({parent:this,position:[-.9,-2,-.1],type:S.MotionType.KINEMATIC}).mesh.material=n.mesh.material,e.createBody({parent:this,position:[-.5,-2,1],type:S.MotionType.KINEMATIC}).mesh.material=n.mesh.material,e.createBody({shape:new S.Shape.Box([.5,.5,.01]),allowedDOFs:S.AllowedDOF.Plane2D,position:[.15,3,0],parent:this})})}constructor(...e){super(...e),this.parts=(()=>{let e=(0,f.mj)(new c.R,this).grid2({size:4}).opacity(.05).draw();return(0,f.mj)(new E,this),(0,f.mj)(new E,{parent:this,position:[1,0,0]}),{line:e}})()}}function T(){return(0,l.Fw)(function*(e){e.pipeline.basicPasses.fxaa.enabled=!1},[]),null}function B(){return(0,r.jsx)(l.uB,{webgpu:!0,vertigoControls:{size:5},children:(0,r.jsxs)("div",{className:"Main layer thru flex flex-col items-start justify-start p-4",children:[(0,r.jsx)("h1",{children:"Chunk Viewer"}),(0,r.jsx)(l.q,{value:A}),(0,r.jsx)(T,{})]})})}},21277:(e,t,n)=>{"use strict";n.d(t,{N:()=>a});var i=n(49797);let r=new i.WBB(1,4);class a extends i.eaF{constructor(e){super(r,new i.V9B({color:"#0c529d",...e,side:i.hsX,depthWrite:!1,depthTest:!1})),this.renderOrder=-1,this.frustumCulled=!1,this.matrixAutoUpdate=!1,this.onBeforeRender=(e,t,n)=>{let i=(n.near+n.far)/2;this.position.copy(n.position),this.scale.setScalar(i),this.updateMatrix(),this.updateMatrixWorld()}}}},23120:(e,t,n)=>{"use strict";n.d(t,{hB:()=>f,hf:()=>x});var i=n(49797),r=n(93432),a=n(68955),o=n(16465),s=n(3293),l=n(79911),c=n(72612),d=n(17099),u=n(8597);function h(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new i.Pq0;return n.set(e,t,e-t)}function f(){let e;for(var t,n,r=arguments.length,a=Array(r),o=0;o<r;o++)a[o]=arguments[o];let s=0,l=0;if("number"==typeof a[0])[s,l]=a,e=null!=(t=a[3])?t:new i.I9Y;else{let[t]=a;s=t.x,l=t.y,e=null!=(n=a[1])?n:new i.I9Y}let c=-Math.log2((l/u.Bg+1)/2)-1,d=.5**c,h=s/(u.NP*d);return e.set(h,c)}function p(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,{x:r,y:a,z:o}=t,s=r+n,l=a+n,c=o+n;for(let t=o;t<c;t++)for(let n=a;n<l;n++)for(let a=r;a<s;a++)e.getVoxelState(a,n,t+4*u.Bg).setInt8(0,i)}function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=u.OZ.clone().multiplyScalar(4/t),r=[];for(let a of(0,c.loop3)(n)){let n=a.x*t,o=a.y*t,s=a.z*t;(function(e,t,n,i){var r,a,o,s,l,c;let d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return!!(e.getVoxelState(t,n,i).getInt8(0)>0)&&!((null!=(s=null==(r=e.tryGetVoxelState(t-d,n,i))?void 0:r.getInt8(0))?s:0)>0)&&!((null!=(l=null==(a=e.tryGetVoxelState(t,n+d,i))?void 0:a.getInt8(0))?l:0)>0)&&!((null!=(c=null==(o=e.tryGetVoxelState(t,n,i+d))?void 0:o.getInt8(0))?c:0)>0)})(e,n,o,s,t)&&d.c.chance(1-a.py)&&r.push(new i.Pq0(n,o,s))}return r}function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=u.OZ.clone().multiplyScalar(4/t),r=[];for(let a of(0,c.loop3)(n)){let n=a.x*t,o=a.y*t,s=a.z*t;(function(e,t,n,i){var r,a,o,s,l,c;let d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return!(e.getVoxelState(t,n,i).getInt8(0)>0)&&!!((null!=(s=null==(r=e.tryGetVoxelState(t+d,n,i))?void 0:r.getInt8(0))?s:0)>0)&&!!((null!=(l=null==(a=e.tryGetVoxelState(t,n-d,i))?void 0:a.getInt8(0))?l:0)>0)&&!!((null!=(c=null==(o=e.tryGetVoxelState(t,n,i-d))?void 0:o.getInt8(0))?c:0)>0)})(e,n,o,s,t)&&d.c.chance(1-a.py)&&r.push(new i.Pq0(n,o,s))}return r}let g=new i.Pq0;new i.Pq0;class x extends i.eaF{createDots(){let e=new i.ZLX(new i.WBB(.1,8),new o.Y,4);for(let[t,n]of((0,l.mj)(e,this),u.rU.entries()))e.setMatrixAt(t,(0,s.w)({position:n})),e.setColorAt(t,(0,s._)("#ffffff"));return this.dots=e,this}updateDots(e){this.dots||this.createDots();let t=this.dots;for(let[n,i]of u.rU.entries()){t.setMatrixAt(n,(0,s.w)({position:i}));let r=e.isWithin(i)?"#00ffa6":"#ff0000";t.setColorAt(n,(0,s._)(r))}t.instanceMatrix.needsUpdate=!0,t.instanceColor.needsUpdate=!0}get gridCoords(){return this._gridCoords}setGridCoords(e){(0,r.wX)(e,this._gridCoords);let{x:t,y:n}=this._gridCoords;this.scale.setScalar(.5**n),function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new i.Pq0,r=.5**t,a=e*u.NP*r,o=u.Bg*(.5*r*2-1),s=e*u.NP*r+2*u.Bg*(1-r);n.set(a,o,s)}(t,n,this.position)}toWhite(){this.material.color.set(0xffffff)}toColor(){this.material.color.set(this.color)}constructor({world:e=null,color:t=0xffffff*d.c.random()}={}){let n=Math.ceil(u.NP*u.Bg*4.8),r=new a.AA(n,1);for(let{x:e,y:t}of(0,c.loop2)(u.NP,u.Bg))h(e,t,g).multiplyScalar(4),p(r,g,4);for(let e=0;e<u.NP;e+=2)h(e,u.Bg-1,g).add(new i.Pq0(1,0,0)).multiplyScalar(4),p(r,g,4),d.c.chance(.8)&&(h(e,u.Bg-1,g).add(new i.Pq0(1,1,0)).multiplyScalar(4),p(r,g,4));{let e=v(r,2),t=m(r,2);for(let t of e)p(r,t,2,1);for(let e of t)p(r,e,2,0)}{let e=v(r,1),t=m(r,1);for(let t of e)d.c.chance(.25)&&p(r,t,1,1);for(let e of t)d.c.chance(.25)&&p(r,e,1,0)}console.time("geometry");let s=(0,a.Cx)(r.voxelFaces());console.timeEnd("geometry");s.scale(.25,.25,.25);let f=new o.Y({color:t});super(s,new o.Y({color:t,side:i.$EB})),this._gridCoords=new i.I9Y,this.world=null,this.dots=null,(0,l.mj)(new i.eaF(s,f),this),(0,l.mj)(new i.IzY,this),this.chunk=r,this.color=t,this.world=e}}},23200:(e,t,n)=>{"use strict";n.d(t,{Main:()=>M});var i=n(70691),r=n(31763),a=n(36508),o=n(33855),s=n(28737),l=n(63106),c=n(49797),d=n(21277),u=n(79911),h=n(72612),f=n(6726),p=n(3293);class m extends c.YJl{clear(){let{lines:e}=this.parts;return e.count=0,e.instanceMatrix.array=new Float32Array(0),e.instanceMatrix.needsUpdate=!0,this}moveTo(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[i,r]=1===t.length?[t[0].x,t[0].y]:t;return this.commands.push({type:"moveTo",x:i,y:r,z:0,w:1}),this}lineTo(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[i,r]=1===t.length?[t[0].x,t[0].y]:t;return this.commands.push({type:"lineTo",x:i,y:r,z:0,w:1}),this}draw(){let{lines:e}=this.parts,{thickness:t,commands:n}=this,i=new Float32Array(16*n.length),r=0;for(let[e,{type:a,x:o,y:s}]of n.entries())if("lineTo"===a){let a=n[e-1],l=o-a.x,c=s-a.y,d=a.x+l/2,u=a.y+c/2,h=Math.sqrt(l*l+c*c),f=Math.atan2(c,l);(0,p.w)({x:d,y:u,rotationZ:f,scaleX:h,scaleY:t}).toArray(i,16*r),r++}return e.count=r,e.instanceMatrix.array=i.slice(0,16*r),e.instanceMatrix.needsUpdate=!0,this}constructor(...e){super(...e),this.thickness=.01,this.parts=(()=>{let e=new c.bdM(1,1),t=new c.V9B;return{lines:(0,u.mj)(new c.ZLX(e,t,0),this)}})(),this.commands=[]}}var v=n(7147),g=n(22899),x=n(14203),w=n(8144);let y=new c.bdM(4,4);new c.WBB(1,12);class b extends c.YJl{constructor(...e){super(...e),this.parts=(()=>{let e=["#95c3fb","#fcff99","#0a1521"].map(e=>new c.Q1f(e)),t=new c.V9B,n={uTime:a.Rv.get("three").uTime,uTimeCycleOffset:{value:0},uColors:{value:e}};t.onBeforeCompile=e=>v.bI.with(e).uniforms(n).defines({USE_UV:""}).varying({vWorldPosition2:"vec3"}).vertex.mainAfterAll("\n        vWorldPosition2 = (modelMatrix * vec4(position, 1.0)).xyz;\n      ").fragment.top("\n\n  // Inigo Quilez\n  // https://iquilezles.org/articles/distfunctions2d/\n\n  // Circle - exact   (https://www.shadertoy.com/view/3ltSW2)\n  float sdCircle( vec2 p, float r )\n  {\n    return length(p) - r;\n  }\n\n  // Rounded Box - exact   (https://www.shadertoy.com/view/4llXD7 and https://www.youtube.com/watch?v=s5NGeUV2EyU)\n  float sdRoundedBox( in vec2 p, in vec2 b, in vec4 r )\n  {\n    r.xy = (p.x>0.0)?r.xy : r.zw;\n    r.x  = (p.y>0.0)?r.x  : r.y;\n    vec2 q = abs(p)-b+r.x;\n    return min(max(q.x,q.y),0.0) + length(max(q,0.0)) - r.x;\n  }\n\n  // Box - exact   (https://www.youtube.com/watch?v=62-pRVZuS5c)\n  float sdBox( in vec2 p, in vec2 b )\n  {\n    vec2 d = abs(p)-b;\n    return length(max(d,0.0)) + min(max(d.x,d.y),0.0);\n  }\n\n  // Segment - exact   (https://www.shadertoy.com/view/3tdSDj and https://www.youtube.com/watch?v=PMltMdi1Wzg)\n  float sdSegment( in vec2 p, in vec2 a, in vec2 b )\n  {\n    vec2 pa = p-a, ba = b-a;\n    float h = clamp( dot(pa,ba)/dot(ba,ba), 0.0, 1.0 );\n    return length( pa - ba*h );\n  }\n\n  // Arc - exact   (https://www.shadertoy.com/view/wl23RK)\n  float sdArc( in vec2 p, in vec2 sc, in float ra, float rb )\n  {\n    // sc is the sin/cos of the arc's aperture\n    p.x = abs(p.x);\n    return ((sc.y*p.x>sc.x*p.y) ? length(p-sc*ra) : \n                                  abs(length(p)-ra)) - rb;\n  }\n\n  float sdRing( in vec2 p, in vec2 n, in float r, in float th )\n  {\n    p.x = abs(p.x);\n    p = mat2(n.x,n.y,-n.y,n.x)*p;\n    return max( abs(length(p)-r)-th*0.5,\n                length(vec2(p.x,max(0.0,abs(r-p.y)-th*0.5)))*sign(p.x) );\n  }\n\n  float opRound( in float d, in float r )\n  {\n    return d - r;\n  }\n\n  float opOnion( in float d, in float r )\n  {\n    return abs(d) - r;\n  }\n",x.O,w.H,g.I).fragment.top("\n        float globalNoise;\n        void computeGlobalNoise() {\n          globalNoise = fnoise(vec3(vWorldPosition2.xy * 0.5, uTime * 0.01), 8, 0.8);\n        }\n        float radius() {\n          return 0.75;\n        }\n        vec2 point() {\n          return (vUv - 0.5) * 2.0;\n        }\n        float time() {\n          return uTime * 0.05 + uTimeCycleOffset * 1.0;\n        }\n        float noisyBox() {\n          return sdBox(point(), vec2(radius())) + globalNoise * 0.1 * sin01(time());\n        }\n        float noisyCircle() {\n          return length(point()) - radius() + globalNoise * 0.3 * sin01(time());\n        }\n      ").fragment.mainBeforeAll("\n        computeGlobalNoise();\n      ").fragment.after("color_fragment","\n        float d = sdBox(point(), vec2(radius()));\n        float d2 = sin01(time());\n        d2 *= 0.1;\n        vec3 color = mix(uColors[0], uColors[1], smoothstep(0.001, 0.0, noisyBox()));\n\n        float nc = noisyCircle();\n        vec3 circleColor = mix(uColors[1], uColors[2], mix(0.25, 1.0, easeInOut2(inverseLerpUnclamped(-radius(), 0.0, nc))));\n        color = mix(color, circleColor, smoothstep(0.001, 0.0, nc));\n        diffuseColor.rgb = color;\n      ");let i=new c.eaF(y,t);return this.add(i),{plane:i,planeUniforms:n,colors:e}})()}}class P extends c.YJl{constructor(...e){super(...e),this.parts=(()=>{let e=(0,u.mj)(new m,this);e.position.z=1,e.thickness=.0125,e.parts.lines.material.color.set("#15093e"),e.parts.lines.material.color.set("#95c3fb");let t=new f.M_(0,0).applyPadding(4.1+.05,"grow"),n=new f.M_(0,0).applyPadding(6.25,"grow");for(let{t:i}of(0,h.loop)(60)){let r=(i+.5/60)*Math.PI*2,a=Math.cos(r),o=Math.sin(r),s=t.raycast(0,0,a,o).getPointMin(),l=n.raycast(0,0,a,o).getPointMin();e.moveTo(s).lineTo(l)}return e.draw(),{lines:e}})()}}function F(){return(0,o.dB)("four-circles",function*(e){(0,u.mj)(new d.N({color:"#e1dff1"}),e),(0,u.mj)(e,{rotationZ:"45deg"}),(0,u.mj)(new P,{parent:e}),(0,u.mj)(new b,{parent:e,position:[2.0175,2.0175,0]},e=>{e.parts.planeUniforms.uTimeCycleOffset.value=0,e.parts.colors[1].set("#fcff99"),e.parts.colors[2].set("#170551")}),(0,u.mj)(new b,{parent:e,position:[2.0175,-2.0175,0]},e=>{e.parts.planeUniforms.uTimeCycleOffset.value=.25,e.parts.colors[1].set("#18188c"),e.parts.colors[2].set("#72d9ab")}),(0,u.mj)(new b,{parent:e,position:[-2.0175,-2.0175,0]},e=>{e.parts.planeUniforms.uTimeCycleOffset.value=.5,e.parts.colors[1].set("#f3a3b3"),e.parts.colors[2].set("#15093e")}),(0,u.mj)(new b,{parent:e,position:[-2.0175,2.0175,0]},e=>{e.parts.planeUniforms.uTimeCycleOffset.value=.75,e.parts.colors[1].set("#3b3426"),e.parts.colors[2].set("#de2566")}),(0,u.mj)(new b,{parent:e,scaleScalar:4,position:[0,0,-1]},e=>{e.parts.planeUniforms.uTimeCycleOffset.value=.75,e.parts.colors[0].set("#e1dff1"),e.parts.colors[1].set("#95c3fb"),e.parts.colors[2].set("#170551")})},[]),null}function C(){return(0,o.yk)(function*(e){(0,s.O)({three:e});let t=new r.n({size:12.2,perspective:0});yield t.start(e.renderer.domElement),a.Rv.get("three").set({minActiveDuration:60}),yield(0,a.xy)("three",n=>{let{aspect:i,camera:r}=e;t.update(r,i,n.deltaTime)}),yield(0,l.a)([[{code:"Space",modifiers:"shift"},()=>{document.body.requestFullscreen()}]])},[]),null}function M(){return(0,i.jsx)("div",{children:(0,i.jsxs)(o.uB,{children:[(0,i.jsx)(C,{}),(0,i.jsx)(F,{})]})})}},30851:(e,t,n)=>{"use strict";n.d(t,{ClientPage:()=>v});var i=n(70691),r=n(33540),a=n(49797),o=n(7147),s=n(3293),l=n(79911),c=n(55227),d=n(8144),u=n(80446),h=n(36508),f=n(38921);class p extends a.Z58{constructor(){super(),this.position.set(0,0,-10),u.n.setRandom("parkmiller",67890);let e=[];for(let t=0;t<300;t++){let t=1.5*u.n.float(.5,2),n=new a.qU7(.25,1,8,24).scale(t,t,t).rotateX(u.n.random()*Math.PI).rotateY(u.n.random()*Math.PI).rotateZ(u.n.random()*Math.PI).translate((u.n.random()-.5)*10,(u.n.random()-.5)*10,(u.n.random()**4-.5)*10);e.push(n)}let t=f.pP(e),n=[t,t.clone().translate(10,0,0),t.clone().translate(10,10,0),t.clone().translate(0,10,0),t.clone().translate(-10,10,0),t.clone().translate(-10,0,0),t.clone().translate(-10,-10,0),t.clone().translate(0,-10,0),t.clone().translate(10,-10,0)],i=f.pP(n);for(let e of(t.computeBoundingBox(),t.dispose(),n))e.dispose();let r=new a.V9B,c={uSize:{value:t.boundingBox.getSize(new a.Pq0)},uTime:h.Rv.get("three").uTime};r.onBeforeCompile=e=>o.bI.with(e).uniforms(c).createVarying("sf_vObjectPosition").fragment.top(d.H).fragment.after("map_fragment","\n        float d = 0.5 + sf_vObjectPosition.z / uSize.z;\n        diffuseColor.rgb = vec3(d);\n        // diffuseColor.rgb = mod(uTime * 0.3, 1.0) > d ? ".concat((0,o.eR)("#fc0")," : ").concat((0,o.eR)("#0cf"),";\n      "));let p=(0,l.mj)(new a.ZLX(i,r,1),this);u.n.seed(56789);for(let e=0;e<1;e++){let t=0===e?0:u.n.float(2*Math.PI);p.setMatrixAt(e,(0,s.w)({z:-10*e,rotationZ:t}))}}}function m(){return(0,r.Fw)(function*(e){e.pipeline.basicPasses.fxaa.enabled=!1;let t=new p,n=new a.nWS(2048,2048,{type:a.ix0,format:a.VT0,generateMipmaps:!0}),i=new a.qUd(-5,5,5,-5,0,20);e.renderer.setRenderTarget(n),e.renderer.render(t,i),e.renderer.setRenderTarget(null);let r=new a.V9B({map:n.texture}),s={uTime:h.Rv.get("three").uTime};r.onBeforeCompile=e=>o.bI.with(e).defines("USE_UV").uniforms(s).fragment.top(c.M).fragment.replace("map_fragment","\n        vec2 uv = vUv;\n        uv.y += uTime * 0.05;\n        uv = mod(uv, 1.0);\n        vec4 texelColor = texture2D(map, uv);\n        // texelColor.rgb = pow(texelColor.rgb, vec3(1.0 / 2.2));\n        float alpha = clamp(mod(texelColor.r + uTime * 0.1, 1.0) * 2.0, 0.0, 1.0);\n        alpha = cos(alpha * 3.14159 * 2.0) * 0.5 + 0.5;\n        alpha = smoothstep(0.2, 0.8, alpha);\n        diffuseColor.rgb = mix(".concat((0,o.eR)("#6f00ffff"),", ").concat((0,o.eR)("#f1ffaaff"),", alpha);\n\n        Vec3Ramp r = ramp(alpha, ").concat((0,o.eR)("#6f00ffff"),", ").concat((0,o.eR)("#08091dff"),", ").concat((0,o.eR)("#00fffaff"),", ").concat((0,o.eR)("#ffe4ffff"),");\n        diffuseColor.rgb = mix(r.a, r.b, r.t);\n      "));let d=(0,l.mj)(new a.eaF(new a.bdM,new a.V9B({map:n.texture})),{parent:e.scene,x:-5,scale:10}),u=(0,l.mj)(new a.eaF(new a.bdM,r),{parent:e.scene,x:5,scale:10});yield()=>{n.dispose(),d.removeFromParent(),u.removeFromParent()}}),(0,r.dB)("my-scene",function*(e){},[]),null}function v(){return(0,i.jsxs)(r.uB,{vertigoControls:{size:10,eventTarget:"canvas"},children:[(0,i.jsxs)("div",{className:"ClientPage layer thru flex flex-col p-12",children:[(0,i.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"Playing with depth"}),(0,i.jsx)("div",{children:"(using a custom shader material on instanced meshes, with a depth texture)"})]}),(0,i.jsx)(m,{})]})}},32137:(e,t,n)=>{"use strict";n.d(t,{Q:()=>u});var i=n(70691),r=n(67203),a=n(63106),o=n(21667),s=n(18479),l=n(43865),c=n.n(l);let d=[c().frame,c().full];function u(e){let[t,n]=(0,r.useState)(0),{ref:l}=(0,s.useLayoutEffects)(function*(e){yield(0,o.G)(e,{onSize:t=>{let{x:n,y:i}=t.size;e.classList.toggle(c().landscape,n>i)}});let t=!1;yield(0,a.a)(document.documentElement,[[{key:"f",noModifiers:!0},i=>{i.event.preventDefault(),document.fullscreenElement!==e?(e.requestFullscreen(),t=!1):!1===t?(t=!0,n(1)):(document.exitFullscreen(),n(0))}]])},[]),{children:u,className:h}=e;return(0,i.jsx)("div",{ref:l,className:[c().Billboard,c().landscape,d[t],null!=h?h:""].join(" "),children:u})}},33540:(e,t,n)=>{"use strict";n.d(t,{q:()=>r.ThreeInstance,uB:()=>r.ThreeProvider,dB:()=>i.dB,yk:()=>i.yk,Fw:()=>i.Fw});var i=n(87548),r=n(42436),a=n(63106);n(18479);var o=n(79911),s=n(67235);let l={hotkey:"g",show:void 0,hide:void 0,isHelper:e=>!0===e.userData.helper};class c{*initialize(){let{hotkey:e}=this.safeParams;yield(0,a.a)([[{key:e,keyCaseInsensitive:!0},()=>this.toggle()]])}toggle(){return this.currentShowHelpers=!this.currentShowHelpers,this.updateHelpers(),this.currentShowHelpers}updateHelpers(){let{isHelper:e}=this.safeParams;for(let t of(0,o.$z)(this.root))e(t)&&(t.visible=this.currentShowHelpers);s.Q.send("TOGGLE_HELPERS",this.currentShowHelpers?"SHOW":"HIDE")}set showHelpers(e){this.currentShowHelpers=null!=e?e:this.currentShowHelpers,this.updateHelpers()}constructor(e,t){var n;c.instances.set(e,this),this.safeParams={...l,...t},this.root=e.scene,this.currentShowHelpers=null!=(n=null==t?void 0:t.show)?n:(null==t?void 0:t.hide)!==!1,this.updateHelpers()}}c.instances=new Map},33589:(e,t,n)=>{"use strict";n.d(t,{F:()=>a});let i={resolved:!1},r=Symbol("promisify");function a(e,t){if(r in e)return e;let{resolved:n=!1}={...i,...t},a={resolve:()=>e,reject:e=>{}},o=new Promise((t,n)=>{a.resolve=()=>(s(),t(e),e),a.reject=e=>{s(),n(Error(e))}}),s=()=>{delete a.resolve,delete a.reject,delete e.then,delete e.catch,delete e.finally,delete e.resolve,delete e.reject,delete e[r]};return Object.assign(e,{then:(e,t)=>(n&&(a.resolve(),n=!1),o.then(e,t)),catch:e=>o.catch(e),finally:e=>o.finally(e),resolve:()=>a.resolve(),reject:()=>a.reject(),[r]:!0}),e}},37821:(e,t,n)=>{"use strict";n.d(t,{D:()=>r});var i=n(67203);function r(){let[e,t]=(0,i.useState)(!1);return(0,i.useLayoutEffect)(()=>{t(!0)},[]),e}},42436:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ThreeInstance:()=>x,ThreeProvider:()=>b});var i=n(70691),r=n(67203),a=n(30158),o=n(24223),s=n(63106),l=n(18479),c=n(37821),d=n(31763),u=n(40951),h=n(29338),f=n(82143),p=n(83628),m=n(67235),v=n(68571),g=n(87548);function x(e){return(0,g.Nj)(e),null}let w={type:void 0,webgl:void 0,webgpu:void 0,className:"",assetsPath:"/",vertigoControls:!1,minActiveDuration:30,fullscreenKey:null};function y(e){var t;let n={...w,...e},{children:c,className:g,vertigoControls:x}=n,y=null!=(t=n.type)?t:n.webgpu?"webgpu":"webgl",b=(0,r.useRef)(void 0);b.current&&b.current!==y&&console.warn('ThreeProvider: the prop "type" is not intended to change after the component is mounted.'),b.current=y;let P=(0,r.useMemo)(()=>"webgl"===y?new f.XW:new p.K,[y]);P.ticker.set({minActiveDuration:n.minActiveDuration});let{ref:F}=(0,l.useLayoutEffects)({debounce:!0},function*(e,t){let n=e.querySelector("#three-wrapper-canvas");yield P.initialize(n,document.body),P.pointer.setEventIgnore(u.K6.Type.Tap,e=>{let{downTarget:t}=e;return!1===(n===t||n.contains(t))}),t.triggerRender(),Object.assign(window,{three:P,THREE:a})},[]);(0,l.useEffects)(function*(){yield m.Q.on("THREE",e=>{e.setPayload(P)}),yield(0,o.O)(P.ticker.requestActivation);let e=()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()};if(n.fullscreenKey&&(yield(0,s.a)([[n.fullscreenKey,e]])),yield m.Q.on("TOGGLE_FULLSCREEN",e),x){var t,i,r;let e="object"==typeof x?x:{},n=new d.n(e).initialize("canvas"===e.eventTarget?P.domElement:F.current);Object.assign(n.inputConfig,e.inputConfig),n.parsePanInputs(null!=(t=e.panInput)?t:""),n.parseOrbitInputs(null!=(i=e.orbitInput)?i:""),n.focusPlane=null!=(r=e.focusPlane)?r:null,P.scene.add(n.group),e.fixed||n.start(),yield(0,s.a)([[{code:"Tab",modifiers:"alt"},e=>{e.event.preventDefault(),n.actions.toggleAlternative()}]]),yield n.destroy;let a=e=>{"SET"===e.type?n.vertigo.set(e.payload):e.setPayload(n)};yield m.Q.on("VERTIGO_CONTROLS",a),yield m.Q.on(d.n,a),yield P.ticker.onTick({name:"VertigoControls",phase:h.z.BeforeRender,order:-1},e=>{n.update(P.camera,P.aspect,e.deltaTime)})}},[x]);let C={position:"absolute",inset:0};return(0,i.jsx)("div",{ref:F,className:g,style:C,children:(0,i.jsxs)(v.reactThreeContext.Provider,{value:P,children:[(0,i.jsx)("div",{id:"three-wrapper-canvas",style:C}),(0,i.jsx)("div",{id:"three-wrapper-hud",style:C,className:"thru",children:P.initialized&&c})]})})}function b(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,c.D)()&&(0,i.jsx)(y,{...t[0]})}},43865:e=>{e.exports={Billboard:"billboard_Billboard__1od0V",landscape:"billboard_landscape__OR09y",frame:"billboard_frame__m5PEh",full:"billboard_full__0I_hQ"}},48181:(e,t,n)=>{"use strict";n.d(t,{R:()=>h});var i=n(49797),r=n(6726),a=n(72612),o=n(93432);let s=new i.I9Y,l=new i.Pq0,c=new i.kn4;function*d(e){let t=new WeakSet;for(let n of e)t.has(n)||(t.add(n),yield n)}function u(e,t,n,i,r){if(null==n?void 0:n.transform)for(let e of((0,o.vl)(n.transform,c),d(t)))e.applyMatrix4(c);if((null==n?void 0:n.color)!==void 0&&e.color(n.color),i){for(let n=0;n<t.length-1;n++)e.points.push(t[n],t[n+1]);r&&e.points.push(t[t.length-1],t[0])}else e.points.push(...t)}class h extends i.DXC{addTo(e){return e?e.add(this):this.removeFromParent(),this}*uniquePoints(){yield*d(this.points)}opacity(e){return this.material.opacity=e,this.material.transparent=this.state.forceTransparent||e<1,this.material.depthWrite=e>=1,this.material.needsUpdate=!0,this}color(e){return this.colors.set(this.points.length,new i.Q1f(e)),this}forceTransparent(){return this.state.forceTransparent=!0,this.material.transparent=!0,this}translate(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[i,r,a]=1===t.length?(0,o.jj)(t[0],l):t;for(let e of this.uniquePoints())e.x+=i,e.y+=r,e.z+=a;return this}rescale(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[i,r,a]=1===t.length?(0,o.jj)(t[0],l):t;for(let e of this.uniquePoints())e.x*=i,e.y*=r,e.z*=a;return this}showOccludedLines(){let{opacity:e=.2}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new i.mrM({color:this.material.color,transparent:!0,depthFunc:i.K52,opacity:e}),n=new i.DXC(this.geometry,t);return this.add(n),this}clear(){return this.points.length=0,this.colors.clear(),this.geometry.setDrawRange(0,0),this}draw(){if(!1===this.state.hasAlreadyBeenRendered&&-1===this.state.reservePoints)this.geometry.setFromPoints(this.points),this.geometry.setDrawRange(0,this.points.length),this.state.reservePoints=this.points.length;else{let{position:e}=this.geometry.attributes;e||(e=new i.THS(new Float32Array(3*this.state.reservePoints),3),this.geometry.setAttribute("position",e));let t=this.points.length;t>e.count&&(console.warn("LineHelper: The number of points (".concat(t,") is greater than the reserved points (").concat(e.count,").")),t=e.count),this.geometry.setDrawRange(0,t);for(let n=0;n<t;n++){let{x:t,y:i,z:r}=this.points[n];e.setXYZ(n,t,i,r)}e.needsUpdate=!0}if(this.geometry.computeBoundingSphere(),this.material.vertexColors=this.colors.size>0,this.material.needsUpdate=!0,this.colors.size>0){var e;let{color:t}=this.geometry.attributes;t||(t=new i.THS(new Float32Array(3*this.geometry.attributes.position.count),3),this.geometry.setAttribute("color",t));let n=new i.Q1f(null!=(e=this.colors.get(0))?e:"white"),r=this.points.length;for(let e=0;e<r;e++){let i=this.colors.get(e);i&&n.copy(i),t.setXYZ(e,n.r,n.g,n.b)}t.needsUpdate=!0}return this}line(e,t,n){return u(this,[(0,o.jj)(e),(0,o.jj)(t)],n),this}capsule2(e,t,n,r){let s=(0,o.jj)(e),l=(0,o.jj)(t),c=new i.Pq0().subVectors(l,s),d=c.length(),h=c.clone().divideScalar(d),f=new i.Pq0(-h.y,h.x);return u(this,[...(0,a.loopArray)(24,e=>{let t=e.p*Math.PI;return s.clone().addScaledVector(f,n*Math.cos(t)).addScaledVector(h,-n*Math.sin(t))}),...(0,a.loopArray)(24,e=>{let t=e.p*Math.PI;return l.clone().addScaledVector(f,-n*Math.cos(t)).addScaledVector(h,n*Math.sin(t))})],r,!0,!0),this}polygon(e,t){let n=e.map(e=>(0,o.jj)(e)),i=[];for(let e=0;e<n.length;e++)i.push(n[e],n[(e+1)%n.length]);return u(this,i,t),this}polyline(e,t){let n=e.map(e=>(0,o.jj)(e)),i=[];for(let e=0;e<n.length-1;e++)i.push(n[e],n[e+1]);return u(this,i,t),this}circle(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let{x:r,y:a,z:l,radius:c,segments:d,plane:f,...p}={...h.circleDefaultOptions,...(()=>{if(t.length>1){let[e,n,i]=t,{x:r,y:a}=(0,o.wX)(e,s);return{x:r,y:a,radius:n,...i}}return t[0]})()},m=new i.Pq0(1,0,0),v=new i.Pq0(0,1,0),g=[];for(let e=0;e<d;e++){let t=e/d*Math.PI*2,n=(e+1)/d*Math.PI*2,o=Math.cos(t)*c,s=Math.sin(t)*c,u=Math.cos(n)*c,h=Math.sin(n)*c,f=new i.Pq0(r,a,l).addScaledVector(m,o).addScaledVector(v,s),p=new i.Pq0(r,a,l).addScaledVector(m,u).addScaledVector(v,h);g.push(f,p)}if("XZ"===f)for(let e of g)e.set(e.x,0,e.y);if("YZ"===f)for(let e of g)e.set(0,e.x,e.y);return u(this,g,p),this}sphere(e){return this.circle({...e,plane:"XY"}).circle({...e,plane:"XZ"}).circle({...e,plane:"YZ"})}rectangle(e,t){let{centerX:n,centerY:a,width:o,height:s}=r.M_.from(e),l=o/2,c=s/2,d=new i.Pq0(n-l,a-c,0),h=new i.Pq0(n+l,a-c,0),f=new i.Pq0(n+l,a+c,0),p=new i.Pq0(n-l,a+c,0);return u(this,[d,h,h,f,f,p,p,d],t),this}placeholder(e,t){let n=r.M_.from(e);return this.rectangle(n,t).line(n.fromRelativePoint(0,0),n.fromRelativePoint(1,1),t).line(n.fromRelativePoint(1,0),n.fromRelativePoint(0,1),t)}grid2(e){let{plane:t,x:n,y:r,z:a,size:l,subdivisions:c,width:d,height:f,widthSubdivisions:p,heightSubdivisions:m,...v}={...h.grid2DefaultOptions,...e},{x:g,y:x}=(0,o.wX)(l,s),{x:w,y:y}=(0,o.wX)(null!=c?c:l);d&&(g=d),f&&(x=f),p&&(w=p),m&&(y=m);let b=g/2,P=x/2,F=[];for(let e=0;e<=w;e++){let t=e/w*g-b;F.push(new i.Pq0(t,-P,0),new i.Pq0(t,P,0))}for(let e=0;e<=y;e++){let t=e/y*x-P;F.push(new i.Pq0(-b,t,0),new i.Pq0(b,t,0))}let C=new i.Pq0(n,r,a);for(let e of F)e.add(C);if("XZ"===t)for(let e of F)e.set(e.x,0,e.y);if("YZ"===t)for(let e of F)e.set(0,e.x,e.y);return u(this,F,v),this}box(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=0,n=0,r=0,a=1,s=1,c=1,{center:d,size:u,box3:h}=e;if(void 0!==d&&({x:t,y:n,z:r}=(0,o.jj)(d,l)),void 0!==u&&({x:a,y:s,z:c}=(0,o.jj)(u,l)),void 0!==h){let{min:i,max:o}=h,{x:l,y:d,z:u}=i,{x:f,y:p,z:m}=o;e.asIntBox3&&(f+=1,p+=1,m+=1),t=(l+f)/2,n=(d+p)/2,r=(u+m)/2,a=f-l,s=p-d,c=m-u}let f=a/2,p=s/2,m=c/2,v=new i.Pq0(t-f,n-p,r-m),g=new i.Pq0(t+f,n-p,r-m),x=new i.Pq0(t+f,n+p,r-m),w=new i.Pq0(t-f,n+p,r-m),y=new i.Pq0(t-f,n-p,r+m),b=new i.Pq0(t+f,n-p,r+m),P=new i.Pq0(t+f,n+p,r+m),F=new i.Pq0(t-f,n+p,r+m);return this.points.push(v,g,g,x,x,w,w,v),this.points.push(y,b,b,P,P,F,F,y),this.points.push(v,y,g,b,x,P,w,F),this}plus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=t/2,{x:a,y:l}=(0,o.wX)(e,s),c=new i.Pq0(a-r,l,0),d=new i.Pq0(a+r,l,0);return u(this,[c,d,new i.Pq0(a,l-r,0),new i.Pq0(a,l+r,0)],n),this}cross(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=t/2,{x:a,y:l}=(0,o.wX)(e,s),c=new i.Pq0(a-r,l-r,0),d=new i.Pq0(a+r,l+r,0);return u(this,[c,d,new i.Pq0(a-r,l+r,0),new i.Pq0(a+r,l-r,0)],n),this}constructor(e=-1,t=new i.mrM({vertexColors:!0})){super(new i.LoY,t),this.points=[],this.colors=new Map,this.state={forceTransparent:!1,hasAlreadyBeenRendered:!1,reservePoints:-1},this.state.reservePoints=e,this.onBeforeRender=()=>{this.state.hasAlreadyBeenRendered=!0}}}h.circleDefaultOptions={plane:"XY",x:0,y:0,z:0,radius:.5,segments:96},h.grid2DefaultOptions={plane:"XY",x:0,y:0,z:0,size:8,width:void 0,height:void 0,subdivisions:void 0,widthSubdivisions:void 0,heightSubdivisions:void 0}},50411:(e,t,n)=>{"use strict";n.d(t,{Main:()=>X});var i,r=n(70691),a=n(25432),o=n(88575),s=n(4003),l=n(72612),c=n(79285),d=n(63126),u=n(28737),h=n(49797),f=n(99332),p=n(31763),m=n(39787),v=n(36508),g=n(7693),x=n(48181),w=n(79911),y=n(44694),b=n(8597);class P extends h.YJl{static current(){if(0===this.instances.length)throw Error("No Scope!");return this.instances[this.instances.length-1]}updateScope(){let{aspect:e=1,size:t=4}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e>1?t:t*e,i=n/e;(n!==this.state.width||i!==this.state.height)&&(this.parts.lines.clear().circle({radius:1}).rectangle([-n/2,-i/2,n,i]).plus([0,0],.2).draw(),this.parts.lines.geometry.computeBoundingSphere(),this.state.width=n,this.state.height=i)}isWithin(e){let{x:t,y:n}=e.clone().applyMatrix4(this.matrixWorldInverse),{width:i,height:r}=this.state;return t>=-i/2&&t<=i/2&&n>=-r/2&&n<=r/2}chunkIntersects(e){this.updateMatrixWorld(),e.updateMatrixWorld();let t=!0,n=!0,i=!0,r=!0,a=this.state.width/2,o=this.state.height/2;for(let s=0;s<4;s++){let{x:l,y:c,z:d}=P._chunkIntersectsVectors[s].copy(b.rU[s]).applyMatrix4(e.matrixWorld).applyMatrix4(this.matrixWorldInverse);if(t&&(t=l<-a),i&&(i=l>a),n&&(n=c<-o),r&&(r=c>o),!1===(t||n||i||r))return!0}return!1}toVertigoProps(){let{width:e,height:t}=this.state;return{perspective:.5,size:[e,t],focus:this.position,rotation:this.rotation}}constructor(){super(),this.parts={lines:(0,w.mj)(new x.R,this),debugLines:(0,w.mj)(new x.R,this)},this.state={width:4,height:4},this.matrixWorldInverse=new h.kn4,this.destroy=()=>{let e=P.instances.indexOf(this);if(-1===e)throw Error("Scope instance not found");P.instances.splice(e,1)},P.instances.push(this),this.position.set(0,0,6),this.rotation.setFromRotationMatrix(b.RY,g.B.default.rotation.order),this.rotation.x+=(0,y.ey)("20deg"),this.updateMatrix(),this.updateMatrixWorld(),this.matrixWorldInverse.copy(this.matrixWorld).invert()}}P.instances=[],P._chunkIntersectsVectors=[new h.Pq0,new h.Pq0,new h.Pq0,new h.Pq0];var F=n(34011),C=n(16465),M=n(23120);function S(e,t){if(e<-32768||e>=32768||t<-32768||t>=32768)throw RangeError("x and y must be in the range -0x8000 to 0x7fff, received: ".concat(e," (0x").concat(e.toString(16),"), ").concat(t," (0x").concat(t.toString(16),")"));return(e+=32768)<<16|(t+=32768)}let D=new h.I9Y;function*E(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[i,r]=(()=>{if(1!==t.length)return t;{let{x:e,y:n}=(0,y.wX)(t[0]);return[e,n]}})();yield D.set(Math.floor((i-1)/2),r-1),yield D.set(Math.floor((i+1)/2),r-1),yield D.set(i-1,r),yield D.set(i+1,r),yield D.set(2*i-1,r+1),yield D.set(2*i,r+1),yield D.set(2*i+1,r+1),yield D.set(2*i+2,r+1)}class A extends h.YJl{drawCircles(){let{count:e=1,step:t=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(let n=1;n<e;n++){let e=1+n*t;(0,w.mj)(new h.DXC(this.parts.circles.geometry,this.parts.circles.material),{parent:this,scaleScalar:e})}return this}constructor(...e){super(...e),this.parts=(()=>{let e=new x.R;e.circle({radius:1,color:F.k.defaultOptions.zColor}).circle({radius:1,color:F.k.defaultOptions.xColor,transform:{rotationY:"90deg"}}).circle({radius:1,color:F.k.defaultOptions.yColor,transform:{rotationX:"90deg"}}).draw();let t=new h.eaF(new F.k,new C.Y({vertexColors:!0}));return{axes:(0,w.mj)(t,this),circles:(0,w.mj)(e,this)}})()}}class T extends h.YJl{static current(){if(0===this.instances.length)throw Error("No World!");return this.instances[this.instances.length-1]}scopeUpdate(e){let t=(0,d.calculateExponentialDecayLerpRatio)(1e-4,e);this.dampedScopeCoordinates.lerp(this.scopeCoordinates,t);let{x:n,y:i}=this.dampedScopeCoordinates;this.scope.position.set(0,0,6).addScaledVector(b.uJ.U,n),this.worldScale=2**(.33*i),this.setChunkGroupScale(this.worldScale)}getChunk(e,t){var n;return null!=(n=this.chunks.get(S(e,t)))?n:null}ensureChunk(e,t){let n=S(e,t),i=this.chunks.get(n);if(i)return i;{let n=(0,w.mj)(new M.hf({world:this}),this.chunkGroup);return this.chunks.set(S(e,t),n),n.setGridCoords([e,t]),n}}ensureChunkNeighbors(e,t){for(let n of(this.ensureChunk(e,t),E(e,t)))this.ensureChunk(n.x,n.y)}ensureScopeChunks(){let e=new Set([S(0,0)]),t=[this.ensureChunk(0,0)],n=0;for(;t.length>0;){if(n++>100){console.error("Exceeded maximum chunk count of ".concat(100));break}let i=t.pop();if(this.scope.chunkIntersects(i))for(let n of E(i.gridCoords)){let i=S(n.x,n.y);e.has(i)||(e.add(i),t.push(this.ensureChunk(n.x,n.y)))}}}toWhite(){for(let e of this.chunks.values())e.toWhite()}toColor(){for(let e of this.chunks.values())e.toColor()}constructor(){super(),this.origin=(0,w.mj)(new h.IzY,{parent:this,position:b.Dm,rotation:b.xO}),this.chunkGroup=(0,w.mj)(new h.YJl,{parent:this}),this.scopeCoordinates=new h.I9Y,this.dampedScopeCoordinates=new h.I9Y,this.worldScale=1,this.scopeOriginPoint=new h.Pq0,this.scopeCenterChunkPoint=new h.Pq0,this.scope=(0,w.mj)(new P,this),this.XXX=(0,w.mj)(new A,this.chunkGroup),this.YYY=new h.I9Y,this.setChunkGroupScale=(()=>{let e=new h.kn4;return t=>{var n;this.scopeCenterChunkPoint.copy(this.scope.position).applyMatrix4(b.mj),this.scopeOriginPoint.set(this.scopeCenterChunkPoint.x,0,0).applyMatrix4(b.RY),this.chunkGroup.position.copy(this.scopeOriginPoint).addScaledVector(this.scopeOriginPoint,-t),this.chunkGroup.scale.setScalar(t),this.chunkGroup.updateMatrix(),this.XXX.position.copy(this.scope.position).applyMatrix4(b.mj),this.XXX.position.z=0,this.XXX.position.applyMatrix4(b.RY).applyMatrix4(e.copy(this.chunkGroup.matrix).invert());let{x:i,y:r}=(0,M.hB)(this.XXX.position,this.YYY);i=Math.round(i-.5),r=Math.round(r+.5),this.toWhite(),null==(n=this.getChunk(i,r))||n.toColor()}})(),this.chunks=new Map,this.destroy=()=>{this.scope.destroy(),this.chunks.clear(),this.clear();let e=T.instances.indexOf(this);if(-1===e)throw Error("World instance not found");T.instances.splice(e,1)},T.instances.push(this)}}T.instances=[];var B=function(e){return e[e.Free=0]="Free",e[e.Scope=1]="Scope",e}(B||{});class z{initialize(e){return this.element=e,this}*doStart(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!=(i=this.element)?i:document.body;yield(0,f.s)(e,{onDrag:e=>{let t=T.current();t.scopeCoordinates.x+=-(.005*e.delta.x)/t.worldScale,t.scopeCoordinates.y+=-(.01*e.delta.y)}}),yield(0,v.xy)("three",e=>{let t=T.current();t.scopeUpdate(e.deltaTime);let n=t.scope.position;this.vertigoControls.vertigo.set({focus:n}),this.vertigoControls.dampedVertigo.set({focus:n})})}start(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._started||(this._destroyables.collect(this.doStart(...t)),this._started=!0)}stop(){this._started&&(this._destroyables.destroy(),this._started=!1)}toggle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this._started;e?this.start():this.stop()}update(e,t,n){this.vertigoControls.update(e,t,n)}constructor(){this.position=new h.I9Y,this.dampedPosition=new h.I9Y,this.scale=1,this._destroyables=new m.el,this.vertigoControls=new p.n({perspective:.5}),this._started=!1,this.destroy=()=>{this._destroyables.destroy()}}}class j{get mode(){return this._mode}set mode(e){this.setMode(e)}initialize(e,t){this.camera=e,this.freeVertigoControls.initialize(t).toggle(0===this._mode),this.scopeCameraHandler.initialize(t).toggle(1===this._mode);let n=P.current().toVertigoProps();return this.scopeCameraHandler.vertigoControls.vertigo.set(n),this.scopeCameraHandler.vertigoControls.dampedVertigo.set(n),this}setMode(e){if(e%=2,this._mode!==e)switch(this._mode=e,this.freeVertigoControls.toggle(0===e),this.scopeCameraHandler.toggle(1===e),e){case 0:this.mode=j.Mode.Free,this.freeVertigoControls.dampedVertigo.copy(this.scopeCameraHandler.vertigoControls.dampedVertigo);break;case 1:this.mode=j.Mode.Scope,this.scopeCameraHandler.vertigoControls.dampedVertigo.copy(this.freeVertigoControls.dampedVertigo),this.scopeCameraHandler.vertigoControls.vertigo.set(P.current().toVertigoProps())}}onTick(e,t){switch(this._mode){case 0:this.freeVertigoControls.update(this.camera,t,e.deltaTime),console.log();break;case 1:this.scopeCameraHandler.update(this.camera,t,e.deltaTime)}}constructor(){this._mode=0,this.freeVertigoControls=new p.n({size:24,perspective:1}),this.scopeCameraHandler=new z,this.destroy=()=>{this.freeVertigoControls.destroy(),this.scopeCameraHandler.destroy();let e=j.instances.indexOf(this);if(-1===e)throw Error("CameraHandler instance not found");j.instances.splice(e,1)},j.instances.push(this)}}j.Mode=B,j.instances=[];var k=n(21277),R=n(17099);function O(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new h.IUQ,i=2**t,r=2*(1-1/i),a=1/i;return n.x=e*b.NP*a,n.y=-b.Bg*r,n.z=b.Bg*r+e*b.NP*a,n.w=a,n}class I extends h.YJl{updatePointer(e){let t=e.intersectPlane(b.gc,new h.Pq0);if(!t)return;let{text:n,pointerText:i}=this.internal,r=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new h.I9Y;return n.y=Math.floor(-Math.log2(1- -t/b.Bg/2)),n.x=Math.floor(e/b.NP*2**n.y),n}(t.x,t.y);if(Number.isNaN(r.x)||Number.isNaN(r.y))return;let a=1/2**function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new h.I9Y,i=1- -t/b.Bg/2;return n.y=-Math.log2(i),n.x=e/(b.NP*i),n}(t.x,t.y,new h.I9Y).y;for(let e of this.internal.positions){let t=e.x===r.x&&e.y===r.y?"#ffff66":"white";n.data.setColorAt(e.i+1,{backgroundColor:t})}n.material.needsUpdate=!0,i.setTextAt(0,"".concat(r.x,",").concat(r.y),{textColor:"#ffff66",textOpacity:0,backgroundColor:"#ffff66",backgroundOpacity:1,position:t,size:3*a});let o=O(r.x,r.y);this.internal.pointerLine.clear().line(t,[o.x,o.y,o.z],{color:"#ffff66"}).draw()}constructor(...e){super(...e),this.internal=(()=>{let e=[new h.Pq0(0,0,0),new h.Pq0(0,-b.Bg,b.Bg),new h.Pq0(b.NP,-b.Bg,b.NP+b.Bg),new h.Pq0(b.NP,0,b.NP)],t=(0,w.mj)(new x.R,this);for(let n=0;n<12;n++){let i=2**n,r=2*(1-1/i),a=1/i,o=new h.Pq0(0,-b.Bg*r,b.Bg*r);t.polygon(e.map(e=>e.clone().multiplyScalar(a).add(o)))}t.polyline([[0,0,0],b.Dm]),t.draw(),(0,w.mj)(new h.eaF(new F.k,new C.Y({vertexColors:!0})),{parent:this,position:b.Dm,rotation:b.xO});let n=(0,l.loop2Array)(4,8),i=(0,w.mj)(new s.w({lineCount:1,lineLength:14}),this),r=(0,w.mj)(new x.R(100),this);for(let e of n){let{x:t,y:n,z:r,w:a}=O(e.x,e.y);i.setTextAt(e.i+1,"".concat(e.x,",").concat(e.y),{textColor:"white",textOpacity:0,backgroundColor:"white",backgroundOpacity:1,position:[t,n,r],size:2*a})}return{positions:n,text:i,pointerText:(0,w.mj)(new s.w({lineCount:2,lineLength:16}),this),pointerLine:r}})()}}var N=n(67203),L=n(18479);n(61249);let _=(0,N.createContext)(null);function U(e,t){let n=(0,N.useContext)(_);return(0,L.useEffects)(async function*(t,i){if(e){let t=e(n,i);if(t&&"function"==typeof t.next)do{let{value:e,done:n}=await t.next();if(n)break;yield e}while(i.mounted)}},null!=t?t:"always"),n}let q={className:"",assetsPath:"/"};function W(e){let{children:t,className:n,assetsPath:i}={...q,...e},a=(0,N.useMemo)(()=>new o.XW,[]);a.loader.setPath(i);let{ref:s}=(0,L.useLayoutEffects)({debounce:!0},function*(e,t){yield a.initialize(e.firstElementChild),t.triggerRender(),Object.assign(window,{three:a})},[]);return(0,r.jsx)("div",{ref:s,className:n,style:{position:"absolute",inset:0},children:(0,r.jsxs)(_.Provider,{value:a,children:[(0,r.jsx)("div",{style:{position:"absolute",inset:"0"}}),(0,r.jsx)("div",{style:{position:"absolute",inset:"0"},className:"thru",children:a.initialized&&t})]})})}function V(e){return function(){let[e,t]=(0,N.useState)(!1);return(0,N.useLayoutEffect)(()=>{t(!0)},[]),e}()&&(0,r.jsx)(W,{...e})}function G(){return!function(e,t,n){let i=(0,N.useMemo)(()=>new h.YJl,[]);i.name=e,U(async function*(e,n){if(e.scene.add(i),yield()=>{i.clear(),i.removeFromParent()},t){let r=t(i,e,n);if(r&&"function"==typeof r.next)do{let{value:e,done:t}=await r.next();if(t)break;yield e}while(n.mounted)}},n)}("fractal-grid",function*(e,t){var n;(0,w.mj)(new k.N({color:"#110512"}),e),(0,w.mj)(new x.R,e).grid2().draw();let i=(0,w.mj)(new I,e);(0,w.mj)(new h.eaF(new h.UPV(2.5,.025,512,32),new C.Y({color:"#0cf"})),e).visible=!1,R.c.seed(98763);let r=(0,w.mj)(new T,e);yield r.destroy,r.visible=!1,r.scope.updateScope({aspect:t.aspect}),r.ensureScopeChunks();let a=new j().initialize(t.camera,t.renderer.domElement),o=new h.Pq0,s=(0,w.mj)(new h.eaF(new h.WBB(.1),new C.Y({color:"#f0f"})),e);yield(0,v.xy)("three",e=>{a.onTick(e,t.aspect),r.scope.updateScope({aspect:t.aspect}),t.pointer.ray.intersectPlane(b.gc,o),s.position.copy(o),i.updatePointer(t.pointer.ray)}),r.toColor(),null==(n=r.getChunk(0,0))||n.toWhite(),Object.assign(window,{world:r,cameraHandler:a}),(0,w.mj)(new h.eaF(new F.k,new C.Y({vertexColors:!0})),e)},[]),null}function Y(){return U(function*(e){let t=new a.F(e.scene,e.camera);t.updatePdMaterial({lumaPhi:10,depthPhi:2,normalPhi:3,radius:2,radiusExponent:2,rings:2,samples:24}),yield e.pipeline.addPass(t,{type:o.O0.PostProcessing}),(0,u.O)({three:e,...l,TextHelper:s.w,calculateExponentialDecayLerpRatio:d.calculateExponentialDecayLerpRatio,calculateExponentialDecayLerpRatio2:d.calculateExponentialDecayLerpRatio2,lerp:c.lerp})},[]),null}function X(){return(0,r.jsx)("div",{className:"FractalGrid",children:(0,r.jsxs)(V,{children:[(0,r.jsxs)("div",{className:"layer thru flex flex-col p-4 gap-2 items-start",children:[(0,r.jsx)("h1",{className:"text-2xl",children:"FractalGrid"}),(0,r.jsx)("button",{className:"border border-white px-2 py-1 rounded",onClick:()=>j.instances[0].mode++,children:"Switch camera"})]}),(0,r.jsx)(Y,{}),(0,r.jsx)(G,{})]})})}},52753:(e,t,n)=>{"use strict";n.d(t,{Client:()=>F});var i=n(70691),r=n(24223),a=n(18479),o=n(36508),s=n(67203),l=n(36575),c=n(42206),d=n(85795),u=n(56905);class h{paint(e){let{ctx:t,pixelRatio:n}=this;t.clearRect(0,0,t.canvas.width,t.canvas.height),e.computeLayout();let i=e=>{let t=0;for(let n of e.allAncestors({includeSelf:!0}))t+=n.positioning===u.EU.Detached?100:1;return t};for(let r of[...e.allDescendants({includeSelf:!1})].filter(e=>!e.userData.skipPaint).sort((e,t)=>i(e)-i(t))){let e=r.rect.clone().multiplyScalar(n),i=function(e){let t;for(;!t&&e;){if(void 0!==(t=e.userData.color))return t;e=e.parent}return"#ffffff"}(r);r.userData.plain?(t.strokeStyle="",t.fillStyle=i,t.fillRect(e.x,e.y,e.width,e.height)):(t.lineWidth=2*n,t.strokeStyle=i,t.fillStyle="rgba(0, 0, 0, .5)",t.fillRect(e.x,e.y,e.width,e.height),t.strokeRect(e.x,e.y,e.width,e.height))}}constructor(e,{pixelRatio:t=window.devicePixelRatio,width:n=800,height:i=600}={}){e.width=n*t,e.height=i*t,e.style.width="".concat(n,"px"),e.style.height="".concat(i,"px"),this.ctx=e.getContext("2d"),this.pixelRatio=t,this.width=n,this.height=i}}let f={yellow:"#ffcc00",magenta:"#cc00ff",paleGreen:"#00ffcc",blue:"#00ccff",vibrantBlue:"#1c55ff"},p=[{direction:c.OP.Horizontal,aspect:1},{direction:c.OP.Vertical,aspect:2},{direction:c.OP.Vertical,aspect:8},{direction:c.OP.Vertical,aspect:.5},{direction:c.OP.Horizontal,aspect:.5},{direction:c.OP.Horizontal,aspect:1/4}];function m(){let e=(0,s.useMemo)(()=>new d.ObservableNumber(0),[]),{ref:t}=(0,a.useEffects)(function*(t){let n=new h(t.querySelector("canvas")),{direction:i,aspect:r}=p[e.value],a=new c.$x({direction:i,size:[n.width,n.height],spacing:10,alignChildren:1}).add(new c.$x({alignChildren:.5,aspect:r,spacing:10,userData:{color:f.yellow}}).add(new c.$x({size:["50%","50%"]}),new c.$x({size:["10%","10%"]})),new c.$x({aspect:r,spacing:10,userData:{color:f.paleGreen}}).add(new c.$x,new c.$x),new c.$x({aspect:r,userData:{color:f.magenta}}));yield e.onChange(e=>{let{direction:t,aspect:n}=p[e];for(let e of(a.set({direction:t}),a.children))e.set({aspect:n})}),yield(0,o.xy)("layout",e=>{a.set({alignChildren:e.cos01Time({frequency:.1})}),a.get(2).set({alignSelf:e.cos01Time({frequency:.3})}),n.paint(a)})},[]),n=()=>{e.value=(e.value+1)%p.length};return(0,i.jsxs)("div",{ref:t,className:"flex flex-col justify-center gap-4",style:{flex:"0 0 800px"},children:[(0,i.jsx)("canvas",{style:{border:"solid 2px #fff1",cursor:"pointer"},onClick:n}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{children:(0,i.jsxs)("button",{className:"border border-white rounded px-2 py-1",onClick:n,children:[(0,i.jsxs)("span",{children:["Direction: ",c.OP[p[(0,l.A)(e)].direction],","]}),"\xa0",(0,i.jsxs)("span",{children:["Aspect: ",p[(0,l.A)(e)].aspect]})]})}),(0,i.jsxs)("p",{style:{color:f.magenta},children:[(0,i.jsx)("code",{children:"alignSelf"})," allows the children to override the parent's ",(0,i.jsx)("code",{children:"alignChildren"}),"."]})]})]})}function v(){let{ref:e}=(0,a.useEffects)(function*(e){let t=e.querySelector("canvas"),n=new c.$x({direction:c.OP.Horizontal,offset:[100,100],size:[600,400],padding:10,gap:10,userData:{color:f.yellow}});n.add(new c.$x({direction:c.OP.Vertical,size:[".25rel","1rel"],spacing:10,userData:{color:f.vibrantBlue}}),new c.$x({direction:c.OP.Vertical,size:[".25rel","1rel"],spacing:10,userData:{color:f.vibrantBlue}}),new c.$x({direction:c.OP.Vertical,size:[".25rel","1rel"],spacing:10,userData:{color:f.vibrantBlue}}));for(let e=0;e<3;e++)n.get(0).add(new c.$x({size:"".concat(e+1,"fr"),spacing:10,userData:{color:f.paleGreen}}));n.computeLayout();let i=window.devicePixelRatio;t.width=800*i,t.height=600*i,t.style.width="800px",t.style.height="600px";let r=t.getContext("2d");for(let e of n.allDescendants({includeSelf:!0})){var a;r.lineWidth=2*i,r.strokeStyle=null!=(a=e.userData.color)?a:"#fff",r.strokeRect(...e.rect.tupple(i))}},[]);return(0,i.jsxs)("div",{ref:e,className:"flex flex-col justify-center gap-4",style:{flex:"0 0 800px"},children:[(0,i.jsx)("canvas",{style:{border:"solid 2px #fff1"}}),(0,i.jsx)("div",{className:"text-center"})]})}function g(){let e=[10,30,90,0],t=[10,80],{ref:n}=(0,a.useEffects)(function*(n){let i=new h(n.querySelector("canvas")),r=new c.$x({direction:c.OP.Horizontal,size:[i.width,i.height],spacing:10,alignChildren:1}).add(new c.$x({userData:{color:f.yellow}}).add(new c.$x({margin:e,userData:{color:f.yellow}}).add(new c.$x({margin:e,userData:{color:f.yellow}}).add(new c.$x({margin:e,userData:{color:f.yellow}}).add(new c.$x({margin:e,userData:{color:f.yellow}}).add(new c.$x({margin:e,userData:{color:f.yellow}})))))),new c.$x({userData:{color:f.paleGreen}}).add(new c.$x({margin:t,userData:{color:f.paleGreen}})),new c.$x({padding:10,userData:{color:f.magenta}}).add(new c.$x({margin:[0,60],marginRight:0,userData:{color:f.magenta}}),new c.$x({margin:[0,60],marginLeft:0,userData:{color:f.magenta}})));yield(0,o.xy)("layout",e=>{var t;null==(t=r.get(2))||t.set({padding:10+40*e.sin01Time({frequency:.2})}),i.paint(r)})},[]);return(0,i.jsxs)("div",{ref:n,className:"flex flex-col justify-center gap-4",style:{flex:"0 0 800px"},children:[(0,i.jsx)("canvas",{style:{border:"solid 2px #fff1"}}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("h1",{children:"css-like margins:"}),(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{style:{color:f.yellow},children:["4 values (",e.join(", "),") (top, right, bottom, left)"]}),(0,i.jsxs)("li",{style:{color:f.paleGreen},children:["2 values (",t.join(", "),") (vertical, horizontal)"]}),(0,i.jsxs)("li",{style:{color:f.magenta},children:["specific overrides: ",(0,i.jsx)("code",{children:"marginLeft"}),' overrides "2 values" declaration']})]})]})]})}function x(){let e=e=>{switch(e){case 40:return f.magenta;case 120:return f.paleGreen;default:return f.yellow}},{ref:t}=(0,a.useEffects)(function*(t){var n,i;let r=new h(t.querySelector("canvas"));function a(t){return{userData:{color:e(t)},margin:t}}let o=new c.$x({direction:c.OP.Horizontal,size:[r.width,r.height],spacing:10,alignChildren:1}).add(new c.$x({spacing:10,userData:{color:"#fff2"}}).add(new c.$x({...a(0)}),new c.$x({...a(0)}),new c.$x({...a(40)}),new c.$x({...a(40)}),new c.$x({...a(120)}),new c.$x({...a(0)})));null==(n=o.get(0,2))||n.add(new c.$x({positioning:u.EU.Detached,alignSelf:0,size:[38,38],offset:[-39,-39],userData:{color:"#fff2",plain:!0}})),null==(i=o.get(0,4))||i.add(new c.$x({positioning:u.EU.Detached,alignSelf:0,size:[118,118],offset:[-119,-119],userData:{color:"#fff2",plain:!0}})),r.paint(o)},[]);return(0,i.jsxs)("div",{ref:t,className:"flex flex-col justify-center gap-4",style:{flex:"0 0 800px"},children:[(0,i.jsx)("canvas",{style:{border:"solid 2px #fff1"}}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("p",{children:'Margins "collapse" when they are adjacent to each other or to the edge (padding) of the container.'}),(0,i.jsx)("p",{style:{color:e(0)},children:"margin: 0"}),(0,i.jsx)("p",{style:{color:e(40)},children:"margin: 40"}),(0,i.jsx)("p",{style:{color:e(120)},children:"margin: 120"})]})]})}var w=n(17099);function y(){let{ref:e}=(0,a.useEffects)(function*(e){let t=new h(e.querySelector("canvas"));w.c.reset();let n=new c.$x({direction:c.OP.Horizontal,size:[t.width,t.height],spacing:10,userData:{color:f.blue}}).add(new c.$x({direction:c.OP.Vertical,size:"1part",spacing:10,userData:{color:f.paleGreen}}).populate(5,{spacing:10}),new c.$x({direction:c.OP.Vertical,size:"2sh",userData:{color:f.magenta},spacing:10}),new c.$x({direction:c.OP.Vertical,size:"1part",spacing:10}).add(new c.$x().setSize("40"),new c.$x().setSize("1part"),new c.$x().setSize("40"),new c.$x().setSize("1part").setSpacing(10).add(new c.$x({direction:"vertical",size:"1part"}),new c.$x({direction:"vertical",size:"1part"}),new c.$x({direction:"vertical",size:"1part"})),new c.$x().setSize("40")),new c.$x().setPositioning("detached").setUserData({skipPaint:!0}).setPadding(20).setSize("1rel").add(new c.$x({positioning:c.EU.Detached,offset:["0rel","1rel"],size:".7sm"})));n.get(0,3).populate(3),n.get(1).add(new c.$x({positioning:c.EU.Detached,direction:c.OP.Vertical,size:90,spacing:10}).populate(4),new c.$x({positioning:c.EU.Detached,alignSelf:0,offset:[0,0],size:70,spacing:10}).populate(3),new c.$x({positioning:c.EU.Detached,alignSelf:[0,1],size:30,spacing:10}).populate(1),new c.$x({positioning:c.EU.Detached,alignSelf:1,size:50,spacing:10}).populate(2));let i=new c.$x({positioning:c.EU.Detached,size:30}).populate(3).addTo(n.get(0,3));for(let e of n.allDescendants({includeSelf:!0}))e.positioning===c.EU.Detached&&e.set({userData:{color:f.yellow}});n.computeLayout(),yield(0,o.xy)("layout",e=>{n.get([0]).sizeX.value=e.lerpCos01Time(2,1,{frequency:1/6}),n.get([1]).sizeX.value=e.lerpCos01Time(0,4,{frequency:1/6}),i.set({alignSelf:e.sin01Time({frequency:1/3})}),t.paint(n)})},[]);return(0,i.jsxs)("div",{ref:e,className:"flex flex-col justify-center gap-4",style:{flex:"0 0 800px"},children:[(0,i.jsx)("canvas",{style:{border:"solid 2px #fff1"}}),(0,i.jsx)("div",{className:"text-center",children:(0,i.jsxs)("p",{children:["When positioning is set to ",(0,i.jsx)("code",{style:{color:f.yellow},children:"detached"}),", spaces are not affected by their parent's size."]})})]})}var b=n(67725),P=n.n(b);function F(){let{ref:e}=(0,a.useEffects)(function*(e){let[t,...n]=e.children;t.style.flex="0 0 ".concat((n.length-1)*800,"px");let i=o.Rv.get("layout").set({minActiveDuration:4});yield(0,r.O)(i.requestActivation)},[]);return(0,i.jsxs)("div",{ref:e,className:"".concat(P().Client," page overflow-scroll"),children:[(0,i.jsx)("div",{}),(0,i.jsx)(v,{}),(0,i.jsx)(g,{}),(0,i.jsx)(x,{}),(0,i.jsx)(m,{}),(0,i.jsx)(y,{})]})}},53733:(e,t,n)=>{"use strict";n.d(t,{PageClient:()=>v});var i=n(70691),r=n(99332),a=n(98839),o=n(33540),s=n(79911),l=n(49797),c=n(7147),d=n(3293),u=n(8144),h=n(80446),f=n(36508);class p extends l.YJl{constructor({count:e=8,color:t=function(){let e=new l.Q1f,t=h.n.new("parkmiller",123456);return()=>e.set(t.int(0x1000000))}()}={}){super(),this.timescale=1,this.name="ShadowHillPlanes";let n=new l.bdM,i=new l.V9B({transparent:!0,side:l.$EB}),r={uTime:{value:0},uShadowColor:{value:new l.Q1f(0)}};i.onBeforeCompile=e=>c.bI.with(e).defines("USE_UV").uniforms(r).varying({vHash:"vec4"}).top(u.H).vertex.mainAfterAll("\n        // Push each layer back a little bit to avoid z-fighting\n        gl_Position.z += -0.0001 * float(gl_InstanceID);\n\n        vHash = vec4(\n          hash(float(gl_InstanceID)),\n          hash(float(gl_InstanceID) * 7.3),\n          hash(float(gl_InstanceID) * 15.7),\n          hash(float(gl_InstanceID) * 23.9)\n        );\n      ").fragment.after("map_fragment","\n        vec2 uv = vUv;\n        float threshold0 = 0.5;\n        float amplitude = 0.1;\n        float threshold1 = threshold0;\n\n        float time = uTime * 0.333;\n        threshold1 += amplitude * sin(uv.x * 1.6783 * (1.0 + vHash.z) + vHash.w * 2.0 * 6.28)\n          * sin(time * 0.13 + vHash.y * 6.28);\n        threshold1 += amplitude * 0.6 * sin(uv.x * 3.739 * (1.0 + vHash.x) + vHash.y * 2.0 * 6.28)\n          * sin(time * 0.1 + vHash.w * 6.28);\n\n        // Small waves\n        threshold1 += amplitude * 0.2 * sin(uv.x * 8.2837 * (1.0 + vHash.y) + vHash.z * 2.0 * 6.28)\n          * sin(time * 0.1172 + vHash.w * 6.28);\n        threshold1 += amplitude * 0.1 * sin(uv.x * 9.7427 * (1.0 + vHash.z) + vHash.x * 2.0 * 6.28)\n          * sin(time * 0.1172 + vHash.w * 6.28);\n\n        float d0 = threshold0 + amplitude - uv.y;\n        float d1 = threshold1 - uv.y;\n        if (d1 > 0.0) {\n          float shadow = 1.0 - (d0 * 1.0 + d1 * 2.0) * 0.75;\n          shadow = clamp(shadow, 0.0, 1.0);\n\n          diffuseColor.rgb = vec3(0.0);\n          diffuseColor.a *= shadow;\n        }\n\n        diffuseColor.rgb *= 1.0 + 0.25 * (0.5 - hash(gl_FragCoord.xy * 0.005 + uTime));\n      ");let a=new l.ZLX(n,i,e),o=f.Rv.get("three");a.onBeforeRender=()=>{r.uTime.value+=o.tick.deltaTime*this.timescale},this.add(a);let s=function(e){let t=new l.Q1f;return"function"==typeof e?n=>t.set(e(n)):Array.isArray(e)?n=>t.set(e[n%e.length]):(t.set(e),()=>t)}(t);for(let t=0;t<e;t++)a.setMatrixAt(t,(0,d.w)({y:(t-(e-1)/2)*.1})),a.setColorAt(t,s(t))}}function m(){return(0,o.dB)("my-scene",function*(e,t){let n=(0,s.mj)(new p,e);n.rotation.z=-Math.PI/4,yield(0,r.s)(t.domElement,{onDown:()=>{n.timescale=10},onUp:()=>{n.timescale=1}})},[]),null}function v(){return(0,i.jsxs)(o.uB,{vertigoControls:{size:1,zoom:2},fullscreenKey:{code:"KeyF",modifiers:"shift"},children:[(0,i.jsxs)("div",{className:"PageClient layer thru p-16 border-[32px] border-[white] flex flex-col items-start",children:[(0,i.jsx)("h1",{className:"text-6xl font-bold",children:"OVVO Layers"}),(0,i.jsx)(a.l,{precision:0,className:"mt-2 px-2 py-1 rounded text-[black] bg-[#fff] text-xs"})]}),(0,i.jsx)(m,{})]})}},56969:(e,t,n)=>{"use strict";n.d(t,{Client:()=>R});var i=n(70691),r=n(49797),a=n(64028),o=n(84306),s=n(34011),l=n(16465),c=n(3293),d=n(79911),u=n(17099),h=n(35375),f=n(33855),p=n(28737),m=n(93432),v=n(42206),g=n(79285);class x{constructor(e,t,n,i){this.space=e,this.rect=t,this.uvRect=n,this.scatterCoeff=i,this.r0=u.c.random(),this.r1=u.c.random()}}class w{constructor(e,t){this.props={...w.defaultProps,...t};let{position:n,size:i,scatterPadding:r,sizeOptions:a,seed:o}=this.props,{col:s,row:l}=e.props;u.c.seed(o);let c=u.c.createPicker(a),d=Array.from({length:s}).map(c),h=Array.from({length:l}).map(c),{x:f,y:p}=(0,m.wX)(n),{x:y,y:b}=(0,m.wX)(i),P=new v.$x(v.OP.Horizontal).setSize(y,b).setOffset(f-y/2,p-b/2);for(let e of d){let t=new v.$x(v.OP.Vertical).setSize("".concat(e,"fr")).addTo(P);for(let e of h)new v.$x(v.OP.Horizontal).setSize("".concat(e,"fr")).addTo(t)}P.computeLayout();let F=P.rect,C=[...P.allLeaves({includeSelf:!1})],M=(y+b)/2,S=C.map(e=>{let t=e.rect.clone(),n=t.clone().relativeTo(F),{x:i,y:a}=t.getCenter(),o=Math.abs(i-f)+Math.abs(a-p),s=(0,g.inverseLerp)(.5,1,o/M);return t.centerX+=u.c.between(-r,r)*s,t.centerY+=u.c.between(-r,r)*s,new x(e,t,n,s)});this.root=P,this.nodes=S}}w.defaultProps={seed:87654,position:new r.I9Y(0,0),size:new r.I9Y(3,2),scatterPadding:.1,sizeOptions:[[.5,1],[1,10],[2,2],[3,1]]};var y=n(48181),b=n(10390),P=n(7147),F=n(22899),C=n(8144),M=n(4941),S=n(6726);class D extends r.B69{constructor(){super();let e=new r.dth("#ffffff","#926969",1);this.add(e);let t=new r.ZyN("#ffffff",2);this.add(t),t.position.set(2,4,1)}}class E extends r.V9B{get mapAspect(){return this.uniforms.uMapInfo.value.x}set mapAspect(e){this.uniforms.uMapInfo.value.x=e}getScatteredSize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new r.I9Y;return e.x=this.uniforms.uScatteredInfo.value.x,e.y=this.uniforms.uScatteredInfo.value.y,e}setScatteredSize(e){this.uniforms.uScatteredInfo.value.x=e.x,this.uniforms.uScatteredInfo.value.y=e.y}get scatteredSize(){return this.getScatteredSize()}set scatteredSize(e){this.setScatteredSize(e)}update(e){e*=.33,this.uniforms.uDispersionTime.value+=e*this.uniforms.uDispersion.value.x,this.uniforms.uLowDispersionTime.value+=e*this.uniforms.uLowDispersion.value.x}constructor(){super({side:r.$EB}),this.uniforms={uDispersionTime:{value:0},uLowDispersionTime:{value:0},uDispersion:{value:new r.IUQ(1,-.6,.4,2)},uLowDispersion:{value:new r.IUQ(0,-.6,.4,0)},uMainParams:{value:new r.IUQ(1,0)},uCenter:{value:new r.Pq0},uMapInfo:{value:new r.IUQ(1,1,.5,.5)},uScatteredInfo:{value:new r.IUQ(1,1,0,0)},uNormalMap:{value:b.o.get("three").loadTexture("textures/rough_concrete_nor_gl_1k.jpg",e=>{e.wrapS=e.wrapT=r.GJx})}},this.userData=function(e,t){for(let[n,i,r,a]of t)Object.defineProperty(e,"".concat(n,"_meta"),{enumerable:!0,value:a}),Object.defineProperty(e,n,{enumerable:!0,get:()=>i[r],set(e){i[r]=e}});return e}({},[["chunkScale",this.uniforms.uMainParams.value,"x","\n        Name(chunk.scale)\n        Slider(0, 1, step: any)\n      "],["imageVisibility",this.uniforms.uMainParams.value,"y","\n        Name(image.visibility)\n        Slider(0, 1, step: any)\n      "],["dispX",this.uniforms.uDispersion.value,"x","\n        Name(disp.x)\n        Slider(0, 1, step: any)\n      "],["dispY",this.uniforms.uDispersion.value,"y","\n        Name(disp.y)\n        Slider(-1, 1, step: any)\n      "],["dispZ",this.uniforms.uDispersion.value,"z","\n        Name(disp.z)\n        Slider(-1, 1, step: any)\n      "],["dispW",this.uniforms.uDispersion.value,"w","\n        Name(disp.cycle)\n        Slider(1, 20, step: 1)\n      "],["lowDispX",this.uniforms.uLowDispersion.value,"x","\n        Name(lowDisp.x)\n        Slider(0, 1, step: any)\n      "]]),this.onBeforeCompile=e=>P.bI.with(e).defines({USE_UV:""}).uniforms(this.uniforms).varying({vRand:"vec4"}).vertex.top(C.H,F.I,'\n  // sizeMode: 0 for "contain", 1 for "cover"\n  vec2 applyUvSize(vec2 uv, float outerAspect, float innerAspect, float sizeMode, vec2 align, vec2 scale) {\n    align.y = 1.0 - align.y; // Flip y-coordinate\n    if ((outerAspect > innerAspect) != (sizeMode == 1.0)) { // XOR condition for mode\n      float scaleFactor = outerAspect / innerAspect;\n      uv.x = (uv.x - align.x) * scaleFactor + align.x; // Adjust x-coordinate\n    } else {\n      float scaleFactor = innerAspect / outerAspect;\n      uv.y = (uv.y - align.y) * scaleFactor + align.y; // Adjust y-coordinate\n    }\n    uv = (uv - align) / scale + align;\n    return uv;\n  }\n\n  vec2 applyUvSize(vec2 uv, float outerAspect, float innerAspect, float sizeMode, vec2 align, float scale) {\n    return applyUvSize(uv, outerAspect, innerAspect, sizeMode, align, vec2(scale));\n  }\n\n  vec2 applyUvSize(vec2 uv, float outerAspect, float innerAspect, float sizeMode, vec2 align) {\n    return applyUvSize(uv, outerAspect, innerAspect, sizeMode, align, vec2(1.0));\n  }\n\n  vec2 applyUvSize(vec2 uv, float outerAspect, float innerAspect, float sizeMode) {\n    return applyUvSize(uv, outerAspect, innerAspect, sizeMode, vec2(0.5));\n  }\n\n  vec2 applyUvSize(vec2 uv, float outerAspect, float innerAspect) {\n    return applyUvSize(uv, outerAspect, innerAspect, 1.0);\n  }\n').vertex.top("\n        attribute vec4 aRectUv;\n        attribute vec4 aRand;\n      ").vertex.top("\n        vec2 delta;\n        float scatterRatio;\n\n        vec4 computeDispersion() {\n          if (uDispersion.x == 0.0) {\n            return vec4(0.0, 0.0, 0.0, 1.0);\n          }\n\n          float duration = lerp(8.0, 1.0, aRand.x * aRand.y * aRand.z);\n          float cycleCount = max(floor(uDispersion.w), 1.0);\n          float time = mod(uDispersionTime + duration * cycleCount * aRand.x, duration * cycleCount) / duration;\n          float cycleVisibility = time <= 1.0 ? 1.0 : easeInOut3(1.0 - inverseLerp(.8 * aRand.w + .1, .8 * aRand.w + .2, uDispersion.x));\n          time = mod(time, 1.0);\n          float size = easeInThenOut(time, 8.0) * lerp(2.0, 1.0, time * time) * cycleVisibility;\n          size = mix(1.0, size, pow(uDispersion.x, 1.0 / 2.0));\n\n          // Apply scale before instanceMatrix (shrinking).\n          vec3 dispersed;\n          dispersed.xy = -delta * lerp(uDispersion.y, uDispersion.z, time);\n          dispersed.z = lerp(1.0, 0.0, time);\n          dispersed *= uDispersion.x;\n\n          return vec4(dispersed, size);\n        }\n\n        float getStartEffect(float time, float duration) {\n          return min(1.0, time / duration);\n        }\n\n        float getEndEffect(float time, float timeMax, float duration) {\n          return max(0.0, time - (timeMax - duration)) / duration;\n        }\n\n        vec4 computeLowDispersion() {\n          if (uLowDispersion.x == 0.0) {\n            return vec4(0.0, 0.0, 0.0, 1.0);\n          }\n\n          float periodScalarT = inverseLerp(0.1, 0.9, scatterRatio);\n          float period = lerp(2.0, 8.0, aRand.x) * lerp(60.0, 1.0, periodScalarT);\n          float time = mod(uLowDispersionTime + period * aRand.z, period);\n\n          float duration = 1.0;\n          float effectStart = min(1.0, time);\n          float effectEnd = getEndEffect(time, period, duration);\n\n          float size = getStartEffect(time, 0.3) * (1.0 - getEndEffect(time, period, 0.3));\n          size = pow(size, 1.0 / 4.0);\n          size = mix(1.0, size, pow(uLowDispersion.x, 1.0 / 4.0));\n\n          vec3 dispersed;\n\n          dispersed.xy = delta * 0.1;\n          dispersed.z = 0.2;\n          dispersed.xyz *= getEndEffect(time, period, 1.0);\n          dispersed *= uLowDispersion.x;\n\n          return vec4(dispersed, size);\n        }\n      ").vertex.replace("project_vertex","\n        vec4 mvPosition = vec4(position, 1.0);\n        delta = instanceMatrix[3].xy - uCenter.xy;\n        scatterRatio = clamp(1.1 * length(delta) / (length(uScatteredInfo.xy) / 2.0), 0.0, 1.0);\n\n        vec4 dispersion = computeDispersion();\n        vec4 lowDispersion = computeLowDispersion();\n\n        float scale = clamp01(uMainParams.x * 3.0 - 2.0 * aRand.w);\n        mvPosition.xyz *= dispersion.w * lowDispersion.w * easeInOut3(scale);\n\n        mvPosition = instanceMatrix * mvPosition;\n        mvPosition.xyz += dispersion.xyz + lowDispersion.xyz;\n\n        mvPosition = modelViewMatrix * mvPosition;\n        gl_Position = projectionMatrix * mvPosition;      \n      ").vertex.replace("uv_vertex","\n        #if defined( USE_UV ) || defined( USE_ANISOTROPY )\n          vUv = vec3( uv, 1 ).xy;\n          vUv = aRectUv.xy + aRectUv.zw * vUv;\n        #endif\n        #ifdef USE_MAP\n          vec2 instanceUv = aRectUv.xy + aRectUv.zw * MAP_UV;\n\n          // vec2 uv, float outerAspect, float innerAspect, float sizeMode, vec2 align, vec2 scale\n          float outerAspect = uScatteredInfo.x / uScatteredInfo.y;\n          float innerAspect = uMapInfo.x;\n          float sizeMode = uMapInfo.y;\n          vec2 align = uMapInfo.zw;\n          instanceUv = applyUvSize(instanceUv, outerAspect, innerAspect, sizeMode, align, vec2(1.0));\n          \n          vMapUv = ( mapTransform * vec3( instanceUv, 1 ) ).xy;\n        #endif\n      ").vertex.mainAfterAll("\n        vRand = aRand;\n      ").fragment.top(C.H,F.I).fragment.replace("color_fragment","\n        vec3 normal = texture2D(uNormalMap, vUv * 4.0).rgb;\n        vec3 light = normalize(vec3(0.5, 2.5, 1.0));\n        float colorAlteration = mix(0.333, 1.0, dot(normal, light));\n        float transition = inverseLerp(0.0, 0.2, uMainParams.y - 0.8 * vRand.w);\n        diffuseColor.rgb = mix(vColor * colorAlteration, diffuseColor.rgb, transition);\n      ")}}class A extends r.B69{static createPlane(e){let{row:t,col:n}=e,i=t*n,a=new r.bdM,o=new r.uWO(new Float32Array(4*i),4);a.setAttribute("aRectUv",o);let s=new r.uWO(new Float32Array(4*i),4);a.setAttribute("aRand",s);for(let e=0;e<i;e++)s.setXYZW(e,u.c.random(),u.c.random(),u.c.random(),u.c.random());let l=new E,c=new r.ZLX(a,l,i);return c.name="plane",c}get count(){return this.internal.count}onTick(e){this.internal.plane.material.update(e.deltaTime)}getDistribution(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new w(this,e)}drawDistribution(e){let{position:t,size:n,scatterPadding:i}=e.props,{x:r,y:a}=(0,m.wX)(t),{x:o,y:s}=(0,m.wX)(n);this.internal.lineHelper.rectangle([r,a,o,s]).rectangle([r,a,o+2*i,s+2*i])}distribute(e){let{count:t,plane:n}=this.internal,{aRectUv:i}=n.geometry.attributes;for(let r=0;r<t;r++){let{rect:t,uvRect:a}=e.nodes[r];n.setMatrixAt(r,(0,c.w)({position:t.getCenter(),scale:t.getSize()})),i.setXYZW(r,a.x,a.y,a.width,a.height)}n.material.setScatteredSize(e.root.rect.getSize());let r=e.root.rect;n.material.setScatteredSize(r.getSize()),n.material.uniforms.uCenter.value.copy(r.getCenter())}lerpDistribute(e,t,n){let{count:i,plane:a}=this.internal,{aRectUv:o}=a.geometry.attributes,s=new S.M_,l=new S.M_,d=new S.M_,u=new r.Pq0,h=new r.Pq0;for(let r=0;r<i;r++){let i=e.nodes[r],d=t.nodes[r],f=.3*(1-i.r0*(i.scatterCoeff+.2*d.r0)),p=(0,g.inverseLerp)(f,.7+f,n),m=(0,M.YN)(p);s.lerpRectangles(i.rect,d.rect,m),l.lerpRectangles(i.uvRect,d.uvRect,m),a.setMatrixAt(r,(0,c.w)({position:s.getCenter(u),scale:s.getSize(h),rotationY:(d.r0<.5?0:1)*m*Math.PI*2,rotationZ:.3*Math.sin(p*Math.PI)*(-1+2*i.r0)})),o.setXYZW(r,l.x,l.y,l.width,l.height)}let f=(0,M._5)((0,g.inverseLerp)(.3,.7,n));d.lerpRectangles(e.root.rect,t.root.rect,f),a.material.setScatteredSize(d.getSize()),a.material.uniforms.uCenter.value.copy(d.getCenter()),a.instanceMatrix.needsUpdate=!0,o.needsUpdate=!0}constructor(e={}){super(),this.transition=0;let t={...A.defaultProps,...e},{col:n,row:i}=t,r=A.createPlane(t);(0,d.DN)(r,this);let a=new y.R;(0,d.DN)(a,this);let o=new D;(0,d.DN)(o,this),this.internal={count:i*n,plane:r,lineHelper:a,lightSetup:o},this.props=t,this.distribute(this.getDistribution())}}A.displayName="ScatteredPlane",A.defaultProps={row:20,col:30,imageAspect:1,imageResizeMode:"cover"},A.transition_meta="Range(0, 1)";class T extends r.eaF{constructor(){super(new r.WBB(40,1),new r.V9B({color:"#aeb4e9",side:r.hsX})),this.onBeforeRender=(e,t,n)=>{this.position.copy(n.position)}}}let B={darkBlue:"#002c52",orange:"#ff5c35",white:"#ffffff",lightGrey:"#c9cfd3"};function z(){let e=(0,o.hG)();return e.three.pipeline.basicPasses.outline.enabled=!1,(0,f.dB)("ScatteredDemo",async function*(t,n){(0,d.DN)(new T,t),(0,d.DN)(new r.eaF(new s.k,new l.Y),t);let i=await n.loader.load("/assets/textures/DebugTexture.png");i.colorSpace=r.er$;let o=(0,d.DN)(new A,t);o.internal.plane.material.map=i,o.internal.plane.material.mapAspect=i.image.width/i.image.height;let h=o.getDistribution({seed:4789,position:[-2,0],size:[2,3]}),f=o.getDistribution({seed:3249,position:[2,0],size:[2,4]});o.drawDistribution(h),o.drawDistribution(f),t.userData.transition=0,t.userData.transition_meta="Slider(0, 1, step: 0.01)",t.userData.scale=1,t.userData.scale_meta="Slider(-1, 1, pow: 10, step: .1)",t.userData.links=[o.internal.plane.material.userData];let p=Object.values(B);for(let e=0,t=o.count;e<t;e++)o.internal.plane.setColorAt(e,(0,c._)(u.c.pick(p)));yield n.onTick(()=>{o.lerpDistribute(h,f,t.userData.transition),o.scale.setScalar(t.userData.scale)}),(0,a.it)(e,t),e.sceneSelection.add("Select ScatteredDemo",t)},[]),null}function j(){return(0,f.yk)(function*(e){e.useOrbitControls({position:[-2,0,8],target:[-2,0,0]})},[]),null}function k(e){let{children:t}=e,n=(0,f.yk)();return n.loader.setPath(h.$.assetsPath),(0,i.jsx)(o.zz,{three:n,backgroundColor:"#26163c4f",children:t})}function R(){return(0,i.jsxs)("div",{className:"layer thru",children:[(0,i.jsx)(p.Leak,{}),(0,i.jsx)(f.uB,{children:(0,i.jsxs)(k,{children:[(0,i.jsx)("div",{className:"layer thru px-3 py-2 flex flex-col gap-4",children:(0,i.jsx)("h1",{className:"text-4xl",children:"ScatteredPlane"})}),(0,i.jsx)(j,{}),(0,i.jsx)(z,{})]})})]})}},58087:(e,t,n)=>{"use strict";n.d(t,{F:()=>c});var i=n(49797),r=n(59411),a=n(39571),o=n(97679),s=n(2573),l=n(14192);class c extends a.o{dispose(){this.gtaoNoiseTexture.dispose(),this.pdNoiseTexture.dispose(),this.normalRenderTarget.dispose(),this.gtaoRenderTarget.dispose(),this.pdRenderTarget.dispose(),this.normalMaterial.dispose(),this.pdMaterial.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose(),this.fsQuad.dispose()}get gtaoMap(){return this.pdRenderTarget.texture}setGBuffer(e,t){void 0!==e?(this.depthTexture=e,this.normalTexture=t,this._renderGBuffer=!1):(this.depthTexture=new i.VCu,this.depthTexture.format=i.dcC,this.depthTexture.type=i.V3x,this.normalRenderTarget=new i.nWS(this.width,this.height,{minFilter:i.hxR,magFilter:i.hxR,type:i.ix0,depthTexture:this.depthTexture}),this.normalTexture=this.normalRenderTarget.texture,this._renderGBuffer=!0);let n=+!!this.normalTexture,r=this.depthTexture===this.normalTexture?"w":"x";this.gtaoMaterial.defines.NORMAL_VECTOR_TYPE=n,this.gtaoMaterial.defines.DEPTH_SWIZZLING=r,this.gtaoMaterial.uniforms.tNormal.value=this.normalTexture,this.gtaoMaterial.uniforms.tDepth.value=this.depthTexture,this.pdMaterial.defines.NORMAL_VECTOR_TYPE=n,this.pdMaterial.defines.DEPTH_SWIZZLING=r,this.pdMaterial.uniforms.tNormal.value=this.normalTexture,this.pdMaterial.uniforms.tDepth.value=this.depthTexture,this.depthRenderMaterial.uniforms.tDepth.value=this.normalRenderTarget.depthTexture}setSceneClipBox(e){e?(this.gtaoMaterial.needsUpdate=1!==this.gtaoMaterial.defines.SCENE_CLIP_BOX,this.gtaoMaterial.defines.SCENE_CLIP_BOX=1,this.gtaoMaterial.uniforms.sceneBoxMin.value.copy(e.min),this.gtaoMaterial.uniforms.sceneBoxMax.value.copy(e.max)):(this.gtaoMaterial.needsUpdate=0===this.gtaoMaterial.defines.SCENE_CLIP_BOX,this.gtaoMaterial.defines.SCENE_CLIP_BOX=0)}updateGtaoMaterial(e){void 0!==e.radius&&(this.gtaoMaterial.uniforms.radius.value=e.radius),void 0!==e.distanceExponent&&(this.gtaoMaterial.uniforms.distanceExponent.value=e.distanceExponent),void 0!==e.thickness&&(this.gtaoMaterial.uniforms.thickness.value=e.thickness),void 0!==e.distanceFallOff&&(this.gtaoMaterial.uniforms.distanceFallOff.value=e.distanceFallOff,this.gtaoMaterial.needsUpdate=!0),void 0!==e.scale&&(this.gtaoMaterial.uniforms.scale.value=e.scale),void 0!==e.samples&&e.samples!==this.gtaoMaterial.defines.SAMPLES&&(this.gtaoMaterial.defines.SAMPLES=e.samples,this.gtaoMaterial.needsUpdate=!0),void 0!==e.screenSpaceRadius&&+!!e.screenSpaceRadius!==this.gtaoMaterial.defines.SCREEN_SPACE_RADIUS&&(this.gtaoMaterial.defines.SCREEN_SPACE_RADIUS=+!!e.screenSpaceRadius,this.gtaoMaterial.needsUpdate=!0)}updatePdMaterial(e){let t=!1;void 0!==e.lumaPhi&&(this.pdMaterial.uniforms.lumaPhi.value=e.lumaPhi),void 0!==e.depthPhi&&(this.pdMaterial.uniforms.depthPhi.value=e.depthPhi),void 0!==e.normalPhi&&(this.pdMaterial.uniforms.normalPhi.value=e.normalPhi),void 0!==e.radius&&e.radius!==this.radius&&(this.pdMaterial.uniforms.radius.value=e.radius),void 0!==e.radiusExponent&&e.radiusExponent!==this.pdRadiusExponent&&(this.pdRadiusExponent=e.radiusExponent,t=!0),void 0!==e.rings&&e.rings!==this.pdRings&&(this.pdRings=e.rings,t=!0),void 0!==e.samples&&e.samples!==this.pdSamples&&(this.pdSamples=e.samples,t=!0),t&&(this.pdMaterial.defines.SAMPLES=this.pdSamples,this.pdMaterial.defines.SAMPLE_VECTORS=(0,l.A)(this.pdSamples,this.pdRings,this.pdRadiusExponent),this.pdMaterial.needsUpdate=!0)}render(e,t,n){switch(this._renderGBuffer&&(this.overrideVisibility(),this.renderOverride(e,this.normalMaterial,this.normalRenderTarget,7829503,1),this.restoreVisibility()),this.gtaoMaterial.uniforms.cameraNear.value=this.camera.near,this.gtaoMaterial.uniforms.cameraFar.value=this.camera.far,this.gtaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.gtaoMaterial.uniforms.cameraProjectionMatrixInverse.value.copy(this.camera.projectionMatrixInverse),this.gtaoMaterial.uniforms.cameraWorldMatrix.value.copy(this.camera.matrixWorld),this.renderPass(e,this.gtaoMaterial,this.gtaoRenderTarget,0xffffff,1),this.pdMaterial.uniforms.cameraProjectionMatrixInverse.value.copy(this.camera.projectionMatrixInverse),this.renderPass(e,this.pdMaterial,this.pdRenderTarget,0xffffff,1),this.output){case c.OUTPUT.Off:break;case c.OUTPUT.Diffuse:this.copyMaterial.uniforms.tDiffuse.value=n.texture,this.copyMaterial.blending=i.XIg,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:t);break;case c.OUTPUT.AO:this.copyMaterial.uniforms.tDiffuse.value=this.gtaoRenderTarget.texture,this.copyMaterial.blending=i.XIg,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:t);break;case c.OUTPUT.Denoise:this.copyMaterial.uniforms.tDiffuse.value=this.pdRenderTarget.texture,this.copyMaterial.blending=i.XIg,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:t);break;case c.OUTPUT.Depth:this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.renderPass(e,this.depthRenderMaterial,this.renderToScreen?null:t);break;case c.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=i.XIg,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:t);break;case c.OUTPUT.Default:this.copyMaterial.uniforms.tDiffuse.value=n.texture,this.copyMaterial.blending=i.XIg,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:t),this.blendMaterial.uniforms.intensity.value=this.blendIntensity,this.blendMaterial.uniforms.tDiffuse.value=this.pdRenderTarget.texture,this.renderPass(e,this.blendMaterial,this.renderToScreen?null:t);break;default:console.warn("THREE.GTAOPass: Unknown output type.")}}renderPass(e,t,n,i,r){e.getClearColor(this.originalClearColor);let a=e.getClearAlpha(),o=e.autoClear;e.setRenderTarget(n),e.autoClear=!1,null!=i&&(e.setClearColor(i),e.setClearAlpha(r||0),e.clear()),this.fsQuad.material=t,this.fsQuad.render(e),e.autoClear=o,e.setClearColor(this.originalClearColor),e.setClearAlpha(a)}renderOverride(e,t,n,i,r){e.getClearColor(this.originalClearColor);let a=e.getClearAlpha(),o=e.autoClear;e.setRenderTarget(n),e.autoClear=!1,i=t.clearColor||i,r=t.clearAlpha||r,null!=i&&(e.setClearColor(i),e.setClearAlpha(r||0),e.clear()),this.scene.overrideMaterial=t;let s=this.camera.layers.mask;this.camera.layers.set(0),e.render(this.scene,this.camera),this.camera.layers.mask=s,this.scene.overrideMaterial=null,e.autoClear=o,e.setClearColor(this.originalClearColor),e.setClearAlpha(a)}setSize(e,t){this.width=e,this.height=t,this.gtaoRenderTarget.setSize(e,t),this.normalRenderTarget.setSize(e,t),this.pdRenderTarget.setSize(e,t),this.gtaoMaterial.uniforms.resolution.value.set(e,t),this.gtaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.gtaoMaterial.uniforms.cameraProjectionMatrixInverse.value.copy(this.camera.projectionMatrixInverse),this.pdMaterial.uniforms.resolution.value.set(e,t),this.pdMaterial.uniforms.cameraProjectionMatrixInverse.value.copy(this.camera.projectionMatrixInverse)}overrideVisibility(){let e=this.scene,t=this._visibilityCache;e.traverse(function(e){t.set(e,e.visible),(e.isPoints||e.isLine)&&(e.visible=!1)})}restoreVisibility(){let e=this.scene,t=this._visibilityCache;e.traverse(function(e){let n=t.get(e);e.visible=n}),t.clear()}generateNoise(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:64,t=new r.h,n=new Uint8Array(e*e*4);for(let i=0;i<e;i++)for(let r=0;r<e;r++){let a=i,o=r;n[(i*e+r)*4]=(.5*t.noise(a,o)+.5)*255,n[(i*e+r)*4+1]=(.5*t.noise(a+e,o)+.5)*255,n[(i*e+r)*4+2]=(.5*t.noise(a,o+e)+.5)*255,n[(i*e+r)*4+3]=(.5*t.noise(a+e,o+e)+.5)*255}let a=new i.GYF(n,e,e,i.GWd,i.OUM);return a.wrapS=i.GJx,a.wrapT=i.GJx,a.needsUpdate=!0,a}constructor(e,t,n,r,c,d,u){super(),this.width=void 0!==n?n:512,this.height=void 0!==r?r:512,this.clear=!0,this.camera=t,this.scene=e,this.output=0,this._renderGBuffer=!0,this._visibilityCache=new Map,this.blendIntensity=1,this.pdRings=2,this.pdRadiusExponent=2,this.pdSamples=16,this.gtaoNoiseTexture=(0,s.QB)(),this.pdNoiseTexture=this.generateNoise(),this.gtaoRenderTarget=new i.nWS(this.width,this.height,{type:i.ix0}),this.pdRenderTarget=this.gtaoRenderTarget.clone(),this.gtaoMaterial=new i.BKk({defines:Object.assign({},s.dB.defines),uniforms:i.LlO.clone(s.dB.uniforms),vertexShader:s.dB.vertexShader,fragmentShader:s.dB.fragmentShader,blending:i.XIg,depthTest:!1,depthWrite:!1}),this.gtaoMaterial.defines.PERSPECTIVE_CAMERA=+!!this.camera.isPerspectiveCamera,this.gtaoMaterial.uniforms.tNoise.value=this.gtaoNoiseTexture,this.gtaoMaterial.uniforms.resolution.value.set(this.width,this.height),this.gtaoMaterial.uniforms.cameraNear.value=this.camera.near,this.gtaoMaterial.uniforms.cameraFar.value=this.camera.far,this.normalMaterial=new i.qBx,this.normalMaterial.blending=i.XIg,this.pdMaterial=new i.BKk({defines:Object.assign({},l.I.defines),uniforms:i.LlO.clone(l.I.uniforms),vertexShader:l.I.vertexShader,fragmentShader:l.I.fragmentShader,depthTest:!1,depthWrite:!1}),this.pdMaterial.uniforms.tDiffuse.value=this.gtaoRenderTarget.texture,this.pdMaterial.uniforms.tNoise.value=this.pdNoiseTexture,this.pdMaterial.uniforms.resolution.value.set(this.width,this.height),this.pdMaterial.uniforms.lumaPhi.value=10,this.pdMaterial.uniforms.depthPhi.value=2,this.pdMaterial.uniforms.normalPhi.value=3,this.pdMaterial.uniforms.radius.value=8,this.depthRenderMaterial=new i.BKk({defines:Object.assign({},s.EC.defines),uniforms:i.LlO.clone(s.EC.uniforms),vertexShader:s.EC.vertexShader,fragmentShader:s.EC.fragmentShader,blending:i.XIg}),this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new i.BKk({uniforms:i.LlO.clone(o.Z.uniforms),vertexShader:o.Z.vertexShader,fragmentShader:o.Z.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:i.wn6,blendDst:i.ojh,blendEquation:i.gO9,blendSrcAlpha:i.hdd,blendDstAlpha:i.ojh,blendEquationAlpha:i.gO9}),this.blendMaterial=new i.BKk({uniforms:i.LlO.clone(s.eQ.uniforms),vertexShader:s.eQ.vertexShader,fragmentShader:s.eQ.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blending:i.bCz,blendSrc:i.wn6,blendDst:i.ojh,blendEquation:i.gO9,blendSrcAlpha:i.hdd,blendDstAlpha:i.ojh,blendEquationAlpha:i.gO9}),this.fsQuad=new a.F(null),this.originalClearColor=new i.Q1f,this.setGBuffer(c?c.depthTexture:void 0,c?c.normalTexture:void 0),void 0!==d&&this.updateGtaoMaterial(d),void 0!==u&&this.updatePdMaterial(u)}}c.OUTPUT={Off:-1,Default:0,Diffuse:1,Depth:2,Normal:3,AO:4,Denoise:5}},61277:(e,t,n)=>{"use strict";n.d(t,{Main:()=>N});var i=n(70691),r=n(32137),a=n(63357),o=n(49797),s=n(30158),l=n(7147),c=n(61249),d=n(22899),u=n(79285),h=n(17099),f=n(35375),p=n(9954);let m=new(n(5832)).Y;function v(e){return new Promise(t=>{m.load(e,e=>{t(e)})})}let g=new p.H;var x=n(55227);let w={white:new o.Q1f("#ffffff"),grey10:new o.Q1f("#f0f0f0"),grey20:new o.Q1f("#e0e0e0"),notSoWhite:new o.Q1f("#f8f8e8"),yellow:new o.Q1f("#fff700"),black:new o.Q1f("#110111"),red:new o.Q1f("#dd1a41"),brightSkin:new o.Q1f("#ebd8c6"),petrol:new o.Q1f("#005e6b"),brightGreen:new o.Q1f("#22c891"),darkGreen:new o.Q1f("#002f1c"),sand:new o.Q1f("#e6db9f")};class y extends o.eaF{static createMaterial(e){let{color:t,shaded:n,emissiveIntensity:i,side:r}={...y.defaultProps,...e};return n?new o.uSd({color:t,emissiveIntensity:i,emissive:i>0?t:void 0,side:r}):new o.V9B({color:t})}}y.defaultProps={color:w.black,radius:1.3,align:.5,thickness:.3,innerRadiusRatio:null,shaded:!0,emissiveIntensity:.333};class b extends y{constructor(e){let{radius:t,thickness:n,align:i,innerRadiusRatio:r,color:a,shaded:s,...l}={...y.defaultProps,...e},d=t-n*i,u=t+n*(1-i);r&&(d=t*r,u=t),super(new o.rKP(d,u,128),y.createMaterial({...e,side:o.$EB})),(0,c.N)(this,l)}}class P extends o.eaF{constructor(e){let{radius:t,thickness:n,align:i,innerRadiusRatio:r,color:a,shaded:s,emissiveIntensity:l,...d}={...y.defaultProps,...e},u=t-n*i,h=t+n*(1-i);r&&(u=t*r,h=t),super(new o.O3Y((u+h)/2,(h-u)/2,128,512),y.createMaterial({...e,side:o.hB5})),(0,c.N)(this,d)}}class F extends b{constructor(e){super(e),this.material.onBeforeCompile=e=>l.bI.with(e).defines({USE_UV:""}).fragment.top(x.M).fragment.after("map_fragment","\n      vec2 p = vUv - 0.5;\n      float alpha = atan(p.y, p.x) / 6.2831853;\n      alpha = 1.0 - mod(alpha + 0.0, 1.0);\n      Vec3Ramp r = ramp(alpha,\n        ".concat((0,l.eR)(w.black),",\n        ").concat((0,l.eR)(w.white),",\n        ").concat((0,l.eR)(w.yellow),");\n      diffuseColor.rgb = mix(r.a, r.b, easeInOut4(r.t));\n    "))}}class C extends o.N1A{constructor(e,t){let n=new o.LoY;n.setAttribute("position",new o.qtW([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),n.computeBoundingSphere(),super(n,new o.mrM({fog:!1})),this.light=e,this.color=t,this.type="RectAreaLightHelper";let i=new o.LoY;i.setAttribute("position",new o.qtW([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),i.computeBoundingSphere(),this.add(new o.eaF(i,new o.V9B({side:o.hsX,fog:!1})))}updateMatrixWorld(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);let e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this.children[0].matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}class M extends o.YJl{constructor({globalIntensity:e=1,debug:t=!1}={}){super(),this.name="lights";let n=new o.dth("#dbebf0","#645d61",e);this.add(n);let i=new o.ure("#e8e6d3",1.3*e);i.position.set(10,10,10),i.width=40,i.height=40,i.lookAt(0,0,0),this.add(i),t&&this.add(new C(i));let r=new o.$p8("#f2f0dd",.8*e);this.add(r)}}function S(e){let{precision:t=3}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=0,i=0,r=0;function a(){return"vec3(".concat(n.toFixed(t),", ").concat(i.toFixed(t),", ").concat(r.toFixed(t),")")}switch(typeof e){case"number":return n=(e>>16&255)/255,i=(e>>8&255)/255,r=(255&e)/255,a();case"string":if(e.startsWith("#")){if(4===e.length)return n=parseInt(e[1]+e[1],16)/255,i=parseInt(e[2]+e[2],16)/255,r=parseInt(e[3]+e[3],16)/255,a();return S(parseInt(e.slice(1),16),{precision:t})}throw Error("Invalid string: ".concat(e));case"object":if(Array.isArray(e))return[n,i,r]=e,a();if("r"in e)return n=e.r,i=e.g,r=e.b,a();if("x"in e)return n=e.x,i=e.y,r=e.z,a();throw Error("Invalid object: ".concat(e))}return"vec3(1.0, 0.0, 1.0)"}var D=n(14203);let E="\n  ".concat(s.ShaderChunk.cube_uv_reflection_fragment,"\n  ").concat(D.O,"\n\n  varying vec3 vPosition;\n  varying vec3 vWorldNormal;\n\n  struct Plane {\n    vec3 origin;\n    vec3 normal;\n  };\n\n  float signedDistanceToPlane(Plane plane, vec3 p) {\n    return dot(plane.normal, p - plane.origin);\n  }\n\n  vec3 checker3(vec3 position, float scale, float edgeWidth, vec3 color1, vec3 color2) {\n    // Scale the position to control the size of the checker cubes\n    vec3 scaledPos = position / scale;\n\n    // Get the integer part (checker grid location)\n    vec3 checkerPos = floor(scaledPos);\n\n    // Get the fractional part (inside each cube)\n    vec3 fractPos = fract(scaledPos);\n\n    // Calculate the checkerboard pattern (even/odd cubes)\n    float checkerSum = mod(checkerPos.x + checkerPos.y + checkerPos.z, 2.0);\n\n    // Smooth transition using smoothstep on the fractional position\n    float edgeX = smoothstep(0.0, edgeWidth, fractPos.x);\n    float edgeY = smoothstep(0.0, edgeWidth, fractPos.y);\n    float edgeZ = smoothstep(0.0, edgeWidth, fractPos.z);\n\n    // Combine the edges to create a smooth transition\n    float blend = edgeX * edgeY * edgeZ;\n    blend = smoothstep(0.0, edgeWidth, min(min(fractPos.x, fractPos.y), fractPos.z));\n    \n    // Interpolate between black and white with the smoothstep value\n    vec3 baseColor = checkerSum == 0.0 ? color1 : color2;\n    vec3 oppositeColor = checkerSum == 0.0 ? color2 : color1;\n\n    // Use the smooth transition to blend between colors\n    return mix(baseColor, oppositeColor, blend);\n  }\n\n  float sphereGrid(vec3 position, float scale, float edgeWidth) {\n    // Scale the position to control the size of the checker cubes\n    vec3 scaledPos = position / scale;\n\n    // Get the integer part (checker grid location)\n    vec3 checkerPos = floor(scaledPos);\n\n    // Get the fractional part (inside each cube)\n    vec3 fractPos = fract(scaledPos);\n\n    vec3 p = fractPos - 0.5;\n    float alpha = 1.0 - length(p) * 2.0;\n\n    return smoothstep(0.0, edgeWidth, alpha - 0.1);    \n  }\n\n  void main() {\n    vec3 p = vWorldNormal * 0.33;\n    float n1 = snoise(p * 6.0 * 0.2 + 0.2);\n    float n2 = snoise(p * 20.0 + 10.1);\n    float n3 = snoise(p * 40.0 + 10.1);\n    float n4 = snoise(p * 1400.0 + 13.1);\n    float n = n1 * 0.5;\n    n += pow(fract((n1 + n2 * 0.015 + n3 * 0.01 + n4 * 0.005) * 85.0), 4.0) * 0.5;\n    n += pow(fract((n1 + n2 * 0.015) * 85.0), 4.0) * 0.25;\n    n += n4 * 0.2;\n    n += 0.8;\n    n = pow(n, 0.3);\n    float alpha = n;\n\n    gl_FragColor.rgb = mix(").concat(S(w.white),", ").concat(S(w.brightSkin),", alpha);\n    gl_FragColor.a = 1.0;\n\n    // float x = sphereGrid(vPosition, 1.0, 0.01);\n    // gl_FragColor.rgb = mix(").concat(S(w.black),", ").concat(S(w.brightSkin),", x);\n    // gl_FragColor.rgb = checker3(vPosition, 1.0, 0.1, ").concat(S(w.black),", ").concat(S(w.brightSkin),");\n  }\n");class A extends o.eaF{constructor({debug:e=!1}={}){super(new o.WBB(5.5,12),new o.BKk({depthWrite:!1,side:o.hsX,vertexShader:"\n  varying vec3 vWorldNormal;\n  varying vec3 vPosition;\n\n  vec3 rotate(mat4 m, vec3 v) {\n    return vec3(\n      dot(v, vec3(m[0][0], m[1][0], m[2][0])),  // X component\n      dot(v, vec3(m[0][1], m[1][1], m[2][1])),  // Y component\n      dot(v, vec3(m[0][2], m[1][2], m[2][2]))   // Z component\n    );\n  }\n\n  void main() {\n    vPosition = position;\n    vWorldNormal = normalize(rotate(modelMatrix, position));\n\n    // gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    // Ignore the position, we only need the normal:\n    gl_Position = projectionMatrix * vec4(rotate(modelViewMatrix, position), 1.0);\n  }\n",fragmentShader:E,uniforms:{}})),e&&(this.material=new o.V9B({depthWrite:!1,color:"white",wireframe:!0})),this.onBeforeRender=(e,t,n,i,r,a)=>{this.position.copy(n.position)},this.renderOrder=-1,this.frustumCulled=!1,this.name="a-sky"}}var T=n(8144);class B extends o.eaF{constructor(e){let{radius:t,...n}={...B.defaultProps,...e},i=new o.WBB(t,18),r=new o.uSd({});r.onBeforeCompile=e=>l.bI.with(e).defines({USE_UV:""}).fragment.top(x.M).fragment.after("map_fragment","\n        vec2 p = vUv - 0.5;\n        float alpha = easeInOut(vUv.y, 1.6, 0.5);\n        Vec3Ramp r = ramp(alpha, ".concat((0,l.eR)(w.black),", ").concat((0,l.eR)(w.white),", ").concat((0,l.eR)(w.yellow),");\n        diffuseColor.rgb = mix(r.a, r.b, easeInOut3(r.t));\n      ")),super(i,r),(0,c.N)(this,n)}}B.defaultProps={radius:1};class z{set(e){this.props={...this.props,...e},this.props.center=this.props.center.clone(),this.props.normal=this.props.normal.clone().normalize(),this.props.binormal=this.props.binormal.clone().normalize()}update(e){let{radius:t,turnVelocity:n,turn:i,center:r,normal:a,binormal:o}=this.props,s=i+n*e;this.props.turn=s;let l=Math.cos(s*Math.PI*2),c=Math.sin(s*Math.PI*2);this.target.position.copy(r).addScaledVector(a,t*l).addScaledVector(o,t*c)}constructor(e,t){this.target=e,this.set({...z.defaultProps,...t})}}z.defaultProps={center:new o.Pq0,normal:new o.Pq0(1,0,0),binormal:new o.Pq0(0,1,0),radius:1,turnVelocity:1,turn:0};class j extends o.eaF{get satellite(){var e;return null!=(e=this._satellite)?e:this._satellite=new z(this)}constructor(e){let{radius:t,singleColor:n,emmissiveIntensity:i,lerpIn:r,lerpOut:a,...s}={...j.defaultProps,...e},{colorTop:u=null!=n?n:j.defaultProps.colorTop,colorBottom:h=null!=n?n:j.defaultProps.colorBottom}={...e},f=new o.WBB(t,12),p=new o.uSd({color:u,emissive:h});p.onBeforeCompile=e=>{l.bI.with(e).defines({USE_UV:""}).uniforms({uLerpIn:{value:r},uLerpOut:{value:a},uColorTop:{value:new o.Q1f(u)},uColorBottom:{value:new o.Q1f(h)}}).fragment.top(d.I,T.H).fragment.mainBeforeAll("\n          float alpha = inverseLerp(uLerpIn, uLerpOut, vUv.y);\n          vec3 sphereColor = mix(uColorBottom, uColorTop, easeInOut3(alpha));\n        ").fragment.after("map_fragment","\n          diffuseColor.rgb = sphereColor;\n        ").fragment.after("emissivemap_fragment","\n          totalEmissiveRadiance.rgb = sphereColor * ".concat(i.toFixed(2),";\n        "))},super(f,p),this._satellite=null,(0,c.N)(this,s)}}j.defaultProps={radius:.225,singleColor:null,colorTop:w.white,colorBottom:w.yellow,emmissiveIntensity:.25,lerpIn:-.2,lerpOut:1.2};class k extends o.eaF{constructor(e){let t=new o.WBB(.4,12),n=new o.uSd({});n.onBeforeCompile=e=>l.bI.with(e).varying({vWorldPosition:"vec3",vNormalWorld:"vec3",vViewDir:"vec3"}).vertex.mainAfterAll("\n        vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n        vNormalWorld = normalize(mat3(modelMatrix) * normal);\n        vViewDir = normalize(cameraPosition - vWorldPosition);\n      ").fragment.top(d.I,"\n\nfloat contrast(float mValue, float mScale, float mMidPoint) {\n	// Why clamp? If necessary, it has to be done outside of this function.\n	// return clamp((mValue - mMidPoint) * mScale + mMidPoint, 0.0, 1.0);\n	return (mValue - mMidPoint) * mScale + mMidPoint;\n}\n\nfloat contrast(float mValue, float mScale) {\n	return contrast(mValue, mScale, 0.5);\n}\n\nvec3 contrast(vec3 mValue, float mScale, float mMidPoint) {\n	return vec3(contrast(mValue.r, mScale, mMidPoint), contrast(mValue.g, mScale, mMidPoint), contrast(mValue.b, mScale, mMidPoint));\n}\n\nvec3 contrast(vec3 mValue, float mScale) {\n	return contrast(mValue, mScale, 0.5);\n}\n\nfloat greyscaleFloat(vec3 color) {\n	return dot(color, vec3(0.299, 0.587, 0.114));\n}\n\nvec3 greyscale(vec3 color) {\n	return vec3(greyscaleFloat(color));\n}\n\nvec3 greyscale(vec3 color, float alpha) {\n	return mix(color, greyscale(color), alpha);\n}\n\n").fragment.after("map_fragment","\n        float fresnel = dot(vNormalWorld, vViewDir);\n        vec3 inner = ".concat((0,l.eR)(w.white),";\n        vec3 outer = ").concat((0,l.eR)(w.black),";\n        float alpha = easeInOut(1.0 - pow(fresnel, 1.5), 2.0, 0.0);\n        diffuseColor.rgb = mix(inner, outer, alpha);\n      ")).fragment.mainAfterAll("\n        // Final tuning\n        gl_FragColor.rgb = mix(contrast(greyscale(gl_FragColor.rgb), 1.5), diffuseColor.rgb, alpha);\n      "),super(t,n),(0,c.N)(this,e)}}class R extends o.eaF{constructor(e){let{color:t,thickness:n,length:i,shaded:r,...a}={...R.defaultProps,...e};super(new o.Ho_(n/2,n/2,i,12,1).rotateZ(.5*Math.PI),r?new o.uSd({color:t}):new o.V9B({color:t})),(0,c.N)(this,a)}}function O(e,t){return t.add(e),e}function*I(e,t){let n=yield*function*(e){let{ticker:t,scene:n}=e;t.set({activeDuration:f.$.development?3:180}),v("https://threejs.org/examples/textures/equirectangular/royal_esplanade_1k.hdr").then(t=>{new s.PMREMGenerator(e.renderer).fromEquirectangular(t).texture});let i=new o.YJl;return n.add(i),yield()=>{i.removeFromParent()},i}(e);if(1===t.renderCount){let{camera:t}=e;t.fov=e.aspect>1?25:180*(2*Math.atan(Math.tan(25*Math.PI/180/2)/e.aspect))/Math.PI,t.far=1e3,t.updateProjectionMatrix(),t.position.set(0,0,10)}n.add(new A),n.add(new M);let i=O(new B,n);n.add(new F({z:-1,radius:1.4,innerRadiusRatio:.805})),n.add(new P({z:-1,radius:.75,thickness:.01,color:w.yellow,emissiveIntensity:1})),n.add(new P({z:-1,radius:.8,thickness:.01,color:w.notSoWhite})),h.c.seed(6789402);let r=h.c.createPicker([[1,4],[2,2],[4,1]]);for(let{i:t}of function*(e){let t=0,n={get i(){return t},get t(){return t/8},get count(){return 8}};for(;t<e;t++)yield n}(8)){let i=h.c.pick(w),a=h.c.pick(w),s=new j({z:-1,radius:.1*r(),colorTop:i,colorBottom:a});s.rotation.set(h.c.between(2*Math.PI),h.c.between(2*Math.PI),h.c.between(2*Math.PI)),n.add(s),s.satellite.set({radius:0===t?.875:h.c.between(.25,.75)*(0,u.lerp)(1,1.5,t),center:new o.Pq0(0,0,-1-.4*t),turnVelocity:h.c.between(.05,.25)}),yield e.ticker.onTick(e=>{s.satellite.update(e.deltaTime)})}let a=new o.YJl;a.rotation.z=-.25*Math.PI,n.add(a),a.add(new j({x:-1.5,z:.5,singleColor:w.yellow})),a.add(new P({x:-1.81,radius:.1,thickness:.01,color:w.notSoWhite}));let l=O(new P({x:-2.315,radius:.2,thickness:.01,color:w.notSoWhite}),a);O(new R({x:-.2,thickness:.01,length:.4,shaded:!0,color:w.notSoWhite}),l),a.add(new j({x:1.7,z:.5,lerpIn:0,lerpOut:1})),a.add(new j({x:1.4,radius:.1,singleColor:w.black}));let d=O(new k({x:2.3}),a);O(new P({radius:.43,thickness:.015,color:w.black}),d),a.add(new R({x:1.5,thickness:.015,color:w.black}));let p=new o.YJl;p.rotation.z=.25*Math.PI,n.add(p),p.add(new R({x:-1.6,thickness:.01,length:.35,shaded:!0,color:w.notSoWhite})),p.add(new R({x:1.6,thickness:.01,length:.35,shaded:!0,color:w.notSoWhite}));let m=new o.YJl;m.rotation.y=.5*Math.PI,n.add(m),m.add(new R({x:-1.2,thickness:.01,length:.35,shaded:!0,color:w.notSoWhite})),m.add(new R({x:1.2,thickness:.01,length:.35,shaded:!0,color:w.notSoWhite})),(function(e){let t=e.split(".").pop();switch(t){case"hdr":return v(e);case"exr":return new Promise(t=>{g.load(e,e=>{t(e)})});default:return Promise.reject("Unsupported texture format: ".concat(t))}})("https://threejs.org/examples/textures/piz_compressed.exr").then(e=>{e.mapping=o.wfO,d.material.envMap=e,d.material.envMapIntensity=.25,d.material.envMapRotation.set(-.1*Math.PI,Math.PI,0),d.material.roughness=.3,d.material.metalness=.5,d.material.needsUpdate=!0,i.material.envMap=e,i.material.roughness=.2,i.material.envMapIntensity=.5,i.material.envMapRotation.set(-.1*Math.PI,Math.PI,0),i.material.needsUpdate=!0});let x=O(new o.YJl,n);x.rotation.z=.25*Math.PI;class y extends o.YJl{constructor(e){super();{let e=new o.Ho_(15,15,5,6,1,!0).rotateY(Math.PI/6),t=new o.uSd({color:new o.Q1f("white").lerp(w.black,.995),side:o.hsX,flatShading:!0});O(new o.eaF(e,t),this)}{let e=new o.Ho_(15,15,5,6,60,!0).rotateY(Math.PI/6),t=new o.uSd({color:w.black,wireframe:!0,flatShading:!0,side:o.hsX});O(new o.eaF(e,t),this)}(0,c.N)(this,e)}}O(new y({y:7.8}),x),O(new y({y:-7.8}),x)}function N(){return(0,i.jsx)("div",{className:"absolute-through",children:(0,i.jsx)(r.Q,{className:"bg-[#ddd]",children:(0,i.jsx)(a.yb,{children:(0,i.jsx)(a.YJ,{fn:I})})})})}R.defaultProps={color:w.black,thickness:.01,shaded:!1,length:1}},67725:e=>{e.exports={Client:"client_Client__zoy80"}},68571:(e,t,n)=>{"use strict";n.d(t,{reactThreeContext:()=>i});let i=(0,n(67203).createContext)(null)},71895:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});let i="\n  // #F0F8FF\n  #define aliceblue vec3(240.0 / 255.0, 248.0 / 255.0, 255.0 / 255.0) \n  // #FAEBD7\n  #define antiquewhite vec3(250.0 / 255.0, 235.0 / 255.0, 215.0 / 255.0) \n  // #00FFFF\n  #define aqua vec3(0.0 / 255.0, 255.0 / 255.0, 255.0 / 255.0) \n  // #7FFFD4\n  #define aquamarine vec3(127.0 / 255.0, 255.0 / 255.0, 212.0 / 255.0) \n  // #F0FFFF\n  #define azure vec3(240.0 / 255.0, 255.0 / 255.0, 255.0 / 255.0) \n  // #F5F5DC\n  #define beige vec3(245.0 / 255.0, 245.0 / 255.0, 220.0 / 255.0) \n  // #FFE4C4\n  #define bisque vec3(255.0 / 255.0, 228.0 / 255.0, 196.0 / 255.0) \n  // #000000\n  #define black vec3(0.0 / 255.0, 0.0 / 255.0, 0.0 / 255.0) \n  // #FFEBCD\n  #define blanchedalmond vec3(255.0 / 255.0, 235.0 / 255.0, 205.0 / 255.0) \n  // #0000FF\n  #define blue vec3(0.0 / 255.0, 0.0 / 255.0, 255.0 / 255.0) \n  // #8A2BE2\n  #define blueviolet vec3(138.0 / 255.0, 43.0 / 255.0, 226.0 / 255.0) \n  // #A52A2A\n  #define brown vec3(165.0 / 255.0, 42.0 / 255.0, 42.0 / 255.0) \n  // #DEB887\n  #define burlywood vec3(222.0 / 255.0, 184.0 / 255.0, 135.0 / 255.0) \n  // #5F9EA0\n  #define cadetblue vec3(95.0 / 255.0, 158.0 / 255.0, 160.0 / 255.0) \n  // #7FFF00\n  #define chartreuse vec3(127.0 / 255.0, 255.0 / 255.0, 0.0 / 255.0) \n  // #D2691E\n  #define chocolate vec3(210.0 / 255.0, 105.0 / 255.0, 30.0 / 255.0) \n  // #FF7F50\n  #define coral vec3(255.0 / 255.0, 127.0 / 255.0, 80.0 / 255.0) \n  // #6495ED\n  #define cornflowerblue vec3(100.0 / 255.0, 149.0 / 255.0, 237.0 / 255.0) \n  // #FFF8DC\n  #define cornsilk vec3(255.0 / 255.0, 248.0 / 255.0, 220.0 / 255.0) \n  // #DC143C\n  #define crimson vec3(220.0 / 255.0, 20.0 / 255.0, 60.0 / 255.0) \n  // #00FFFF\n  #define cyan vec3(0.0 / 255.0, 255.0 / 255.0, 255.0 / 255.0) \n  // #00008B\n  #define darkblue vec3(0.0 / 255.0, 0.0 / 255.0, 139.0 / 255.0) \n  // #008B8B\n  #define darkcyan vec3(0.0 / 255.0, 139.0 / 255.0, 139.0 / 255.0) \n  // #B8860B\n  #define darkgoldenrod vec3(184.0 / 255.0, 134.0 / 255.0, 11.0 / 255.0) \n  // #A9A9A9\n  #define darkgray vec3(169.0 / 255.0, 169.0 / 255.0, 169.0 / 255.0) \n  // #A9A9A9\n  #define darkgrey vec3(169.0 / 255.0, 169.0 / 255.0, 169.0 / 255.0) \n  // #006400\n  #define darkgreen vec3(0.0 / 255.0, 100.0 / 255.0, 0.0 / 255.0) \n  // #BDB76B\n  #define darkkhaki vec3(189.0 / 255.0, 183.0 / 255.0, 107.0 / 255.0) \n  // #8B008B\n  #define darkmagenta vec3(139.0 / 255.0, 0.0 / 255.0, 139.0 / 255.0) \n  // #556B2F\n  #define darkolivegreen vec3(85.0 / 255.0, 107.0 / 255.0, 47.0 / 255.0) \n  // #FF8C00\n  #define darkorange vec3(255.0 / 255.0, 140.0 / 255.0, 0.0 / 255.0) \n  // #9932CC\n  #define darkorchid vec3(153.0 / 255.0, 50.0 / 255.0, 204.0 / 255.0) \n  // #8B0000\n  #define darkred vec3(139.0 / 255.0, 0.0 / 255.0, 0.0 / 255.0) \n  // #E9967A\n  #define darksalmon vec3(233.0 / 255.0, 150.0 / 255.0, 122.0 / 255.0) \n  // #8FBC8F\n  #define darkseagreen vec3(143.0 / 255.0, 188.0 / 255.0, 143.0 / 255.0) \n  // #483D8B\n  #define darkslateblue vec3(72.0 / 255.0, 61.0 / 255.0, 139.0 / 255.0) \n  // #2F4F4F\n  #define darkslategray vec3(47.0 / 255.0, 79.0 / 255.0, 79.0 / 255.0) \n  // #2F4F4F\n  #define darkslategrey vec3(47.0 / 255.0, 79.0 / 255.0, 79.0 / 255.0) \n  // #00CED1\n  #define darkturquoise vec3(0.0 / 255.0, 206.0 / 255.0, 209.0 / 255.0) \n  // #9400D3\n  #define darkviolet vec3(148.0 / 255.0, 0.0 / 255.0, 211.0 / 255.0) \n  // #FF1493\n  #define deeppink vec3(255.0 / 255.0, 20.0 / 255.0, 147.0 / 255.0) \n  // #00BFFF\n  #define deepskyblue vec3(0.0 / 255.0, 191.0 / 255.0, 255.0 / 255.0) \n  // #696969\n  #define dimgray vec3(105.0 / 255.0, 105.0 / 255.0, 105.0 / 255.0) \n  // #696969\n  #define dimgrey vec3(105.0 / 255.0, 105.0 / 255.0, 105.0 / 255.0) \n  // #1E90FF\n  #define dodgerblue vec3(30.0 / 255.0, 144.0 / 255.0, 255.0 / 255.0) \n  // #B22222\n  #define firebrick vec3(178.0 / 255.0, 34.0 / 255.0, 34.0 / 255.0) \n  // #FFFAF0\n  #define floralwhite vec3(255.0 / 255.0, 250.0 / 255.0, 240.0 / 255.0) \n  // #228B22\n  #define forestgreen vec3(34.0 / 255.0, 139.0 / 255.0, 34.0 / 255.0) \n  // #FF00FF\n  #define fuchsia vec3(255.0 / 255.0, 0.0 / 255.0, 255.0 / 255.0) \n  // #DCDCDC\n  #define gainsboro vec3(220.0 / 255.0, 220.0 / 255.0, 220.0 / 255.0) \n  // #F8F8FF\n  #define ghostwhite vec3(248.0 / 255.0, 248.0 / 255.0, 255.0 / 255.0) \n  // #FFD700\n  #define gold vec3(255.0 / 255.0, 215.0 / 255.0, 0.0 / 255.0) \n  // #DAA520\n  #define goldenrod vec3(218.0 / 255.0, 165.0 / 255.0, 32.0 / 255.0) \n  // #808080\n  #define gray vec3(128.0 / 255.0, 128.0 / 255.0, 128.0 / 255.0) \n  // #808080\n  #define grey vec3(128.0 / 255.0, 128.0 / 255.0, 128.0 / 255.0) \n  // #008000\n  #define green vec3(0.0 / 255.0, 128.0 / 255.0, 0.0 / 255.0) \n  // #ADFF2F\n  #define greenyellow vec3(173.0 / 255.0, 255.0 / 255.0, 47.0 / 255.0) \n  // #F0FFF0\n  #define honeydew vec3(240.0 / 255.0, 255.0 / 255.0, 240.0 / 255.0) \n  // #FF69B4\n  #define hotpink vec3(255.0 / 255.0, 105.0 / 255.0, 180.0 / 255.0) \n  // #CD5C5C\n  #define indianred vec3(205.0 / 255.0, 92.0 / 255.0, 92.0 / 255.0) \n  // #4B0082\n  #define indigo vec3(75.0 / 255.0, 0.0 / 255.0, 130.0 / 255.0) \n  // #FFFFF0\n  #define ivory vec3(255.0 / 255.0, 255.0 / 255.0, 240.0 / 255.0) \n  // #F0E68C\n  #define khaki vec3(240.0 / 255.0, 230.0 / 255.0, 140.0 / 255.0) \n  // #E6E6FA\n  #define lavender vec3(230.0 / 255.0, 230.0 / 255.0, 250.0 / 255.0) \n  // #FFF0F5\n  #define lavenderblush vec3(255.0 / 255.0, 240.0 / 255.0, 245.0 / 255.0) \n  // #7CFC00\n  #define lawngreen vec3(124.0 / 255.0, 252.0 / 255.0, 0.0 / 255.0) \n  // #FFFACD\n  #define lemonchiffon vec3(255.0 / 255.0, 250.0 / 255.0, 205.0 / 255.0) \n  // #ADD8E6\n  #define lightblue vec3(173.0 / 255.0, 216.0 / 255.0, 230.0 / 255.0) \n  // #F08080\n  #define lightcoral vec3(240.0 / 255.0, 128.0 / 255.0, 128.0 / 255.0) \n  // #E0FFFF\n  #define lightcyan vec3(224.0 / 255.0, 255.0 / 255.0, 255.0 / 255.0) \n  // #FAFAD2\n  #define lightgoldenrodyellow vec3(250.0 / 255.0, 250.0 / 255.0, 210.0 / 255.0) \n  // #D3D3D3\n  #define lightgray vec3(211.0 / 255.0, 211.0 / 255.0, 211.0 / 255.0) \n  // #D3D3D3\n  #define lightgrey vec3(211.0 / 255.0, 211.0 / 255.0, 211.0 / 255.0) \n  // #90EE90\n  #define lightgreen vec3(144.0 / 255.0, 238.0 / 255.0, 144.0 / 255.0) \n  // #FFB6C1\n  #define lightpink vec3(255.0 / 255.0, 182.0 / 255.0, 193.0 / 255.0) \n  // #FFA07A\n  #define lightsalmon vec3(255.0 / 255.0, 160.0 / 255.0, 122.0 / 255.0) \n  // #20B2AA\n  #define lightseagreen vec3(32.0 / 255.0, 178.0 / 255.0, 170.0 / 255.0) \n  // #87CEFA\n  #define lightskyblue vec3(135.0 / 255.0, 206.0 / 255.0, 250.0 / 255.0) \n  // #778899\n  #define lightslategray vec3(119.0 / 255.0, 136.0 / 255.0, 153.0 / 255.0) \n  // #778899\n  #define lightslategrey vec3(119.0 / 255.0, 136.0 / 255.0, 153.0 / 255.0) \n  // #B0C4DE\n  #define lightsteelblue vec3(176.0 / 255.0, 196.0 / 255.0, 222.0 / 255.0) \n  // #FFFFE0\n  #define lightyellow vec3(255.0 / 255.0, 255.0 / 255.0, 224.0 / 255.0) \n  // #00FF00\n  #define lime vec3(0.0 / 255.0, 255.0 / 255.0, 0.0 / 255.0) \n  // #32CD32\n  #define limegreen vec3(50.0 / 255.0, 205.0 / 255.0, 50.0 / 255.0) \n  // #FAF0E6\n  #define linen vec3(250.0 / 255.0, 240.0 / 255.0, 230.0 / 255.0) \n  // #FF00FF\n  #define magenta vec3(255.0 / 255.0, 0.0 / 255.0, 255.0 / 255.0) \n  // #800000\n  #define maroon vec3(128.0 / 255.0, 0.0 / 255.0, 0.0 / 255.0) \n  // #66CDAA\n  #define mediumaquamarine vec3(102.0 / 255.0, 205.0 / 255.0, 170.0 / 255.0) \n  // #0000CD\n  #define mediumblue vec3(0.0 / 255.0, 0.0 / 255.0, 205.0 / 255.0) \n  // #BA55D3\n  #define mediumorchid vec3(186.0 / 255.0, 85.0 / 255.0, 211.0 / 255.0) \n  // #9370DB\n  #define mediumpurple vec3(147.0 / 255.0, 112.0 / 255.0, 219.0 / 255.0) \n  // #3CB371\n  #define mediumseagreen vec3(60.0 / 255.0, 179.0 / 255.0, 113.0 / 255.0) \n  // #7B68EE\n  #define mediumslateblue vec3(123.0 / 255.0, 104.0 / 255.0, 238.0 / 255.0) \n  // #00FA9A\n  #define mediumspringgreen vec3(0.0 / 255.0, 250.0 / 255.0, 154.0 / 255.0) \n  // #48D1CC\n  #define mediumturquoise vec3(72.0 / 255.0, 209.0 / 255.0, 204.0 / 255.0) \n  // #C71585\n  #define mediumvioletred vec3(199.0 / 255.0, 21.0 / 255.0, 133.0 / 255.0) \n  // #191970\n  #define midnightblue vec3(25.0 / 255.0, 25.0 / 255.0, 112.0 / 255.0) \n  // #F5FFFA\n  #define mintcream vec3(245.0 / 255.0, 255.0 / 255.0, 250.0 / 255.0) \n  // #FFE4E1\n  #define mistyrose vec3(255.0 / 255.0, 228.0 / 255.0, 225.0 / 255.0) \n  // #FFE4B5\n  #define moccasin vec3(255.0 / 255.0, 228.0 / 255.0, 181.0 / 255.0) \n  // #FFDEAD\n  #define navajowhite vec3(255.0 / 255.0, 222.0 / 255.0, 173.0 / 255.0) \n  // #000080\n  #define navy vec3(0.0 / 255.0, 0.0 / 255.0, 128.0 / 255.0) \n  // #FDF5E6\n  #define oldlace vec3(253.0 / 255.0, 245.0 / 255.0, 230.0 / 255.0) \n  // #808000\n  #define olive vec3(128.0 / 255.0, 128.0 / 255.0, 0.0 / 255.0) \n  // #6B8E23\n  #define olivedrab vec3(107.0 / 255.0, 142.0 / 255.0, 35.0 / 255.0) \n  // #FFA500\n  #define orange vec3(255.0 / 255.0, 165.0 / 255.0, 0.0 / 255.0) \n  // #FF4500\n  #define orangered vec3(255.0 / 255.0, 69.0 / 255.0, 0.0 / 255.0) \n  // #DA70D6\n  #define orchid vec3(218.0 / 255.0, 112.0 / 255.0, 214.0 / 255.0) \n  // #EEE8AA\n  #define palegoldenrod vec3(238.0 / 255.0, 232.0 / 255.0, 170.0 / 255.0) \n  // #98FB98\n  #define palegreen vec3(152.0 / 255.0, 251.0 / 255.0, 152.0 / 255.0) \n  // #AFEEEE\n  #define paleturquoise vec3(175.0 / 255.0, 238.0 / 255.0, 238.0 / 255.0) \n  // #DB7093\n  #define palevioletred vec3(219.0 / 255.0, 112.0 / 255.0, 147.0 / 255.0) \n  // #FFEFD5\n  #define papayawhip vec3(255.0 / 255.0, 239.0 / 255.0, 213.0 / 255.0) \n  // #FFDAB9\n  #define peachpuff vec3(255.0 / 255.0, 218.0 / 255.0, 185.0 / 255.0) \n  // #CD853F\n  #define peru vec3(205.0 / 255.0, 133.0 / 255.0, 63.0 / 255.0) \n  // #FFC0CB\n  #define pink vec3(255.0 / 255.0, 192.0 / 255.0, 203.0 / 255.0) \n  // #DDA0DD\n  #define plum vec3(221.0 / 255.0, 160.0 / 255.0, 221.0 / 255.0) \n  // #B0E0E6\n  #define powderblue vec3(176.0 / 255.0, 224.0 / 255.0, 230.0 / 255.0) \n  // #800080\n  #define purple vec3(128.0 / 255.0, 0.0 / 255.0, 128.0 / 255.0) \n  // #663399\n  #define rebeccapurple vec3(102.0 / 255.0, 51.0 / 255.0, 153.0 / 255.0) \n  // #FF0000\n  #define red vec3(255.0 / 255.0, 0.0 / 255.0, 0.0 / 255.0) \n  // #BC8F8F\n  #define rosybrown vec3(188.0 / 255.0, 143.0 / 255.0, 143.0 / 255.0) \n  // #4169E1\n  #define royalblue vec3(65.0 / 255.0, 105.0 / 255.0, 225.0 / 255.0) \n  // #8B4513\n  #define saddlebrown vec3(139.0 / 255.0, 69.0 / 255.0, 19.0 / 255.0) \n  // #FA8072\n  #define salmon vec3(250.0 / 255.0, 128.0 / 255.0, 114.0 / 255.0) \n  // #F4A460\n  #define sandybrown vec3(244.0 / 255.0, 164.0 / 255.0, 96.0 / 255.0) \n  // #2E8B57\n  #define seagreen vec3(46.0 / 255.0, 139.0 / 255.0, 87.0 / 255.0) \n  // #FFF5EE\n  #define seashell vec3(255.0 / 255.0, 245.0 / 255.0, 238.0 / 255.0) \n  // #A0522D\n  #define sienna vec3(160.0 / 255.0, 82.0 / 255.0, 45.0 / 255.0) \n  // #C0C0C0\n  #define silver vec3(192.0 / 255.0, 192.0 / 255.0, 192.0 / 255.0) \n  // #87CEEB\n  #define skyblue vec3(135.0 / 255.0, 206.0 / 255.0, 235.0 / 255.0) \n  // #6A5ACD\n  #define slateblue vec3(106.0 / 255.0, 90.0 / 255.0, 205.0 / 255.0) \n  // #708090\n  #define slategray vec3(112.0 / 255.0, 128.0 / 255.0, 144.0 / 255.0) \n  // #708090\n  #define slategrey vec3(112.0 / 255.0, 128.0 / 255.0, 144.0 / 255.0) \n  // #FFFAFA\n  #define snow vec3(255.0 / 255.0, 250.0 / 255.0, 250.0 / 255.0) \n  // #00FF7F\n  #define springgreen vec3(0.0 / 255.0, 255.0 / 255.0, 127.0 / 255.0) \n  // #4682B4\n  #define steelblue vec3(70.0 / 255.0, 130.0 / 255.0, 180.0 / 255.0) \n  // #D2B48C\n  #define tan_color vec3(210.0 / 255.0, 180.0 / 255.0, 140.0 / 255.0) \n  // #008080\n  #define teal vec3(0.0 / 255.0, 128.0 / 255.0, 128.0 / 255.0) \n  // #D8BFD8\n  #define thistle vec3(216.0 / 255.0, 191.0 / 255.0, 216.0 / 255.0) \n  // #FF6347\n  #define tomato vec3(255.0 / 255.0, 99.0 / 255.0, 71.0 / 255.0) \n  // #40E0D0\n  #define turquoise vec3(64.0 / 255.0, 224.0 / 255.0, 208.0 / 255.0) \n  // #EE82EE\n  #define violet vec3(238.0 / 255.0, 130.0 / 255.0, 238.0 / 255.0) \n  // #F5DEB3\n  #define wheat vec3(245.0 / 255.0, 222.0 / 255.0, 179.0 / 255.0) \n  // #FFFFFF\n  #define white vec3(255.0 / 255.0, 255.0 / 255.0, 255.0 / 255.0) \n  // #F5F5F5\n  #define whitesmoke vec3(245.0 / 255.0, 245.0 / 255.0, 245.0 / 255.0) \n  // #FFFF00\n  #define yellow vec3(255.0 / 255.0, 255.0 / 255.0, 0.0 / 255.0) \n  // #9ACD32\n  #define yellowgreen vec3(154.0 / 255.0, 205.0 / 255.0, 50.0 / 255.0) \n"},72612:(e,t,n)=>{"use strict";function*i(e){let t=0,n={get i(){return t},get t(){return t/e},get p(){return t/(e-1)},get size(){return e},clone(){return{...this}}};for(t=0;t<e;t++)yield n}function r(e,t){let n=[];for(let r of i(e)){let e=r.clone();n.push(t?t(e):e)}return n}function*a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let i=0,r=0;2===t.length?(i=t[0],r=t[1]):Array.isArray(t[0])?(i=t[0][0],r=t[0][1]):(i=t[0].x,r=t[0].y);let a=0,o=0,s=0,l={get i(){return a},get x(){return o},get y(){return s},get tx(){return o/i},get ty(){return s/r},get px(){return o/(i-1)},get py(){return s/(r-1)},get sizeX(){return i},get sizeY(){return r},clone(){return{...this}}};for(s=0;s<r;s++)for(o=0;o<i;o++)yield l,a++}function o(){let e;for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];let r=0,o=0;"number"==typeof n[0]?(r=n[0],o=n[1],e=n[2]):(Array.isArray(n[0])?(r=n[0][0],o=n[0][1]):(r=n[0].x,o=n[0].y),e=n[1]);let s=[];for(let t of a(r,o)){let n=t.clone();s.push(e?e(n):n)}return s}function*s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let i=0,r=0,a=0;3===t.length?(i=t[0],r=t[1],a=t[2]):Array.isArray(t[0])?(i=t[0][0],r=t[0][1],a=t[0][2]):(i=t[0].x,r=t[0].y,a=t[0].z);let o=0,s=0,l=0,c=0,d={get i(){return o},get x(){return s},get y(){return l},get z(){return c},get tx(){return s/i},get ty(){return l/r},get tz(){return c/a},get px(){return s/(i-1)},get py(){return l/(r-1)},get pz(){return c/(a-1)},clone(){return{...this}}};for(c=0;c<a;c++)for(l=0;l<r;l++)for(s=0;s<i;s++)yield d,o++}function l(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let i=[];for(let e of s(...t))i.push(e.clone());return i}n.r(t),n.d(t,{loop:()=>i,loop2:()=>a,loop2Array:()=>o,loop3:()=>s,loop3Array:()=>l,loopArray:()=>r})},73446:(e,t,n)=>{"use strict";n.d(t,{x:()=>r});var i=n(1029);let r="\n#ifndef BLENDING\n#define BLENDING\n\n".concat((0,i.N)("vecX","\n  T multiplyBlending(in T a, in T b) {\n    return a * b;\n  }\n"),"\n\n").concat((0,i.N)("vecX","\n  T screenBlending(in T a, in T b) {\n    return 1.0 - (1.0 - a) * (1.0 - b);\n  }\n"),"\n\nfloat overlayBlending(in float a, in float b) {\n  return a < 0.5 ? (2.0 * a * b) : (1.0 - 2.0 * (1.0 - a) * (1.0 - b));\n}\n\nvec2 overlayBlending(in vec2 a, in vec2 b) {\n  return vec2(\n    overlayBlending(a.x, b.x),\n    overlayBlending(a.y, b.y));\n}\n\nvec3 overlayBlending(in vec3 a, in vec3 b) {\n  return vec3(\n    overlayBlending(a.x, b.x),\n    overlayBlending(a.y, b.y),\n    overlayBlending(a.z, b.z));\n}\n\nvec4 overlayBlending(in vec4 a, in vec4 b) {\n  return vec4(\n    overlayBlending(a.x, b.x),\n    overlayBlending(a.y, b.y),\n    overlayBlending(a.z, b.z),\n    overlayBlending(a.w, b.w));\n}\n\n").concat((0,i.N)("vecX","\n  T darkenBlending(in T a, in T b) {\n    return max(a, b);\n  }\n"),"\n\n").concat((0,i.N)("vecX","\n  T lightenBlending(in T a, in T b) {\n    return max(a, b);\n  }\n"),"\n\n").concat((0,i.N)("vecX","\n  T differenceBlending(in T a, in T b) {\n    return abs(a - b);\n  }\n"),"\n\n#endif\n")},80446:(e,t,n)=>{"use strict";n.d(t,{n:()=>r});var i=n(79105);let r=function e(){let t=Math.random,n=()=>{};function r(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return t}function a(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];if(0===n.length)return t();if(1===n.length)return t()*n[0];if(2===n.length)return t()*(n[1]-n[0])+n[0];throw Error("Invalid arguments")}function o(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];if(1===n.length)return Math.floor(t()*n[0]);if(2===n.length)return Math.floor(t()*(n[1]-n[0]))+n[0];throw Error("Invalid arguments")}function s(e){let{weightsAreNormalized:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===e.length)throw Error("Weights array is empty");if(!1===n){let n=e.reduce((e,t)=>e+t,0),i=t()*n,r=0;for(let t=0;t<e.length;t++)if(i<(r+=e[t]))return t;return e.length-1}{let n=t(),i=0;for(let t=0;t<e.length;t++)if(n<(i+=e[t]))return t;return e.length-1}}let l={new:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return e().setRandom(...n)},setRandom:function(){for(var e=arguments.length,a=Array(e),o=0;o<e;o++)a[o]=arguments[o];let[s,c=0]=a,d="string"==typeof c?r(c):c;if("parkmiller"===s){let e=i.Ts(d);t=()=>(e=i.K2(e),i.Tj(e)),n=t=>{e=i.Ts(t)}}else{if(void 0!==s&&"function"!=typeof s)throw Error("Invalid random function");t=null!=s?s:Math.random,n=()=>{}}return n(d),l},seed:function(e){return n("string"==typeof e?r(e):null!=e?e:0),l},get random(){return t},chance:function(e){return t()<e},number:a,float:a,f:a,sign:function(){return .5>t()?-1:1},int:o,i:o,hexColor:function(){let e=Math.floor(0xffffff*t());return"#".concat(e.toString(16).padStart(6,"0"))},pickIndex:s,pick:function(e,n){if(0===e.length)throw Error("Array is empty");if(n)return e[s(n)];let i=Math.floor(t()*e.length);return e[i]},createPicker:function(e){let t=e.map(e=>e[0]),n=e.map(e=>e[1]),i=t.reduce((e,t)=>e+t,0);for(let e=0;e<t.length;e++)t[e]/=i;return()=>n[s(t,{weightsAreNormalized:!0})]},direction2:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},n=t()*Math.PI*2;return e.x=Math.cos(n),e.y=Math.sin(n),e},direction3:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0},n=t(),i=t(),r=2*Math.PI*n,a=Math.acos(1-2*i);return e.x=Math.sin(a)*Math.cos(r),e.y=Math.sin(a)*Math.sin(r),e.z=Math.cos(a),e},quaternion:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0,w:1},n=t(),i=t(),r=t(),a=Math.sqrt(1-n),o=Math.sqrt(n);return e.x=a*Math.sin(2*Math.PI*i),e.y=a*Math.cos(2*Math.PI*i),e.z=o*Math.sin(2*Math.PI*r),e.w=o*Math.cos(2*Math.PI*r),e},shuffleIndexes:function*(e){if(e<=0)throw Error("N must be greater than 0");let n=0,i=Math.floor((2+2*t())*e);for(;1!==function(e,t){for(;0!==t;)[e,t]=[t,e%t];return e}(e,i);){if(++n>1e3)throw Error("Failed to find a suitable a value after 1000 attempts");i=e+Math.floor(t()*e)}let r=Math.floor(t()*e);for(let t=0;t<e;t++)yield(r+t*i)%e}};return l}()},82143:(e,t,n)=>{"use strict";n.d(t,{O0:()=>i,XW:()=>z});var i,r=n(49797),a=n(99613),o=n(50373),s=n(64416),l=n(27491),c=n(27146),d=n(71591),u=n(28334);!function(e){e[e.Render=0]="Render",e[e.PostProcessing=1e3]="PostProcessing",e[e.GizmoRender=2e3]="GizmoRender",e[e.Outline=3e3]="Outline",e[e.Output=4e3]="Output",e[e.Antialiasing=5e3]="Antialiasing"}(i||(i={}));class h{get passes(){return this.composer.passes}sortPasses(){let e=[...this.passMap];for(let[t]of e)this.composer.removePass(t);for(let[t]of(e.sort((e,t)=>{let n=e[1],i=t[1];return n.type!==i.type?n.type-i.type:n.insertOrder-i.insertOrder}),e))this.composer.addPass(t);return this}*getPassesByType(e){for(let[t,n]of this.passMap)n.type===e&&(yield[t,n])}addPass(e){let{type:t=i.Render,insertOrder:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===n){var r,a,o;n=(null!=(o=null==(a=[...this.getPassesByType(t)].at(-1))||null==(r=a[1])?void 0:r.insertOrder)?o:-1)+1}return this.passMap.set(e,{type:t,insertOrder:n}),this.sortPasses(),{destroy:()=>this.removePass(e)}}removePass(e){return this.passMap.has(e)?(this.passMap.delete(e),this.composer.removePass(e),!0):(console.warn("The pass is not in the pipeline."),!1)}setSize(e,t,n){this.composer.setSize(e,t),this.composer.setPixelRatio(n),this.basicPasses.fxaa.uniforms.resolution.value.set(1/n/e,1/n/t),this.basicPasses.smaa.setSize(e*n,t*n)}setScene(e){let t=this.basicPasses.mainRender.scene;for(let n of this.composer.passes)n instanceof l.A&&n.scene===t&&(n.scene=e)}render(e){this.composer.render(e.deltaTime)}getPassesInfo(){let e=["".concat(this.constructor.name," passes info:")],{composer:t,passMap:n}=this;for(let[r,a]of t.passes.entries()){let t=n.get(a);if(t){let n=a.enabled?"":"";e.push("- ".concat(r,": ").concat(n," ").concat(i[t.type]," (insertOrder: ").concat(t.insertOrder,") ").concat(a.constructor.name))}else e.push("- ".concat(r,": NO METADATA for ").concat(a.constructor.name))}return e.join("\n")}constructor(e,t,n,h){let f=new a.s(e),p=new Map,m=new l.A(t,h);m.clearAlpha=0,p.set(m,{type:i.Render,insertOrder:0}),f.addPass(m);let v=new l.A(n,h);p.set(v,{type:i.GizmoRender,insertOrder:0}),v.clear=!1,v.clearDepth=!1,f.addPass(v);let g=new o.G(new r.I9Y,t,h);p.set(g,{type:i.GizmoRender,insertOrder:0}),f.addPass(g);let x=new s.X;p.set(x,{type:i.Output,insertOrder:0}),f.addPass(x);let w=new c.p(u.o);p.set(w,{type:i.Antialiasing,insertOrder:0}),f.addPass(w);let y=new d.I;y.enabled=!1,p.set(y,{type:i.Antialiasing,insertOrder:0}),f.addPass(y),this.composer=f,this.basicPasses={mainRender:m,gizmoRender:v,outline:g,output:x,fxaa:w,smaa:y},this.passMap=p}}var f=n(28535),p=n(76999),m=n(57368),v=n(30158),g=n(17223),x=n(24223),w=n(79285);let y=JSON.parse('[{"name":"Lavender","hex":"E6E6FA"},{"name":"Thistle","hex":"D8BFD8"},{"name":"Plum","hex":"DDA0DD"},{"name":"Violet","hex":"EE82EE"},{"name":"Orchid","hex":"DA70D6"},{"name":"Fuchsia","hex":"FF00FF"},{"name":"Magenta","hex":"FF00FF"},{"name":"MediumOrchid","hex":"BA55D3"},{"name":"MediumPurple","hex":"9370DB"},{"name":"BlueViolet","hex":"8A2BE2"},{"name":"DarkViolet","hex":"9400D3"},{"name":"DarkOrchid","hex":"9932CC"},{"name":"DarkMagenta","hex":"8B008B"},{"name":"Purple","hex":"800080"},{"name":"Indigo","hex":"4B0082"},{"name":"DarkSlateBlue","hex":"483D8B"},{"name":"SlateBlue","hex":"6A5ACD"},{"name":"MediumSlateBlue","hex":"7B68EE"},{"name":"Pink","hex":"FFC0CB"},{"name":"LightPink","hex":"FFB6C1"},{"name":"HotPink","hex":"FF69B4"},{"name":"DeepPink","hex":"FF1493"},{"name":"PaleVioletRed","hex":"DB7093"},{"name":"MediumVioletRed","hex":"C71585"},{"name":"LightSalmon","hex":"FFA07A"},{"name":"Salmon","hex":"FA8072"},{"name":"DarkSalmon","hex":"E9967A"},{"name":"LightCoral","hex":"F08080"},{"name":"IndianRed","hex":"CD5C5C"},{"name":"Crimson","hex":"DC143C"},{"name":"FireBrick","hex":"B22222"},{"name":"DarkRed","hex":"8B0000"},{"name":"Red","hex":"FF0000"},{"name":"OrangeRed","hex":"FF4500"},{"name":"Tomato","hex":"FF6347"},{"name":"Coral","hex":"FF7F50"},{"name":"DarkOrange","hex":"FF8C00"},{"name":"Orange","hex":"FFA500"},{"name":"Yellow","hex":"FFFF00"},{"name":"LightYellow","hex":"FFFFE0"},{"name":"LemonChiffon","hex":"FFFACD"},{"name":"LightGoldenrodYellow","hex":"FAFAD2"},{"name":"PapayaWhip","hex":"FFEFD5"},{"name":"Moccasin","hex":"FFE4B5"},{"name":"PeachPuff","hex":"FFDAB9"},{"name":"PaleGoldenrod","hex":"EEE8AA"},{"name":"Khaki","hex":"F0E68C"},{"name":"DarkKhaki","hex":"BDB76B"},{"name":"Gold","hex":"FFD700"},{"name":"Cornsilk","hex":"FFF8DC"},{"name":"BlanchedAlmond","hex":"FFEBCD"},{"name":"Bisque","hex":"FFE4C4"},{"name":"NavajoWhite","hex":"FFDEAD"},{"name":"Wheat","hex":"F5DEB3"},{"name":"BurlyWood","hex":"DEB887"},{"name":"Tan","hex":"D2B48C"},{"name":"RosyBrown","hex":"BC8F8F"},{"name":"SandyBrown","hex":"F4A460"},{"name":"Goldenrod","hex":"DAA520"},{"name":"DarkGoldenrod","hex":"B8860B"},{"name":"Peru","hex":"CD853F"},{"name":"Chocolate","hex":"D2691E"},{"name":"SaddleBrown","hex":"8B4513"},{"name":"Sienna","hex":"A0522D"},{"name":"Brown","hex":"A52A2A"},{"name":"Maroon","hex":"800000"},{"name":"DarkOliveGreen","hex":"556B2F"},{"name":"Olive","hex":"808000"},{"name":"OliveDrab","hex":"6B8E23"},{"name":"YellowGreen","hex":"9ACD32"},{"name":"LimeGreen","hex":"32CD32"},{"name":"Lime","hex":"00FF00"},{"name":"LawnGreen","hex":"7CFC00"},{"name":"Chartreuse","hex":"7FFF00"},{"name":"GreenYellow","hex":"ADFF2F"},{"name":"SpringGreen","hex":"00FF7F"},{"name":"MediumSpringGreen","hex":"00FA9A"},{"name":"LightGreen","hex":"90EE90"},{"name":"PaleGreen","hex":"98FB98"},{"name":"DarkSeaGreen","hex":"8FBC8F"},{"name":"MediumSeaGreen","hex":"3CB371"},{"name":"SeaGreen","hex":"2E8B57"},{"name":"ForestGreen","hex":"228B22"},{"name":"Green","hex":"008000"},{"name":"DarkGreen","hex":"006400"},{"name":"MediumAquamarine","hex":"66CDAA"},{"name":"Aqua","hex":"00FFFF"},{"name":"Cyan","hex":"00FFFF"},{"name":"LightCyan","hex":"E0FFFF"},{"name":"PaleTurquoise","hex":"AFEEEE"},{"name":"Aquamarine","hex":"7FFFD4"},{"name":"Turquoise","hex":"40E0D0"},{"name":"MediumTurquoise","hex":"48D1CC"},{"name":"DarkTurquoise","hex":"00CED1"},{"name":"LightSeaGreen","hex":"20B2AA"},{"name":"CadetBlue","hex":"5F9EA0"},{"name":"DarkCyan","hex":"008B8B"},{"name":"Teal","hex":"008080"},{"name":"LightSteelBlue","hex":"B0C4DE"},{"name":"PowderBlue","hex":"B0E0E6"},{"name":"LightBlue","hex":"ADD8E6"},{"name":"SkyBlue","hex":"87CEEB"},{"name":"LightSkyBlue","hex":"87CEFA"},{"name":"DeepSkyBlue","hex":"00BFFF"},{"name":"DodgerBlue","hex":"1E90FF"},{"name":"CornflowerBlue","hex":"6495ED"},{"name":"SteelBlue","hex":"4682B4"},{"name":"RoyalBlue","hex":"4169E1"},{"name":"Blue","hex":"0000FF"},{"name":"MediumBlue","hex":"0000CD"},{"name":"DarkBlue","hex":"00008B"},{"name":"Navy","hex":"000080"},{"name":"MidnightBlue","hex":"191970"},{"name":"White","hex":"FFFFFF"},{"name":"Snow","hex":"FFFAFA"},{"name":"Honeydew","hex":"F0FFF0"},{"name":"MintCream","hex":"F5FFFA"},{"name":"Azure","hex":"F0FFFF"},{"name":"AliceBlue","hex":"F0F8FF"},{"name":"GhostWhite","hex":"F8F8FF"},{"name":"WhiteSmoke","hex":"F5F5F5"},{"name":"Seashell","hex":"FFF5EE"},{"name":"Beige","hex":"F5F5DC"},{"name":"OldLace","hex":"FDF5E6"},{"name":"FloralWhite","hex":"FFFAF0"},{"name":"Ivory","hex":"FFFFF0"},{"name":"AntiqueWhite","hex":"FAEBD7"},{"name":"Linen","hex":"FAF0E6"},{"name":"LavenderBlush","hex":"FFF0F5"},{"name":"MistyRose","hex":"FFE4E1"},{"name":"Gainsboro","hex":"DCDCDC"},{"name":"LightGray","hex":"D3D3D3"},{"name":"Silver","hex":"C0C0C0"},{"name":"DarkGray","hex":"A9A9A9"},{"name":"Gray","hex":"808080"},{"name":"DimGray","hex":"696969"},{"name":"LightSlateGray","hex":"778899"},{"name":"SlateGray","hex":"708090"},{"name":"DarkSlateGray","hex":"2F4F4F"},{"name":"Black","hex":"000000"}]');function b(e){return(0,w.toff)(e).toString(16).padStart(2,"0")}function P(e,t){return null!=t||(t={r:1,g:1,b:1,a:1}),t.r=(e>>16&255)/255,t.g=(e>>8&255)/255,t.b=(255&e)/255,t}function F(e,t){switch(null!=t||(t={r:1,g:1,b:1,a:1}),typeof e){case"number":return P(e,t);case"string":if(e.startsWith("#"))return function(e,t){if(null!=t||(t={r:1,g:1,b:1,a:1}),e.startsWith("#")&&(e=e.slice(1)),3===e.length||4===e.length){let[n,i,r,a="f"]=e;return t.r=Number.parseInt(n+n,16)/255,t.g=Number.parseInt(i+i,16)/255,t.b=Number.parseInt(r+r,16)/255,t.a=Number.parseInt(a+a,16)/255,t}if(6===e.length||8===e.length){let n=e.slice(0,2),i=e.slice(2,4),r=e.slice(4,6),a=e.slice(6,8)||"ff";return t.r=Number.parseInt(n,16)/255,t.g=Number.parseInt(i,16)/255,t.b=Number.parseInt(r,16)/255,t.a=Number.parseInt(a,16)/255,t}throw Error("Invalid hex string")}(e,t);if(e.startsWith("rgb")||e.startsWith("hsl"))throw Error("Not implemented");try{return P(function(e){let t=RegExp("^".concat(e.toLowerCase(),"$"),"i"),n=y.find(e=>e.name.match(t));if(n)return Number.parseInt(n.hex,16);throw Error("Invalid web color")}(e),t)}catch(e){throw Error("Invalid color string")}case"object":if(Array.isArray(e)){let[n,i,r,a=1]=e;return t.r=n,t.g=i,t.b=r,t.a=a,t}if("object"==typeof e&&"r"in e&&"g"in e&&"b"in e&&"a"in e)return t.r=e.r,t.g=e.g,t.b=e.b,t.a=e.a,t}throw Error("Invalid color declaration")}class C{static from(e){return F(e,new C)}static lerpColors(e,t,n){return new C().lerpColors(e,t,n)}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b,yield this.a}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}clone(){return new this.constructor().copy(this)}set(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return this.r=e,this.g=t,this.b=n,this.a=i,this}lerpColors(e,t,n){return this.r=(0,w.lerp)(e.r,t.r,n),this.g=(0,w.lerp)(e.g,t.g,n),this.b=(0,w.lerp)(e.b,t.b,n),this.a=(0,w.lerp)(e.a,t.a,n),this}toCSS(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"hex";switch(e){case"hex":return"#".concat(b(this.r)).concat(b(this.g)).concat(b(this.b)).concat(b(this.a));case"rgba":return"rgba(".concat((0,w.toff)(this.r),", ").concat((0,w.toff)(this.g),", ").concat((0,w.toff)(this.b),", ").concat(this.a.toFixed(2),")")}throw Error("Invalid format")}constructor(e){this.r=1,this.g=1,this.b=1,this.a=1,e&&F(e,this)}}var M=n(39787),S=n(93432),D=n(10390),E=n(79911),A=n(52489),T=n(29338),B=new WeakMap;class z extends A.${static current(){return this.instances[this.instances.length-1]}_onSetScene(){this.pipeline.setScene(this.scene)}useOrbitControls(){var e,t;let{position:n=null,target:i=null,element:r=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"string"==typeof r&&(r=document.querySelector(r)),null!=(e=this.internal).orbitControls||(e.orbitControls=new g.N(this.camera,r)),r&&r!==this.internal.orbitControls.domElement&&(this.internal.orbitControls.dispose(),this.internal.orbitControls=new g.N(this.camera,r)),n&&(0,S.jj)(n,this.internal.orbitControls.object.position),i&&(0,S.jj)(i,this.internal.orbitControls.target),this.internal.orbitControls.update(),this.internal.orbitControls}initialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(this.initialized)return console.warn("ThreeWebGLContext is already initialized."),this;Object.defineProperty(this,"initialized",{value:!0,writable:!1,configurable:!1,enumerable:!1});let{onDestroy:n}=this,{domElement:i}=this.renderer;e.appendChild(i),n(()=>{e.removeChild(i)});let r=()=>{this.setSize({width:e.clientWidth,height:e.clientHeight,pixelRatio:window.devicePixelRatio})},a=new ResizeObserver(r);return a.observe(e),n(()=>{a.disconnect()}),r(),n(this.pointer.initialize(i,t,this.camera,this.ticker)),n((0,x.O)(this.ticker.requestActivation),this.ticker.onTick({phase:T.z.Render,name:"WebGL:Render"},e=>this.renderFrame(e))),n(()=>{var e;null==(e=this.internal.orbitControls)||e.dispose()}),this.domContainer=e,this.domElement=i,this}_onSetSize(){let{size:{x:e,y:t},pixelRatio:n}=this,{renderer:i,perspectiveCamera:r,pipeline:a}=this;i.setSize(e,t),i.setPixelRatio(n),a.setSize(e,t,n),r.aspect=e/t,r.updateProjectionMatrix()}renderFrame(e,t){var n;(!1!==this._enabled||(null==t?void 0:t.force)===!0)&&(null==(n=this.internal.orbitControls)||n.update(e.deltaTime),super.renderFrame(e,t),!1===this.skipRender&&this.pipeline.render(e))}*findAll(e,t){yield*(0,E.wV)(this.scene,e,t)}find(e){for(let t of this.findAll(e))return t;return null}isPartOfScene(e){let t=e;for(;t;){if(t===this.scene)return!0;t=t.parent}return!1}pixelColor(e,t){if(this.pipeline.composer.readBuffer.texture.type===r.ix0){let{uint16:n,color:i}=(0,f._)(this,B);this.renderer.readRenderTargetPixels(this.pipeline.composer.readBuffer,e,t,1,1,n),i.r=r.GxU.fromHalfFloat(n[0]),i.g=r.GxU.fromHalfFloat(n[1]),i.b=r.GxU.fromHalfFloat(n[2]),i.a=r.GxU.fromHalfFloat(n[3])}else throw Error("Unsupported texture type: ".concat(this.pipeline.composer.readBuffer.texture.type));return(0,f._)(this,B).color}pixelColorNdc(e){let{x:t,y:n}=e;return t=Math.floor((t+1)/2*this.fullSize.x),n=Math.floor((n+1)/2*this.fullSize.y),this.pixelColor(t,n)}pointerPixelColor(){return this.pixelColorNdc(this.pointer.screenPosition)}constructor(){super(T.s.WebGL),(0,p._)(this,B,{writable:!0,value:void 0}),this.renderer=new v.WebGLRenderer,this.perspectiveCamera=new r.ubm,this.orthographicCamera=new r.qUd,this.camera=this.perspectiveCamera,this.gizmoScene=new r.Z58,this.pipeline=new h(this.renderer,this.scene,this.gizmoScene,this.perspectiveCamera),this.internal={destroyables:[],orbitControls:null},this.onTick=this.ticker.onTick.bind(this.ticker),this.onDestroy=this.internal.destroyables.push.bind(this.internal.destroyables),this.loader=D.o.get("three"),this.initialized=!1,this.destroyed=!1,this.destroy=()=>{if(this.destroyed)return void console.warn("ThreeWebGLContext is already destroyed.");Object.defineProperty(this,"destroyed",{value:!0,writable:!1,configurable:!1,enumerable:!1}),(0,M.zr)(this.internal.destroyables),this.internal.destroyables=[],this.renderer.dispose()},(0,m._)(this,B,{uint16:new Uint16Array(4),color:new C}),this.camera.position.set(0,1,10),this.camera.lookAt(0,0,0),z.instances.push(this)}}z.instances=[]},83628:(e,t,n)=>{"use strict";n.d(t,{K:()=>c});var i=n(17953),r=n(81074),a=n(49797),o=n(24223),s=n(52489),l=n(29338);class c extends s.${_onSetSize(){let{size:{x:e,y:t},pixelRatio:n}=this,{renderer:i,perspectiveCamera:r,orthographicCamera:a}=this;i.setSize(e,t),i.setPixelRatio(n);let o=e/t;r.aspect=o,r.updateProjectionMatrix(),a.left=-o,a.right=o,a.top=1,a.bottom=-1,a.updateProjectionMatrix()}initialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(this.initialized)return console.warn("ThreeWebGLContext is already initialized."),this;Object.defineProperty(this,"initialized",{value:!0,writable:!1,configurable:!1,enumerable:!1});let n=this.scenePass.getTextureNode("output");this.postProcessing.outputNode=n,new ResizeObserver(()=>{this.setSize({width:e.clientWidth,height:e.clientHeight,pixelRatio:window.devicePixelRatio})}).observe(e);let{domElement:i}=this.renderer;return i.style.display="block",i.style.width="100%",i.style.height="100%",e.appendChild(i),this.setSize({width:i.clientWidth,height:i.clientHeight,pixelRatio:window.devicePixelRatio}),this.internal.cancelTick=this.ticker.onTick({name:"WebGPU:Render",phase:l.z.Render},e=>{this.renderFrame(e)}).destroy,this.internal.cancelRequestActivation=(0,o.O)(document.body,this.ticker.requestActivation).destroy,this.internal.cancelPointer=this.pointer.initialize(this.renderer.domElement,t,this.camera,this.ticker),this.domContainer=e,this.domElement=i,this}renderFrame(e,t){(!1!==this._enabled||(null==t?void 0:t.force)===!0)&&(super.renderFrame(e,t),!1===this.skipRender&&this.postProcessing.renderAsync())}constructor(){super(l.s.WebGPU),this.renderer=new r.uV1({antialias:!0}),this.perspectiveCamera=new a.ubm,this.orthographicCamera=new a.qUd,this.camera=this.perspectiveCamera,this.postProcessing=new r.io7(this.renderer),this.scenePass=(0,i.IXH)(this.scene,this.perspectiveCamera),this.internal={observer:null,cancelRequestActivation:null,cancelTick:null,cancelPointer:null},this.initialized=!1,this.destroyed=!1,this.destroy=()=>{var e,t,n,i,r,a,o;if(this.destroyed)return void console.warn("ThreeWebGLContext is already destroyed.");Object.defineProperty(this,"destroyed",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.renderer.dispose(),null==(e=this.internal.observer)||e.disconnect(),null==(t=(n=this.internal).cancelTick)||t.call(n),null==(i=(r=this.internal).cancelRequestActivation)||i.call(r),null==(a=(o=this.internal).cancelPointer)||a.call(o)},this.camera.position.set(0,1,10),this.camera.lookAt(0,0,0),this.pointer.updatePosition(this.camera,{x:0,y:0},this.renderer.domElement.getBoundingClientRect())}}},84059:(e,t,n)=>{"use strict";n.d(t,{Main:()=>B});var i=n(70691),r=n(84306),a=n(49797),o=n(99332),s=n(93432);let l=new a.mrM({color:"white",transparent:!0,depthTest:!1}),c={circle:(()=>{let e=new a.LoY,t=Array.from({length:81},(e,t)=>{let n=t/80*Math.PI*2;return new a.Pq0(Math.cos(n),Math.sin(n),0)});return e.setFromPoints(t),e})(),box2:(()=>{let e=new a.LoY,t=[new a.Pq0(-.5,-.5,0),new a.Pq0(.5,-.5,0),new a.Pq0(.5,.5,0),new a.Pq0(-.5,.5,0),new a.Pq0(-.5,-.5,0)];return e.setFromPoints(t),e})()};class d extends a.YJl{setupUniforms(e,t){let{value:n}=e,{value:i}=t;n.copy(this.matrixWorld),n.invert()}init(e){this.props=e,this.renderOrder=1}setup(){}set(e){Object.assign(this.props,e),this.setup()}}let u={radius:2,falloff:1};class h extends d{get radius(){return this.props.radius}set radius(e){this.props.radius=e,this.setup()}get falloff(){return this.props.falloff}set falloff(e){this.props.falloff=e,this.setup()}setupUniforms(e,t){super.setupUniforms(e,t);let{radius:n,falloff:i}=this.props;t.value.set(n,i,0,0)}setup(){let{circle0:e,circle1:t}=this.parts,{radius:n,falloff:i}=this.props;e.scale.setScalar(n),t.scale.setScalar(n+i)}constructor(e){super(),this.parts={circle0:new a.N1A(c.circle,l),circle1:new a.N1A(c.circle,l)},this.init({...u,...e}),this.add(this.parts.circle0),this.add(this.parts.circle1),this.setup()}}h.glsl="\n    struct CircleFalloff {\n      mat4 matrix;\n      float radius;\n      float falloff;\n    };\n    float falloff(CircleFalloff falloff, vec3 p) {\n      p = (falloff.matrix * vec4(p, 1.0)).xyz;\n      float d = length(p);\n      return 1.0 - (d - falloff.radius) / falloff.falloff;\n    }\n  ";let f={width:1,height:1,falloff:1};class p extends d{setupUniforms(e,t){super.setupUniforms(e,t);let{width:n,height:i,falloff:r}=this.props;t.value.set(n,i,r,0)}setup(){let{box0:e,box1:t}=this.parts,{width:n,height:i,falloff:r}=this.props;e.scale.set(n,i,1),t.scale.set(n+2*r,i+2*r,1)}constructor(e){super(),this.parts={box0:new a.N1A(c.box2,l),box1:new a.N1A(c.box2,l)},this.init({...f,...e}),this.add(this.parts.box0),this.add(this.parts.box1),this.setup()}}p.glsl="\n    struct ManhattanBox2Falloff {\n      mat4 matrix;\n      float width;\n      float height;\n      float falloff;\n    };\n    float falloff(ManhattanBox2Falloff falloff, vec3 p) {\n      p = (falloff.matrix * vec4(p, 1.0)).xyz;\n      float x = abs(p.x) - falloff.width * 0.5;\n      float y = abs(p.y) - falloff.height * 0.5;\n      return 1.0 - max(x, y) / falloff.falloff;\n    }\n  ";var m=n(7147),v=n(3293),g=n(79911),x=n(71895),w=n(22899),y=n(8144),b=n(72612),P=n(79285);function F(e){let{r:t,g:n,b:i}=new a.Q1f(e);return"vec3(".concat(t.toFixed(3),", ").concat(n.toFixed(3),", ").concat(i.toFixed(3),")")}let C={grid:[16,16]},M=new a.bdM(1,1,1,1),S=new a.V9B({side:a.$EB,transparent:!0}),D={uRadiusScalar:new a.nc$(.9),uCircleMat:new a.nc$(new a.kn4().identity()),uCircleProps:new a.nc$(new a.IUQ(1,2,0,0)),uBox0Mat:new a.nc$(new a.kn4().identity()),uBox0Props:new a.nc$(new a.IUQ(1,1,0,0))};S.onBeforeCompile=e=>m.bI.with(e).defines({USE_UV:""}).uniforms(D).varying({vCenter:"vec3",vWorldPosition2:"vec3"}).vertex.mainAfterAll("\n    vWorldPosition2 = (modelMatrix * instanceMatrix * vec4(transformed, 1.0)).xyz;\n    vCenter = (modelMatrix * instanceMatrix[3]).xyz;\n  ").fragment.top(y.H,x.D,w.I).fragment.top(h.glsl,p.glsl).fragment.after("color_fragment","\n    CircleFalloff circle = CircleFalloff(uCircleMat, uCircleProps.x, uCircleProps.y);\n    ManhattanBox2Falloff box = ManhattanBox2Falloff(uBox0Mat, uBox0Props.x, uBox0Props.y, uBox0Props.z);\n    float d = 0.0;\n    d += clamp01(falloff(box, vWorldPosition2));\n    d += clamp01(falloff(circle, vWorldPosition2));\n    diffuseColor.rgb = mix(".concat(F("#c2e1ff"),", ").concat(F("#d80773"),", easeInOut3(clamp01(d)));\n  ")).fragment.after("alphamap_fragment","\n    float scalar = 1.0 / uRadiusScalar / mix(1.0, 0.25, easeInOut3(clamp01(d)));\n    float alpha = smoothstep(1.0, 0.99, length(vUv - 0.5) * scalar / 0.5);\n\n    if (alpha < 0.01) discard;\n\n    diffuseColor.a *= alpha;\n  ");class E extends a.ZLX{onTick(e){for(let e of Object.values(this.falloffs))e.visible=this.falloffsAreVisible;let{box0:t,circle:n}=this.falloffs;n.falloff=(0,P.lerp)(.1,4,e.sin01Time({frequency:.15})),n.radius=(0,P.lerp)(1,5,e.sin01Time({frequency:.1,phase:.5})),n.setupUniforms(D.uCircleMat,D.uCircleProps),t.rotation.z+=.1*e.deltaTime,t.set({width:8,falloff:(0,P.lerp)(.5,6,e.sin01Time({frequency:.15}))}),t.setupUniforms(D.uBox0Mat,D.uBox0Props)}constructor(e){var t;let{x:n,y:i}=(0,s.wX)(null!=(t=null==e?void 0:e.grid)?t:C.grid);for(let t of(super(M,S,n*i),this.internal={grid:new a.I9Y},this.falloffsAreVisible=!0,this.falloffs={circle:(0,g.mj)(new h,{parent:this,position:[-3,-2,0]}),box0:(0,g.mj)(new p({}),{parent:this,position:[3,2,0]})},this.props={...C,...e},(0,b.loop2)(n,i)))this.setMatrixAt(t.i,(0,v.w)({x:t.x-n/2,y:t.y-i/2}))}}function*A(e){e.scene.background=new a.Q1f("#1c54e0"),e.ticker.set({activeDuration:30}),e.useOrbitControls();let t=new E;e.scene.add(t),yield()=>t.removeFromParent(),yield(0,o.s)(document.body,{onTap(){t.falloffsAreVisible=!t.falloffsAreVisible}})}function T(){return(0,r.yk)(A),null}function B(){return(0,i.jsx)("div",{className:"absolute-through",children:(0,i.jsx)(r.uB,{children:(0,i.jsx)(T,{})})})}},87548:(e,t,n)=>{"use strict";n.d(t,{Fw:()=>d,Nj:()=>h,dB:()=>u,yk:()=>c});var i=n(67203),r=n(49797),a=n(18479),o=n(29338),s=n(79911),l=n(68571);function c(e,t){let n=(0,i.useContext)(l.reactThreeContext);return(0,a.useEffects)(async function*(t,i){if(e){let t=e(n,i);if(t&&"function"==typeof t.next)do{let{value:e,done:n}=await t.next();if(n)break;yield e}while(i.mounted)}},null!=t?t:"always"),n}function d(e,t){let n=c(async function*(t,n){if(t.type===o.s.WebGL&&e){let i=e(t,n);if(i&&"function"==typeof i.next)for(;;){let{value:e,done:t}=await i.next();if(t)break;yield e}}},t);return n.type===o.s.WebGL?n:null}function u(e,t,n){let a=(0,i.useMemo)(()=>new r.YJl,[]);return a.name=e,c(async function*(e,n){if(e.scene.add(a),yield()=>{a.clear(),a.removeFromParent()},t){let i=t(a,e,n);if(i&&"function"==typeof i.next)do{let{value:e,done:t}=await i.next();if(t)break;yield e}while(n.mounted)}},n),a}function h(e){c(async function*(t){let{value:n,args:i=[],hidden:a}=e;if(!n)return;let o="function"==typeof n&&n.prototype&&r.B69.prototype.isPrototypeOf(n.prototype)?new n(...i):n;for(let n of((0,s.mj)(o,{parent:t.scene,...e.transform}),a&&(o.visible=!1),(0,s.$z)(o,{includeSelf:!0})))if("onInitialize"in n){let e=n.onInitialize(t);if(e&&"function"==typeof e.next)for(;;){let{value:t,done:n}=await e.next();if(n)break;yield t}}yield()=>{for(let t of(o.removeFromParent(),(0,s.$z)(o,{includeSelf:!0})))if("onDestroy"in t){var e;null==(e=t.onDestroy)||e.call(t)}}},"always")}},88452:(e,t,n)=>{"use strict";n.d(t,{Art:()=>O});var i=n(70691),r=n(99332),a=n(21667),o=n(18479),s=n(79285),l=n(67235),c=n(85795),d=n(36508),u=n(32137),h=n(30158),f=n(49797),p=n(99613),m=n(64416),v=n(27491),g=n(27146),x=n(28334),w=n(24223),y=n(29717),b=n(71895),P=n(22899);function F(){let{ref:e}=(0,o.useLayoutEffects)(function*(e){let t=function(e){let{width:t=window.innerWidth,height:n=window.innerHeight,pixelRatio:i=window.devicePixelRatio}=e;i=1;let r=new h.WebGLRenderer({antialias:!0});r.setSize(t,n),r.setPixelRatio(i);let a=new f.ubm(75,t/n,.1,1e3);a.position.z=4.7,a.near=a.position.z-2.4,a.far=a.position.z+1,a.updateProjectionMatrix();let o=new f.Z58,s=new f.YJl;o.add(s);let c=new f.UPV(2,1.02,1024,512),u=new f.UPV(2,.9,1024,512);u.computeBoundingSphere(),u.computeBoundingBox();let F=new f.eaF(c,new f.V9B({color:0xffff00,side:f.$EB}));s.add(F);let C=new f.eaF(new f.UPV(2,.25,1024,512),new f.V9B({color:0xff00ff,side:f.$EB}));F.add(C);let M=new f.eaF(new f.UPV(2,.35,1024,512),new f.V9B({color:0xff00ff,side:f.$EB}));F.add(M);let S={camera:a,knotWrapper:s,knot:F,knotGeometry1:c,knotGeometry2:u},D=new f.nWS(t*i,n*i,{depthBuffer:!0,depthTexture:new f.VCu(t*i,n*i,f.cHt)});function E(e){let{r:t,g:n,b:i}=new f.Q1f(e);return"vec3(".concat(t.toFixed(3),", ").concat(n.toFixed(3),", ").concat(i.toFixed(3),")")}let A=new f.BKk({uniforms:{depthTexture:{value:D.depthTexture},cameraNear:{value:a.near},cameraFar:{value:a.far}},vertexShader:"\n      varying vec2 vUv;\n  \n      void main() {\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n      }\n    ",fragmentShader:"\n      ".concat(b.D,"\n      ").concat(P.I,"\n  \n      vec3[] COLORS = vec3[](\n        aliceblue,\n        ").concat(E("#471864"),",\n        aqua,\n        aquamarine,\n        ").concat(E("#c8d50d"),"\n      );\n      int COLORS_COUNT = 5;\n  \n      uniform sampler2D depthTexture;\n      uniform float cameraNear;\n      uniform float cameraFar;\n      varying vec2 vUv;\n  \n      float lines(float x) {\n        // Inside your fragment shader\n        float lineWidth = 0.03; // Adjust line width to what you need\n        float edgeSmoothness = 0.01; // Controls the smooth transition around the line edge\n  \n        // Get the position in the UV space (assuming you're using UV coordinates)\n  \n  \n        // Calculate the fract values to simulate lines\n        float linePattern = 1.0 - fract(x * 20.0); // 10.0 determines the spacing of the lines\n  \n        // Use smoothstep to soften the edge of the line\n        float line = smoothstep(lineWidth - edgeSmoothness, lineWidth + edgeSmoothness, linePattern);\n  \n        return line;\n      }\n  \n      vec3 removeGamma(vec3 color) {\n        return pow(color, vec3(2.2));  // Linearize color\n      }\n  \n      vec3 applyGamma(vec3 color) {\n        return pow(color, vec3(1.0 / 2.2));  // Apply gamma\n      }\n  \n      float linearizeDepth(float depth) {\n        float z = depth * 2.0 - 1.0; // Back to NDC\n        return (2.0 * cameraNear * cameraFar) / (cameraFar + cameraNear - z * (cameraFar - cameraNear));\n      }\n  \n      void main() {\n        float depth = texture2D(depthTexture, vUv).r;\n        float linearDepth = linearizeDepth(depth);\n        // gl_FragColor = vec4(vec3(linearDepth), 1.0);\n        // gl_FragColor = vec4(vec3(depth), 1.0);\n        // gl_FragColor = vec4(vUv, 1.0, 1.0);\n  \n        float x = 1.0 - depth;\n        x *= float(COLORS_COUNT);\n        float f = 1.0 - fract(x);\n        int i = int(floor(x));\n        vec3 color1 = COLORS[i];\n        vec3 color2 = COLORS[(i + COLORS_COUNT - 1) % COLORS_COUNT];\n  \n        vec3 color = mix(color1, color2, easeInOut4(f));\n        // color *= mix(0.8, 1.1, f * f * f);\n  \n        color = 1.0 - color;\n  \n        gl_FragColor.a = 1.0;\n        gl_FragColor.rgb = color;\n        // gl_FragColor.rgb *= lines(depth);\n      }\n    ")}),T=new f.bdM(2,2),B=new f.eaF(T,A),z=new f.qUd(-1,1,1,-1,0,1),j=new p.s(r),k=new v.A(B,z);j.addPass(k);let R=new g.p(x.o);R.material.uniforms.resolution.value.set(1/t,1/n),j.addPass(R);let O=new m.X;j.addPass(O);let I=d.Rv.current();function N(){r.dispose(),r.domElement.remove(),D.dispose(),j.dispose(),I.destroy()}return I.set({activeDuration:60}),I.onTick(e=>{y.X5.core.updateInstances(e.deltaTime),r.setRenderTarget(D),r.render(o,a),r.setRenderTarget(null),j.render()}),{renderer:r,scene:o,camera:a,artParts:S,resize:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.devicePixelRatio;r.setSize(e,t),r.setPixelRatio(n),a.aspect=e/t,a.updateProjectionMatrix(),D.setSize(e*n,t*n),j.setSize(e,t),j.setPixelRatio(n),R.material.uniforms.resolution.value.set(1/e,1/t)},init:function*(){yield(0,w.O)(I.requestActivation),yield N,yield l.Q.on("REQUIRE:ART_PARTS",e=>{e.payloadAssign(S)})},destroy:N}}({width:e.clientWidth,height:e.clientHeight});yield*t.init(),e.appendChild(t.renderer.domElement),yield(0,a.G)(e,{onSize:e=>{t.resize(e.size.x,e.size.y)}}),yield()=>t.renderer.domElement.remove()},[]);return(0,i.jsx)("div",{ref:e,className:"absolute inset-0"})}var C=n(17099),M=n(67203);let S=["#452E00","#F8FEF0","#FF0000","#BC0172","#AE9DFF"];var D=function(e){return e.Circle="circle",e.Rectangle="rectangle",e}({});function E(){return{lineShapeObs:new c.Observable("circle")}}function A(){let{ref:e}=(0,o.useLayoutEffects)(function*(e){let t=e.querySelector("circle"),n=new c.ObservableNumber(0);yield n.onPass("through",5,()=>{n.passed("above",5)?(y.X5.during({target:"CallToAction:Fade",duration:1}).onUpdate(t=>{let{progress:n}=t,i=y.X5.ease("out3")(n);e.setAttribute("opacity",i.toFixed(3))}),y.X5.during({target:"CallToAction:Scale",duration:3}).onUpdate(e=>{let{progress:n,complete:i}=e;n=i?1:2*n%1;let r=y.X5.ease("out3")(n),a=Math.sin(r*Math.PI);t.setAttribute("opacity",a.toFixed(3)),t.setAttribute("r",(0,s.lerp)(200,300,r).toFixed(3))})):y.X5.during({target:"CallToAction:Fade",duration:.2}).onUpdate(t=>{let{progress:n}=t,i=y.X5.ease("inOut3")(n);e.setAttribute("opacity",(1-i).toFixed(3))})}),yield(0,r.s)(document.documentElement,{onChange:()=>{n.set(0)},onDown:()=>{n.set(0)}}),yield d.Rv.current().onTick(e=>{n.increment(e.deltaTime),n.passed("above",15)&&n.set(0)})},[]);return(0,i.jsx)("g",{ref:e,children:(0,i.jsx)("circle",{r:150,fill:"none",stroke:"white",strokeWidth:1.5,opacity:0})})}function T(){let e=(0,M.useMemo)(E,[]),{ref:t}=(0,o.useLayoutEffects)(function*(t){let n=t.querySelector("svg"),i=[...n.querySelectorAll("circle")],a=[...n.querySelectorAll("polygon")];yield l.Q.on("REQUIRE:ART_PARTS",t=>{t.payloadAssign(e)});let{lineShapeObs:o}=e;o.onChange({executeImmediately:!0},e=>{"circle"===e?(n.querySelector(".rectangles").setAttribute("style","display: none"),n.querySelector(".circles").removeAttribute("style")):(n.querySelector(".rectangles").removeAttribute("style"),n.querySelector(".circles").setAttribute("style","display: none"))});let u=new c.ObservableNumber(0),h=new c.ObservableNumber(120),p=new f.I9Y,m=i.map(()=>new f.I9Y);yield(0,r.s)(document.documentElement,{onChange:e=>{},onDrag:e=>{let{x:n,y:i}=e.position,r=t.getBoundingClientRect();p.x=(0,s.remap)(n,r.left,r.right,-512,512),p.y=(0,s.remap)(i,r.top,r.bottom,-512,512)},onDown:()=>{u.set(0),h.set(84),p.set(0,0);for(let e=0;e<20;e++)m[e].copy(p)}}),yield d.Rv.current().onTick(e=>{u.increment(e.deltaTime);let t=u.get(),n=120*(t<1),r=t<1?.999:(0,s.remap)(t,1,2,0,.9);h.exponentialGrow(n,[r,.2],e.deltaTime);for(let e=0;e<20;e++){let t=i[e],n=m[e];n.lerp(0===e?p:m[e-1],.1),t.setAttribute("cx",n.x.toString()),t.setAttribute("cy",n.y.toString()),t.setAttribute("stroke-width",h.get().toFixed(3));let r=a[e];r.setAttribute("transform","translate(".concat(n.x,",").concat(n.y,")")),r.setAttribute("stroke-width",h.get().toFixed(3))}})},[20]);return(0,i.jsx)("div",{ref:t,className:"absolute inset-0",children:(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"-512 -512 1024 1024",className:"w-full h-full",children:[(0,i.jsx)("g",{className:"circles",style:{display:e.lineShapeObs.is("circle")?"":"none"},children:Array.from({length:20}).map((e,t)=>(0,i.jsx)("circle",{cx:"0",cy:"0",r:120*(.99*t+.25),fill:"none",stroke:S[(t+1)%S.length],strokeWidth:120},t))}),(0,i.jsx)("g",{className:"rectangles",style:{display:e.lineShapeObs.is("rectangle")?"":"none"},children:Array.from({length:20}).map((e,t)=>{C.c.seed(t+4);let n=(t+.25)*238;return(0,i.jsx)("polygon",{points:function(){let{cx:e=0,cy:t=0,r:n=1,count:i=3,turnOffset:r=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=[];for(let o=0;o<i;o++){let s=(o/i+r)*Math.PI*2,l=e+n*Math.cos(s),c=t+n*Math.sin(s);a.push("".concat(l.toFixed(3),",").concat(c.toFixed(3)))}return a.join(" ")}({count:4,r:n*Math.SQRT1_2}),fill:"none",stroke:C.c.pick(S,null,{indexOffset:1}),strokeWidth:120},t)})}),(0,i.jsx)(A,{})]})})}var B=n(95286),z=n.n(B),j=function(e){return e[e.Static=0]="Static",e[e.Rotating=1]="Rotating",e[e.RotatingCloseUp=2]="RotatingCloseUp",e}(j||{});function k(){return(0,o.useEffects)(function*(){let e=l.Q.send("REQUIRE:ART_PARTS").payload,{camera:t,knotWrapper:n,knot:i,lineShapeObs:a}=e;Object.assign(window,{artParts:e});let o=new c.Observable(0);yield(0,r.s)(document.documentElement,{onDown:e=>{o.set((o.get()+1)%3)}}),o.onChange(t=>{switch(a.set(a.get()===D.Circle?D.Rectangle:D.Circle),t){case 0:i.geometry=e.knotGeometry1;break;case 1:{let t=Math.random()*Math.PI*.4;i.geometry=e.knotGeometry2,i.rotation.x+=t,i.rotation.y+=t,i.rotation.z+=t;break}case 2:i.geometry=e.knotGeometry2}}),yield d.Rv.current().onTick(e=>{switch(o.value){case 0:{i.rotation.x=0,i.rotation.y=0,i.rotation.z+=.033*e.deltaTime;let r=(0,s.sin01)(.05*e.time),a=(0,s.lerp)(.9,1.1,r);n.scale.set(a,a,1),t.position.z=(0,s.lerp)(4.9,4.7,r);break}case 1:i.rotation.x+=.05*e.deltaTime,i.rotation.y+=.05*e.deltaTime,i.rotation.z+=.0166*e.deltaTime,n.scale.set(1.4,1.4,1),t.position.z=4.5;break;case 2:i.rotation.x+=-.05*e.deltaTime,i.rotation.y+=-.05*e.deltaTime,i.rotation.z+=.05*e.deltaTime,n.scale.set(1.8,1.8,2),t.position.z=-1}})},[]),(0,i.jsxs)("div",{className:z().Art,children:[(0,i.jsx)(F,{}),(0,i.jsx)(T,{})]})}function R(){let{ref:e}=(0,o.useLayoutEffects)(function*(e){yield(0,a.G)(document.documentElement,{onSize:t=>{let{size:{x:n,y:i}}=t;!1==n>i?e.style.display="none":e.style.display=""}});let t=new c.ObservableNumber(0);yield d.Rv.current().onTick(n=>{t.increment(n.deltaTime),e.classList.toggle(z().hidden,t.get()>1)}),yield(0,r.s)(document.documentElement,{onDown:()=>{t.set(0)},onChange:()=>{t.set(0)}})},[]);return(0,i.jsx)("div",{ref:e,className:"".concat(z().Caption," pointer-through"),children:(0,i.jsxs)("div",{className:"flex flex-row items-center",children:[(0,i.jsxs)("span",{children:["Press ",(0,i.jsx)("kbd",{style:{color:S[3]},children:"F"})," to toggle fullscreen."]}),(0,i.jsx)("span",{className:z().Github,style:{color:S[2]},children:(0,i.jsx)("a",{href:"https://github.com/jniac/three-xp",children:"Github"})}),(0,i.jsx)("span",{className:z().Close,style:{color:S[4]},onPointerDown:t=>{"A"!==t.target.tagName&&(t.preventDefault(),t.stopPropagation(),e.current.style.display="none")}})]})})}function O(){return(0,i.jsxs)("div",{children:[(0,i.jsx)(u.Q,{children:(0,i.jsx)(k,{})}),(0,i.jsx)("div",{className:"absolute-through",children:(0,i.jsx)(R,{})})]})}},95286:e=>{e.exports={Caption:"style_Caption__FCtWy",hidden:"style_hidden__PEKsD",Github:"style_Github__qs6RR",Close:"style_Close__E3PRZ"}},98839:(e,t,n)=>{"use strict";n.d(t,{l:()=>i.FpsMeter});var i=n(98114)},99332:(e,t,n)=>{"use strict";n.d(t,{m:()=>s,s:()=>A});class i{clone(){let e=Object.create(this);for(let[t,n]of Object.entries(this))e[t]=function e(t){if("object"!=typeof t)return t;if(Array.isArray(t))return t.map(e);switch(t.constructor){case DOMPoint:return DOMPoint.fromPoint(t);case DOMRect:return DOMRect.fromRect(t);case Object:{let n=Object.create(t);for(let i of Object.keys(t))n[i]=e(t[i]);return n}}throw Error("Unsupported value type: ".concat(t.constructor))}(n);return Object.freeze(e)}}class r{get targetElement(){throw Error("Not implemented")}get button(){throw Error("Not implemented")}getLocalPosition(e){let t=this.targetElement.getBoundingClientRect(),{x:n,y:i}=this.position;return null!=e||(e={}),e.x=n-t.x,e.y=i-t.y,e}get localPosition(){return this.getLocalPosition(new DOMPoint)}getRelativeLocalPosition(e){let{x:t,y:n}=this.localPosition,i=this.targetElement.getBoundingClientRect();return null!=e||(e={}),e.x=(t-i.x)/i.width,e.y=(n-i.y)/i.height,e}get relativeLocalPosition(){return this.getRelativeLocalPosition(new DOMPoint)}constructor(){this.position=new DOMPoint}}class a extends r{get targetElement(){let e=this.event.target;if(e instanceof Element)return e;throw Error("targetElement is not an Element")}get button(){return this.event instanceof MouseEvent||this.event instanceof PointerEvent?this.event.button:0}get localPosition(){let e=this.targetElement.getBoundingClientRect(),{x:t,y:n}=this.position;return new DOMPoint(t-e.x,n-e.y)}constructor(e=!1,t=!1,n=new DOMPoint,i=new DOMPoint,r=null){super(),this.entered=e,this.pressed=t,this.downPosition=n,this.upPosition=i,this.event=r}}let o=["onDown","onUp","onChange","onEnter","onLeave"];var s,l=n(36508);!function(e){e[e.Main=0]="Main",e[e.Aux=1]="Aux",e[e.Second=2]="Second",e[e.Fourth=3]="Fourth",e[e.Fifth=4]="Fifth",e[e.DoubleTouch=5]="DoubleTouch",e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right"}(s||(s={}));class c extends r{get button(){return this._button}get targetElement(){return this.downTargetElement}constructor(...e){super(...e),this.direction="horizontal",this.startPosition=new DOMPoint,this.position=new DOMPoint,this.positionOld=new DOMPoint,this.movement=new DOMPoint,this.delta=new DOMPoint,this.deltaTime=1/60,this.shiftKey=!1,this.metaKey=!1,this.altKey=!1,this.ctrlKey=!1,this.touchCount=0,this.downTargetElement=null,this._button=0}}let d={dragDistanceThreshold:10,dragSnapToInitialPosition:!1,dragPreventDefault:!1,dragButton:1<<s.Main,dragEaseFactor:1,dragTickOrder:void 0},u=["onDragStart","onDragStop","onDrag","onVerticalDragStart","onVerticalDragStop","onVerticalDrag","onHorizontalDragStart","onHorizontalDragStop","onHorizontalDrag"],h={},f=["onFocusEnter","onFocusLeave"];class p{}let m=["onDownOutside"];var v=n(6726);let g=["onPressStart","onPressStop","onPressFrame"];class x extends r{get targetElement(){return this.tapTarget}get button(){return this.orignalDownEvent.button}getLocalDownPosition(e){let{x:t,y:n}=this.localPosition;return null!=e||(e={}),e.x=t,e.y=n,e}get localDownPosition(){return this.localPosition}constructor(e,t,n,i,r){super(),this.originalUpEvent=null,this.timestamp=e,this.tapTarget=t,this.downTarget=n,this.downPosition=i,this.orignalDownEvent=r,this.position=i}}let w={maxDistance:10,maxDuration:.3},y=["onTap"];var b=n(79285);class P extends i{constructor(...e){super(...e),this.time=-1,this.rawDeltaTime=-1,this.deltaTime=-1,this.delta=new DOMPoint,this.phase="start",this.event=null}}let F={wheelPreventDefault:!1},C=["onWheel","onWheelStart","onWheelEnd"];class M extends i{constructor(e=0,t=0,n=new DOMPoint,i="start"){super(),this.time=e,this.deltaTime=t,this.delta=n,this.phase=i}}let S={preventDefault:!1,wheelFrameTickOrder:void 0},D=["onWheelFrame","onWheelFrameStart","onWheelFrameEnd"];class E{add(e){if(this.data.length===this.capacity){let e=this.data.shift();this.sum.x-=e.x,this.sum.y-=e.y,this.sum.z-=e.z}this.data.push(e),this.sum.x+=e.x,this.sum.y+=e.y,this.sum.z+=e.z;let t=this.data.length;this.average.x=this.sum.x/t,this.average.y=this.sum.y/t,this.average.z=this.sum.z/t}constructor(e=5){this.data=[],this.sum=new DOMPoint,this.average=new DOMPoint,this.capacity=e}}function A(e,t){let n=[];for(let i of"length"in e?Array.from(e):[e])(function(e){return o.some(t=>t in e)})(t)&&n.push(function(e,t){let n={touchStarted:!1,touchTimestamp:-1};function i(){return n.touchStarted||n.touchTimestamp>Date.now()-1e3}let r=new a,o=(e,n,i)=>{var a;r.pressed=!0,r.downPosition.x=n,r.downPosition.y=i,l(e,n,i),null==(a=t.onDown)||a.call(t,r)},s=(e,n,i)=>{var a;r.pressed=!1,r.upPosition.x=n,r.upPosition.y=i,l(e,n,i),null==(a=t.onUp)||a.call(t,r),r.position.x=-1,r.position.y=-1},l=(e,n,i)=>{if(r.position.x!==n||r.position.y!==i){var a;r.event=e,r.position.x=n,r.position.y=i,null==(a=t.onChange)||a.call(t,r)}},c=e=>{!1===i()&&o(e,e.clientX,e.clientY)},d=e=>{!1===i()&&s(e,e.clientX,e.clientY)},u=e=>{!1===i()&&l(e,e.clientX,e.clientY)},h=()=>{document.body.addEventListener("mouseup",p),m()},f=()=>{v()},p=()=>{r.pressed=!1,v(),document.documentElement.removeEventListener("mouseup",p)},m=()=>{if(!1===r.entered){var e;r.entered=!0,null==(e=t.onEnter)||e.call(t,r)}},v=()=>{if(r.entered&&!1===r.pressed){var e;r.entered=!1,null==(e=t.onLeave)||e.call(t,r)}},g=e=>{1===e.touches.length&&(n.touchStarted=!0,n.touchTimestamp=Date.now(),o(e,e.touches[0].clientX,e.touches[0].clientY))},x=e=>{0===e.touches.length&&(n.touchStarted=!1,n.touchTimestamp=Date.now(),s(e,e.changedTouches[0].clientX,e.changedTouches[0].clientY))},w=e=>{1===e.touches.length&&(n.touchTimestamp=Date.now(),l(e,e.touches[0].clientX,e.touches[0].clientY))};return e.addEventListener("mouseover",h),e.addEventListener("mouseout",f),e.addEventListener("mousedown",c),e.addEventListener("mouseup",d),e.addEventListener("mousemove",u),e.addEventListener("touchstart",g,{passive:!1}),e.addEventListener("touchend",x,{passive:!1}),e.addEventListener("touchmove",w,{passive:!1}),()=>{e.removeEventListener("mouseover",h),e.removeEventListener("mouseout",f),e.removeEventListener("mousedown",c),e.removeEventListener("mouseup",d),e.removeEventListener("mousemove",u),e.removeEventListener("touchstart",g),e.removeEventListener("touchend",x),e.removeEventListener("touchmove",w),document.body.removeEventListener("mouseup",p)}}(i,t)),function(e){return u.some(t=>t in e)}(t)&&n.push(function(e,t){let{dragDistanceThreshold:n,dragSnapToInitialPosition:i,dragPreventDefault:r,dragButton:a,dragEaseFactor:o,dragTickOrder:u,onDragStart:h,onDragStop:f,onDrag:p,onVerticalDragStart:m,onVerticalDragStop:v,onVerticalDrag:g,onHorizontalDragStart:x,onHorizontalDragStop:w,onHorizontalDrag:y}={...d,...t},b=!1,P=!1,F=!1,C=-1,M=new DOMPoint(0,0),S=new c,{startPosition:D,position:E,positionOld:A,movement:T,delta:B}=S,z=()=>{C=void 0===u?window.requestAnimationFrame(_):l.Rv.current().requestAnimationFrame(_,{order:u})},j=()=>{void 0===u?window.cancelAnimationFrame(C):l.Rv.current().cancelAnimationFrame(C)},k=(e,t)=>{z(),b=!0,D.x=e,D.y=t,M.x=e,M.y=t},R=()=>{switch(P=!0,B.x=0,B.y=0,T.x=0,T.y=0,E.x=D.x,E.y=D.y,null==h||h(S),S.direction){case"horizontal":null==x||x(S);break;case"vertical":null==m||m(S)}},O=()=>{switch(P=!1,null==f||f(S),S.direction){case"horizontal":null==w||w(S);break;case"vertical":null==v||v(S)}},I=(e,t)=>{A.x=E.x,A.y=E.y,E.x+=(e-E.x)*o,E.y+=(t-E.y)*o,B.x=E.x-A.x,B.y=E.y-A.y,T.x=E.x-D.x,T.y=E.y-D.y},N=()=>{switch(i&&!1===F?I(D.x,D.y):I(M.x,M.y),null==p||p(S),S.direction){case"horizontal":null==y||y(S);break;case"vertical":null==g||g(S)}},L=0,_=e=>{if(S.deltaTime=(e-L)/1e3,L=e,b){z();let e=D.x-M.x,t=D.y-M.y;F=Math.sqrt(e*e+t*t)>n,!1===P&&F&&(S.direction=Math.abs(e/t)>=1?"horizontal":"vertical",R()),P&&N()}},U=e=>{S._button=e.button,S.downTargetElement=e.target,a&1<<e.button&&(window.addEventListener("mousemove",q,{passive:!1}),window.addEventListener("mouseup",W),k(e.clientX,e.clientY))},q=e=>{M.x=e.clientX,M.y=e.clientY,S.shiftKey=e.shiftKey,S.metaKey=e.metaKey,S.altKey=e.altKey,S.ctrlKey=e.ctrlKey,P&&r&&e.preventDefault()},W=()=>{window.removeEventListener("mousemove",q),window.addEventListener("mouseup",W),P&&O(),b=!1},V=null,G=e=>{if(S.touchCount=e.touches.length,a&1<<s.Main){let t=e.changedTouches[0];null===V&&(V=t,window.addEventListener("touchmove",Y,{passive:!1}),window.addEventListener("touchend",X),z(),b=!0,S.downTargetElement=e.target,B.x=0,B.y=0,T.x=0,T.y=0,D.x=t.clientX,D.y=t.clientY,E.x=t.clientX,E.y=t.clientY,M.x=t.clientX,M.y=t.clientY)}},Y=e=>{let t=e.changedTouches[0];S.touchCount=e.touches.length,t.identifier===V.identifier&&(M.x=t.clientX,M.y=t.clientY,S.shiftKey=e.shiftKey,S.metaKey=e.metaKey,S.altKey=e.altKey,S.ctrlKey=e.ctrlKey,P&&r&&e.preventDefault())},X=e=>{let t=e.changedTouches[0];S.touchCount=e.touches.length,t.identifier===V.identifier&&(window.removeEventListener("touchmove",Y),window.removeEventListener("touchend",X),P&&O(),b=!1,V=null)};return e.addEventListener("mousedown",U,{passive:!1}),e.addEventListener("touchstart",G,{passive:!1}),()=>{e.removeEventListener("mousedown",U),e.removeEventListener("touchstart",G),window.removeEventListener("mousemove",q),window.removeEventListener("mouseup",W),window.removeEventListener("touchmove",Y),window.removeEventListener("touchend",X),j()}}(i,t)),function(e){return f.some(t=>t in e)}(t)&&n.push(function(e,t){let{onFocusEnter:n,onFocusLeave:i}={...h,...t},r=()=>{e.addEventListener("blur",a),null==n||n({})},a=()=>{e.removeEventListener("blur",a),null==i||i({})};return e.addEventListener("focus",r),()=>{e.removeEventListener("focus",r),e.removeEventListener("blur",a)}}(i,t)),function(e){return g.some(t=>t in e)}(t)&&n.push(function(e,t){let{onPressStart:n,onPressStop:i,onPressFrame:r}=t,a=!1,o=-1,s=new DOMPoint(0,0),l=new DOMPoint(0,0),c=new DOMPoint(0,0),d={position:l,delta:c,target:e,targetRectOnDown:new v.M_,get pointerIsInside(){return d.targetRectOnDown.contains(s.x,s.y)}},u=()=>{a&&(o=window.requestAnimationFrame(u),c.x=s.x-l.x,c.y=s.y-l.y,l.x+=c.x,l.y+=c.y,null==r||r(d))},h=t=>{window.addEventListener("mousemove",f),window.addEventListener("mouseup",p),o=window.requestAnimationFrame(u),a=!0,d.targetRectOnDown.copy(e.getBoundingClientRect()),c.x=0,c.y=0,l.x=t.clientX,l.y=t.clientY,s.x=t.clientX,s.y=t.clientY,null==n||n(d)},f=e=>{s.x=e.clientX,s.y=e.clientY},p=()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",p),a=!1,null==i||i(d)},m=t=>{t.preventDefault();let i=t.touches[0];i&&(window.addEventListener("touchmove",g),window.addEventListener("touchend",x),o=window.requestAnimationFrame(u),a=!0,d.targetRectOnDown.copy(e.getBoundingClientRect()),c.x=0,c.y=0,l.x=i.clientX,l.y=i.clientY,s.x=i.clientX,s.y=i.clientY,null==n||n(d))},g=e=>{let t=e.touches[0];t&&(s.x=t.clientX,s.y=t.clientY)},x=e=>{window.removeEventListener("touchmove",g),window.removeEventListener("touchend",x),a=!1,null==i||i(d)};return e.addEventListener("mousedown",h,{passive:!1}),e.addEventListener("touchstart",m,{passive:!1}),()=>{e.removeEventListener("mousedown",h),e.removeEventListener("touchstart",m),window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",p),window.removeEventListener("touchmove",g),window.removeEventListener("touchend",x),window.cancelAnimationFrame(o)}}(i,t)),function(e){return y.some(t=>t in e)}(t)&&n.push(function(e,t){let{maxDistance:n,maxDuration:i,onTap:r}={...w,...t},a=null,o=t=>{a=new x(Date.now(),e,t.target,new DOMPoint(t.clientX,t.clientY),t),window.addEventListener("pointerup",s)},s=e=>{window.removeEventListener("pointerup",s),function(e,t){if(!e)return!1;let n=t;for(;n;){if(n===e)return!0;n=n.parentElement}return!1}(a.downTarget,e.target)&&(Date.now()-a.timestamp)/1e3<=i&&Math.hypot(e.clientX-a.downPosition.x,e.clientY-a.downPosition.y)<=n&&(a.originalUpEvent=e,window.requestAnimationFrame(()=>{null==r||r(a)}))};return e.addEventListener("pointerdown",o),()=>{e.removeEventListener("pointerdown",o),window.removeEventListener("pointerup",s)}}(i,t)),function(e){return C.some(t=>t in e)}(t)&&n.push(function(e,t){let{wheelPreventDefault:n,onWheel:i,onWheelStart:r,onWheelEnd:a}={...F,...t},o={start:!1,timeout:-1,time:-1},s=new P,l=e=>{n&&e.preventDefault();let t=!1===o.start?"start":"continue",l=e.timeStamp/1e3,c="start"===t?1/60:l-o.time;o.time=l,s.event=e,s.phase=t,s.time=l;let d=function(e){switch(e){default:case 0:return 1;case 1:return 16;case 2:return 1e3}}(e.deltaMode);s.delta.x=e.deltaX*d,s.delta.y=e.deltaY*d,s.delta.z=e.deltaZ*d;let u=(0,b.clamp)(c,1/240,1/30);s.rawDeltaTime=c,s.deltaTime=u,"start"===t&&(o.start=!0,null==r||r(s)),null==i||i(s),window.clearTimeout(o.timeout),o.timeout=window.setTimeout(()=>{o.start=!1,s.phase="end",s.deltaTime=.1,s.time=l+.1,s.delta.x=0,s.delta.y=0,s.delta.z=0,null==a||a(s)},100)};return e.addEventListener("wheel",l,{passive:!n}),()=>{e.removeEventListener("wheel",l)}}(i,t)),function(e){return D.some(t=>t in e)}(t)&&n.push(function(e,t){let{preventDefault:n,wheelFrameTickOrder:i,onWheelFrame:r,onWheelFrameStart:a,onWheelFrameEnd:o}={...S,...t},s={msOld:0,frame:0,frameID:0,deltaTime:0,time:0,position:new DOMPoint,positionOld:new DOMPoint,eventCount:0,eventCountOld:0,eventFrame:0,eventMsOld:0,eventPosition:new DOMPoint,eventVelocities:new E(5),eventVelocity:new DOMPoint},c=e=>{n&&e.preventDefault();let t=0===s.eventCount?1/60:(e.timeStamp-s.eventMsOld)/1e3;0===s.eventCount&&d(),s.eventPosition.x+=e.deltaX,s.eventPosition.y+=e.deltaY,s.eventPosition.z+=e.deltaZ;let i=new DOMPoint;i.x=e.deltaX/t,i.y=e.deltaY/t,i.z=e.deltaZ/t,s.eventVelocities.add(i),s.eventCount++,s.eventFrame=s.frame,s.eventMsOld=e.timeStamp},d=()=>{u(),s.frameID=void 0===i?window.requestAnimationFrame(h):l.Rv.current().requestAnimationFrame(h,{order:i})},u=()=>{void 0===i?window.cancelAnimationFrame(s.frameID):l.Rv.current().cancelAnimationFrame(s.frameID)},h=e=>{let t=0===s.eventCountOld?"start":s.frame===s.eventFrame+8?"end":"continue";console.log(t);let n=(e-s.msOld)/1e3,i="start"===t?1/60:(0,b.clamp)(n,1/240,1/30);if(s.deltaTime=i,s.msOld=e,"end"!==t?d():u(),s.time+=i,"end"===t)s.position.x=s.eventPosition.x,s.position.y=s.eventPosition.y,s.position.z=s.eventPosition.z;else{let{x:e,y:t,z:n}=s.eventVelocities.average;s.position.x+=e*i*8,s.position.y+=t*i*8,s.position.z+=n*i*8;let r=10000000000000017e-46**i;s.position.x+=(s.eventPosition.x-s.position.x)*r,s.position.y+=(s.eventPosition.y-s.position.y)*r,s.position.z+=(s.eventPosition.z-s.position.z)*r}let l=new DOMPoint;l.x=s.position.x-s.positionOld.x,l.y=s.position.y-s.positionOld.y,l.z=s.position.z-s.positionOld.z;let c=new M(s.time,i,l,t);"start"===t&&(null==a||a(c)),null==r||r(c),"end"!==t?(s.eventCountOld=s.eventCount,s.frame++,s.positionOld.x=s.position.x,s.positionOld.y=s.position.y,s.positionOld.z=s.position.z):(s.eventCount=0,s.eventCountOld=0,s.frame=0,null==o||o(c))};return e.addEventListener("wheel",c,{passive:!n}),()=>{e.removeEventListener("wheel",c),u()}}(i,t)),function(e){return m.some(t=>t in e)}(t)&&n.push(function(e,t){let n=n=>{if(n.target!==e&&!1===e.contains(n.target)&&t.onDownOutside){let e=new p;t.onDownOutside(e)}};return document.body.addEventListener("pointerdown",n,{passive:!0}),()=>{document.body.removeEventListener("pointerdown",n)}}(i,t));return()=>{for(let e of n)e()}}}},e=>{var t=t=>e(e.s=t);e.O(0,[9454,9510,2193,2878,9459,9687,5611,7190,6564,4272,4189,7962,9635,8921,7953,4512,7775,7436,7706,9294,5438,7833,9558,9901,146,6726,3445,3414,9717,1763,7558,5033,5672,3470,8610,2595,1319,6852,7358],()=>t(13580)),_N_E=e.O()}]);