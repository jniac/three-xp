(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5385],{1029:(n,t,e)=>{"use strict";e.d(t,{N:()=>r});let a={vecX:["float","vec2","vec3","vec4"]},r=(n,t)=>{let e=[],r=Array.isArray(n)?n:[n].map(n=>n in a?a[n]:n).flat();if("function"==typeof t)for(let n of r)e.push(t(n).replaceAll(/\bT\b/g,n));else for(let n of r)e.push(t.replaceAll(/\bT\b/g,n));return e.join("\n")}},8144:(n,t,e)=>{"use strict";e.d(t,{H:()=>o});var a=e(65927),r=e(1029);let o="\n".concat(a.S,"\n\n#ifndef GLSL_UTILS\n#define GLSL_UTILS\n\nfloat sin01(float x) {\n  return 0.5 + 0.5 * sin(x * 6.283185307179586);\n}\n\nvec2 scaleAround(vec2 p, vec2 c, float s) {\n  return c + (p - c) / s;\n}\n\n// Same as mix, but clamped.\n").concat((0,r.N)("vecX","\n  T lerp(in T a, in T b, in float x) {\n    return mix(a, b, clamp01(x));\n  }\n"),"\n\nfloat inverseLerpUnclamped(in float a, in float b, float x) {\n  return (x - a) / (b - a);\n}\n\nfloat inverseLerp(in float a, in float b, float x) {\n  return clamp01((x - a) / (b - a));\n}\n\nfloat remap(in float x, in float a, in float b, in float c, in float d) {\n  return c + (d - c) * inverseLerp(a, b, x);\n}\n\n// Remap from [-1, 1] to [0, 1]\nfloat remap1101(in float x) {\n  return clamp01(0.5 + 0.5 * x);\n}\n\n").concat((0,r.N)("vecX","\n  T oneMinus(in T x) {\n    return 1.0 - x;\n  }\n"),"\n\n// Returns x^p, but handles negative x values correctly.\nfloat spow(in float x, in float p) {\n  return x >= 0.0 ? pow(x, p) : -pow(-x, p);\n}\n\nfloat threshold(in float x, in float thresholdValue) {\n  return x < thresholdValue ? 0. : 1.;\n}\n\nfloat threshold(in float x, in float thresholdValue, in float width) {\n  return width < 1e-9 \n    ? (x < thresholdValue ? 0. : 1.)\n    : clamp01((x - thresholdValue + width * .5) / width);\n}\n\nmat3 extractRotation(mat4 matrix) {\n  return mat3(matrix[0].xyz, matrix[1].xyz, matrix[2].xyz);\n}\n\nvec2 rotate(vec2 p, float a) {\n  float c = cos(a);\n  float s = sin(a);\n  float x = c * p.x + s * p.y;\n  float y = -s * p.x + c * p.y;\n  return vec2(x, y);\n}\n\nvec2 rotateAround(vec2 p, float a, vec2 c) {\n  return c + rotate(p - c, a);\n}\n\nvec2 rotateScaleAround(vec2 p, float a, float s, vec2 c) {\n  return c + rotate((p - c) / s, a);\n}\n\nfloat positiveModulo(float x) {\n  x = mod(x, 1.0);\n  return x < 0.0 ? x + 1.0 : x;\n}\n\n// Modulo that keeps the result in the range [0, modulo]\nfloat positiveModulo(float x, float modulo) {\n  x = mod(x, modulo);\n  return x < 0.0 ? x + modulo : x;\n}\n\n// Modulo that keeps the result in the range [-m/2, m/2]\nfloat middleModulo(float x, float modulo) {\n  x = mod(x, modulo);\n  return x < -modulo / 2.0 ? x + modulo : x > modulo / 2.0 ? x - modulo : x;\n}\n\n// Limit a value to a maximum that the function tends to reach when x -> âˆž\n// https://www.desmos.com/calculator/0vewkbnscu\nfloat limited(float x, float maxValue) {\n  return x <= 0.0 ? x : maxValue * x / (maxValue + x);\n}\n\n// https://www.desmos.com/calculator/0vewkbnscu\nfloat limited(float x, float minValue, float maxValue) {\n  float d = maxValue - minValue;\n  float xd = x - minValue;\n  return x <= minValue ? x : minValue + d * xd / (d + xd);\n}\n\nfloat sqLength(in vec2 p) {\n  return p.x * p.x + p.y * p.y;\n}\n\nfloat sqLength(in vec3 p) {\n  return p.x * p.x + p.y * p.y + p.z * p.z;\n}\n\nfloat pcurve(float x, float a, float b) {\n  float k = pow(a + b, a + b) / (pow(a, a) * pow(b, b));\n  return k * pow(x, a) * pow(1.0 - x, b);\n}\n\nfloat hash(float p) {\n  return fract(sin(p * 12.9898) * 43758.5453);\n}\n\nfloat hash(vec2 p) {\n  return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nfloat hash(vec3 p) {\n  return fract(sin(dot(p, vec3(12.9898, 78.233, 45.164))) * 43758.5453);\n}\n\nfloat hash(vec4 p) {\n  return fract(sin(dot(p, vec4(12.9898, 78.233, 45.164, 94.673))) * 43758.5453);\n}\n\nvec2 hash2(float p) {\n  return vec2(hash(p), hash(p + 1.0));\n}\n\nvec2 hash2(vec2 p) {\n  return vec2(hash(p.x), hash(p.y));\n}\n\nvec2 hash2(vec3 p) {\n  return vec2(hash(p.xy), hash(p.yz));\n}\n\nvec2 hash2(vec4 p) {\n  return vec2(hash(p.xyz), hash(p.yzw));\n}\n\nvec3 hash3(float p) {\n  return vec3(hash2(p),  hash(p + 2.0));\n}\n\nvec3 hash3(vec2 p) {\n  return vec3(hash2(p), hash(p));\n}\n\nvec3 hash3(vec3 p) {\n  return vec3(hash(p.x), hash(p.y), hash(p.z));\n}\n\nvec3 hash3(vec4 p) {\n  return vec3(hash(p.xy), hash(p.yz), hash(p.zw));\n}\n\nfloat hash_alt(float p) {\n  return fract(sin(p * 127.1) * 311.7);\n}\n\nfloat hash_alt(vec2 p) {\n  return fract(sin(dot(p, vec2(127.1, 311.7))) * 269.5);\n}\n\nfloat hash_alt(vec3 p) {\n  return fract(sin(dot(p, vec3(127.1, 311.7, 74.7))) * 269.5);\n}\n\nfloat hash_alt(vec4 p) {\n  return fract(sin(dot(p, vec4(127.1, 311.7, 74.7, 113.5))) * 269.5);\n}\n\n").concat((0,r.N)("vecX","\n  T min3(in T a, in T b, in T c) {\n    return min(min(a, b), c);\n  }\n"),"\n\n").concat((0,r.N)("vecX","\n  T min4(in T a, in T b, in T c, in T d) {\n    return min(min(a, b), min(c, d));\n  }\n"),"\n\n#endif // GLSL_UTILS\n")},22899:(n,t,e)=>{"use strict";e.d(t,{I:()=>o});var a=e(65927);let r=["linear"];for(let n=1;n<=10;n++)r.push("easeIn".concat(n)),r.push("easeOut".concat(n)),r.push("easeInOut".concat(n)),r.push("easeOutIn".concat(n));let o="\n#ifndef GLSL_EASING\n#define GLSL_EASING\n\n".concat(a.S,"\n\nfloat easePow1(float x) {\n  return x;\n}\n\nfloat easePow2(float x) {\n  return x * x;\n}\n\nfloat easePow3(float x) {\n  return x * x * x;\n}\n\nfloat easePow4(float x) {\n  x *= x;\n  return x *= x;\n}\n\nfloat easePow5(float x) {\n  float x0 = x;\n  x *= x;\n  x *= x;\n  return x0 * x;\n}\n\nfloat easePow6(float x) {\n  x *= x * x;\n  return x *= x;\n}\n\nfloat easePow7(float x) {\n  float x0 = x;\n  x *= x * x;\n  x *= x;\n  return x0 * x;\n}\n\nfloat easePow8(float x) {\n  x *= x;\n  x *= x;\n  return x *= x;\n}\n\nfloat easePow9(float x) {\n  x *= x * x;\n  return x *= x * x;\n}\n\nfloat easePow10(float x) {\n  float x0 = x;\n  x *= x * x;\n  x *= x * x;\n  return x0 * x;\n}\n\nfloat linear(float x) {\n  return clamp01(x);\n}\n\n").concat(Array.from({length:10},(n,t)=>{let e=t+1;return"\n\n  float easeIn".concat(e," (float x) {\n    return easePow").concat(e,"(clamp01(x));\n  }\n  float easeOut").concat(e," (float x) {\n    return 1.0 - easePow").concat(e,"(clamp01(1.0 - x));\n  }\n  float easeInOut").concat(e," (float x) {\n    return x < 0.5 \n      ? 0.5 * easePow").concat(e,"(2.0 * x) \n      : 1.0 - 0.5 * easePow").concat(e,"(2.0 * (1.0 - x));\n  }\n  float easeOutIn").concat(e," (float x) {\n    return x < 0.5\n      ? 0.5 * (1.0 - easePow").concat(e,"(1.0 - x * 2.0))\n      : 1.0 - 0.5 * (1.0 - easePow").concat(e,"(2.0 * x - 1.0));\n  }\n\n").trim()}).join("\n\n"),"\n\n\n// https://www.desmos.com/calculator/mqou4lf9zc?lang=fr\nfloat easeInOut(float x, float p, float i) {\n  return  x <= 0.0 ? 0.0 :\n          x >= 1.0 ? 1.0 :\n          x <= i ? 1.0 / pow(i, p - 1.0) * pow(x, p) :\n          1.0 - 1.0 / pow(1.0 - i, p - 1.0) * pow(1.0 - x, p);\n}\n\n// https://www.desmos.com/calculator/nrjlezusdv\nfloat easeInThenOut(float x, float p) {\n  return 1.0 - pow(abs(2.0 * x - 1.0), p);\n}\n\n#endif\n")},30851:(n,t,e)=>{"use strict";e.d(t,{ClientPage:()=>d});var a=e(70691),r=e(53097),o=e(49797),l=e(7147),c=e(3293),f=e(79911),s=e(55227),i=e(8144),u=e(80446),x=e(36508),h=e(38921);class p extends o.Z58{constructor(){super(),this.position.set(0,0,-10),u.n.setRandom("parkmiller",67890);let n=[];for(let t=0;t<300;t++){let t=1.5*u.n.float(.5,2),e=new o.qU7(.25,1,8,24).scale(t,t,t).rotateX(u.n.random()*Math.PI).rotateY(u.n.random()*Math.PI).rotateZ(u.n.random()*Math.PI).translate((u.n.random()-.5)*10,(u.n.random()-.5)*10,(u.n.random()**4-.5)*10);n.push(e)}let t=h.pP(n),e=[t,t.clone().translate(10,0,0),t.clone().translate(10,10,0),t.clone().translate(0,10,0),t.clone().translate(-10,10,0),t.clone().translate(-10,0,0),t.clone().translate(-10,-10,0),t.clone().translate(0,-10,0),t.clone().translate(10,-10,0)],a=h.pP(e);for(let n of(t.computeBoundingBox(),t.dispose(),e))n.dispose();let r=new o.V9B,s={uSize:{value:t.boundingBox.getSize(new o.Pq0)},uTime:x.Rv.get("three").uTime};r.onBeforeCompile=n=>l.bI.with(n).uniforms(s).createVarying("sf_vObjectPosition").fragment.top(i.H).fragment.after("map_fragment","\n        float d = 0.5 + sf_vObjectPosition.z / uSize.z;\n        diffuseColor.rgb = vec3(d);\n        // diffuseColor.rgb = mod(uTime * 0.3, 1.0) > d ? ".concat((0,l.eR)("#fc0")," : ").concat((0,l.eR)("#0cf"),";\n      "));let p=(0,f.mj)(new o.ZLX(a,r,1),this);u.n.seed(56789);for(let n=0;n<1;n++){let t=0===n?0:u.n.float(2*Math.PI);p.setMatrixAt(n,(0,c.w)({z:-10*n,rotationZ:t}))}}}function m(){return(0,r.Fw)(function*(n){n.pipeline.basicPasses.fxaa.enabled=!1;let t=new p,e=new o.nWS(2048,2048,{type:o.ix0,format:o.VT0,generateMipmaps:!0}),a=new o.qUd(-5,5,5,-5,0,20);n.renderer.setRenderTarget(e),n.renderer.render(t,a),n.renderer.setRenderTarget(null);let r=new o.V9B({map:e.texture}),c={uTime:x.Rv.get("three").uTime};r.onBeforeCompile=n=>l.bI.with(n).defines("USE_UV").uniforms(c).fragment.top(s.M).fragment.replace("map_fragment","\n        vec2 uv = vUv;\n        uv.y += uTime * 0.05;\n        uv = mod(uv, 1.0);\n        vec4 texelColor = texture2D(map, uv);\n        // texelColor.rgb = pow(texelColor.rgb, vec3(1.0 / 2.2));\n        float alpha = clamp(mod(texelColor.r + uTime * 0.1, 1.0) * 2.0, 0.0, 1.0);\n        alpha = cos(alpha * 3.14159 * 2.0) * 0.5 + 0.5;\n        alpha = smoothstep(0.2, 0.8, alpha);\n        diffuseColor.rgb = mix(".concat((0,l.eR)("#6f00ffff"),", ").concat((0,l.eR)("#f1ffaaff"),", alpha);\n\n        Vec3Ramp r = ramp(alpha, ").concat((0,l.eR)("#6f00ffff"),", ").concat((0,l.eR)("#08091dff"),", ").concat((0,l.eR)("#00fffaff"),", ").concat((0,l.eR)("#ffe4ffff"),");\n        diffuseColor.rgb = mix(r.a, r.b, r.t);\n      "));let i=(0,f.mj)(new o.eaF(new o.bdM,new o.V9B({map:e.texture})),{parent:n.scene,x:-5,scale:10}),u=(0,f.mj)(new o.eaF(new o.bdM,r),{parent:n.scene,x:5,scale:10});yield()=>{e.dispose(),i.removeFromParent(),u.removeFromParent()}}),(0,r.dB)("my-scene",function*(n){},[]),null}function d(){return(0,a.jsxs)(r.uB,{vertigoControls:{size:10,eventTarget:"canvas"},children:[(0,a.jsxs)("div",{className:"ClientPage layer thru flex flex-col p-12",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"Playing with depth"}),(0,a.jsx)("div",{children:"(using a custom shader material on instanced meshes, with a depth texture)"})]}),(0,a.jsx)(m,{})]})}},55227:(n,t,e)=>{"use strict";e.d(t,{M:()=>l});var a=e(22899),r=e(1029);let o="\n\nstruct FloatRamp {\n  float a;\n  float b;\n  float t;\n};\n\nstruct Vec2Ramp {\n  vec2 a;\n  vec2 b;\n  float t;\n};\n\nstruct Vec3Ramp {\n  vec3 a;\n  vec3 b;\n  float t;\n};\n\nstruct Vec4Ramp {\n  vec4 a;\n  vec4 b;\n  float t;\n};\n\n".concat((0,r.N)("vecX",n=>{let t=n[0].toUpperCase()+n.slice(1)+"Ramp";return"\n\n".concat(t," ramp(float t, T a, T b) {\n  return ").concat(t,"(a, b, t);\n}\n\n").concat(t," ramp(float t, T a, T b, T c) {\n  if (t < .5) {\n    return ").concat(t,"(a, b, t * 2.0);\n  } else {\n    return ").concat(t,"(b, c, (t - 0.5) * 2.0);\n  }\n}\n\n").concat(t," ramp(float t, T a, T b, T c, T d) {\n  if (t < .33) {\n    return ").concat(t,"(a, b, t * 3.0);\n  } else if (t < .66) {\n    return ").concat(t,"(b, c, (t - 0.33) * 3.0);\n  } else {\n    return ").concat(t,"(c, d, (t - 0.66) * 3.0);\n  }\n}\n\n").slice(1,-1)})),l="\n#ifndef GLSL_RAMP\n#define GLSL_RAMP\n".concat(a.I,"\n").concat(o,"\n#endif\n")},65927:(n,t,e)=>{"use strict";e.d(t,{S:()=>a});let a="\n#ifndef GLSL_BASIC\n#define GLSL_BASIC\n\nfloat clamp01(float x) {\n  return x < 0.0 ? 0.0 : x > 1.0 ? 1.0 : x;\n}\n\nvec2 clamp01(vec2 x) {\n  return vec2(clamp01(x.x), clamp01(x.y));\n}\n\nvec3 clamp01(vec3 x) {\n  return vec3(clamp01(x.x), clamp01(x.y), clamp01(x.z));\n}\n\nvec4 clamp01(vec4 x) {\n  return vec4(clamp01(x.x), clamp01(x.y), clamp01(x.z), clamp01(x.w));\n}\n\n#endif\n"},66620:(n,t,e)=>{"use strict";e.d(t,{_:()=>o});var a=e(89868),r=e(44138);function o(n,t){var e=(0,r._)(n,t,"update");return(0,a._)(n,e)}},79105:(n,t,e)=>{"use strict";e.d(t,{K2:()=>l,KP:()=>r,Tj:()=>c,Ts:()=>o,Zu:()=>a});let a=0x7fffffff,r=123456,o=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;if(Number.isNaN(n))throw Error("NaN is not a valid seed.");let t=n;if(10>Math.abs(t)&&(t*=1e6),t%=a,(t=t<0?t+a:t)>1)return t&a;if(0===t)return r;throw Error("Impossible. ".concat(t))},l=n=>n=Math.imul(n,48271)&a,c=n=>(n-1)/(a-1)},80446:(n,t,e)=>{"use strict";e.d(t,{n:()=>r});var a=e(79105);let r=function n(){let t=Math.random,e=()=>{};function r(n){let t=0;for(let e=0;e<n.length;e++)t=(t<<5)-t+n.charCodeAt(e)|0;return t}function o(){for(var n=arguments.length,e=Array(n),a=0;a<n;a++)e[a]=arguments[a];if(0===e.length)return t();if(1===e.length)return t()*e[0];if(2===e.length)return t()*(e[1]-e[0])+e[0];throw Error("Invalid arguments")}function l(){for(var n=arguments.length,e=Array(n),a=0;a<n;a++)e[a]=arguments[a];if(1===e.length)return Math.floor(t()*e[0]);if(2===e.length)return Math.floor(t()*(e[1]-e[0]))+e[0];throw Error("Invalid arguments")}function c(n){let{weightsAreNormalized:e=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===n.length)throw Error("Weights array is empty");if(!1===e){let e=n.reduce((n,t)=>n+t,0),a=t()*e,r=0;for(let t=0;t<n.length;t++)if(a<(r+=n[t]))return t;return n.length-1}{let e=t(),a=0;for(let t=0;t<n.length;t++)if(e<(a+=n[t]))return t;return n.length-1}}let f={new:function(){for(var t=arguments.length,e=Array(t),a=0;a<t;a++)e[a]=arguments[a];return n().setRandom(...e)},setRandom:function(){for(var n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];let[c,s=0]=o,i="string"==typeof s?r(s):s;if("parkmiller"===c){let n=a.Ts(i);t=()=>(n=a.K2(n),a.Tj(n)),e=t=>{n=a.Ts(t)}}else{if(void 0!==c&&"function"!=typeof c)throw Error("Invalid random function");t=null!=c?c:Math.random,e=()=>{}}return e(i),f},seed:function(n){return e("string"==typeof n?r(n):null!=n?n:0),f},get random(){return t},chance:function(n){return t()<n},number:o,float:o,f:o,sign:function(){return .5>t()?-1:1},int:l,i:l,hexColor:function(){let n=Math.floor(0xffffff*t());return"#".concat(n.toString(16).padStart(6,"0"))},pickIndex:c,pick:function(n,e){if(0===n.length)throw Error("Array is empty");if(e)return n[c(e)];let a=Math.floor(t()*n.length);return n[a]},createPicker:function(n){let t=n.map(n=>n[0]),e=n.map(n=>n[1]),a=t.reduce((n,t)=>n+t,0);for(let n=0;n<t.length;n++)t[n]/=a;return()=>e[c(t,{weightsAreNormalized:!0})]},direction2:function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},e=t()*Math.PI*2;return n.x=Math.cos(e),n.y=Math.sin(e),n},direction3:function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0},e=t(),a=t(),r=2*Math.PI*e,o=Math.acos(1-2*a);return n.x=Math.sin(o)*Math.cos(r),n.y=Math.sin(o)*Math.sin(r),n.z=Math.cos(o),n},quaternion:function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0,w:1},e=t(),a=t(),r=t(),o=Math.sqrt(1-e),l=Math.sqrt(e);return n.x=o*Math.sin(2*Math.PI*a),n.y=o*Math.cos(2*Math.PI*a),n.z=l*Math.sin(2*Math.PI*r),n.w=l*Math.cos(2*Math.PI*r),n},shuffleIndexes:function*(n){if(n<=0)throw Error("N must be greater than 0");let e=0,a=Math.floor((2+2*t())*n);for(;1!==function(n,t){for(;0!==t;)[n,t]=[t,n%t];return n}(n,a);){if(++e>1e3)throw Error("Failed to find a suitable a value after 1000 attempts");a=n+Math.floor(t()*n)}let r=Math.floor(t()*n);for(let t=0;t<n;t++)yield(r+t*a)%n}};return f}()},89558:(n,t,e)=>{Promise.resolve().then(e.bind(e,30851))}},n=>{var t=t=>n(n.s=t);n.O(0,[5611,7190,6564,7962,9635,8921,7953,4512,7775,7436,146,6726,3445,9332,3414,9717,1763,2143,3097,1319,6852,7358],()=>t(89558)),_N_E=n.O()}]);