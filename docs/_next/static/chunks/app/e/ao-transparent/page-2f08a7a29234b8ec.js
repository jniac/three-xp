(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5348],{3589:(e,t,a)=>{"use strict";a.d(t,{Main:()=>w});var r=a(70691),i=a(67203),s=a(18479),n=a(67235),l=a(30158),o=a(49797),d=a(17223),h=a(99613),u=a(64416),p=a(27491),c=a(27146),f=a(28334),m=a(36508),g=a(24223),v=a(58087),x=a(5832);class M extends p.A{render(e,t,a,r,i){var s;if(null==(s=this.onBeforeRender)||s.call(this),this.disableBackground){let s=this.scene.background;this.scene.background=null,super.render(e,t,a,r,i),this.scene.background=s}else super.render(e,t,a,r,i)}constructor(...e){super(...e),this.onBeforeRender=null,this.disableBackground=!1}}function y(){let{ref:e}=(0,s.useEffects)(function*(e){let t=function(e){let{width:t=window.innerWidth,height:a=window.innerHeight}=e,r=new l.WebGLRenderer({});r.setSize(t,a),r.setPixelRatio(window.devicePixelRatio);let i=new o.ubm(75,t/a,.1,1e3);i.position.z=8,new d.N(i,r.domElement);let s=new m.Rv().set({activeDuration:30}),p=(0,g.O)(()=>s.requestActivation()),y=function(e){let t=new o.Z58;{let e=new o.ZyN(0xffffff,1);e.position.set(0,3,1),t.add(e);let a=new o.dth("#afdbf5","#845244",1);t.add(a)}new x.Y().setPath("https://threejs.org/examples/textures/equirectangular/").loadAsync("pedestrian_overpass_1k.hdr").then(e=>{e.mapping=o.wfO,t.environmentIntensity=.1,t.environment=e,t.backgroundBlurriness=.5,t.background=e});let a=new o.eaF(new o.UPV(2,1,512,64),new o.uSd);t.add(a);let r=new o.eaF(new o.iNn(10,1,3),new o.uSd);t.add(r);let i=new o.eaF(new o.iNn(1,10,3),new o.uSd);i.position.set(5,0,0),t.add(i);let s=new o.eaF(new o.bdM(10,10),new o.uSd({color:"#d1ddff",transmission:1,roughness:0,dispersion:.1,ior:2.5,opacity:1}));return s.layers.set(1),t.add(s),e.onTick(e=>{a.rotation.x+=.5*e.deltaTime,a.rotation.y+=.5*e.deltaTime}),t}(s),w=new h.s(r),b=new M(y,i);b.onBeforeRender=()=>{i.layers.enableAll()},w.addPass(b);let E=new v.F(y,i,t,a);w.addPass(E);let T=new u.X;w.addPass(T);let R=new c.p(f.o);R.material.uniforms.resolution.value.set(1/t,1/a),w.addPass(R),s.onTick(()=>{w.render()}),n.Q.on("REQUIRE:THREE",e=>{e.payload={three:S}});let S={renderer:r,camera:i,scene:y,ticker:s,passes:{render:b,ao:E,output:T},destroy:()=>{r.domElement.remove(),s.destroy(),p.destroy()}};return S}({width:e.clientWidth,height:e.clientHeight});yield t,Object.assign(window,{three:t}),e.appendChild(t.renderer.domElement)},[]);return(0,r.jsx)("div",{ref:e,className:"absolute inset-0"})}function w(){let[e,t]=(0,i.useState)(!0);return(0,r.jsxs)("div",{className:"page",children:[(0,r.jsx)(y,{}),(0,r.jsxs)("div",{className:"absolute inset-0 p-8 flex flex-col items-start justify-start pointer-through",children:[(0,r.jsxs)("div",{className:"flex flex-col items-start justify-start pointer-through max-w-[480px]",children:[(0,r.jsx)("h1",{className:"text-4xl uppercase",children:"ao-transparent"}),(0,r.jsx)("div",{className:"mt-4"}),(0,r.jsx)("p",{children:"Handling Ambient Occlusion and transparent objects"}),(0,r.jsx)("p",{children:"The glass does not generate AO"}),(0,r.jsx)("div",{className:"mt-4"}),(0,r.jsxs)("p",{children:["This is achieved by using a fork of the ",(0,r.jsx)("a",{href:"https://github.com/mrdoob/three.js/blob/master/examples/jsm/postprocessing/GTAOPass.js",children:"GTAOPass"}),"\xa0where the camera layer mask is set to 0 (default layer) and the glass object is set to layer 1 (transparent objects)."]}),(0,r.jsx)("div",{className:"mt-4"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl",children:"Pros:"}),(0,r.jsx)("ul",{children:(0,r.jsx)("li",{children:"Simple (layer based)"})})]}),(0,r.jsx)("div",{className:"mt-4"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl",children:"Cons:"}),(0,r.jsx)("ul",{children:(0,r.jsx)("li",{children:"AO is still rendered on top of transparent objects. For semi-opaque objects, this is could be a problem."})})]})]}),(0,r.jsx)("div",{className:"mt-4"}),(0,r.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,r.jsx)("label",{htmlFor:"ao-enabled",className:"select-none",children:"Enable AO"}),(0,r.jsx)("input",{type:"checkbox",name:"ao-enabled",id:"ao-enabled",checked:e,onChange:()=>{let{payload:e}=n.Q.send("REQUIRE:THREE");if(e){let{three:a}=e,{passes:r}=a,{ao:i}=r;i.enabled=!i.enabled,t(i.enabled)}}})]})]})]})}},5832:(e,t,a)=>{"use strict";a.d(t,{Y:()=>i});var r=a(49797);class i extends r.BRH{constructor(e){super(e),this.type=r.ix0}parse(e){let t,a,i,s=function(e,t){switch(e){case 1:throw Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw Error("THREE.RGBELoader: Memory Error: "+(t||""))}},n=function(e,t,a){t=t||1024;let r=e.pos,i=-1,s=0,n="",l=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));for(;0>(i=l.indexOf("\n"))&&s<t&&r<e.byteLength;)n+=l,s+=l.length,r+=128,l+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));return -1<i&&(!1!==a&&(e.pos+=s+i+1),n+l.slice(0,i))},l=new Uint8Array(e);l.pos=0;let o=function(e){let t,a,r=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,i=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,l=/^\s*FORMAT=(\S+)\s*$/,o=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,d={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};for(!(e.pos>=e.byteLength)&&(t=n(e))||s(1,"no header found"),(a=t.match(/^#\?(\S+)/))||s(3,"bad initial token"),d.valid|=1,d.programtype=a[1],d.string+=t+"\n";!1!==(t=n(e));){if(d.string+=t+"\n","#"===t.charAt(0)){d.comments+=t+"\n";continue}if((a=t.match(r))&&(d.gamma=parseFloat(a[1])),(a=t.match(i))&&(d.exposure=parseFloat(a[1])),(a=t.match(l))&&(d.valid|=2,d.format=a[1]),(a=t.match(o))&&(d.valid|=4,d.height=parseInt(a[1],10),d.width=parseInt(a[2],10)),2&d.valid&&4&d.valid)break}return 2&d.valid||s(3,"missing format specifier"),4&d.valid||s(3,"missing image size specifier"),d}(l),d=o.width,h=o.height,u=function(e,t,a){if(t<8||t>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);t!==(e[2]<<8|e[3])&&s(3,"wrong scanline width");let r=new Uint8Array(4*t*a);r.length||s(4,"unable to allocate buffer space");let i=0,n=0,l=4*t,o=new Uint8Array(4),d=new Uint8Array(l),h=a;for(;h>0&&n<e.byteLength;){n+4>e.byteLength&&s(1),o[0]=e[n++],o[1]=e[n++],o[2]=e[n++],o[3]=e[n++],(2!=o[0]||2!=o[1]||(o[2]<<8|o[3])!=t)&&s(3,"bad rgbe scanline format");let a=0,u;for(;a<l&&n<e.byteLength;){let t=(u=e[n++])>128;if(t&&(u-=128),(0===u||a+u>l)&&s(3,"bad scanline data"),t){let t=e[n++];for(let e=0;e<u;e++)d[a++]=t}else d.set(e.subarray(n,n+u),a),a+=u,n+=u}for(let e=0;e<t;e++){let a=0;r[i]=d[e+a],a+=t,r[i+1]=d[e+a],a+=t,r[i+2]=d[e+a],a+=t,r[i+3]=d[e+a],i+=4}h--}return r}(l.subarray(l.pos),d,h);switch(this.type){case r.RQf:let p=new Float32Array(4*(i=u.length/4));for(let e=0;e<i;e++)!function(e,t,a,r){let i=Math.pow(2,e[t+3]-128)/255;a[r+0]=e[t+0]*i,a[r+1]=e[t+1]*i,a[r+2]=e[t+2]*i,a[r+3]=1}(u,4*e,p,4*e);t=p,a=r.RQf;break;case r.ix0:let c=new Uint16Array(4*(i=u.length/4));for(let e=0;e<i;e++)!function(e,t,a,i){let s=Math.pow(2,e[t+3]-128)/255;a[i+0]=r.GxU.toHalfFloat(Math.min(e[t+0]*s,65504)),a[i+1]=r.GxU.toHalfFloat(Math.min(e[t+1]*s,65504)),a[i+2]=r.GxU.toHalfFloat(Math.min(e[t+2]*s,65504)),a[i+3]=r.GxU.toHalfFloat(1)}(u,4*e,c,4*e);t=c,a=r.ix0;break;default:throw Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:d,height:h,data:t,header:o.string,gamma:o.gamma,exposure:o.exposure,type:a}}setDataType(e){return this.type=e,this}load(e,t,a,i){return super.load(e,function(e,a){switch(e.type){case r.RQf:case r.ix0:e.colorSpace=r.Zr2,e.minFilter=r.k6q,e.magFilter=r.k6q,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,a)},a,i)}}},24223:(e,t,a)=>{"use strict";function r(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];let[r,i]=1===t.length?[window,t[0]]:t,s=()=>{i()};return r.addEventListener("mousemove",s,{passive:!0}),r.addEventListener("mousedown",s,{passive:!0}),r.addEventListener("mouseup",s,{passive:!0}),r.addEventListener("touchstart",s,{passive:!0}),r.addEventListener("touchmove",s,{passive:!0}),r.addEventListener("wheel",s,{passive:!0}),r.addEventListener("keydown",s,{passive:!0}),r.addEventListener("keyup",s,{passive:!0}),window.addEventListener("resize",s,{passive:!0}),{destroy:()=>{r.removeEventListener("mousemove",s),r.removeEventListener("mousedown",s),r.removeEventListener("mouseup",s),r.removeEventListener("touchstart",s),r.removeEventListener("touchmove",s),r.removeEventListener("wheel",s),r.removeEventListener("keydown",s),r.removeEventListener("keyup",s),window.removeEventListener("resize",s)}}}a.d(t,{O:()=>r})},45841:(e,t,a)=>{Promise.resolve().then(a.bind(a,3589))},58087:(e,t,a)=>{"use strict";a.d(t,{F:()=>d});var r=a(49797),i=a(59411),s=a(39571),n=a(97679),l=a(2573),o=a(14192);class d extends s.o{dispose(){this.gtaoNoiseTexture.dispose(),this.pdNoiseTexture.dispose(),this.normalRenderTarget.dispose(),this.gtaoRenderTarget.dispose(),this.pdRenderTarget.dispose(),this.normalMaterial.dispose(),this.pdMaterial.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose(),this.fsQuad.dispose()}get gtaoMap(){return this.pdRenderTarget.texture}setGBuffer(e,t){void 0!==e?(this.depthTexture=e,this.normalTexture=t,this._renderGBuffer=!1):(this.depthTexture=new r.VCu,this.depthTexture.format=r.dcC,this.depthTexture.type=r.V3x,this.normalRenderTarget=new r.nWS(this.width,this.height,{minFilter:r.hxR,magFilter:r.hxR,type:r.ix0,depthTexture:this.depthTexture}),this.normalTexture=this.normalRenderTarget.texture,this._renderGBuffer=!0);let a=+!!this.normalTexture,i=this.depthTexture===this.normalTexture?"w":"x";this.gtaoMaterial.defines.NORMAL_VECTOR_TYPE=a,this.gtaoMaterial.defines.DEPTH_SWIZZLING=i,this.gtaoMaterial.uniforms.tNormal.value=this.normalTexture,this.gtaoMaterial.uniforms.tDepth.value=this.depthTexture,this.pdMaterial.defines.NORMAL_VECTOR_TYPE=a,this.pdMaterial.defines.DEPTH_SWIZZLING=i,this.pdMaterial.uniforms.tNormal.value=this.normalTexture,this.pdMaterial.uniforms.tDepth.value=this.depthTexture,this.depthRenderMaterial.uniforms.tDepth.value=this.normalRenderTarget.depthTexture}setSceneClipBox(e){e?(this.gtaoMaterial.needsUpdate=1!==this.gtaoMaterial.defines.SCENE_CLIP_BOX,this.gtaoMaterial.defines.SCENE_CLIP_BOX=1,this.gtaoMaterial.uniforms.sceneBoxMin.value.copy(e.min),this.gtaoMaterial.uniforms.sceneBoxMax.value.copy(e.max)):(this.gtaoMaterial.needsUpdate=0===this.gtaoMaterial.defines.SCENE_CLIP_BOX,this.gtaoMaterial.defines.SCENE_CLIP_BOX=0)}updateGtaoMaterial(e){void 0!==e.radius&&(this.gtaoMaterial.uniforms.radius.value=e.radius),void 0!==e.distanceExponent&&(this.gtaoMaterial.uniforms.distanceExponent.value=e.distanceExponent),void 0!==e.thickness&&(this.gtaoMaterial.uniforms.thickness.value=e.thickness),void 0!==e.distanceFallOff&&(this.gtaoMaterial.uniforms.distanceFallOff.value=e.distanceFallOff,this.gtaoMaterial.needsUpdate=!0),void 0!==e.scale&&(this.gtaoMaterial.uniforms.scale.value=e.scale),void 0!==e.samples&&e.samples!==this.gtaoMaterial.defines.SAMPLES&&(this.gtaoMaterial.defines.SAMPLES=e.samples,this.gtaoMaterial.needsUpdate=!0),void 0!==e.screenSpaceRadius&&+!!e.screenSpaceRadius!==this.gtaoMaterial.defines.SCREEN_SPACE_RADIUS&&(this.gtaoMaterial.defines.SCREEN_SPACE_RADIUS=+!!e.screenSpaceRadius,this.gtaoMaterial.needsUpdate=!0)}updatePdMaterial(e){let t=!1;void 0!==e.lumaPhi&&(this.pdMaterial.uniforms.lumaPhi.value=e.lumaPhi),void 0!==e.depthPhi&&(this.pdMaterial.uniforms.depthPhi.value=e.depthPhi),void 0!==e.normalPhi&&(this.pdMaterial.uniforms.normalPhi.value=e.normalPhi),void 0!==e.radius&&e.radius!==this.radius&&(this.pdMaterial.uniforms.radius.value=e.radius),void 0!==e.radiusExponent&&e.radiusExponent!==this.pdRadiusExponent&&(this.pdRadiusExponent=e.radiusExponent,t=!0),void 0!==e.rings&&e.rings!==this.pdRings&&(this.pdRings=e.rings,t=!0),void 0!==e.samples&&e.samples!==this.pdSamples&&(this.pdSamples=e.samples,t=!0),t&&(this.pdMaterial.defines.SAMPLES=this.pdSamples,this.pdMaterial.defines.SAMPLE_VECTORS=(0,o.A)(this.pdSamples,this.pdRings,this.pdRadiusExponent),this.pdMaterial.needsUpdate=!0)}render(e,t,a){switch(this._renderGBuffer&&(this.overrideVisibility(),this.renderOverride(e,this.normalMaterial,this.normalRenderTarget,7829503,1),this.restoreVisibility()),this.gtaoMaterial.uniforms.cameraNear.value=this.camera.near,this.gtaoMaterial.uniforms.cameraFar.value=this.camera.far,this.gtaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.gtaoMaterial.uniforms.cameraProjectionMatrixInverse.value.copy(this.camera.projectionMatrixInverse),this.gtaoMaterial.uniforms.cameraWorldMatrix.value.copy(this.camera.matrixWorld),this.renderPass(e,this.gtaoMaterial,this.gtaoRenderTarget,0xffffff,1),this.pdMaterial.uniforms.cameraProjectionMatrixInverse.value.copy(this.camera.projectionMatrixInverse),this.renderPass(e,this.pdMaterial,this.pdRenderTarget,0xffffff,1),this.output){case d.OUTPUT.Off:break;case d.OUTPUT.Diffuse:this.copyMaterial.uniforms.tDiffuse.value=a.texture,this.copyMaterial.blending=r.XIg,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:t);break;case d.OUTPUT.AO:this.copyMaterial.uniforms.tDiffuse.value=this.gtaoRenderTarget.texture,this.copyMaterial.blending=r.XIg,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:t);break;case d.OUTPUT.Denoise:this.copyMaterial.uniforms.tDiffuse.value=this.pdRenderTarget.texture,this.copyMaterial.blending=r.XIg,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:t);break;case d.OUTPUT.Depth:this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.renderPass(e,this.depthRenderMaterial,this.renderToScreen?null:t);break;case d.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=r.XIg,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:t);break;case d.OUTPUT.Default:this.copyMaterial.uniforms.tDiffuse.value=a.texture,this.copyMaterial.blending=r.XIg,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:t),this.blendMaterial.uniforms.intensity.value=this.blendIntensity,this.blendMaterial.uniforms.tDiffuse.value=this.pdRenderTarget.texture,this.renderPass(e,this.blendMaterial,this.renderToScreen?null:t);break;default:console.warn("THREE.GTAOPass: Unknown output type.")}}renderPass(e,t,a,r,i){e.getClearColor(this.originalClearColor);let s=e.getClearAlpha(),n=e.autoClear;e.setRenderTarget(a),e.autoClear=!1,null!=r&&(e.setClearColor(r),e.setClearAlpha(i||0),e.clear()),this.fsQuad.material=t,this.fsQuad.render(e),e.autoClear=n,e.setClearColor(this.originalClearColor),e.setClearAlpha(s)}renderOverride(e,t,a,r,i){e.getClearColor(this.originalClearColor);let s=e.getClearAlpha(),n=e.autoClear;e.setRenderTarget(a),e.autoClear=!1,r=t.clearColor||r,i=t.clearAlpha||i,null!=r&&(e.setClearColor(r),e.setClearAlpha(i||0),e.clear()),this.scene.overrideMaterial=t;let l=this.camera.layers.mask;this.camera.layers.set(0),e.render(this.scene,this.camera),this.camera.layers.mask=l,this.scene.overrideMaterial=null,e.autoClear=n,e.setClearColor(this.originalClearColor),e.setClearAlpha(s)}setSize(e,t){this.width=e,this.height=t,this.gtaoRenderTarget.setSize(e,t),this.normalRenderTarget.setSize(e,t),this.pdRenderTarget.setSize(e,t),this.gtaoMaterial.uniforms.resolution.value.set(e,t),this.gtaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.gtaoMaterial.uniforms.cameraProjectionMatrixInverse.value.copy(this.camera.projectionMatrixInverse),this.pdMaterial.uniforms.resolution.value.set(e,t),this.pdMaterial.uniforms.cameraProjectionMatrixInverse.value.copy(this.camera.projectionMatrixInverse)}overrideVisibility(){let e=this.scene,t=this._visibilityCache;e.traverse(function(e){t.set(e,e.visible),(e.isPoints||e.isLine)&&(e.visible=!1)})}restoreVisibility(){let e=this.scene,t=this._visibilityCache;e.traverse(function(e){let a=t.get(e);e.visible=a}),t.clear()}generateNoise(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:64,t=new i.h,a=new Uint8Array(e*e*4);for(let r=0;r<e;r++)for(let i=0;i<e;i++){let s=r,n=i;a[(r*e+i)*4]=(.5*t.noise(s,n)+.5)*255,a[(r*e+i)*4+1]=(.5*t.noise(s+e,n)+.5)*255,a[(r*e+i)*4+2]=(.5*t.noise(s,n+e)+.5)*255,a[(r*e+i)*4+3]=(.5*t.noise(s+e,n+e)+.5)*255}let s=new r.GYF(a,e,e,r.GWd,r.OUM);return s.wrapS=r.GJx,s.wrapT=r.GJx,s.needsUpdate=!0,s}constructor(e,t,a,i,d,h,u){super(),this.width=void 0!==a?a:512,this.height=void 0!==i?i:512,this.clear=!0,this.camera=t,this.scene=e,this.output=0,this._renderGBuffer=!0,this._visibilityCache=new Map,this.blendIntensity=1,this.pdRings=2,this.pdRadiusExponent=2,this.pdSamples=16,this.gtaoNoiseTexture=(0,l.QB)(),this.pdNoiseTexture=this.generateNoise(),this.gtaoRenderTarget=new r.nWS(this.width,this.height,{type:r.ix0}),this.pdRenderTarget=this.gtaoRenderTarget.clone(),this.gtaoMaterial=new r.BKk({defines:Object.assign({},l.dB.defines),uniforms:r.LlO.clone(l.dB.uniforms),vertexShader:l.dB.vertexShader,fragmentShader:l.dB.fragmentShader,blending:r.XIg,depthTest:!1,depthWrite:!1}),this.gtaoMaterial.defines.PERSPECTIVE_CAMERA=+!!this.camera.isPerspectiveCamera,this.gtaoMaterial.uniforms.tNoise.value=this.gtaoNoiseTexture,this.gtaoMaterial.uniforms.resolution.value.set(this.width,this.height),this.gtaoMaterial.uniforms.cameraNear.value=this.camera.near,this.gtaoMaterial.uniforms.cameraFar.value=this.camera.far,this.normalMaterial=new r.qBx,this.normalMaterial.blending=r.XIg,this.pdMaterial=new r.BKk({defines:Object.assign({},o.I.defines),uniforms:r.LlO.clone(o.I.uniforms),vertexShader:o.I.vertexShader,fragmentShader:o.I.fragmentShader,depthTest:!1,depthWrite:!1}),this.pdMaterial.uniforms.tDiffuse.value=this.gtaoRenderTarget.texture,this.pdMaterial.uniforms.tNoise.value=this.pdNoiseTexture,this.pdMaterial.uniforms.resolution.value.set(this.width,this.height),this.pdMaterial.uniforms.lumaPhi.value=10,this.pdMaterial.uniforms.depthPhi.value=2,this.pdMaterial.uniforms.normalPhi.value=3,this.pdMaterial.uniforms.radius.value=8,this.depthRenderMaterial=new r.BKk({defines:Object.assign({},l.EC.defines),uniforms:r.LlO.clone(l.EC.uniforms),vertexShader:l.EC.vertexShader,fragmentShader:l.EC.fragmentShader,blending:r.XIg}),this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new r.BKk({uniforms:r.LlO.clone(n.Z.uniforms),vertexShader:n.Z.vertexShader,fragmentShader:n.Z.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:r.wn6,blendDst:r.ojh,blendEquation:r.gO9,blendSrcAlpha:r.hdd,blendDstAlpha:r.ojh,blendEquationAlpha:r.gO9}),this.blendMaterial=new r.BKk({uniforms:r.LlO.clone(l.eQ.uniforms),vertexShader:l.eQ.vertexShader,fragmentShader:l.eQ.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blending:r.bCz,blendSrc:r.wn6,blendDst:r.ojh,blendEquation:r.gO9,blendSrcAlpha:r.hdd,blendDstAlpha:r.ojh,blendEquationAlpha:r.gO9}),this.fsQuad=new s.F(null),this.originalClearColor=new r.Q1f,this.setGBuffer(d?d.depthTexture:void 0,d?d.normalTexture:void 0),void 0!==h&&this.updateGtaoMaterial(h),void 0!==u&&this.updatePdMaterial(u)}}d.OUTPUT={Off:-1,Default:0,Diffuse:1,Depth:2,Normal:3,AO:4,Denoise:5}},67235:(e,t,a)=>{"use strict";a.d(t,{Q:()=>o});var r=a(54530);class i{_getId(){return i._idHash.init().update(++this._count).getValue()}_registerObject(e){let t=this._getId();return this._weakMap.set(e,t),t}_registerPrimitive(e){let t=this._getId();return this._map.set(e,t),t}_requirePrimitiveId(e){var t;return null!=(t=this._map.get(e))?t:this._registerPrimitive(e)}_requireObjectId(e){var t;return null!=(t=this._weakMap.get(e))?t:this._registerObject(e)}_requireArrayId(e){let{_arrayHash:t}=i;for(let a of(t.init(),e.flat(16)))t.update(this.requireId(a));return t.getValue()}requireId(e){return!function(e){if(null==e)return!0;switch(typeof e){case"function":case"object":return!1;default:return!0}}(e)?Array.isArray(e)?this._requireArrayId(e):this._requireObjectId(e):this._requirePrimitiveId(e)}constructor(){this._count=1,this._map=new Map,this._weakMap=new WeakMap}}i._idHash=new r.V,i._arrayHash=new r.V;class s{constructor(e,t){this.filter=e,this.callback=t,this.match="*"===e?()=>!0:"string"==typeof e?t=>t===e:e instanceof RegExp?t=>e.test(t):()=>!1}}let n=new i,l=new Map;class o{setPayload(e){return this.payload=e,this}assignPayload(e){let{overwrite:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.payload=t?{...this.payload,...e}:{...e,...this.payload},this}payloadAssign(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return this.assignPayload(...t)}assertPayload(){if(void 0!==this.payload)return this.payload;throw Error('Message.payloadAssert: assertion failed for message with target "'.concat(this.target,'"'))}constructor(e,t,a){var r;this.id=o.nextId++,this.debug={currentListenerIndex:-1,listenerCount:0},this.targetId=n.requireId(e),this.target=e,this.type=null!=t?t:"message",this.payload=a;let i=(null!=(r=l.get(this.targetId))?r:[]).filter(e=>e.match(this.type));for(let e of(this.debug.listenerCount=i.length,i))this.debug.currentListenerIndex++,e.callback(this)}}function d(e){if(2===e.length){let[t,a]=e;return[t,"*",a]}return e}function h(){for(var e,t=arguments.length,a=Array(t),r=0;r<t;r++)a[r]=arguments[r];let[i,o,h]=d(a),u=n.requireId(i),p=new s(o,h);return(null!=(e=l.get(u))?e:(()=>{let e=[];return l.set(u,e),e})()).push(p),{destroy:()=>{!function(e,t){let a=l.get(e);if(a){let r=a.indexOf(t);if(-1!==r)a.splice(r,1),0===a.length&&l.delete(e)}}(u,p)}}}o.send=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];let[r,i,s]=function(e){let[t,...a]=e;if(2===a.length){let[e,{payload:r}]=a;return[t,e,r]}if(1===a.length){let[e]=a;return"string"==typeof e?[t,e]:[t,void 0,e.payload]}return[t]}(t);return new o(r,i,s)},o.on=h,o.wait=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return new Promise(e=>{let a=t=>{e(t)},[r,i]=d([...t,a]);h(r,i,a)})},o.debug={listenerMap:l,idRegister:n},o.nextId=0}},e=>{var t=t=>e(e.s=t);e.O(0,[5611,7190,7962,9635,5438,146,1319,6852,7358],()=>t(45841)),_N_E=e.O()}]);