"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[411],{4003:(t,e,o)=>{o.d(e,{w:()=>i.w});var i=o(3461)},8597:(t,e,o)=>{o.d(e,{Bg:()=>r,Dm:()=>a,NP:()=>s,OZ:()=>n,RY:()=>p,gc:()=>g,mj:()=>f,rU:()=>l,uJ:()=>u,xO:()=>w});var i=o(49797);let s=6,r=4,n=new i.Pq0(s,r,s+r-1),l=[new i.Pq0(0,0,r),new i.Pq0(0,r,0),new i.Pq0(s,0,r+s-1),new i.Pq0(s,r,s)],a=new i.Pq0(0,-2*r,2*r),c=new i.Pq0(1,0,1).normalize(),h=new i.Pq0(0,1,-1).normalize(),d=new i.Pq0().crossVectors(c,h).normalize();h.crossVectors(d,c).normalize();let u={U:c,V:h,W:d},p=new i.kn4().makeBasis(c,h,d).setPosition(a),f=new i.kn4().copy(p).invert(),w=new i.O9p().setFromRotationMatrix(p),g=new i.Zcv().setFromNormalAndCoplanarPoint(d,a)},21277:(t,e,o)=>{o.d(e,{N:()=>r});var i=o(49797);let s=new i.WBB(1,4);class r extends i.eaF{constructor(t){super(s,new i.V9B({color:"#0c529d",...t,side:i.hsX,depthWrite:!1,depthTest:!1})),this.renderOrder=-1,this.frustumCulled=!1,this.matrixAutoUpdate=!1,this.onBeforeRender=(t,e,o)=>{let i=(o.near+o.far)/2;this.position.copy(o.position),this.scale.setScalar(i),this.updateMatrix(),this.updateMatrixWorld()}}}},23120:(t,e,o)=>{o.d(e,{hB:()=>p,hf:()=>x});var i=o(49797),s=o(94065),r=o(68955),n=o(16465),l=o(3293),a=o(79911),c=o(72612),h=o(17099),d=o(8597);function u(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new i.Pq0;return o.set(t,e,t-e)}function p(){let t;for(var e,o,s=arguments.length,r=Array(s),n=0;n<s;n++)r[n]=arguments[n];let l=0,a=0;if("number"==typeof r[0])[l,a]=r,t=null!=(e=r[3])?e:new i.I9Y;else{let[e]=r;l=e.x,a=e.y,t=null!=(o=r[1])?o:new i.I9Y}let c=-Math.log2((a/d.Bg+1)/2)-1,h=.5**c,u=l/(d.NP*h);return t.set(u,c)}function f(t,e,o){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,{x:s,y:r,z:n}=e,l=s+o,a=r+o,c=n+o;for(let e=n;e<c;e++)for(let o=r;o<a;o++)for(let r=s;r<l;r++)t.getVoxelState(r,o,e+4*d.Bg).setInt8(0,i)}function w(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,o=d.OZ.clone().multiplyScalar(4/e),s=[];for(let r of(0,c.loop3)(o)){let o=r.x*e,n=r.y*e,l=r.z*e;(function(t,e,o,i){var s,r,n,l,a,c;let h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return!!(t.getVoxelState(e,o,i).getInt8(0)>0)&&!((null!=(l=null==(s=t.tryGetVoxelState(e-h,o,i))?void 0:s.getInt8(0))?l:0)>0)&&!((null!=(a=null==(r=t.tryGetVoxelState(e,o+h,i))?void 0:r.getInt8(0))?a:0)>0)&&!((null!=(c=null==(n=t.tryGetVoxelState(e,o,i+h))?void 0:n.getInt8(0))?c:0)>0)})(t,o,n,l,e)&&h.c.chance(1-r.py)&&s.push(new i.Pq0(o,n,l))}return s}function g(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,o=d.OZ.clone().multiplyScalar(4/e),s=[];for(let r of(0,c.loop3)(o)){let o=r.x*e,n=r.y*e,l=r.z*e;(function(t,e,o,i){var s,r,n,l,a,c;let h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return!(t.getVoxelState(e,o,i).getInt8(0)>0)&&!!((null!=(l=null==(s=t.tryGetVoxelState(e+h,o,i))?void 0:s.getInt8(0))?l:0)>0)&&!!((null!=(a=null==(r=t.tryGetVoxelState(e,o-h,i))?void 0:r.getInt8(0))?a:0)>0)&&!!((null!=(c=null==(n=t.tryGetVoxelState(e,o,i-h))?void 0:n.getInt8(0))?c:0)>0)})(t,o,n,l,e)&&h.c.chance(1-r.py)&&s.push(new i.Pq0(o,n,l))}return s}let m=new i.Pq0;new i.Pq0;class x extends i.eaF{createDots(){let t=new i.ZLX(new i.WBB(.1,8),new n.Y,4);for(let[e,o]of((0,a.mj)(t,this),d.rU.entries()))t.setMatrixAt(e,(0,l.w)({position:o})),t.setColorAt(e,(0,l._)("#ffffff"));return this.dots=t,this}updateDots(t){this.dots||this.createDots();let e=this.dots;for(let[o,i]of d.rU.entries()){e.setMatrixAt(o,(0,l.w)({position:i}));let s=t.isWithin(i)?"#00ffa6":"#ff0000";e.setColorAt(o,(0,l._)(s))}e.instanceMatrix.needsUpdate=!0,e.instanceColor.needsUpdate=!0}get gridCoords(){return this._gridCoords}setGridCoords(t){(0,s.wX)(t,this._gridCoords);let{x:e,y:o}=this._gridCoords;this.scale.setScalar(.5**o),function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new i.Pq0,s=.5**e,r=t*d.NP*s,n=d.Bg*(.5*s*2-1),l=t*d.NP*s+2*d.Bg*(1-s);o.set(r,n,l)}(e,o,this.position)}toWhite(){this.material.color.set(0xffffff)}toColor(){this.material.color.set(this.color)}constructor({world:t=null,color:e=0xffffff*h.c.random()}={}){let o=Math.ceil(d.NP*d.Bg*4.8),s=new r.AA(o,1);for(let{x:t,y:e}of(0,c.loop2)(d.NP,d.Bg))u(t,e,m).multiplyScalar(4),f(s,m,4);for(let t=0;t<d.NP;t+=2)u(t,d.Bg-1,m).add(new i.Pq0(1,0,0)).multiplyScalar(4),f(s,m,4),h.c.chance(.8)&&(u(t,d.Bg-1,m).add(new i.Pq0(1,1,0)).multiplyScalar(4),f(s,m,4));{let t=g(s,2),e=w(s,2);for(let e of t)f(s,e,2,1);for(let t of e)f(s,t,2,0)}{let t=g(s,1),e=w(s,1);for(let e of t)h.c.chance(.25)&&f(s,e,1,1);for(let t of e)h.c.chance(.25)&&f(s,t,1,0)}console.time("geometry");let l=(0,r.Cx)(s.voxelFaces());console.timeEnd("geometry");l.scale(.25,.25,.25);let p=new n.Y({color:e});super(l,new n.Y({color:e,side:i.$EB})),this._gridCoords=new i.I9Y,this.world=null,this.dots=null,(0,a.mj)(new i.eaF(l,p),this),(0,a.mj)(new i.IzY,this),this.chunk=s,this.color=e,this.world=t}}},28737:(t,e,o)=>{o.d(e,{Leak:()=>d,O:()=>h});var i={};o.r(i),o.d(i,{distribute:()=>r.mn,every:()=>r.Si,findMaxBy:()=>r.vj,pairwise:()=>r.Ju,recordBy:()=>r.VY,some:()=>r.zN,split:()=>r.mn,uniqueBy:()=>r.pD});var s=o(30158),r=o(43107),n=o(38062),l=o(85795),a=o(17099),c=o(96122);function h(t){Object.assign(window,{...s,...l,...i,...t,PRNG:a.c,waveform:n.o,dedent:c.T})}function d(t){return h(t),null}},34011:(t,e,o)=>{o.d(e,{e:()=>a,k:()=>h});var i=o(49797),s=o(38921);let r={axis:"x",length:1,radialSegments:12,radius:.01,coneRatio:.1,radiusScale:1,vertexColor:!0,baseCap:"flat",color:"white",align:0,heightSegments:1},n=new i.Q1f;function l(t){let{axis:e,length:o,radius:l,radialSegments:a,heightSegments:c,coneRatio:h,radiusScale:d,vertexColor:u,baseCap:p,color:f,align:w}={...r,...t},g=l*d,m=o*h,x=Math.max(1,Math.ceil(c*h)),y=Math.max(1,Math.ceil(c*(1-h))),C=new i.qFE(3*g,m,a,x),P=new i.Ho_(g,g,1,a,y,!0),v=o-m,k=o-.5*m;C.rotateZ(-Math.PI/2).translate(k,0,0),P.scale(1,v,1).rotateZ(-Math.PI/2).translate(.5*v,0,0);let M="none"===p?new i.LoY:"flat"===p?new i.tcD(g,a).rotateY(-Math.PI/2):new i.Gu$(g,a,3,0,2*Math.PI,0,.5*Math.PI).rotateZ(Math.PI/2).rotateX(Math.PI/2),S=(0,s.pP)([C,P,M]);switch(0!==w&&S.translate(-o*w,0,0),e){case"y":S.rotateZ(Math.PI/2);break;case"z":S.rotateY(-Math.PI/2)}if(u){let t=S.attributes.position.count,e=new i.THS(new Float32Array(3*t),3);S.setAttribute("color",e),n.set(f);for(let o=0;o<t;o++)e.setXYZ(o,n.r,n.g,n.b)}return S}class a extends i.LoY{constructor(t){super();let e=l(t);this.copy(e),e.dispose()}}let c={xColor:"#ff3333",yColor:"#33cc66",zColor:"#3366ff"};class h extends i.LoY{static get defaultOptions(){return{...c}}constructor(t){super();let{xColor:e,yColor:o,zColor:i,...r}={...c,...t},n=l({...r,axis:"x",color:e}),a=l({...r,axis:"y",color:o}),h=l({...r,axis:"z",color:i}),d=(0,s.pP)([n,a,h]);this.copy(d),d.dispose()}}},38062:(t,e,o)=>{o.d(e,{o:()=>i});let i={triangle:function(t){let{frequency:e=1,phase:o=0,f:i=e,p:s=o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t*i+s,n=2*r-Math.floor(2*r);return r-Math.floor(r)<.5?n:1-n}}},50411:(t,e,o)=>{o.d(e,{Main:()=>T});var i,s=o(70691),r=o(25432),n=o(88575),l=o(4003),a=o(72612),c=o(79285),h=o(63126),d=o(28737),u=o(49797),p=o(99332),f=o(31763),w=o(39787),g=o(36508),m=o(7693),x=o(48181),y=o(79911),C=o(44694),P=o(8597);class v extends u.YJl{static current(){if(0===this.instances.length)throw Error("No Scope!");return this.instances[this.instances.length-1]}updateScope(){let{aspect:t=1,size:e=4}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t>1?e:e*t,i=o/t;(o!==this.state.width||i!==this.state.height)&&(this.parts.lines.clear().circle({radius:1}).rectangle([-o/2,-i/2,o,i]).plus([0,0],.2).draw(),this.parts.lines.geometry.computeBoundingSphere(),this.state.width=o,this.state.height=i)}isWithin(t){let{x:e,y:o}=t.clone().applyMatrix4(this.matrixWorldInverse),{width:i,height:s}=this.state;return e>=-i/2&&e<=i/2&&o>=-s/2&&o<=s/2}chunkIntersects(t){this.updateMatrixWorld(),t.updateMatrixWorld();let e=!0,o=!0,i=!0,s=!0,r=this.state.width/2,n=this.state.height/2;for(let l=0;l<4;l++){let{x:a,y:c,z:h}=v._chunkIntersectsVectors[l].copy(P.rU[l]).applyMatrix4(t.matrixWorld).applyMatrix4(this.matrixWorldInverse);if(e&&(e=a<-r),i&&(i=a>r),o&&(o=c<-n),s&&(s=c>n),!1===(e||o||i||s))return!0}return!1}toVertigoProps(){let{width:t,height:e}=this.state;return{perspective:.5,size:[t,e],focus:this.position,rotation:this.rotation}}constructor(){super(),this.parts={lines:(0,y.mj)(new x.R,this),debugLines:(0,y.mj)(new x.R,this)},this.state={width:4,height:4},this.matrixWorldInverse=new u.kn4,this.destroy=()=>{let t=v.instances.indexOf(this);if(-1===t)throw Error("Scope instance not found");v.instances.splice(t,1)},v.instances.push(this),this.position.set(0,0,6),this.rotation.setFromRotationMatrix(P.RY,m.B.default.rotation.order),this.rotation.x+=(0,C.ey)("20deg"),this.updateMatrix(),this.updateMatrixWorld(),this.matrixWorldInverse.copy(this.matrixWorld).invert()}}v.instances=[],v._chunkIntersectsVectors=[new u.Pq0,new u.Pq0,new u.Pq0,new u.Pq0];var k=o(34011),M=o(16465),S=o(23120);function Y(t,e){if(t<-32768||t>=32768||e<-32768||e>=32768)throw RangeError("x and y must be in the range -0x8000 to 0x7fff, received: ".concat(t," (0x").concat(t.toString(16),"), ").concat(e," (0x").concat(e.toString(16),")"));return(t+=32768)<<16|(e+=32768)}let j=new u.I9Y;function*I(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];let[i,s]=(()=>{if(1!==e.length)return e;{let{x:t,y:o}=(0,C.wX)(e[0]);return[t,o]}})();yield j.set(Math.floor((i-1)/2),s-1),yield j.set(Math.floor((i+1)/2),s-1),yield j.set(i-1,s),yield j.set(i+1,s),yield j.set(2*i-1,s+1),yield j.set(2*i,s+1),yield j.set(2*i+1,s+1),yield j.set(2*i+2,s+1)}class b extends u.YJl{drawCircles(){let{count:t=1,step:e=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(let o=1;o<t;o++){let t=1+o*e;(0,y.mj)(new u.DXC(this.parts.circles.geometry,this.parts.circles.material),{parent:this,scaleScalar:t})}return this}constructor(...t){super(...t),this.parts=(()=>{let t=new x.R;t.circle({radius:1,color:k.k.defaultOptions.zColor}).circle({radius:1,color:k.k.defaultOptions.xColor,transform:{rotationY:"90deg"}}).circle({radius:1,color:k.k.defaultOptions.yColor,transform:{rotationX:"90deg"}}).draw();let e=new u.eaF(new k.k,new M.Y({vertexColors:!0}));return{axes:(0,y.mj)(e,this),circles:(0,y.mj)(t,this)}})()}}class N extends u.YJl{static current(){if(0===this.instances.length)throw Error("No World!");return this.instances[this.instances.length-1]}scopeUpdate(t){let e=(0,h.calculateExponentialDecayLerpRatio)(1e-4,t);this.dampedScopeCoordinates.lerp(this.scopeCoordinates,e);let{x:o,y:i}=this.dampedScopeCoordinates;this.scope.position.set(0,0,6).addScaledVector(P.uJ.U,o),this.worldScale=2**(.33*i),this.setChunkGroupScale(this.worldScale)}getChunk(t,e){var o;return null!=(o=this.chunks.get(Y(t,e)))?o:null}ensureChunk(t,e){let o=Y(t,e),i=this.chunks.get(o);if(i)return i;{let o=(0,y.mj)(new S.hf({world:this}),this.chunkGroup);return this.chunks.set(Y(t,e),o),o.setGridCoords([t,e]),o}}ensureChunkNeighbors(t,e){for(let o of(this.ensureChunk(t,e),I(t,e)))this.ensureChunk(o.x,o.y)}ensureScopeChunks(){let t=new Set([Y(0,0)]),e=[this.ensureChunk(0,0)],o=0;for(;e.length>0;){if(o++>100){console.error("Exceeded maximum chunk count of ".concat(100));break}let i=e.pop();if(this.scope.chunkIntersects(i))for(let o of I(i.gridCoords)){let i=Y(o.x,o.y);t.has(i)||(t.add(i),e.push(this.ensureChunk(o.x,o.y)))}}}toWhite(){for(let t of this.chunks.values())t.toWhite()}toColor(){for(let t of this.chunks.values())t.toColor()}constructor(){super(),this.origin=(0,y.mj)(new u.IzY,{parent:this,position:P.Dm,rotation:P.xO}),this.chunkGroup=(0,y.mj)(new u.YJl,{parent:this}),this.scopeCoordinates=new u.I9Y,this.dampedScopeCoordinates=new u.I9Y,this.worldScale=1,this.scopeOriginPoint=new u.Pq0,this.scopeCenterChunkPoint=new u.Pq0,this.scope=(0,y.mj)(new v,this),this.XXX=(0,y.mj)(new b,this.chunkGroup),this.YYY=new u.I9Y,this.setChunkGroupScale=(()=>{let t=new u.kn4;return e=>{var o;this.scopeCenterChunkPoint.copy(this.scope.position).applyMatrix4(P.mj),this.scopeOriginPoint.set(this.scopeCenterChunkPoint.x,0,0).applyMatrix4(P.RY),this.chunkGroup.position.copy(this.scopeOriginPoint).addScaledVector(this.scopeOriginPoint,-e),this.chunkGroup.scale.setScalar(e),this.chunkGroup.updateMatrix(),this.XXX.position.copy(this.scope.position).applyMatrix4(P.mj),this.XXX.position.z=0,this.XXX.position.applyMatrix4(P.RY).applyMatrix4(t.copy(this.chunkGroup.matrix).invert());let{x:i,y:s}=(0,S.hB)(this.XXX.position,this.YYY);i=Math.round(i-.5),s=Math.round(s+.5),this.toWhite(),null==(o=this.getChunk(i,s))||o.toColor()}})(),this.chunks=new Map,this.destroy=()=>{this.scope.destroy(),this.chunks.clear(),this.clear();let t=N.instances.indexOf(this);if(-1===t)throw Error("World instance not found");N.instances.splice(t,1)},N.instances.push(this)}}N.instances=[];var B=function(t){return t[t.Free=0]="Free",t[t.Scope=1]="Scope",t}(B||{});class V{initialize(t){return this.element=t,this}*doStart(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!=(i=this.element)?i:document.body;yield(0,p.s)(t,{onDrag:t=>{let e=N.current();e.scopeCoordinates.x+=-(.005*t.delta.x)/e.worldScale,e.scopeCoordinates.y+=-(.01*t.delta.y)}}),yield(0,g.xy)("three",t=>{let e=N.current();e.scopeUpdate(t.deltaTime);let o=e.scope.position;this.vertigoControls.vertigo.set({focus:o}),this.vertigoControls.dampedVertigo.set({focus:o})})}start(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];this._started||(this._destroyables.collect(this.doStart(...e)),this._started=!0)}stop(){this._started&&(this._destroyables.destroy(),this._started=!1)}toggle(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this._started;t?this.start():this.stop()}update(t,e,o){this.vertigoControls.update(t,e,o)}constructor(){this.position=new u.I9Y,this.dampedPosition=new u.I9Y,this.scale=1,this._destroyables=new w.el,this.vertigoControls=new f.n({perspective:.5}),this._started=!1,this.destroy=()=>{this._destroyables.destroy()}}}class q{get mode(){return this._mode}set mode(t){this.setMode(t)}initialize(t,e){this.camera=t,this.freeVertigoControls.initialize(e).toggle(0===this._mode),this.scopeCameraHandler.initialize(e).toggle(1===this._mode);let o=v.current().toVertigoProps();return this.scopeCameraHandler.vertigoControls.vertigo.set(o),this.scopeCameraHandler.vertigoControls.dampedVertigo.set(o),this}setMode(t){if(t%=2,this._mode!==t)switch(this._mode=t,this.freeVertigoControls.toggle(0===t),this.scopeCameraHandler.toggle(1===t),t){case 0:this.mode=q.Mode.Free,this.freeVertigoControls.dampedVertigo.copy(this.scopeCameraHandler.vertigoControls.dampedVertigo);break;case 1:this.mode=q.Mode.Scope,this.scopeCameraHandler.vertigoControls.dampedVertigo.copy(this.freeVertigoControls.dampedVertigo),this.scopeCameraHandler.vertigoControls.vertigo.set(v.current().toVertigoProps())}}onTick(t,e){switch(this._mode){case 0:this.freeVertigoControls.update(this.camera,e,t.deltaTime),console.log();break;case 1:this.scopeCameraHandler.update(this.camera,e,t.deltaTime)}}constructor(){this._mode=0,this.freeVertigoControls=new f.n({size:24,perspective:1}),this.scopeCameraHandler=new V,this.destroy=()=>{this.freeVertigoControls.destroy(),this.scopeCameraHandler.destroy();let t=q.instances.indexOf(this);if(-1===t)throw Error("CameraHandler instance not found");q.instances.splice(t,1)},q.instances.push(this)}}q.Mode=B,q.instances=[];var _=o(21277),O=o(17099);function z(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new u.IUQ,i=2**e,s=2*(1-1/i),r=1/i;return o.x=t*P.NP*r,o.y=-P.Bg*s,o.z=P.Bg*s+t*P.NP*r,o.w=r,o}class W extends u.YJl{updatePointer(t){let e=t.intersectPlane(P.gc,new u.Pq0);if(!e)return;let{text:o,pointerText:i}=this.internal,s=function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new u.I9Y;return o.y=Math.floor(-Math.log2(1- -e/P.Bg/2)),o.x=Math.floor(t/P.NP*2**o.y),o}(e.x,e.y);if(Number.isNaN(s.x)||Number.isNaN(s.y))return;let r=1/2**function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new u.I9Y,i=1- -e/P.Bg/2;return o.y=-Math.log2(i),o.x=t/(P.NP*i),o}(e.x,e.y,new u.I9Y).y;for(let t of this.internal.positions){let e=t.x===s.x&&t.y===s.y?"#ffff66":"white";o.data.setColorAt(t.i+1,{backgroundColor:e})}o.material.needsUpdate=!0,i.setTextAt(0,"".concat(s.x,",").concat(s.y),{textColor:"#ffff66",textOpacity:0,backgroundColor:"#ffff66",backgroundOpacity:1,position:e,size:3*r});let n=z(s.x,s.y);this.internal.pointerLine.clear().line(e,[n.x,n.y,n.z],{color:"#ffff66"}).draw()}constructor(...t){super(...t),this.internal=(()=>{let t=[new u.Pq0(0,0,0),new u.Pq0(0,-P.Bg,P.Bg),new u.Pq0(P.NP,-P.Bg,P.NP+P.Bg),new u.Pq0(P.NP,0,P.NP)],e=(0,y.mj)(new x.R,this);for(let o=0;o<12;o++){let i=2**o,s=2*(1-1/i),r=1/i,n=new u.Pq0(0,-P.Bg*s,P.Bg*s);e.polygon(t.map(t=>t.clone().multiplyScalar(r).add(n)))}e.polyline([[0,0,0],P.Dm]),e.draw(),(0,y.mj)(new u.eaF(new k.k,new M.Y({vertexColors:!0})),{parent:this,position:P.Dm,rotation:P.xO});let o=(0,a.loop2Array)(4,8),i=(0,y.mj)(new l.w({lineCount:1,lineLength:14}),this),s=(0,y.mj)(new x.R(100),this);for(let t of o){let{x:e,y:o,z:s,w:r}=z(t.x,t.y);i.setTextAt(t.i+1,"".concat(t.x,",").concat(t.y),{textColor:"white",textOpacity:0,backgroundColor:"white",backgroundOpacity:1,position:[e,o,s],size:2*r})}return{positions:o,text:i,pointerText:(0,y.mj)(new l.w({lineCount:2,lineLength:16}),this),pointerLine:s}})()}}var X=o(67203),E=o(18479);o(61249);let R=(0,X.createContext)(null);function F(t,e){let o=(0,X.useContext)(R);return(0,E.useEffects)(async function*(e,i){if(t){let e=t(o,i);if(e&&"function"==typeof e.next)do{let{value:t,done:o}=await e.next();if(o)break;yield t}while(i.mounted)}},null!=e?e:"always"),o}let G={className:"",assetsPath:"/"};function A(t){let{children:e,className:o,assetsPath:i}={...G,...t},r=(0,X.useMemo)(()=>new n.XW,[]);r.loader.setPath(i);let{ref:l}=(0,E.IZ)({debounce:!0},function*(t,e){yield r.initialize(t.firstElementChild),e.triggerRender(),Object.assign(window,{three:r})},[]);return(0,s.jsx)("div",{ref:l,className:o,style:{position:"absolute",inset:0},children:(0,s.jsxs)(R.Provider,{value:r,children:[(0,s.jsx)("div",{style:{position:"absolute",inset:"0"}}),(0,s.jsx)("div",{style:{position:"absolute",inset:"0"},className:"thru",children:r.initialized&&e})]})})}function D(t){return function(){let[t,e]=(0,X.useState)(!1);return(0,X.useLayoutEffect)(()=>{e(!0)},[]),t}()&&(0,s.jsx)(A,{...t})}function L(){return!function(t,e,o){let i=(0,X.useMemo)(()=>new u.YJl,[]);i.name=t,F(async function*(t,o){if(t.scene.add(i),yield()=>{i.clear(),i.removeFromParent()},e){let s=e(i,t,o);if(s&&"function"==typeof s.next)do{let{value:t,done:e}=await s.next();if(e)break;yield t}while(o.mounted)}},o)}("fractal-grid",function*(t,e){var o;(0,y.mj)(new _.N({color:"#110512"}),t),(0,y.mj)(new x.R,t).grid2().draw();let i=(0,y.mj)(new W,t);(0,y.mj)(new u.eaF(new u.UPV(2.5,.025,512,32),new M.Y({color:"#0cf"})),t).visible=!1,O.c.seed(98763);let s=(0,y.mj)(new N,t);yield s.destroy,s.visible=!1,s.scope.updateScope({aspect:e.aspect}),s.ensureScopeChunks();let r=new q().initialize(e.camera,e.renderer.domElement),n=new u.Pq0,l=(0,y.mj)(new u.eaF(new u.WBB(.1),new M.Y({color:"#f0f"})),t);yield(0,g.xy)("three",t=>{r.onTick(t,e.aspect),s.scope.updateScope({aspect:e.aspect}),e.pointer.ray.intersectPlane(P.gc,n),l.position.copy(n),i.updatePointer(e.pointer.ray)}),s.toColor(),null==(o=s.getChunk(0,0))||o.toWhite(),Object.assign(window,{world:s,cameraHandler:r}),(0,y.mj)(new u.eaF(new k.k,new M.Y({vertexColors:!0})),t)},[]),null}function H(){return F(function*(t){let e=new r.F(t.scene,t.camera);e.updatePdMaterial({lumaPhi:10,depthPhi:2,normalPhi:3,radius:2,radiusExponent:2,rings:2,samples:24}),yield t.pipeline.addPass(e,{type:n.O0.PostProcessing}),(0,d.O)({three:t,...a,TextHelper:l.w,calculateExponentialDecayLerpRatio:h.calculateExponentialDecayLerpRatio,calculateExponentialDecayLerpRatio2:h.calculateExponentialDecayLerpRatio2,lerp:c.lerp})},[]),null}function T(){return(0,s.jsx)("div",{className:"FractalGrid",children:(0,s.jsxs)(D,{children:[(0,s.jsxs)("div",{className:"layer thru flex flex-col p-4 gap-2 items-start",children:[(0,s.jsx)("h1",{className:"text-2xl",children:"FractalGrid"}),(0,s.jsx)("button",{className:"border border-white px-2 py-1 rounded",onClick:()=>q.instances[0].mode++,children:"Switch camera"})]}),(0,s.jsx)(H,{}),(0,s.jsx)(L,{})]})})}},96122:(t,e,o)=>{o.d(e,{T:()=>i});function i(t){let e=t.split("\n"),o=0;for(let t of e){let e=t.match(/^(\s*)\S/);if(e){o=e[1].length;break}}return e.map(t=>t.slice(Math.min(t.length,o))).join("\n")}}}]);