"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5731],{25731:function(e,t,r){r.d(t,{Main:function(){return q}});var n,o,i,s=r(78485),a=r(53171),l=r(48181),c=r(8834),u=r(52471),h=r(63221),d=r(63549),f=r(38137),p=r(87858),g=r(28142),w=r(9710),y=r(74831),m=r(494),x=r(1296),v=r(48437),C=r(88156),V=r(74175),M=r(81796),A=r(82446),S=r(99553),b=r(49635),k=r(16573);let P=[new u.Vector3(0,0,4).multiplyScalar(1),new u.Vector3(0,4,0).multiplyScalar(1),new u.Vector3(6,0,9).multiplyScalar(1),new u.Vector3(6,4,6).multiplyScalar(1)],z=new u.Vector3(0,-4,8);class F extends u.Mesh{createDots(){let e=new u.InstancedMesh(new u.IcosahedronGeometry(.1,8),new d.P,4);for(let[t,r]of((0,p.cY)(e,this),P.entries()))e.setMatrixAt(t,(0,b.$)({position:r})),e.setColorAt(t,(0,b.E)("#ffffff"));return this.dots=e,this}updateDots(e){this.dots||this.createDots();let t=this.dots;for(let[r,n]of P.entries()){t.setMatrixAt(r,(0,b.$)({position:n}));let o=e.isWithin(n)?"#00ffa6":"#ff0000";t.setColorAt(r,(0,b.E)(o))}t.instanceMatrix.needsUpdate=!0,t.instanceColor.needsUpdate=!0}get gridCoords(){return this._gridCoords}setGridCoords(e){(0,M.iK)(e,this._gridCoords);let{x:t,y:r}=this._gridCoords;this.scale.setScalar(.5**r),function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new u.Vector3,n=.5**t;r.set(6*e*n,4*(.5*n*2-1),6*e*n+8*(1-n)).multiplyScalar(1)}(t,r,this.position)}constructor({world:e=null,color:t=16777215*g.T.random()}={}){let r=new A.z(Math.ceil(115.19999999999999),1),n=new u.Vector3,o=(e,t)=>{let{x:n,y:o,z:i}=e,s=n+t,a=o+t,l=i+t;for(let e=i;e<l;e++)for(let t=o;t<a;t++)for(let o=n;o<s;o++)r.getVoxelState(o,t,e).setInt8(0,1)};for(let{x:e,y:t}of(0,k.B0)(6,4))n.set(e,t,e+4-1-t).multiplyScalar(4),o(n,4);for(let e=0;e<6;e+=2)n.set(e+1,3,e).multiplyScalar(4),o(n,4);console.time("geometry");let i=(0,A.eO)(r.voxelFaces());console.timeEnd("geometry"),i.scale(.25,.25,.25),super(i,new d.P({color:"#fff"})),this._gridCoords=new u.Vector2,this.world=null,this.dots=null,(0,S.c)(this.geometry,t),(0,p.cY)(new u.AxesHelper,this),this.world=e}}let B=new u.Vector3(1,0,1).normalize(),G=new u.Vector3(0,1,-1).normalize(),_=new u.Vector3().crossVectors(B,G).normalize();G.crossVectors(_,B).normalize();let D=new u.Matrix4().makeBasis(B,G,_);class I extends u.Group{static current(){if(0===this.instances.length)throw Error("No Scope!");return this.instances[this.instances.length-1]}updateScope(){let{aspect:e=1,width:t=4}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t/e;(t!==this.state.width||r!==this.state.height)&&(this.parts.lines.clear().circle({radius:1}).rectangle([-t/2,-r/2,t,r]).plus([0,0],.2).draw(),this.parts.lines.geometry.computeBoundingSphere(),this.state.width=t,this.state.height=r)}isWithin(e){let{x:t,y:r}=e.clone().applyMatrix4(this.matrixWorldInverse),{width:n,height:o}=this.state;return t>=-n/2&&t<=n/2&&r>=-o/2&&r<=o/2}chunkIntersects(e){this.updateMatrixWorld(),e.updateMatrixWorld();let t=!0,r=!0,n=!0,o=!0,i=this.state.width/2,s=this.state.height/2;for(let a=0;a<4;a++){let{x:l,y:c,z:u}=I._chunkIntersectsVectors[a].copy(P[a]).applyMatrix4(e.matrixWorld).applyMatrix4(this.matrixWorldInverse);if(t&&(t=l<-i),n&&(n=l>i),r&&(r=c<-s),o&&(o=c>s),!1===(t||r||n||o))return!0}return!1}toVertigoProps(){let{width:e,height:t}=this.state;return{perspective:.5,size:[e,t],focus:this.position,rotation:this.rotation}}constructor(){super(),this.parts={axes:(0,p.cY)(new u.Mesh(new h.w,new d.P({vertexColors:!0})),{parent:this,visible:!1}),lines:(0,p.cY)(new C.O,this),debugLines:(0,p.cY)(new C.O,this)},this.state={width:4,height:4},this.matrixWorldInverse=new u.Matrix4,this.destroy=()=>{let e=I.instances.indexOf(this);if(-1===e)throw Error("Scope instance not found");I.instances.splice(e,1)},I.instances.push(this),this.position.set(0,0,6),this.rotation.setFromRotationMatrix(D,v.a.default.rotation.order),this.rotation.x+=(0,V.FE)("20deg"),this.updateMatrix(),this.updateMatrixWorld(),this.matrixWorldInverse.copy(this.matrixWorld).invert()}}function E(e,t){if(e<-32768||e>=32768||t<-32768||t>=32768)throw RangeError("x and y must be in the range -0x8000 to 0x7fff");return(e+=32768)<<16|(t+=32768)}I.instances=[],I._chunkIntersectsVectors=[new u.Vector3,new u.Vector3,new u.Vector3,new u.Vector3];let L=new u.Vector2;function*N(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[n,o]=(()=>{if(1!==t.length)return t;{let{x:e,y:r}=(0,V.iK)(t[0]);return[e,r]}})();yield L.set(Math.floor((n-1)/2),o-1),yield L.set(Math.floor((n+1)/2),o-1),yield L.set(n-1,o),yield L.set(n+1,o),yield L.set(2*n-1,o+1),yield L.set(2*n,o+1),yield L.set(2*n+1,o+1),yield L.set(2*n+2,o+1)}class O extends u.Group{static current(){if(0===this.instances.length)throw Error("No World!");return this.instances[this.instances.length-1]}getChunk(e,t){var r;return null!==(r=this.chunks.get(E(e,t)))&&void 0!==r?r:null}ensureChunk(e,t){let r=E(e,t),n=this.chunks.get(r);if(n)return n;{let r=(0,p.cY)(new F({world:this}),this.chunkGroup);return this.chunks.set(E(e,t),r),r.setGridCoords([e,t]),r}}ensureChunkNeighbors(e,t){for(let r of(this.ensureChunk(e,t),N(e,t)))this.ensureChunk(r.x,r.y)}ensureScopeChunks(){let e=new Set([E(0,0)]),t=[this.ensureChunk(0,0)],r=0;for(;t.length>0;){if(r++>50){console.error("Exceeded maximum chunk count of ".concat(50));break}let n=t.pop();if(this.scope.chunkIntersects(n))for(let r of N(n.gridCoords)){let n=E(r.x,r.y);e.has(n)||(e.add(n),t.push(this.ensureChunk(r.x,r.y)))}}}constructor(){super(),this.origin=(0,p.cY)(new u.AxesHelper,{parent:this,position:z}),this.chunkWrapper=(0,p.cY)(new u.Group,{parent:this,position:z}),this.chunkGroup=(0,p.cY)(new u.Group,{parent:this.chunkWrapper,position:z.clone().negate()}),this.sphere=(0,p.cY)(new u.Mesh(new u.IcosahedronGeometry(1,8),new d.P({wireframe:!0})),{parent:this.chunkWrapper}),this.scope=(0,p.cY)(new I,this),this.chunks=new Map,this.destroy=()=>{this.scope.destroy(),this.chunks.clear(),this.clear();let e=O.instances.indexOf(this);if(-1===e)throw Error("World instance not found");O.instances.splice(e,1)},O.instances.push(this)}}O.instances=[],(n=o||(o={}))[n.Free=0]="Free",n[n.Scope=1]="Scope";class R{initialize(e){return this.element=e,this}*doStart(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(i=this.element)&&void 0!==i?i:document.body;yield(0,y.w)(e,{onDrag:e=>{this.position.x+=.01*e.delta.x,this.position.y+=-(.01*e.delta.y)}}),yield(0,w.RC)("three",e=>{let t=O.current();I.current(),this.dampedPosition.lerp(this.position,1-Math.exp(-(10*e.deltaTime)));let r=this.dampedPosition.y;t.chunkWrapper.scale.setScalar(2**(.33*r))})}start(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this._started||(this._destroyables.collect(this.doStart(...t)),this._started=!0)}stop(){this._started&&(this._destroyables.destroy(),this._started=!1)}toggle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this._started;e?this.start():this.stop()}update(e,t,r){this.vertigoControls.update(e,t,r)}constructor(){this.position=new u.Vector2,this.dampedPosition=new u.Vector2,this._destroyables=new x.N,this.vertigoControls=new m.F({perspective:.5}),this._started=!1,this.destroy=()=>{this._destroyables.destroy()}}}class W{get mode(){return this._mode}set mode(e){this.setMode(e)}initialize(e,t){this.camera=e,this.freeVertigoControls.initialize(t).toggle(0===this._mode),this.scopeCameraHandler.initialize(t).toggle(1===this._mode);let r=I.current().toVertigoProps();return this.scopeCameraHandler.vertigoControls.vertigo.set(r),this.scopeCameraHandler.vertigoControls.dampedVertigo.set(r),this}setMode(e){if(e%=2,this._mode!==e)switch(this._mode=e,this.freeVertigoControls.toggle(0===e),this.scopeCameraHandler.toggle(1===e),e){case 0:(()=>{this.mode=W.Mode.Free,this.freeVertigoControls.dampedVertigo.copy(this.scopeCameraHandler.vertigoControls.dampedVertigo)})();break;case 1:(()=>{this.mode=W.Mode.Scope,this.scopeCameraHandler.vertigoControls.dampedVertigo.copy(this.freeVertigoControls.dampedVertigo),this.scopeCameraHandler.vertigoControls.vertigo.set(I.current().toVertigoProps())})()}}onTick(e,t){switch(this._mode){case 0:this.freeVertigoControls.update(this.camera,t,e.deltaTime);break;case 1:this.scopeCameraHandler.update(this.camera,t,e.deltaTime)}}constructor(){this._mode=0,this.freeVertigoControls=new m.F({size:24,perspective:1}),this.scopeCameraHandler=new R,this.destroy=()=>{this.freeVertigoControls.destroy(),this.scopeCameraHandler.destroy();let e=W.instances.indexOf(this);if(-1===e)throw Error("CameraHandler instance not found");W.instances.splice(e,1)},W.instances.push(this)}}W.Mode=o,W.instances=[];var Y=r(27275),U=r(48583);r(94588);let j=(0,Y.createContext)(null);function H(e,t){let r=(0,Y.useContext)(j);return(0,U.sv)(async function*(t,n){if(e){let t=e(r,n);if(t&&"function"==typeof t.next)do{let{value:e,done:r}=await t.next();if(r)break;yield e}while(n.mounted)}},null!=t?t:"always"),r}let T={className:"",assetsPath:"/"};function X(e){let{children:t,className:r,assetsPath:n}={...T,...e},o=(0,Y.useMemo)(()=>new l.Vu,[]);o.loader.setPath(n);let{ref:i}=(0,U.Nv)({debounce:!0},function*(e,t){yield o.initialize(e),t.triggerRender(),Object.assign(window,{three:o})},[]);return(0,s.jsx)("div",{ref:i,className:r,style:{position:"absolute",inset:0},children:(0,s.jsx)(j.Provider,{value:o,children:o.initialized&&t})})}function Z(e){return function(){let[e,t]=(0,Y.useState)(!1);return(0,Y.useLayoutEffect)(()=>{t(!0)},[]),e}()&&(0,s.jsx)(X,{...e})}function K(){return!function(e,t,r){let n=(0,Y.useMemo)(()=>new u.Group,[]);n.name=e,H(async function*(e,r){if(e.scene.add(n),yield()=>{n.clear(),n.removeFromParent()},t){let o=t(n,e,r);if(o&&"function"==typeof o.next)do{let{value:e,done:t}=await o.next();if(t)break;yield e}while(r.mounted)}},r)}("fractal-grid",function*(e,t){(0,p.cY)(new f.w({color:"#110512"}),e),(0,p.cY)(new u.Mesh(new u.TorusKnotGeometry(2.5,.025,512,32),new d.P({color:"#0cf"})),e).visible=!1,g.T.seed(98763);let r=(0,p.cY)(new O,e);yield r.destroy,r.scope.updateScope({aspect:t.aspect}),r.ensureScopeChunks();let n=new W().initialize(t.camera,t.renderer.domElement);yield(0,w.RC)("three",e=>{n.onTick(e,t.aspect),r.scope.updateScope({aspect:t.aspect})}),Object.assign(window,{world:r,cameraHandler:n}),(0,p.cY)(new u.Mesh(new h.w,new d.P({vertexColors:!0})),e)},[]),null}function Q(){return H(function*(e){let t=new a.n(e.scene,e.camera);t.updatePdMaterial({lumaPhi:10,depthPhi:2,normalPhi:3,radius:2,radiusExponent:2,rings:2,samples:24}),yield e.pipeline.addPass(t,{type:l.GR.PostProcessing}),(0,c.a)({three:e})},[]),null}function q(){return(0,s.jsx)("div",{className:"FractalGrid",children:(0,s.jsxs)(Z,{children:[(0,s.jsx)("h1",{children:"FractalGrid"}),(0,s.jsx)(Q,{}),(0,s.jsx)(K,{})]})})}},8834:function(e,t,r){r.d(t,{Leak:function(){return a},a:function(){return s}});var n=r(40855),o=r(79509),i=r(28142);function s(e){Object.assign(window,{...o,...n,...e,PRNG:i.T})}function a(e){return s(e),null}},82446:function(e,t,r){r.d(t,{z:function(){return v},eO:function(){return A}});var n,o,i,s,a,l,c=r(52471);(n=s||(s={}))[n.X=0]="X",n[n.Y=2]="Y",n[n.Z=4]="Z",(o=a||(a={}))[o.R=0]="R",o[o.L=1]="L",o[o.U=2]="U",o[o.D=3]="D",o[o.F=4]="F",o[o.B=5]="B",(i=l||(l={}))[i.None=0]="None",i[i.All=63]="All",i[i.R=1]="R",i[i.L=2]="L",i[i.U=4]="U",i[i.D=8]="D",i[i.F=16]="F",i[i.B=32]="B";let u=[5,4,0,1,0,1],h=[new c.Vector3(1,0,0),new c.Vector3(-1,0,0),new c.Vector3(0,1,0),new c.Vector3(0,-1,0),new c.Vector3(0,0,1),new c.Vector3(0,0,-1)],d=0,f=0,p=0,g=0,w=[],y={A:()=>(w[d++]=f,w[d++]=p,w[d++]=g,y),B:()=>(w[d++]=f,w[d++]=p,w[d++]=g+1,y),C:()=>(w[d++]=f,w[d++]=p+1,w[d++]=g,y),D:()=>(w[d++]=f,w[d++]=p+1,w[d++]=g+1,y),E:()=>(w[d++]=f+1,w[d++]=p,w[d++]=g,y),F:()=>(w[d++]=f+1,w[d++]=p,w[d++]=g+1,y),G:()=>(w[d++]=f+1,w[d++]=p+1,w[d++]=g,y),H:()=>(w[d++]=f+1,w[d++]=p+1,w[d++]=g+1,y)},m={R:()=>(w[d++]=1,w[d++]=0,w[d++]=0,m),L:()=>(w[d++]=-1,w[d++]=0,w[d++]=0,m),U:()=>(w[d++]=0,w[d++]=1,w[d++]=0,m),D:()=>(w[d++]=0,w[d++]=-1,w[d++]=0,m),F:()=>(w[d++]=0,w[d++]=0,w[d++]=1,m),B:()=>(w[d++]=0,w[d++]=0,w[d++]=-1,m),R6:()=>m.R().R().R().R().R().R(),L6:()=>m.L().L().L().L().L().L(),U6:()=>m.U().U().U().U().U().U(),D6:()=>m.D().D().D().D().D().D(),F6:()=>m.F().F().F().F().F().F(),B6:()=>m.B().B().B().B().B().B()};class x{positionToArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{position:r,direction:n}=this;switch(w=e,d=t,f=r.x,p=r.y,g=r.z,n){case a.R:y.E().G().F().F().G().H();break;case a.L:y.A().B().D().A().D().C();break;case a.U:y.D().H().G().D().G().C();break;case a.D:y.A().E().F().A().F().B();break;case a.F:y.B().F().H().B().H().D();break;case a.B:y.A().C().E().E().C().G()}return e}normalToArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{direction:r}=this;switch(w=e,d=t,r){case a.R:m.R6();break;case a.L:m.L6();break;case a.U:m.U6();break;case a.D:m.D6();break;case a.F:m.F6();break;case a.B:m.B6()}return e}constructor(e,t,r=u[t]){this.position=e,this.direction=t,this.tangent=r}}class v{getVoxelState(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[n,o,i]=1===t.length?[t[0].x,t[0].y,t[0].z]:t,{size:s,size2:a,voxelStateByteSize:l,voxelState:c}=this;if(n<0||n>=s||o<0||o>=s||i<0||i>=s)throw Error("Coordinates out of bounds: ".concat(n,", ").concat(o,", ").concat(i,", size: ").concat(s));return new DataView(c,(n+o*s+i*a)*l,l)}tryGetVoxelState(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[n,o,i]=1===t.length?[t[0].x,t[0].y,t[0].z]:t,{size:s}=this;return n<0||n>=s||o<0||o>=s||i<0||i>=s?null:this.getVoxelState(n,o,i)}*voxelFaces(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>0!==e.getUint8(0),{size:t}=this,r=new x(new c.Vector3,0);for(let n=0;n<t;n++)for(let o=0;o<t;o++)for(let i=0;i<t;i++)if(e(this.getVoxelState(n,o,i)))for(let t=0;t<6;t++){let s=h[t],a=this.tryGetVoxelState(n+s.x,o+s.y,i+s.z);a&&e(a)||(r.position.set(n,o,i),r.direction=t,yield r)}}constructor(e=16,t=4){this.worldConnection=null,this.size=e,this.size2=e*e,this.size3=e*e*e,this.voxelStateByteSize=t,this.voxelState=new ArrayBuffer(e**3*t)}}class C{ensureSize(e){if(this.array.length<e){let t=new Float32Array(1<<Math.ceil(Math.log(e)/Math.log(2)));t.set(this.array),this.array=t}return this.array}copy(e){return new Float32Array(this.array.buffer,0,e).slice()}constructor(e=0){this.array=new Float32Array(0),this.ensureSize(e)}}let V=new C(768),M=new C(768);function A(e){let{geometry:t=new c.BufferGeometry}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="function"==typeof e?e():e;V.array.fill(0),M.array.fill(0);let n=0;for(let e of r){let t=18*n;V.ensureSize(t+18),M.ensureSize(t+18),e.positionToArray(V.array,t),e.normalToArray(M.array,t),n++}return t.setAttribute("position",new c.BufferAttribute(V.copy(18*n),3)),t.setAttribute("normal",new c.BufferAttribute(M.copy(18*n),3)),t}},63221:function(e,t,r){r.d(t,{w:function(){return c}});var n=r(52471),o=r(66666);let i={axis:"x",length:1,radialSegments:12,radius:.01,coneRatio:.1,radiusScale:1,vertexColor:!0,baseCap:"flat",color:"white"},s=new n.Color;function a(e){let{axis:t,length:r,radius:a,radialSegments:l,coneRatio:c,radiusScale:u,vertexColor:h,baseCap:d,color:f}={...i,...e},p=a*u,g=r*c,w=new n.ConeGeometry(3*p,g,l),y=new n.CylinderGeometry(p,p,1,l,1,!0),m=r-g,x=r-.5*g;w.rotateZ(-Math.PI/2).translate(x,0,0),y.scale(1,m,1).rotateZ(-Math.PI/2).translate(.5*m,0,0);let v="none"===d?new n.BufferGeometry:"flat"===d?new n.CircleGeometry(p,l).rotateY(-Math.PI/2):new n.SphereGeometry(p,l,3,0,2*Math.PI,0,.5*Math.PI).rotateZ(Math.PI/2).rotateX(Math.PI/2),C=(0,o.n4)([w,y,v]);switch(t){case"y":C.rotateZ(Math.PI/2);break;case"z":C.rotateY(-Math.PI/2)}if(h){let e=C.attributes.position.count,t=new n.BufferAttribute(new Float32Array(3*e),3);C.setAttribute("color",t),s.set(f);for(let r=0;r<e;r++)t.setXYZ(r,s.r,s.g,s.b)}return C}let l={xColor:"#ff3333",yColor:"#33cc66",zColor:"#3366ff"};class c extends n.BufferGeometry{constructor(e){super();let{xColor:t,yColor:r,zColor:n,...i}={...l,...e},s=a({...i,axis:"x",color:t}),c=a({...i,axis:"y",color:r}),u=a({...i,axis:"z",color:n}),h=(0,o.n4)([s,c,u]);this.copy(h),h.dispose()}}},88156:function(e,t,r){r.d(t,{O:function(){return u}});var n=r(52471),o=r(58648),i=r(81796);let s=new n.Vector2,a=new n.Vector3,l=new n.Matrix4;function c(e,t,r){if(null==r?void 0:r.transform)for(let e of((0,i.Xe)(r.transform,l),t))e.applyMatrix4(l);e.push(...t)}class u extends n.LineSegments{showOccludedLines(){let{opacity:e=.2}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new n.LineBasicMaterial({color:this.material.color,transparent:!0,depthFunc:n.GreaterDepth,opacity:e}),r=new n.LineSegments(this.geometry,t);return this.add(r),this}clear(){return this.points.length=0,this.geometry.setFromPoints(this.points),this}draw(){return this.geometry.setFromPoints(this.points),this.geometry.computeBoundingSphere(),this}line(e,t,r){let n=(0,i.Q7)(e),o=(0,i.Q7)(t);return c(this.points,[n,o],r),this}circle(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let{x:o,y:a,radius:l,segments:h,...d}={...u.circleDefaultOptions,...(()=>{if(t.length>1){let[e,r,n]=t,{x:o,y:a}=(0,i.iK)(e,s);return{x:o,y:a,radius:r,...n}}return t[0]})()},f=new n.Vector3(1,0,0),p=new n.Vector3(0,1,0),g=[];for(let e=0;e<h;e++){let t=e/h*Math.PI*2,r=(e+1)/h*Math.PI*2,i=Math.cos(t)*l,s=Math.sin(t)*l,c=Math.cos(r)*l,u=Math.sin(r)*l,d=new n.Vector3(o,a,0).addScaledVector(f,i).addScaledVector(p,s),w=new n.Vector3(o,a,0).addScaledVector(f,c).addScaledVector(p,u);g.push(d,w)}return c(this.points,g,d),this}rectangle(e,t){let{centerX:r,centerY:i,width:s,height:a}=o.Ae.from(e),l=s/2,u=a/2,h=new n.Vector3(r-l,i-u,0),d=new n.Vector3(r+l,i-u,0),f=new n.Vector3(r+l,i+u,0),p=new n.Vector3(r-l,i+u,0);return c(this.points,[h,d,d,f,f,p,p,h],t),this}box(){let{center:e=[0,0,0],size:t=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{x:r,y:o,z:s}=(0,i.Q7)(e,a),{x:l,y:c,z:u}=(0,i.Q7)(t,a),h=l/2,d=c/2,f=u/2,p=new n.Vector3(r-h,o-d,s-f),g=new n.Vector3(r+h,o-d,s-f),w=new n.Vector3(r+h,o+d,s-f),y=new n.Vector3(r-h,o+d,s-f),m=new n.Vector3(r-h,o-d,s+f),x=new n.Vector3(r+h,o-d,s+f),v=new n.Vector3(r+h,o+d,s+f),C=new n.Vector3(r-h,o+d,s+f);return this.points.push(p,g,g,w,w,y,y,p),this.points.push(m,x,x,v,v,C,C,m),this.points.push(p,m,g,x,w,v,y,C),this}plus(e,t,r){let o=t/2,{x:a,y:l}=(0,i.iK)(e,s),u=new n.Vector3(a-o,l,0),h=new n.Vector3(a+o,l,0),d=new n.Vector3(a,l-o,0),f=new n.Vector3(a,l+o,0);return c(this.points,[u,h,d,f],r),this}cross(e,t,r){let o=t/2,{x:a,y:l}=(0,i.iK)(e,s),u=new n.Vector3(a-o,l-o,0),h=new n.Vector3(a+o,l+o,0),d=new n.Vector3(a-o,l+o,0),f=new n.Vector3(a+o,l-o,0);return c(this.points,[u,h,d,f],r),this}constructor(...e){super(...e),this.points=[]}}u.circleDefaultOptions={x:0,y:0,radius:.5,segments:96}},63549:function(e,t,r){r.d(t,{P:function(){return i}});var n=r(52471);let o={vertexColors:!0,color:"white",luminosity:.5};class i extends n.ShaderMaterial{constructor(e){let{color:t,luminosity:r,vertexColors:i,...s}={...o,...e};super({...s,uniforms:{uColor:{value:new n.Color(t)},uSunPosition:{value:new n.Vector3(.5,.7,.3)},uLuminosity:{value:r}},vertexColors:i,vertexShader:"\nvarying vec3 vWorldNormal;\nvarying vec3 vColor;\n\nvoid main() {\n  vWorldNormal = mat3(modelMatrix) * normal;\n  vColor = color;\n#ifdef USE_INSTANCING\n  gl_Position = projectionMatrix * viewMatrix * modelMatrix * instanceMatrix * vec4(position, 1.0);\n#else\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n#endif\n#ifdef USE_INSTANCING_COLOR\n	vColor.xyz *= instanceColor.xyz;\n#endif\n}\n",fragmentShader:"\nvarying vec3 vWorldNormal;\nvarying vec3 vColor;\n\nuniform vec3 uSunPosition;\nuniform vec3 uColor;\nuniform float uLuminosity;\n\nvoid main() {\n  vec3 lightDirection = normalize(uSunPosition);\n  float light = dot(vWorldNormal, lightDirection) * 0.5 + 0.5;\n  light = pow(light, 2.0);\n  light = mix(uLuminosity, 1.0, light);\n  gl_FragColor = vec4(vColor * uColor * light, 1.0);\n}\n"}),this.sunPosition=this.uniforms.uSunPosition.value}}},38137:function(e,t,r){r.d(t,{w:function(){return i}});var n=r(52471);let o=new n.IcosahedronGeometry(1,4);class i extends n.Mesh{constructor(e){super(o,new n.MeshBasicMaterial({color:"#0c529d",...e,side:n.BackSide,depthWrite:!1,depthTest:!1})),this.renderOrder=-1,this.frustumCulled=!1,this.matrixAutoUpdate=!1,this.onBeforeRender=(e,t,r)=>{let n=(r.near+r.far)/2;this.position.copy(r.position),this.scale.setScalar(n),this.updateMatrix(),this.updateMatrixWorld()}}}},99553:function(e,t,r){r.d(t,{c:function(){return o}});var n=r(52471);function o(e,t){var r;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=Array.isArray(t)?t.map(e=>new n.Color(e)):[new n.Color(t)],a=e.attributes.position.count,l=null!==(r=e.attributes.color)&&void 0!==r?r:function(){let t=new n.BufferAttribute(new Float32Array(3*a),3);return e.setAttribute("color",t),t}(),c=i<0?a:i;if(1===s.length){let{r:e,g:t,b:r}=s[0];for(let n=o;n<c;n++)l.setXYZ(n,e,t,r)}else for(let e=o;e<c;e++){let{r:t,g:r,b:n}=s[e%s.length];l.setXYZ(e,t,r,n)}l.needsUpdate=!0}},49635:function(e,t,r){r.d(t,{$:function(){return s},E:function(){return l}});var n=r(52471),o=r(81796);let i=new n.Matrix4;function s(e){return(0,o.Xe)(e,i)}let a=new n.Color;function l(e){return a.set(e)}},16573:function(e,t,r){function*n(e){let t=0,r={get i(){return t},get t(){return t/e},get p(){return t/(e-1)}};for(t=0;t<e;t++)yield r}function*o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=0,o=0;2===t.length?(n=t[0],o=t[1]):Array.isArray(t[0])?(n=t[0][0],o=t[0][1]):(n=t[0].x,o=t[0].y);let i=0,s=0,a=0,l={get i(){return i},get x(){return s},get y(){return a},get tx(){return s/n},get ty(){return a/o},get px(){return s/(n-1)},get py(){return a/(o-1)}};for(a=0;a<o;a++)for(s=0;s<n;s++)yield l,i++}function*i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=0,o=0,i=0;3===t.length?(n=t[0],o=t[1],i=t[2]):Array.isArray(t[0])?(n=t[0][0],o=t[0][1],i=t[0][2]):(n=t[0].x,o=t[0].y,i=t[0].z);let s=0,a=0,l=0,c=0,u={get i(){return s},get x(){return a},get y(){return l},get z(){return c},get tx(){return a/n},get ty(){return l/o},get tz(){return c/i},get px(){return a/(n-1)},get py(){return l/(o-1)},get pz(){return c/(i-1)}};for(c=0;c<i;c++)for(l=0;l<o;l++)for(a=0;a<n;a++)yield u,s++}r.d(t,{B0:function(){return o},KA:function(){return i},VX:function(){return n}})},28142:function(e,t,r){r.d(t,{T:function(){return c}});let n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:123456;return(e=(e=(7*e+Math.sqrt(e)+16087*Math.sin(e))%2147483647)<0?e+2147483647:e)>1?2147483647&e:0===e?345678:123456},o=e=>e=2147483647&Math.imul(e,48271),i=e=>(e-1)/2147483646,s=e=>e,a={weightsAreNormalized:!1,indexOffset:0,forbiddenItems:[]};function l(){let e=o(o(n(123456)));function t(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:123456;return"string"==typeof t&&(t=t.split("").reduce((e,t)=>7*e+t.charCodeAt(0),0)),e=o(o(n(t))),h}function r(){return i(e=o(e))}function l(e){switch(e.length){default:return[0,1,s];case 1:return[0,e[0],s];case 2:return[e[0],e[1],s];case 3:return[e[0],e[1],e[2]]}}function c(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[o,i,s]=l(t);return o+(i-o)*s(r())}function u(){for(var e,t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];let[i,s,{weightsAreNormalized:l,indexOffset:c,forbiddenItems:u}]=function(e){let[t,r=null,n]=e,o={...a,...n};if(Array.isArray(t))return[t,r,o];if("object"==typeof t)return[Object.values(t),r?Object.values(r):null,o];throw Error("pick: unsupported options type")}(n);if(u.length>0){let t=new Set;for(let e of u){let r=i.indexOf(e);r>=0&&t.add(r)}if(i=i.filter((e,r)=>!t.has(r)),s=null!==(e=null==s?void 0:s.filter((e,r)=>!t.has(r)))&&void 0!==e?e:null,0===i.length)throw Error("pick: all items are forbidden")}if(null===s){let e=Math.floor(r()*i.length);return c&&(e+=c,(e%=i.length)<0&&(e+=i.length)),i[e]}if(!l){let e=s.reduce((e,t)=>e+t,0);s=s.map(t=>t/e)}let h=r(),d=0;for(let e=0;e<i.length;e++)if(h<(d+=s[e]))return i[e];throw Error("among: unreachable")}let h={seed:t,seedMax:function(){return 2147483647},reset:function(){return t(123456),h},next:function(){return e=o(e),h},random:r,between:c,around:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[o=1,i=s]=t,a=2*r();return(a>1?1:-1)*i(a>1?a-1:a)*o},int:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[o,i,s]=l(t);return o+Math.floor(s(r())*(i-o))},chance:function(e){return r()<e},shuffle:function(e){let{mutate:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t&&Array.isArray(e)?e:[...e],o=n.length;for(let e=0;e<o;e++){let t=Math.floor(o*r()),i=n[e];n[e]=n[t],n[t]=i}return n},pick:u,createPicker:function(e){let t=e.map(e=>{let[t]=e;return t}),r=e.map(e=>{let[t,r]=e;return r}),n=r.reduce((e,t)=>e+t,0);for(let[e,t]of r.entries())r[e]=t/n;return()=>u(t,r,{weightsAreNormalized:!0})},vector:function(e,t){let[r=0,n=1]=Array.isArray(t)?t:[null==t?void 0:t.min,null==t?void 0:t.max];for(let t of Object.keys(e))e[t]=c(r,n);return e},unitVector:function(e,t){let[r=-1,n=1]=Array.isArray(t)?t:[null==t?void 0:t.min,null==t?void 0:t.max],o=Object.keys(e),i=o.map(()=>c(r,n)),s=Math.sqrt(i.reduce((e,t)=>e+t*t,0));for(let[t,r]of o.entries())e[r]=i[t]/s;return e},boxMuller:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=r(),o=r(),i=Math.sqrt(-2*Math.log(n)),s=2*Math.PI*o;return[e+t*i*Math.cos(s),e+t*i*Math.sin(s)]}};return h}let c=class{constructor(e){Object.assign(this,l().seed(e))}};Object.assign(c,l())}}]);