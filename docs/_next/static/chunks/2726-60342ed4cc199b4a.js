(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2726],{14277:(t,e,r)=>{"use strict";r.d(e,{D:()=>i});var n=r(67203);function i(){let[t,e]=(0,n.useState)(!1);return(0,n.useLayoutEffect)(()=>{e(!0)},[]),t}},25499:t=>{t.exports={Client:"client_Client__Zi5zI"}},33855:(t,e,r)=>{"use strict";r.d(e,{dB:()=>p,q:()=>d,uB:()=>g,yk:()=>f});var n=r(70691),i=r(67203),s=r(49797),a=r(7587),l=r(48083),o=r(6697),h=r(36508),c=r(14277);let u=(0,i.createContext)(null);function f(t,e){let r=(0,i.useContext)(u);return(0,a.C7)(async function*(e,n){if(t){let e=t(r,n);if(e&&"function"==typeof e.next)do{let{value:t,done:r}=await e.next();if(r)break;yield t}while(n.mounted)}},null!=e?e:"always"),r}function p(t,e,r){let n=(0,i.useMemo)(()=>new s.YJl,[]);return n.name=t,f(async function*(t,r){if(t.scene.add(n),yield()=>{n.clear(),n.removeFromParent()},e){let i=e(n,t,r);if(i&&"function"==typeof i.next)do{let{value:t,done:e}=await i.next();if(e)break;yield t}while(r.mounted)}},r),n}function d(t){let{value:e}=t,r=(0,i.useMemo)(()=>"function"==typeof e?new e:e,[e]);return f(async function*(t){if(t.scene.add(r),"initialize"in r){let e=r.initialize(t);if(e&&"function"==typeof e.next)for(;;){let{value:t,done:r}=await e.next();if(r)break;yield t}}yield()=>{if(r.removeFromParent(),"destroy"in r){var t;null==(t=r.destroy)||t.call(r)}}},[r]),null}let y={className:"",assetsPath:"/",vertigoControls:!1};function x(t){let{children:e,className:r,assetsPath:s,vertigoControls:c}={...y,...t},f=(0,i.useMemo)(()=>new o.XW,[]);f.loader.setPath(s);let{ref:p}=(0,a.IZ)({debounce:!0},function*(t,e){yield f.initialize(t.firstElementChild),e.triggerRender(),Object.assign(window,{three:f})},[]);(0,a.C7)(function*(){if(c){let t=new l.n("object"==typeof c?c:{}).initialize(p.current).start();yield t.destroy,yield(0,h.xy)("three",e=>{t.update(f.camera,f.aspect,e.deltaTime)})}},[c]);let d={position:"absolute",inset:0};return(0,n.jsx)("div",{ref:p,className:r,style:d,children:(0,n.jsxs)(u.Provider,{value:f,children:[(0,n.jsx)("div",{style:d}),(0,n.jsx)("div",{style:d,className:"thru",children:f.initialized&&e})]})})}function g(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return(0,c.D)()&&(0,n.jsx)(x,{...e[0]})}},42726:(t,e,r)=>{"use strict";r.d(e,{Client:()=>tx});var n=r(70691);r(48083),r(9723),r(87381),r(36508);var i=r(33855),s=r(25499),a=r.n(s),l=r(67203),o=r(49797),h=r(22641),c=r(67840);class u{ensureKeyEntry(t,e,r){let n=this.keyMap.get(t);if(n){if(n.count!==r)throw Error("A key entry already exists with a different count. This is not allowed. Once a key is set, it cannot be changed.");return n}{let n={index:e,count:r};return this.keyMap.set(t,n),n}}applyTransform(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];throw Error("Not implemented!")}clear(){return this.keyMap.clear(),this}constructor(){this.keyMap=new Map,this.transformMatrix=new o.kn4}}function f(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}var p=r(29443),d=r(17953),y=r(81074),x=r(6726),g=r(60041);let m=new o.Pq0,w=new o.Pq0,b=new o.Pq0,M=new o.Pq0,z=new o.Pq0,A=new o.Pq0,_=new o.Pq0,S=new o.Q1f,P=new o.kn4;class C{static box(t){let[e,r,n,i,s,a,l,o]=C.boxPoints;if("min"in t||"max"in t){let{min:n=C.boxMinMaxDefaults.min,max:i=C.boxMinMaxDefaults.max}=t;(0,h.jj)(n,e),(0,h.jj)(i,r)}else if("center"in t||"size"in t){let{center:s=C.boxCenterSizeDefaults.center,size:a=C.boxCenterSizeDefaults.size}=t;(0,h.jj)(s,n),(0,h.jj)(a,i).multiplyScalar(.5),e.copy(n).sub(i),r.copy(n).add(i)}else e.copy(C.boxMinMaxDefaults.min),r.copy(C.boxMinMaxDefaults.max);t.inset&&(e.addScalar(t.inset),r.addScalar(-t.inset));let{x:c,y:u,z:f}=e,{x:p,y:d,z:y}=r;return r.set(p,u,f),n.set(p,u,y),i.set(c,u,y),s.set(c,d,f),a.set(p,d,f),l.set(p,d,y),o.set(c,d,y),t.transform&&((0,h.vl)(t.transform,P),e.applyMatrix4(P),r.applyMatrix4(P),n.applyMatrix4(P),i.applyMatrix4(P),s.applyMatrix4(P),a.applyMatrix4(P),l.applyMatrix4(P),o.applyMatrix4(P)),C}}C.boxPoints=[new o.Pq0,new o.Pq0,new o.Pq0,new o.Pq0,new o.Pq0,new o.Pq0,new o.Pq0,new o.Pq0],C.boxDefaults={inset:0,transform:void 0},C.boxMinMaxDefaults={min:new o.Pq0(-.5,-.5,-.5),max:new o.Pq0(.5,.5,.5)},C.boxCenterSizeDefaults={center:new o.Pq0(0,0,0),size:new o.Pq0(1,1,1)};let T={size:.1,proportionalSize:!1,position:"middle",skip:void 0,type:"single",scale:1},j={key:void 0,color:void 0,opacity:1,arrow:!1};var q=new WeakSet;class k extends u{static createParts(){let{nodeMaterial:t=!1,lineCount:e=2e4,defaultColor:r="white",defaultOpacity:n=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=new o.LoY,s={position:new o.THS(new Float32Array(3*e*2),3),color:new o.THS(new Float32Array(3*e*2),3),aOpacity:new o.THS(new Float32Array(2*e),1)};for(let[t,e]of Object.entries(s))i.setAttribute(t,e);let a=t?(()=>{let t=new y.e9u({vertexColors:!0,transparent:!0,depthWrite:!1}),e=(0,d.xIr)(s.aOpacity,"float",1,0);return t.opacityNode=(0,d.PCg)(e),t})():(()=>{let t=new o.mrM({vertexColors:!0,transparent:!0,depthWrite:!1});return t.onBeforeCompile=t=>g.b.with(t).varying({vOpacity:"float"}).vertex.top("\n          attribute float aOpacity;\n        ").vertex.mainAfterAll("\n          vOpacity = aOpacity;\n        ").fragment.after("color_fragment","\n          diffuseColor.a *= vOpacity;\n        "),t})(),l=new o.DXC(i,a);return l.frustumCulled=!1,{count:e,defaults:{color:r,opacity:n},geometry:i,attributes:s,lines:l}}applyTransform(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.parts.geometry.applyMatrix4((0,h.GD)(e))}clear(){return super.clear(),this.state.index=0,this.parts.geometry.setDrawRange(0,0),this}onTop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,{lines:e}=this.parts;return 0!==t?(e.renderOrder=t,e.material.depthTest=!1,e.material.depthWrite=!1):(e.renderOrder=0,e.material.depthTest=!0,e.material.depthWrite=!0),this}segmentsArray(t,e){let{position:r,color:n,aOpacity:i}=this.parts.attributes,{key:s,color:a,opacity:l}={...j,...this.parts.defaults,...e},{r:o,g:h,b:c}=S.set(a),u=t.length/3,p=function(t,e){var r,n;if(!1===e||void 0===e)return new Float32Array;let i=Array.isArray(e)?e:[!0===e?{}:e],s=0;for(let t of i){let e=null!=(r=null==t?void 0:t.type)?r:T.type,i=null!=(n=null==t?void 0:t.position)?n:T.position;s+=(Array.isArray(i)?i.length:1)*("triple"===e?3:"double"===e?2:1)}let a=t.length/3/2,l=new Float32Array(a*s*12),o=0;for(let e=0;e<a;e++){let r=6*e;m.set(t[r+0],t[r+1],t[r+2]),w.set(t[r+3],t[r+4],t[r+5]),b.subVectors(w,m);let n=b.lengthSq();for(let t of i){let{size:e=T.size,proportionalSize:r=T.proportionalSize,position:i=T.position,skip:s=T.skip,type:a=T.type,scale:h=T.scale}=null!=t?t:{};if(void 0!==s){if(!0===s||"less-than-size"===s){if(n<e*e)continue}else if("number"==typeof s&&n<s*s)continue}let c=Math.sqrt(n),u=(r?c:1)*e*h;M.copy(b).divideScalar(c);let f=Math.abs(M.x),p=Math.abs(M.y),d=Math.abs(M.z);for(let t of(f>=d&&p>=d?z.set(M.y,-M.x,0).normalize():p>=f?z.set(M.z,0,-M.x).normalize():z.set(0,M.z,-M.y).normalize(),Array.isArray(i)?i:[i])){let r="triple"===a?3:"double"===a?2:1;for(let n=0;n<r;n++){let i=function(t){if("number"==typeof t)return t;switch(t){case"end":return 1;case"start":return 0;case"middle":return .5;default:throw Error("Invalid arrow position: ".concat(t))}}(t);r>1&&(i+=(n/(r-1)-i)*e/c*.8),A.lerpVectors(m,w,i),A.toArray(l,(4*o+0)*3),_.copy(A).addScaledVector(M,-u).addScaledVector(z,-u).toArray(l,(4*o+1)*3),A.toArray(l,(4*o+2)*3),_.copy(A).addScaledVector(M,-u).addScaledVector(z,u).toArray(l,(4*o+3)*3),o++}}}}return l}(t,null==e?void 0:e.arrow),d=p.length/3,y=u+d,{index:x}=void 0!==s?this.ensureKeyEntry(s,this.state.index,u):this.state;if(x+y>this.parts.count)throw console.log("Overflow Handling Not implemented",x+y,this.parts.count),Error("Overflow Handling Not implemented");this.state.index=Math.max(this.state.index,x+y);{let{transformMatrix:e}=this;for(let s=0;s<u;s++)m.fromArray(t,3*s).applyMatrix4(e).toArray(r.array,(x+s)*3),n.setXYZ(x+s,o,h,c),i.setX(x+s,l)}{let t=x+u;for(let e=0;e<d;e++)m.fromArray(p,3*e).applyMatrix4(this.transformMatrix).toArray(r.array,(t+e)*3),n.setXYZ(t+e,o,h,c),i.setX(t+e,l)}return f(this,q,E).call(this),this}segments(t,e){let r=t.length,n=new Float32Array(3*r);for(let e=0;e<r;e++){let{x:r,y:i,z:s}=(0,h.jj)(t[e],m),a=3*e;n[a+0]=r,n[a+1]=i,n[a+2]=s}return this.segmentsArray(n,e)}line(t,e,r){return this.segments([t,e],r)}polyline(t,e){if(t.length<2)return this;let r=Array((t.length-1)*2);for(let e=1;e<t.length;e++)r[2*e-2]=t[e-1],r[2*e-1]=t[e];return this.segments(r,e)}polygon(t,e){return t.length<2||(this.polyline(t,e),this.line(t[t.length-1],t[0],e)),this}box(t,e){let[r,n,i,s,a,l,o,h]=C.box(t).boxPoints;return this.segmentsArray(new Float32Array([r.x,r.y,r.z,n.x,n.y,n.z,n.x,n.y,n.z,i.x,i.y,i.z,i.x,i.y,i.z,s.x,s.y,s.z,s.x,s.y,s.z,r.x,r.y,r.z,a.x,a.y,a.z,l.x,l.y,l.z,l.x,l.y,l.z,o.x,o.y,o.z,o.x,o.y,o.z,h.x,h.y,h.z,h.x,h.y,h.z,a.x,a.y,a.z,r.x,r.y,r.z,a.x,a.y,a.z,n.x,n.y,n.z,l.x,l.y,l.z,i.x,i.y,i.z,o.x,o.y,o.z,s.x,s.y,s.z,h.x,h.y,h.z]),e)}rect(t,e){let{minX:r,minY:n,maxX:i,maxY:s}=x.M_.from(t),{inset:a}={...k.rectDefaultOptions,...e};return r+=a,n+=a,i-=a,s-=a,this.segments([{x:r,y:n,z:0},{x:i,y:n,z:0},{x:i,y:n,z:0},{x:i,y:s,z:0},{x:i,y:s,z:0},{x:r,y:s,z:0},{x:r,y:s,z:0},{x:r,y:n,z:0}],e)}circle(){let{center:t=0,axis:e="z",radius:r=1,quality:n="medium",segments:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;null!=i||(i=k.circleQualityPresets[n]);let{x:a,y:l,z:o}=(0,h.jj)(t,m);(0,h.jj)(e,m).normalize(),w.set(m.y,m.z,m.x).cross(m).normalize(),b.crossVectors(m,w);let c=new Float32Array(3*i*2);for(let t=0;t<i;t++){let e=t/i*Math.PI*2,n=(t+1)/i*Math.PI*2,s=Math.cos(e)*r,h=Math.sin(e)*r,u=Math.cos(n)*r,f=Math.sin(n)*r,p=6*t;c[p+0]=a+s*w.x+h*b.x,c[p+1]=l+s*w.y+h*b.y,c[p+2]=o+s*w.z+h*b.z,c[p+3]=a+u*w.x+f*b.x,c[p+4]=l+u*w.y+f*b.y,c[p+5]=o+u*w.z+f*b.z}return this.segmentsArray(c,s),this}regularGrid(t){let{color:e,opacity:r,plane:n,size:i,subdivisions:s}={...k.regularGridDefaults,...t},a=s.length,l=s.map((t,e)=>s.slice(e).reduce((t,e)=>t*e,1)),o=l[0],h=new Float32Array((o+1)*12),c=new Float32Array((o+1)*12).fill(1),u=new Float32Array((o+1)*4).fill(1),p=Array.isArray(e)?e:[e],d=s.map((t,e)=>{let{r,g:n,b:i}=S.set(p[Math.min(e,p.length-1)]);return[r,n,i]}),y=Array.isArray(r)?r:[r],x=s.map((t,e)=>y[Math.min(e,y.length-1)]);for(let t=0;t<=o;t++){let e=a-1;for(;t%l[e]==0&&!(--e<=0););let[r,n,s]=d[e],f=x[e],p=t/o*i,y=12*t;h[y+0]=-i/2,h[y+1]=-i/2+p,h[y+2]=0,h[y+3]=i/2,h[y+4]=-i/2+p,h[y+5]=0,h[y+6]=-i/2+p,h[y+7]=-i/2,h[y+8]=0,h[y+9]=-i/2+p,h[y+10]=i/2,h[y+11]=0,c[y+0]=r,c[y+1]=n,c[y+2]=s,c[y+3]=r,c[y+4]=n,c[y+5]=s,c[y+6]=r,c[y+7]=n,c[y+8]=s,c[y+9]=r,c[y+10]=n,c[y+11]=s;let g=4*t;u[g+0]=f,u[g+1]=f,u[g+2]=f,u[g+3]=f}if("xz"===n)for(let t=0;t<h.length;t+=3)h[t+2]=h[t+1],h[t+1]=0;else if("yz"===n)for(let t=0;t<h.length;t+=3)h[t+2]=h[t+1],h[t+1]=h[t+0],h[t+0]=0;let{index:g}=this.state;return this.parts.attributes.position.array.set(h,3*g),this.parts.attributes.color.array.set(c,3*g),this.parts.attributes.aOpacity.array.set(u,g),this.state.index+=(o+1)*4,f(this,q,E).call(this),this}constructor(t){super(),function(t,e){(0,p._)(t,e),e.add(t)}(this,q),this.state={index:0},this.parts=k.createParts(t)}}function E(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(let t of(this.parts.geometry.setDrawRange(0,this.state.index),Object.values(this.parts.attributes)))t.needsUpdate=!0;if(this.state.index>2*this.parts.count)throw Error("Not implemented!");if(t)for(let t of Object.values(this.parts.attributes))t.array.some(t=>isNaN(t))&&console.log(t.array.findIndex(t=>isNaN(t)))}k.rectDefaultOptions={inset:0},k.circleQualityPresets={low:18,medium:36,high:64,ultra:256},k.regularGridDefaults={plane:"xy",size:100,subdivisions:[10,2,5],opacity:[.2,.05,.01],color:"white"};class N extends u{static createParts(){let{pointCount:t=1e4}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new o.LoY,r={position:new o.THS(new Float32Array(3*t),3),color:new o.THS(new Float32Array(3*t),3),aScale:new o.THS(new Float32Array(t),1),aShape:new o.THS(new Float32Array(t),1)};for(let[t,n]of Object.entries(r))e.setAttribute(t,n);let n=new o.BH$({vertexColors:!0});n.onBeforeCompile=t=>g.b.with(t).varying({vShape:"float"}).vertex.top("\n        attribute float aScale;\n        attribute float aShape;\n      ").vertex.mainAfterAll("\n        gl_PointSize *= aScale;\n        vShape = aShape;\n      ").fragment.top("\n        float sdBox(in vec2 p, in vec2 b) {\n          vec2 d = abs(p) - b;\n          return length(max(d, 0.0)) + min(max(d.x, d.y), 0.0);\n        }\n      ").fragment.after("color_fragment","\n        float regular = .2;\n        float thin = .1;\n        float ultraThin = .033;\n\n        if (vShape == ".concat(N.shapes.circle,".0) {\n          float d = distance(gl_PointCoord * 2.0, vec2(1.0));\n          if (d > 1.0) discard;\n        }\n\n        if (vShape == ").concat(N.shapes.ring,".0) {\n          float d = distance(gl_PointCoord * 2.0, vec2(1.0));\n          if (d < 0.8 || d > 1.0) discard;\n        }\n\n        if (vShape == ").concat(N.shapes["ring-thin"],".0) {\n          float d = distance(gl_PointCoord * 2.0, vec2(1.0));\n          if (d < 0.9 || d > 1.0) discard;\n        }\n\n        else if (vShape == ").concat(N.shapes.plus,".0) {\n          float d0 = sdBox(gl_PointCoord * 2.0 - 1.0, vec2(1.0, regular));\n          float d1 = sdBox(gl_PointCoord * 2.0 - 1.0, vec2(regular, 1.0));\n          if (d0 > 0.0 && d1 > 0.0) discard;\n        }\n\n        else if (vShape == ").concat(N.shapes["plus-thin"],".0) {\n          float d0 = sdBox(gl_PointCoord * 2.0 - 1.0, vec2(1.0, thin));\n          float d1 = sdBox(gl_PointCoord * 2.0 - 1.0, vec2(thin, 1.0));\n          if (d0 > 0.0 && d1 > 0.0) discard;\n        }\n\n        else if (vShape == ").concat(N.shapes["plus-ultra-thin"],".0) {\n          float d0 = sdBox(gl_PointCoord * 2.0 - 1.0, vec2(1.0, ultraThin));\n          float d1 = sdBox(gl_PointCoord * 2.0 - 1.0, vec2(ultraThin, 1.0));\n          if (d0 > 0.0 && d1 > 0.0) discard;\n        }\n\n        else if (vShape == ").concat(N.shapes.x,".0) {\n          vec2 p = gl_PointCoord * 2.0 - 1.0;\n          float c = 0.70710678;\n          p = mat2(c, -c, c, c) * p;\n          float d0 = sdBox(p, vec2(1.0, regular));\n          float d1 = sdBox(p, vec2(regular, 1.0));\n          if (d0 > 0.0 && d1 > 0.0) discard;\n        }\n\n        else if (vShape == ").concat(N.shapes["x-thin"],".0) {\n          vec2 p = gl_PointCoord * 2.0 - 1.0;\n          float c = 0.70710678;\n          p = mat2(c, -c, c, c) * p;\n          float d0 = sdBox(p, vec2(1.0, thin));\n          float d1 = sdBox(p, vec2(thin, 1.0));\n          if (d0 > 0.0 && d1 > 0.0) discard;\n        }\n\n        else if (vShape == ").concat(N.shapes["x-ultra-thin"],".0) {\n          vec2 p = gl_PointCoord * 2.0 - 1.0;\n          float c = 0.70710678;\n          p = mat2(c, -c, c, c) * p;\n          float d0 = sdBox(p, vec2(1.0, ultraThin));\n          float d1 = sdBox(p, vec2(ultraThin, 1.0));\n          if (d0 > 0.0 && d1 > 0.0) discard;\n        }\n\n        // diffuseColor.rgb *= vec3(gl_PointCoord, 1.0);\n      "));let i=new o.ONl(e,n);return i.frustumCulled=!1,{count:t,geometry:e,attributes:r,points:i}}applyTransform(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.parts.geometry.applyMatrix4((0,h.GD)(e))}clear(){return super.clear(),this.state.index=0,this.parts.geometry.setDrawRange(0,0),this}onTop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,{points:e}=this.parts;return 0!==t?(e.renderOrder=t,e.material.depthTest=!1,e.material.depthWrite=!1,e.material.transparent=!0):(e.renderOrder=0,e.material.depthTest=!0,e.material.depthWrite=!0,e.material.transparent=!1),this}points(t){let{key:e,size:r=.1,scale:n=1,color:i="white",shape:s="square"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{transformMatrix:a}=this,l=void 0!==e,o=t.length,{index:c}=l?this.ensureKeyEntry(e,this.state.index,o):this.state,{position:u,color:f,aScale:p,aShape:d}=this.parts.attributes,{r:y,g:x,b:g}=S.set(i),w=n*r,b=N.shapes[s];for(let e=0;e<o;e++){let{x:r,y:n,z:i}=(0,h.jj)(t[e],m).applyMatrix4(a),s=c+e;u.setXYZ(s,r,n,i),f.setXYZ(s,y,x,g),p.setX(s,w),d.setX(s,b)}for(let t of(this.state.index=l?Math.max(this.state.index,c+o):c+o,this.parts.geometry.setDrawRange(0,this.state.index),Object.values(this.parts.attributes)))t.needsUpdate=!0;if(this.state.index>this.parts.count)throw Error("Overflow Handling Not implemented");return this}box(t,e){let{boxPoints:r}=C.box(t);return this.points(r,e)}point(t,e){return this.points([t],e)}constructor(t){super(),this.state={index:0},this.parts=N.createParts(t)}}N.shapes=(()=>{let t=0;return{square:t++,circle:t++,ring:t++,"ring-thin":t++,plus:t++,"plus-thin":t++,"plus-ultra-thin":t++,x:t++,"x-thin":t++,"x-ultra-thin":t++}})();class F extends u{static createParts(t){let e=new c.w({textCount:2e3,...t});return{count:e.count,textHelper:e}}applyTransform(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.parts.textHelper.applyTransform(...e)}clear(){return this.state.index=0,this.parts.textHelper.clearAllText(),this}onTop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return this.parts.textHelper.onTop(t),this}texts(t,e){let r=this.state.index,{texts:n,...i}={...F.textDefaults,...e},s="function"==typeof n?n:t=>n[t%n.length],a=0;for(let e of t){let{x:t,y:n,z:l}=(0,h.jj)(e,m);this.parts.textHelper.setTextAt(r,s(a),{...i,x:t,y:n,z:l}),r++,a++}return this.state.index=r,this}text(t,e,r){return this.texts([t],{...r,texts:[e]})}textAt(t,e,r){return this.parts.textHelper.setTextAt(t,e,{...r}),this}constructor(t){super(),this.state={index:0},this.parts=F.createParts(t)}}F.textDefaults={texts:t=>t.toString()};let O={color:void 0,size:.1,shape:"square",scale:1};class D extends o.YJl{static createParts(t,e){let{nodeMaterial:r}=null!=e?e:{},n=new N(null==e?void 0:e.points);t.add(n.parts.points);let i=new k({nodeMaterial:r,...null==e?void 0:e.lines});t.add(i.parts.lines);let s=new F({nodeMaterial:r,...null==e?void 0:e.texts});return t.add(s.parts.textHelper),{pointsManager:n,linesManager:i,textsManager:s}}points(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.pointsManager.points(...e),this}point(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.pointsManager.point(...e),this}segments(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.linesManager.segments(...e),this}line(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.linesManager.line(...e),this}polyline(t,e){return this.parts.linesManager.polyline(t,e),(null==e?void 0:e.points)&&this.points(t,{...O,color:e.color,...!0===e.points?{}:e.points}),this}polylines(t,e){for(let r of t)this.polyline(r,e);return this}polygon(t,e){return this.parts.linesManager.polygon(t,e),(null==e?void 0:e.points)&&this.points(t,{...O,color:e.color,...!0===e.points?{}:e.points}),this}polygons(t,e){for(let r of t)this.polygon(r,e);return this}box(t,e){return this.parts.linesManager.box(t,e),(null==e?void 0:e.points)&&this.parts.pointsManager.box(t,{...O,color:e.color,...!0===e.points?{}:e.points}),this}circle(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.linesManager.circle(...e),this}rect(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.linesManager.rect(...e),this}regularGrid(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.linesManager.regularGrid(...e),this}texts(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.textsManager.texts(...e),this}text(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.textsManager.text(...e),this}textAt(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.textsManager.textAt(...e),this}applyTransform(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.pointsManager.applyTransform(...e),this.parts.linesManager.applyTransform(...e),this.parts.textsManager.applyTransform(...e),this}clear(){return this.parts.pointsManager.clear(),this.parts.linesManager.clear(),this.parts.textsManager.clear(),this}onTop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return this.renderOrder=t,this.parts.pointsManager.onTop(t),this.parts.linesManager.onTop(t),this.parts.textsManager.onTop(t),this}globalExpose(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"debugHelper";return Object.assign(globalThis,{[t]:this}),this}addTo(t){return t?t.add(this):this.removeFromParent(),this}constructor(t){super(),this.parts=D.createParts(this,t)}}let B=new D;function H(t){let{plane:e="xz",size:r=120,subdivisions:n=[100,3],opacity:s=[.1,.01]}=t;return(0,i.dB)("grid",function*(t){new D().regularGrid({plane:e,size:r,subdivisions:n,opacity:s}).addTo(t)}),null}function I(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6329;return(t=Math.imul(t,r))<<e|t>>>32-e}let W=new Float64Array(1),R=new Int32Array(W.buffer);function X(t,e){W[0]=t;let r=R[0],n=R[1];W[0]=e;let i=R[0],s=R[1];return 0x131e63bd^(I(r,3,48271)^I(n,17,0x85ebca77)^(I(i,13,0xc2b2ae3d)^I(s,27,0x27d4eb2f)))}function V(t,e,r){W[0]=t;let n=R[0],i=R[1];W[0]=e;let s=R[0],a=R[1];W[0]=r;let l=R[0],o=R[1];return 0x9a586057^(I(n,3,48271)^I(i,17,0x85ebca77)^(I(s,13,0xc2b2ae3d)^I(a,27,0x27d4eb2f))^(I(l,5,0x165667b1)^I(o,19,0x9e3779b1)))}function Y(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];switch(1===e.length&&"object"==typeof e[0]&&(e=Object.values(e[0]).filter(t=>"number"==typeof t)),e.length){case 2:return X(e[0],e[1]);case 3:return V(e[0],e[1],e[2]);default:return function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let n=0x96d50edf,i=0;for(;i<e.length-1;i+=2)n=V(n,e[i],e[i+1]);for(;i<e.length;i++)n=X(n,e[i]);return n}(...e)}}var G=r(28535),Z=r(76999),K=r(57368),L=r(44138);function Q(t,e){var r=(0,L._)(t,e,"update");if(r.set){if(!r.get)throw TypeError("attempted to read set only private field");return"__destrWrapper"in r||(r.__destrWrapper={set value(v){r.set.call(t,v)},get value(){return r.get.call(t)}}),r.__destrWrapper}if(!r.writable)throw TypeError("attempted to set read only private field");return r}class J{insert(t,e,r){let n=this;for(;;){if(n.x===t&&n.y===e){n.value=r;return}if(n.next)n=n.next;else{n.next=new J(t,e,r);return}}}remove(t,e){let r=this;for(;r.next;){if(r.next.x===t&&r.next.y===e)return r.next=r.next.next,!0;r=r.next}return!1}constructor(t,e,r){this.x=t,this.y=e,this.value=r}}function*U(t){if(void 0!==t)if(t instanceof J){let e=t;for(;e;)yield[e.x,e.y,e.value],e=e.next}else yield[t.x,t.y,t.value]}var $=new WeakMap,tt=new WeakMap,te=new WeakMap,tr=new WeakMap;class tn{clear(){(0,G._)(this,$).clear(),(0,K._)(this,tt,0)}hasCell(t,e){return(0,G._)(this,$).has((0,G._)(this,tr).call(this,t,e))}has(t,e){return void 0!==this.get(t,e)}get(t,e){let r=(0,G._)(this,tr).call(this,t,e),n=(0,G._)(this,$).get(r);if(void 0!==n)if(!(n instanceof J))return n.x===t&&n.y===e?n.value:void 0;else{let r=n;for(;r;){if(r.x===t&&r.y===e)return r.value;r=r.next}return}}set(t,e,r){if(void 0===r)return void this.delete(t,e);let n=(0,G._)(this,tr).call(this,t,e),i=(0,G._)(this,$).get(n);if(void 0===i)(0,G._)(this,$).set(n,{x:t,y:e,value:r}),Q(this,tt).value++;else if(i instanceof J)i.insert(t,e,r),Q(this,tt).value++;else if(i.x===t&&i.y===e)i.value=r;else{let s=new J(i.x,i.y,i.value);s.insert(t,e,r),(0,G._)(this,$).set(n,s),Q(this,tt).value++}}delete(t,e){let r=(0,G._)(this,tr).call(this,t,e),n=(0,G._)(this,$).get(r);if(void 0===n)return!1;if(n instanceof J)if(n.x===t&&n.y===e)return n.next?(0,G._)(this,$).set(r,n.next):(0,G._)(this,$).delete(r),Q(this,tt).value--,!0;else return Q(this,tt).value--,n.remove(t,e);return n.x===t&&n.y===e&&((0,G._)(this,$).delete(r),Q(this,tt).value--,!0)}*cellEntries(t,e){let r=(0,G._)(this,$).get((0,G._)(this,tr).call(this,t,e));yield*U(r)}cellFirstEntry(t,e){let r=(0,G._)(this,$).get((0,G._)(this,tr).call(this,t,e));return r&&[r.x,r.y,r.value]}*cellNeighborEntries(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=(0,G._)(this,$),i=(0,G._)(this,tr),s=(0,G._)(this,te);for(let a=-r;a<=r;a++)for(let l=-r;l<=r;l++){let r=t+a*s,o=e+l*s,h=n.get(i(r,o));yield*U(h)}}*entries(){for(let t of(0,G._)(this,$).values())yield*U(t)}*cellValues(t,e){for(let[,,r]of this.cellEntries(t,e))yield r}*values(){for(let[,,t]of this.entries())yield t}mapEntries(t){let e=[];for(let[r,n,i]of this.entries())e.push(t(r,n,i));return e}*query(t,e,r){let n=r*r;for(let[i,s,a]of this.cellNeighborEntries(t,e,Math.ceil(r/(0,G._)(this,te)))){let r=i-t,l=s-e;r*r+l*l<=n&&(yield[i,s,a])}}queryFirst(t,e,r){for(let[n,i,s]of this.query(t,e,r))return[n,i,s]}queryNearest(t,e,r){let n,i=1/0;for(let[s,a,l]of this.query(t,e,r)){let r=s-t,o=a-e,h=r*r+o*o;h<i&&(i=h,n=[s,a,l])}return n}get cellCount(){return(0,G._)(this,$).size}get valueCount(){return(0,G._)(this,tt)}get cellSize(){return(0,G._)(this,te)}get cellHash(){return(0,G._)(this,tr)}floor(t){return Math.floor(t/(0,G._)(this,te))*(0,G._)(this,te)}ceil(t){return Math.ceil(t/(0,G._)(this,te))*(0,G._)(this,te)}round(t){return Math.round(t/(0,G._)(this,te))*(0,G._)(this,te)}computeMaxValueCountPerCell(){let t=0;for(let e of(0,G._)(this,$).values())if(e instanceof J){let r=0,n=e;for(;n;)r++,n=n.next;r>t&&(t=r)}else t=Math.max(t,1);return t}constructor(t=0){(0,Z._)(this,$,{writable:!0,value:void 0}),(0,Z._)(this,tt,{writable:!0,value:void 0}),(0,Z._)(this,te,{writable:!0,value:void 0}),(0,Z._)(this,tr,{writable:!0,value:void 0}),(0,K._)(this,$,new Map),(0,K._)(this,tt,0),(0,K._)(this,te,t),(0,K._)(this,tr,0===t?X:(e,r)=>X(Math.floor(e/t),Math.floor(r/t)))}}function*ti(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,n=0;for(;n++<r;){yield t;let r=e.get(t);if(void 0===r)break;if(t=r,n>1e3)throw console.log(n),Error("Infinite loop?")}}class ts{next(){var t,e,r,n,i,s,a;let l;if(0===this.openSet.size)return null;let o=1/0;for(let e of this.openSet){let r=null!=(t=this.fScore.get(e))?t:1/0;r<o&&(l=e,o=r)}if(!l)return null;if(this.current=l,this.current===this.params.goal){return a=this.cameFrom,[...ti(this.current,a)].reverse()}for(let{node:t,cost:a}of(this.openSet.delete(this.current),this.params.getNeighbors(this.current))){this.neighbor=t;let l=null!=(n=null==(e=(r=this.params).customNeighborHeuristic)?void 0:e.call(r,this))?n:a,o=(null!=(i=this.gScore.get(this.current))?i:1/0)+l;o<(null!=(s=this.gScore.get(this.neighbor))?s:1/0)&&(this.cameFrom.set(this.neighbor,this.current),this.gScore.set(this.neighbor,o),this.fScore.set(this.neighbor,o+this.params.heuristic(this.neighbor,this.params.goal)),this.openSet.add(this.neighbor))}return null}findPath(){let{openSet:t}=this;for(;t.size>0;){let t=this.next();if(t)return t}return[]}solve(){return this.findPath()}constructor(t){var e=this;this.openSet=new Set,this.cameFrom=new Map,this.gScore=new Map,this.fScore=new Map,this.params=t;let{start:r,goal:n,heuristic:i}=t;this.current=r,this.neighbor=r,this.openSet.add(r),this.gScore.set(r,0),this.fScore.set(r,i(r,n)),this.start=r,this.goal=n,this.wayback=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;return ti(e.current,e.cameFrom,t)}}}var ta=r(44694);let tl={radius:1,radiusRatioMax:1,maxCount:1e3,random:Math.random,start:[0,0],isValid:(t,e)=>!0,maxAttempts:23};var to=r(79285),th=r(79105);let tc=function t(){let e=Math.random,r=()=>{};function n(t){if(0===t.length)throw Error("Weights array is empty");let r=t.reduce((t,e)=>t+e,0),n=e()*r,i=0;for(let e=0;e<t.length;e++)if(n<(i+=t[e]))return e;return t.length-1}let i={new:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return t().setRandom(...r)},setRandom:function(){for(var t=arguments.length,n=Array(t),s=0;s<t;s++)n[s]=arguments[s];let[a,l=0]=n;if("parkmiller"===a){let t=th.Ts(l);e=()=>(t=th.K2(t),th.Tj(t)),r=e=>{t=th.Ts(e)}}else{if(void 0!==a&&"function"!=typeof a)throw Error("Invalid random function");e=null!=a?a:Math.random,r=()=>{}}return r(l),i},seed:function(t){return r("reset"===t?0:null!=t?t:0),i},get random(){return e},number:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];if(0===r.length)return e();if(1===r.length)return e()*r[0];if(2===r.length)return e()*(r[1]-r[0])+r[0];throw Error("Invalid arguments")},int:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];if(1===r.length)return Math.floor(e()*r[0]);if(2===r.length)return Math.floor(e()*(r[1]-r[0]))+r[0];throw Error("Invalid arguments")},hexColor:function(){let t=Math.floor(0xffffff*e());return"#".concat(t.toString(16).padStart(6,"0"))},pickIndex:n,pick:function(t,r){if(0===t.length)throw Error("Array is empty");if(r)return t[n(r)];let i=Math.floor(e()*t.length);return t[i]}};return i}(),tu=["#ffcc33","#33ccff","#cc66ff"];function tf(t){let{title:e="Info title",description:r="Info description"}=t;return r=r.trim().split("\n").map(t=>t.trim()).filter(t=>t.length>0).join("\n"),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:".125em"},children:[(0,n.jsx)("div",{children:e}),(0,n.jsx)("div",{style:{fontSize:".75em",color:"#fff9",textAlign:"left",whiteSpace:"pre-wrap",overflowY:"auto",maxHeight:"10em",paddingLeft:"2em"},children:r})]})}function tp(){return(0,i.dB)("random-scene",function*(t){B.clear().addTo(t);let e=new tn(.5);e.set(.5,.3,"#ffcc00"),e.set(2.2,3.1,"#00ffcc"),e.set(2.5,3.5,"#00b7ff"),tc.setRandom("parkmiller").seed("reset");for(let t=0;t<300;t++){let t=tc.number(-10,10),r=tc.number(-10,10),n=tc.pick(tu);e.set(t,r,n)}let r=new Map;for(let[t,n,i]of e.entries()){B.point([t,n],{color:i,size:1,shape:"plus-thin"});let s=Y(t,n),a=r.get(s);void 0===a?r.set(s,{x:e.floor(t),y:e.floor(n),count:1}):a.count++}for(let[t,r,n]of e.cellEntries(3.5,-2.5))B.point([t,r],{color:n,size:2,shape:"ring-thin"});for(let[t,r,n]of(B.box({center:[5+.5*e.cellSize,4+.5*e.cellSize],size:[5*e.cellSize,5*e.cellSize]}),e.cellNeighborEntries(5,4,2)))B.point([t,r],{color:n,size:2,shape:"ring-thin"});for(let[,{x:t,y:n,count:i}]of r.entries())B.text([t+e.cellSize/2,n+e.cellSize/2],"(".concat(t,",").concat(n,")\n"),{color:"white",size:.25}).text([t+e.cellSize/2,n+e.cellSize/2],"\n".concat(i),{color:"white",size:.5});for(let[t,r,n]of e.query(-5,-2,4))B.point([t,r],{size:1.5,shape:"ring",color:n});B.circle({center:[-5,-2],radius:4,quality:"ultra"})},[]),(0,n.jsx)(tf,{title:"Hash-Grid 2D",description:"\n        grid.cellEntries(x, y) - query all items in a cell\n        grid.cellNeighborEntries(x, y, manhattanRadius) - query all items in a cell and its neighbors\n        grid.query(x, y, radius) - query all items in a circle\n      "})}function td(){let[t,e]=(0,l.useState)("");return(0,i.dB)("poisson-scene",function*(t){let r=[],n=new D({points:{pointCount:1e5}}).clear().addTo(t);tc.setRandom("parkmiller").seed("reset");let i=performance.now(),s=new o.I9Y(20.5,.15),a=function(t){let e={...tl,...t},{radius:r,radiusRatioMax:n,maxCount:i,random:s,start:a,isValid:l,maxAttempts:o}=e;if(r<=0)throw Error("Radius must be greater than 0");if(n<1)throw Error("Radius ratio max must be greater than or equal to 1");let h=new tn(r/Math.sqrt(2)),c=(0,ta.wX)(a);if(!l(c.x,c.y))throw Error("First sample is not valid");let u=[c];h.set(c.x,c.y,0);let f=[c];for(;u.length>0&&f.length<i;){let t=Math.floor(s()*u.length),e=u[t],i=!1,a=s()*Math.PI*2;for(let t=0;t<o;t++){let c=a+t/o*Math.PI*2,p=r+s()*(n-r),d=e.x+Math.cos(c)*p,y=e.y+Math.sin(c)*p;if(!l(d,y)||h.hasCell(d,y))continue;let x=!0;for(let[t,e,n]of h.cellNeighborEntries(d,y,2)){let n=d-t,i=y-e;if(Math.sqrt(n*n+i*i)<r){x=!1;break}}if(!1===x)continue;i=!0;let g={x:d,y};f.push(g),u.push(g),h.set(d,y,f.length-1);break}!1===i&&u.splice(t,1)}return{samples:f,grid:h,params:e}}({maxCount:1e4,isValid:(t,e)=>20>Math.hypot(t-20,e-0)&&Math.hypot(t-10,e)>(0,to.lerp)(9.25,9.5,.5*Math.sin(40*Math.atan2(e,t-10))+.5)&&Math.hypot(t-30,e)>(0,to.lerp)(9.25,9.5,.5*Math.sin(40*Math.atan2(e,t-30))+.5),start:s,random:tc.random,radius:.1,radiusRatioMax:1.4}),l=performance.now()-i;for(let t of(r.push("Poisson sampling took ".concat(l.toFixed(2),"ms")),n.circle({center:s,radius:.1}),a.samples))n.point(t,{size:.33,shape:"circle",color:tc.pick(tu)});for(let[t,e]of a.grid.query(18,-8,1))n.point([t,e],{size:.5,shape:"ring",color:tc.pick(tu)});for(let[t,e]of a.grid.query(20,-10,1.5*a.params.radius))n.point([t,e],{size:.5,shape:"ring",color:tc.pick(tu)});{let[t,e]=a.grid.queryNearest(20,10,.2);n.point([t,e],{size:1.5,shape:"ring",color:"white"})}{let t=performance.now(),i=(0,h.wX)(a.grid.queryNearest(20,-10,.5)),s=(0,h.wX)(a.grid.queryNearest(20,10,.5)),l=new Map;l.set(Y(i.x,i.y),i),l.set(Y(s.x,s.y),s);let c=new ts({start:i,goal:s,getNeighbors:function(t){let e=[];for(let[r,n]of a.grid.query(t.x,t.y,1.5*a.params.radius)){let t=Y(r,n);if(l.has(t))e.push(l.get(t));else{let i=new o.I9Y(r,n);l.set(t,i),e.push(i)}}return e.map(t=>({node:t,cost:t.distanceTo(t)}))},heuristic:(t,e)=>t.distanceTo(e)}).findPath();n.polyline(c,{color:"white",points:{size:.2,shape:"x"}});let u=performance.now()-t;r.push("A* pathfinding took ".concat(u.toFixed(2),"ms (").concat(c.length," nodes)")),e(r.join("\n"))}},[]),(0,n.jsx)(tf,{title:"Poisson sampling + A* pathfinding",description:t})}function ty(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(H,{size:100,subdivisions:[10,10,2],opacity:[.1,.01,.004],plane:"xy"}),(0,n.jsxs)("div",{className:"p-8",children:[(0,n.jsx)(tp,{}),(0,n.jsx)(td,{})]})]})}function tx(){return(0,n.jsx)("div",{className:"layer thru ".concat(a().Client),children:(0,n.jsx)(i.uB,{vertigoControls:{size:24},children:(0,n.jsx)(ty,{})})})}}}]);