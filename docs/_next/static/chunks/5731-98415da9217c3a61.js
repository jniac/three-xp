"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5731],{25731:function(t,e,r){r.d(e,{Main:function(){return Q}});var n,o,i,s=r(78485),a=r(53171),l=r(48181),c=r(8834),u=r(52471),h=r(63221),d=r(63549),f=r(38137),p=r(87858),g=r(28142),y=r(9710),w=r(74831),m=r(494),v=r(1296);let x=new u.Vector3(1,0,1).normalize(),C=new u.Vector3(0,1,-1).normalize(),V=new u.Vector3().crossVectors(x,C).normalize();C.crossVectors(V,x).normalize();let M=new u.Matrix4().makeBasis(x,C,V);var A=r(48437),S=r(88156),b=r(74175),k=r(81796),P=r(82446),z=r(99553),F=r(49635),B=r(16573);let G=[new u.Vector3(0,0,4).multiplyScalar(1),new u.Vector3(0,4,0).multiplyScalar(1),new u.Vector3(6,0,9).multiplyScalar(1),new u.Vector3(6,4,6).multiplyScalar(1)];class _ extends u.Mesh{createDots(){let t=new u.InstancedMesh(new u.IcosahedronGeometry(.1,8),new d.P,4);for(let[e,r]of((0,p.cY)(t,this),G.entries()))t.setMatrixAt(e,(0,F.$)({position:r})),t.setColorAt(e,(0,F.E)("#ffffff"));return this.dots=t,this}updateDots(t){this.dots||this.createDots();let e=this.dots;for(let[r,n]of G.entries()){e.setMatrixAt(r,(0,F.$)({position:n}));let o=t.isWithin(n)?"#00ffa6":"#ff0000";e.setColorAt(r,(0,F.E)(o))}e.instanceMatrix.needsUpdate=!0,e.instanceColor.needsUpdate=!0}get gridCoords(){return this._gridCoords}setGridCoords(t){(0,k.iK)(t,this._gridCoords);let{x:e,y:r}=this._gridCoords,n=.5**r,o=.5*n;this.scale.setScalar(n),this.position.set(6*e*n,4*(2*o-1),6*e*n+8*(1-n)).multiplyScalar(1)}constructor({world:t=null,color:e=16777215*g.T.random()}={}){let r=new P.z(128,1),n=new u.Vector3,o=(t,e)=>{let{x:n,y:o,z:i}=t,s=n+e,a=o+e,l=i+e;for(let t=i;t<l;t++)for(let e=o;e<a;e++)for(let o=n;o<s;o++)r.getVoxelState(o,e,t).setInt8(0,1)};for(let{x:t,y:e}of(0,B.B0)(6,4))n.set(t,e,t+4-1-e).multiplyScalar(4),o(n,4);for(let t=0;t<6;t+=2)n.set(t+1,3,t).multiplyScalar(4),o(n,4);let i=1/4;console.time("geometry");let s=(0,P.eO)(r.voxelFaces());console.timeEnd("geometry"),s.scale(i,i,i),super(s,new d.P({color:"#fff"})),this._gridCoords=new u.Vector2,this.world=null,this.dots=null,(0,z.c)(this.geometry,e),this.world=t}}class D extends u.Group{static current(){if(0===this.instances.length)throw Error("No Scope!");return this.instances[this.instances.length-1]}updateScope(){let{aspect:t=1,width:e=4}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e/t;(e!==this.state.width||r!==this.state.height)&&(this.parts.lines.clear().circle({radius:1}).rectangle([-e/2,-r/2,e,r]).plus([0,0],.2).draw(),this.parts.lines.geometry.computeBoundingSphere(),this.state.width=e,this.state.height=r)}isWithin(t){let{x:e,y:r}=t.clone().applyMatrix4(this.matrixWorldInverse),{width:n,height:o}=this.state;return e>=-n/2&&e<=n/2&&r>=-o/2&&r<=o/2}chunkIntersects(t){this.updateMatrixWorld(),t.updateMatrixWorld();let e=!0,r=!0,n=!0,o=!0,i=this.state.width/2,s=this.state.height/2;for(let a=0;a<4;a++){let{x:l,y:c,z:u}=D._chunkIntersectsVectors[a].copy(G[a]).applyMatrix4(t.matrixWorld).applyMatrix4(this.matrixWorldInverse);if(e&&(e=l<-i),n&&(n=l>i),r&&(r=c<-s),o&&(o=c>s),!1===(e||r||n||o))return!0}return!1}toVertigoProps(){let{width:t,height:e}=this.state;return{perspective:.5,size:[t,e],focus:this.position,rotation:this.rotation}}constructor(){super(),this.parts={axes:(0,p.cY)(new u.Mesh(new h.w,new d.P({vertexColors:!0})),{parent:this,visible:!1}),lines:(0,p.cY)(new S.O,this),debugLines:(0,p.cY)(new S.O,this)},this.state={width:4,height:4},this.matrixWorldInverse=new u.Matrix4,this.destroy=()=>{let t=D.instances.indexOf(this);if(-1===t)throw Error("Scope instance not found");D.instances.splice(t,1)},D.instances.push(this),this.position.set(0,0,6),this.rotation.setFromRotationMatrix(M,A.a.default.rotation.order),this.rotation.x+=(0,b.FE)("20deg"),this.updateMatrix(),this.updateMatrixWorld(),this.matrixWorldInverse.copy(this.matrixWorld).invert()}}function I(t,e){if(t<-32768||t>=32768||e<-32768||e>=32768)throw RangeError("x and y must be in the range -0x8000 to 0x7fff");return(t+=32768)<<16|(e+=32768)}D.instances=[],D._chunkIntersectsVectors=[new u.Vector3,new u.Vector3,new u.Vector3,new u.Vector3];let E=new u.Vector2;function*L(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let[n,o]=(()=>{if(1!==e.length)return e;{let{x:t,y:r}=(0,b.iK)(e[0]);return[t,r]}})();yield E.set(Math.floor((n-1)/2),o-1),yield E.set(Math.floor((n+1)/2),o-1),yield E.set(n-1,o),yield E.set(n+1,o),yield E.set(2*n-1,o+1),yield E.set(2*n,o+1),yield E.set(2*n+1,o+1),yield E.set(2*n+2,o+1)}class N extends u.Group{static current(){if(0===this.instances.length)throw Error("No World!");return this.instances[this.instances.length-1]}getChunk(t,e){var r;return null!==(r=this.chunks.get(I(t,e)))&&void 0!==r?r:null}ensureChunk(t,e){let r=I(t,e),n=this.chunks.get(r);if(n)return n;{let r=(0,p.cY)(new _({world:this}),this.chunkGroup);return this.chunks.set(I(t,e),r),r.setGridCoords([t,e]),r}}ensureChunkNeighbors(t,e){for(let r of(this.ensureChunk(t,e),L(t,e)))this.ensureChunk(r.x,r.y)}ensureScopeChunks(){let t=new Set([I(0,0)]),e=[this.ensureChunk(0,0)],r=0;for(;e.length>0;){if(r++>50){console.error("Exceeded maximum chunk count of ".concat(50));break}let n=e.pop();if(this.scope.chunkIntersects(n))for(let r of L(n.gridCoords)){let n=I(r.x,r.y);t.has(n)||(t.add(n),e.push(this.ensureChunk(r.x,r.y)))}}}constructor(){super(),this.scope=(0,p.cY)(new D,this),this.chunkGroup=(0,p.cY)(new u.Group,this),this.chunks=new Map,this.destroy=()=>{this.scope.destroy(),this.chunks.clear(),this.clear();let t=N.instances.indexOf(this);if(-1===t)throw Error("World instance not found");N.instances.splice(t,1)},N.instances.push(this)}}N.instances=[],(n=o||(o={}))[n.Free=0]="Free",n[n.Scope=1]="Scope";class O{initialize(t){return this.element=t,this}*doStart(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(i=this.element)&&void 0!==i?i:document.body;yield(0,w.w)(t,{onDrag:t=>{this.position.x+=.01*t.delta.x,this.position.y+=-(.01*t.delta.y)}}),yield(0,y.RC)("three",t=>{let e=N.current(),r=D.current(),n=this.position.y;e.chunkGroup.position.set(0,0,0).addScaledVector(C,n);let o=2**(n/4);r.scale.setScalar(1/o),this.vertigoControls.vertigo.set({zoom:o}),this.vertigoControls.dampedVertigo.set({zoom:o})})}start(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this._started||(this._destroyables.collect(this.doStart(...e)),this._started=!0)}stop(){this._started&&(this._destroyables.destroy(),this._started=!1)}toggle(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this._started;t?this.start():this.stop()}update(t,e,r){this.vertigoControls.update(t,e,r)}constructor(){this.position=new u.Vector2,this._destroyables=new v.N,this.vertigoControls=new m.F({perspective:.5}),this._started=!1,this.destroy=()=>{this._destroyables.destroy()}}}class R{get mode(){return this._mode}set mode(t){this.setMode(t)}initialize(t,e){this.camera=t,this.freeVertigoControls.initialize(e).toggle(0===this._mode),this.scopeCameraHandler.initialize(e).toggle(1===this._mode);let r=D.current().toVertigoProps();return this.scopeCameraHandler.vertigoControls.vertigo.set(r),this.scopeCameraHandler.vertigoControls.dampedVertigo.set(r),this}setMode(t){if(t%=2,this._mode!==t)switch(this._mode=t,this.freeVertigoControls.toggle(0===t),this.scopeCameraHandler.toggle(1===t),t){case 0:(()=>{this.mode=R.Mode.Free,this.freeVertigoControls.dampedVertigo.copy(this.scopeCameraHandler.vertigoControls.dampedVertigo)})();break;case 1:(()=>{this.mode=R.Mode.Scope,this.scopeCameraHandler.vertigoControls.dampedVertigo.copy(this.freeVertigoControls.dampedVertigo),this.scopeCameraHandler.vertigoControls.vertigo.set(D.current().toVertigoProps())})()}}onTick(t,e){switch(this._mode){case 0:this.freeVertigoControls.update(this.camera,e,t.deltaTime);break;case 1:this.scopeCameraHandler.update(this.camera,e,t.deltaTime)}}constructor(){this._mode=0,this.freeVertigoControls=new m.F({size:24,perspective:1}),this.scopeCameraHandler=new O,this.destroy=()=>{this.freeVertigoControls.destroy(),this.scopeCameraHandler.destroy();let t=R.instances.indexOf(this);if(-1===t)throw Error("CameraHandler instance not found");R.instances.splice(t,1)},R.instances.push(this)}}R.Mode=o,R.instances=[];var U=r(27275),j=r(48583);r(94588);let W=(0,U.createContext)(null);function Y(t,e){let r=(0,U.useContext)(W);return(0,j.sv)(async function*(e,n){if(t){let e=t(r,n);if(e&&"function"==typeof e.next)do{let{value:t,done:r}=await e.next();if(r)break;yield t}while(n.mounted)}},null!=e?e:"always"),r}let H={className:"",assetsPath:"/"};function T(t){let{children:e,className:r,assetsPath:n}={...H,...t},o=(0,U.useMemo)(()=>new l.Vu,[]);o.loader.setPath(n);let{ref:i}=(0,j.Nv)({debounce:!0},function*(t,e){yield o.initialize(t),e.triggerRender(),Object.assign(window,{three:o})},[]);return(0,s.jsx)("div",{ref:i,className:r,style:{position:"absolute",inset:0},children:(0,s.jsx)(W.Provider,{value:o,children:o.initialized&&e})})}function X(t){return function(){let[t,e]=(0,U.useState)(!1);return(0,U.useLayoutEffect)(()=>{e(!0)},[]),t}()&&(0,s.jsx)(T,{...t})}function Z(){return!function(t,e,r){let n=(0,U.useMemo)(()=>new u.Group,[]);n.name=t,Y(async function*(t,r){if(t.scene.add(n),yield()=>{n.clear(),n.removeFromParent()},e){let o=e(n,t,r);if(o&&"function"==typeof o.next)do{let{value:t,done:e}=await o.next();if(e)break;yield t}while(r.mounted)}},r)}("fractal-grid",function*(t,e){(0,p.cY)(new f.w({color:"#110512"}),t),(0,p.cY)(new u.Mesh(new u.TorusKnotGeometry(2.5,.025,512,32),new d.P({color:"#0cf"})),t).visible=!1,g.T.seed(98763);let r=(0,p.cY)(new N,t);yield r.destroy,r.scope.updateScope({aspect:e.aspect}),r.ensureScopeChunks();let n=new R().initialize(e.camera,e.renderer.domElement);yield(0,y.RC)("three",t=>{n.onTick(t,e.aspect),r.scope.updateScope({aspect:e.aspect})}),Object.assign(window,{world:r,cameraHandler:n}),(0,p.cY)(new u.Mesh(new h.w,new d.P({vertexColors:!0})),t)},[]),null}function K(){return Y(function*(t){let e=new a.n(t.scene,t.camera);e.updatePdMaterial({lumaPhi:10,depthPhi:2,normalPhi:3,radius:2,radiusExponent:2,rings:2,samples:24}),yield t.pipeline.addPass(e,{type:l.GR.PostProcessing}),(0,c.a)({three:t})},[]),null}function Q(){return(0,s.jsx)("div",{className:"FractalGrid",children:(0,s.jsxs)(X,{children:[(0,s.jsx)("h1",{children:"FractalGrid"}),(0,s.jsx)(K,{}),(0,s.jsx)(Z,{})]})})}},8834:function(t,e,r){r.d(e,{Leak:function(){return a},a:function(){return s}});var n=r(40855),o=r(79509),i=r(28142);function s(t){Object.assign(window,{...o,...n,...t,PRNG:i.T})}function a(t){return s(t),null}},82446:function(t,e,r){r.d(e,{z:function(){return x},eO:function(){return A}});var n,o,i,s,a,l,c=r(52471);(n=s||(s={}))[n.X=0]="X",n[n.Y=2]="Y",n[n.Z=4]="Z",(o=a||(a={}))[o.R=0]="R",o[o.L=1]="L",o[o.U=2]="U",o[o.D=3]="D",o[o.F=4]="F",o[o.B=5]="B",(i=l||(l={}))[i.None=0]="None",i[i.All=63]="All",i[i.R=1]="R",i[i.L=2]="L",i[i.U=4]="U",i[i.D=8]="D",i[i.F=16]="F",i[i.B=32]="B";let u=[5,4,0,1,0,1],h=[new c.Vector3(1,0,0),new c.Vector3(-1,0,0),new c.Vector3(0,1,0),new c.Vector3(0,-1,0),new c.Vector3(0,0,1),new c.Vector3(0,0,-1)],d=0,f=0,p=0,g=0,y=[],w={A:()=>(y[d++]=f,y[d++]=p,y[d++]=g,w),B:()=>(y[d++]=f,y[d++]=p,y[d++]=g+1,w),C:()=>(y[d++]=f,y[d++]=p+1,y[d++]=g,w),D:()=>(y[d++]=f,y[d++]=p+1,y[d++]=g+1,w),E:()=>(y[d++]=f+1,y[d++]=p,y[d++]=g,w),F:()=>(y[d++]=f+1,y[d++]=p,y[d++]=g+1,w),G:()=>(y[d++]=f+1,y[d++]=p+1,y[d++]=g,w),H:()=>(y[d++]=f+1,y[d++]=p+1,y[d++]=g+1,w)},m={R:()=>(y[d++]=1,y[d++]=0,y[d++]=0,m),L:()=>(y[d++]=-1,y[d++]=0,y[d++]=0,m),U:()=>(y[d++]=0,y[d++]=1,y[d++]=0,m),D:()=>(y[d++]=0,y[d++]=-1,y[d++]=0,m),F:()=>(y[d++]=0,y[d++]=0,y[d++]=1,m),B:()=>(y[d++]=0,y[d++]=0,y[d++]=-1,m),R6:()=>m.R().R().R().R().R().R(),L6:()=>m.L().L().L().L().L().L(),U6:()=>m.U().U().U().U().U().U(),D6:()=>m.D().D().D().D().D().D(),F6:()=>m.F().F().F().F().F().F(),B6:()=>m.B().B().B().B().B().B()};class v{positionToArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{position:r,direction:n}=this;switch(y=t,d=e,f=r.x,p=r.y,g=r.z,n){case a.R:w.E().G().F().F().G().H();break;case a.L:w.A().B().D().A().D().C();break;case a.U:w.D().H().G().D().G().C();break;case a.D:w.A().E().F().A().F().B();break;case a.F:w.B().F().H().B().H().D();break;case a.B:w.A().C().E().E().C().G()}return t}normalToArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{direction:r}=this;switch(y=t,d=e,r){case a.R:m.R6();break;case a.L:m.L6();break;case a.U:m.U6();break;case a.D:m.D6();break;case a.F:m.F6();break;case a.B:m.B6()}return t}constructor(t,e,r=u[e]){this.position=t,this.direction=e,this.tangent=r}}class x{getVoxelState(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let[n,o,i]=1===e.length?[e[0].x,e[0].y,e[0].z]:e,{size:s,size2:a,voxelStateByteSize:l,voxelState:c}=this;if(n<0||n>=s||o<0||o>=s||i<0||i>=s)throw Error("Coordinates out of bounds: ".concat(n,", ").concat(o,", ").concat(i,", size: ").concat(s));return new DataView(c,(n+o*s+i*a)*l,l)}tryGetVoxelState(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let[n,o,i]=1===e.length?[e[0].x,e[0].y,e[0].z]:e,{size:s}=this;return n<0||n>=s||o<0||o>=s||i<0||i>=s?null:this.getVoxelState(n,o,i)}*voxelFaces(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t=>0!==t.getUint8(0),{size:e}=this,r=new v(new c.Vector3,0);for(let n=0;n<e;n++)for(let o=0;o<e;o++)for(let i=0;i<e;i++)if(t(this.getVoxelState(n,o,i)))for(let e=0;e<6;e++){let s=h[e],a=this.tryGetVoxelState(n+s.x,o+s.y,i+s.z);a&&t(a)||(r.position.set(n,o,i),r.direction=e,yield r)}}constructor(t=16,e=4){this.worldConnection=null,this.size=t,this.size2=t*t,this.size3=t*t*t,this.voxelStateByteSize=e,this.voxelState=new ArrayBuffer(t**3*e)}}class C{ensureSize(t){if(this.array.length<t){let e=new Float32Array(1<<Math.ceil(Math.log(t)/Math.log(2)));e.set(this.array),this.array=e}return this.array}copy(t){return new Float32Array(this.array.buffer,0,t).slice()}constructor(t=0){this.array=new Float32Array(0),this.ensureSize(t)}}let V=new C(768),M=new C(768);function A(t){let{geometry:e=new c.BufferGeometry}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="function"==typeof t?t():t;V.array.fill(0),M.array.fill(0);let n=0;for(let t of r){let e=18*n;V.ensureSize(e+18),M.ensureSize(e+18),t.positionToArray(V.array,e),t.normalToArray(M.array,e),n++}return e.setAttribute("position",new c.BufferAttribute(V.copy(18*n),3)),e.setAttribute("normal",new c.BufferAttribute(M.copy(18*n),3)),e}},63221:function(t,e,r){r.d(e,{w:function(){return c}});var n=r(52471),o=r(66666);let i={axis:"x",length:1,radialSegments:12,radius:.01,coneRatio:.1,radiusScale:1,vertexColor:!0,baseCap:"flat",color:"white"},s=new n.Color;function a(t){let{axis:e,length:r,radius:a,radialSegments:l,coneRatio:c,radiusScale:u,vertexColor:h,baseCap:d,color:f}={...i,...t},p=a*u,g=r*c,y=new n.ConeGeometry(3*p,g,l),w=new n.CylinderGeometry(p,p,1,l,1,!0),m=r-g,v=r-.5*g;y.rotateZ(-Math.PI/2).translate(v,0,0),w.scale(1,m,1).rotateZ(-Math.PI/2).translate(.5*m,0,0);let x="none"===d?new n.BufferGeometry:"flat"===d?new n.CircleGeometry(p,l).rotateY(-Math.PI/2):new n.SphereGeometry(p,l,3,0,2*Math.PI,0,.5*Math.PI).rotateZ(Math.PI/2).rotateX(Math.PI/2),C=(0,o.n4)([y,w,x]);switch(e){case"y":C.rotateZ(Math.PI/2);break;case"z":C.rotateY(-Math.PI/2)}if(h){let t=C.attributes.position.count,e=new n.BufferAttribute(new Float32Array(3*t),3);C.setAttribute("color",e),s.set(f);for(let r=0;r<t;r++)e.setXYZ(r,s.r,s.g,s.b)}return C}let l={xColor:"#ff3333",yColor:"#33cc66",zColor:"#3366ff"};class c extends n.BufferGeometry{constructor(t){super();let{xColor:e,yColor:r,zColor:n,...i}={...l,...t},s=a({...i,axis:"x",color:e}),c=a({...i,axis:"y",color:r}),u=a({...i,axis:"z",color:n}),h=(0,o.n4)([s,c,u]);this.copy(h),h.dispose()}}},88156:function(t,e,r){r.d(e,{O:function(){return u}});var n=r(52471),o=r(58648),i=r(81796);let s=new n.Vector2,a=new n.Vector3,l=new n.Matrix4;function c(t,e,r){if(null==r?void 0:r.transform)for(let t of((0,i.Xe)(r.transform,l),e))t.applyMatrix4(l);t.push(...e)}class u extends n.LineSegments{showOccludedLines(){let{opacity:t=.2}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new n.LineBasicMaterial({color:this.material.color,transparent:!0,depthFunc:n.GreaterDepth,opacity:t}),r=new n.LineSegments(this.geometry,e);return this.add(r),this}clear(){return this.points.length=0,this.geometry.setFromPoints(this.points),this}draw(){return this.geometry.setFromPoints(this.points),this.geometry.computeBoundingSphere(),this}line(t,e,r){let n=(0,i.Q7)(t),o=(0,i.Q7)(e);return c(this.points,[n,o],r),this}circle(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let{x:o,y:a,radius:l,segments:h,...d}={...u.circleDefaultOptions,...(()=>{if(e.length>1){let[t,r,n]=e,{x:o,y:a}=(0,i.iK)(t,s);return{x:o,y:a,radius:r,...n}}return e[0]})()},f=new n.Vector3(1,0,0),p=new n.Vector3(0,1,0),g=[];for(let t=0;t<h;t++){let e=t/h*Math.PI*2,r=(t+1)/h*Math.PI*2,i=Math.cos(e)*l,s=Math.sin(e)*l,c=Math.cos(r)*l,u=Math.sin(r)*l,d=new n.Vector3(o,a,0).addScaledVector(f,i).addScaledVector(p,s),y=new n.Vector3(o,a,0).addScaledVector(f,c).addScaledVector(p,u);g.push(d,y)}return c(this.points,g,d),this}rectangle(t,e){let{centerX:r,centerY:i,width:s,height:a}=o.Ae.from(t),l=s/2,u=a/2,h=new n.Vector3(r-l,i-u,0),d=new n.Vector3(r+l,i-u,0),f=new n.Vector3(r+l,i+u,0),p=new n.Vector3(r-l,i+u,0);return c(this.points,[h,d,d,f,f,p,p,h],e),this}box(){let{center:t=[0,0,0],size:e=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{x:r,y:o,z:s}=(0,i.Q7)(t,a),{x:l,y:c,z:u}=(0,i.Q7)(e,a),h=l/2,d=c/2,f=u/2,p=new n.Vector3(r-h,o-d,s-f),g=new n.Vector3(r+h,o-d,s-f),y=new n.Vector3(r+h,o+d,s-f),w=new n.Vector3(r-h,o+d,s-f),m=new n.Vector3(r-h,o-d,s+f),v=new n.Vector3(r+h,o-d,s+f),x=new n.Vector3(r+h,o+d,s+f),C=new n.Vector3(r-h,o+d,s+f);return this.points.push(p,g,g,y,y,w,w,p),this.points.push(m,v,v,x,x,C,C,m),this.points.push(p,m,g,v,y,x,w,C),this}plus(t,e,r){let o=e/2,{x:a,y:l}=(0,i.iK)(t,s),u=new n.Vector3(a-o,l,0),h=new n.Vector3(a+o,l,0),d=new n.Vector3(a,l-o,0),f=new n.Vector3(a,l+o,0);return c(this.points,[u,h,d,f],r),this}cross(t,e,r){let o=e/2,{x:a,y:l}=(0,i.iK)(t,s),u=new n.Vector3(a-o,l-o,0),h=new n.Vector3(a+o,l+o,0),d=new n.Vector3(a-o,l+o,0),f=new n.Vector3(a+o,l-o,0);return c(this.points,[u,h,d,f],r),this}constructor(...t){super(...t),this.points=[]}}u.circleDefaultOptions={x:0,y:0,radius:.5,segments:96}},63549:function(t,e,r){r.d(e,{P:function(){return i}});var n=r(52471);let o={vertexColors:!0,color:"white",luminosity:.5};class i extends n.ShaderMaterial{constructor(t){let{color:e,luminosity:r,vertexColors:i,...s}={...o,...t};super({...s,uniforms:{uColor:{value:new n.Color(e)},uSunPosition:{value:new n.Vector3(.5,.7,.3)},uLuminosity:{value:r}},vertexColors:i,vertexShader:"\nvarying vec3 vWorldNormal;\nvarying vec3 vColor;\n\nvoid main() {\n  vWorldNormal = mat3(modelMatrix) * normal;\n  vColor = color;\n#ifdef USE_INSTANCING\n  gl_Position = projectionMatrix * viewMatrix * modelMatrix * instanceMatrix * vec4(position, 1.0);\n#else\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n#endif\n#ifdef USE_INSTANCING_COLOR\n	vColor.xyz *= instanceColor.xyz;\n#endif\n}\n",fragmentShader:"\nvarying vec3 vWorldNormal;\nvarying vec3 vColor;\n\nuniform vec3 uSunPosition;\nuniform vec3 uColor;\nuniform float uLuminosity;\n\nvoid main() {\n  vec3 lightDirection = normalize(uSunPosition);\n  float light = dot(vWorldNormal, lightDirection) * 0.5 + 0.5;\n  light = pow(light, 2.0);\n  light = mix(uLuminosity, 1.0, light);\n  gl_FragColor = vec4(vColor * uColor * light, 1.0);\n}\n"}),this.sunPosition=this.uniforms.uSunPosition.value}}},38137:function(t,e,r){r.d(e,{w:function(){return i}});var n=r(52471);let o=new n.IcosahedronGeometry(1,4);class i extends n.Mesh{constructor(t){super(o,new n.MeshBasicMaterial({color:"#0c529d",...t,side:n.BackSide,depthWrite:!1,depthTest:!1})),this.renderOrder=-1,this.frustumCulled=!1,this.matrixAutoUpdate=!1,this.onBeforeRender=(t,e,r)=>{let n=(r.near+r.far)/2;this.position.copy(r.position),this.scale.setScalar(n),this.updateMatrix(),this.updateMatrixWorld()}}}},99553:function(t,e,r){r.d(e,{c:function(){return o}});var n=r(52471);function o(t,e){var r;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=Array.isArray(e)?e.map(t=>new n.Color(t)):[new n.Color(e)],a=t.attributes.position.count,l=null!==(r=t.attributes.color)&&void 0!==r?r:function(){let e=new n.BufferAttribute(new Float32Array(3*a),3);return t.setAttribute("color",e),e}(),c=i<0?a:i;if(1===s.length){let{r:t,g:e,b:r}=s[0];for(let n=o;n<c;n++)l.setXYZ(n,t,e,r)}else for(let t=o;t<c;t++){let{r:e,g:r,b:n}=s[t%s.length];l.setXYZ(t,e,r,n)}l.needsUpdate=!0}},49635:function(t,e,r){r.d(e,{$:function(){return s},E:function(){return l}});var n=r(52471),o=r(81796);let i=new n.Matrix4;function s(t){return(0,o.Xe)(t,i)}let a=new n.Color;function l(t){return a.set(t)}},16573:function(t,e,r){function*n(t){let e=0,r={get i(){return e},get t(){return e/t},get p(){return e/(t-1)}};for(e=0;e<t;e++)yield r}function*o(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let n=0,o=0;2===e.length?(n=e[0],o=e[1]):Array.isArray(e[0])?(n=e[0][0],o=e[0][1]):(n=e[0].x,o=e[0].y);let i=0,s=0,a=0,l={get i(){return i},get x(){return s},get y(){return a},get tx(){return s/n},get ty(){return a/o},get px(){return s/(n-1)},get py(){return a/(o-1)}};for(a=0;a<o;a++)for(s=0;s<n;s++)yield l,i++}function*i(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let n=0,o=0,i=0;3===e.length?(n=e[0],o=e[1],i=e[2]):Array.isArray(e[0])?(n=e[0][0],o=e[0][1],i=e[0][2]):(n=e[0].x,o=e[0].y,i=e[0].z);let s=0,a=0,l=0,c=0,u={get i(){return s},get x(){return a},get y(){return l},get z(){return c},get tx(){return a/n},get ty(){return l/o},get tz(){return c/i},get px(){return a/(n-1)},get py(){return l/(o-1)},get pz(){return c/(i-1)}};for(c=0;c<i;c++)for(l=0;l<o;l++)for(a=0;a<n;a++)yield u,s++}r.d(e,{B0:function(){return o},KA:function(){return i},VX:function(){return n}})},28142:function(t,e,r){r.d(e,{T:function(){return c}});let n=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:123456;return(t=(t=(7*t+Math.sqrt(t)+16087*Math.sin(t))%2147483647)<0?t+2147483647:t)>1?2147483647&t:0===t?345678:123456},o=t=>t=2147483647&Math.imul(t,48271),i=t=>(t-1)/2147483646,s=t=>t,a={weightsAreNormalized:!1,indexOffset:0,forbiddenItems:[]};function l(){let t=o(o(n(123456)));function e(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:123456;return"string"==typeof e&&(e=e.split("").reduce((t,e)=>7*t+e.charCodeAt(0),0)),t=o(o(n(e))),h}function r(){return i(t=o(t))}function l(t){switch(t.length){default:return[0,1,s];case 1:return[0,t[0],s];case 2:return[t[0],t[1],s];case 3:return[t[0],t[1],t[2]]}}function c(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];let[o,i,s]=l(e);return o+(i-o)*s(r())}function u(){for(var t,e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];let[i,s,{weightsAreNormalized:l,indexOffset:c,forbiddenItems:u}]=function(t){let[e,r=null,n]=t,o={...a,...n};if(Array.isArray(e))return[e,r,o];if("object"==typeof e)return[Object.values(e),r?Object.values(r):null,o];throw Error("pick: unsupported options type")}(n);if(u.length>0){let e=new Set;for(let t of u){let r=i.indexOf(t);r>=0&&e.add(r)}if(i=i.filter((t,r)=>!e.has(r)),s=null!==(t=null==s?void 0:s.filter((t,r)=>!e.has(r)))&&void 0!==t?t:null,0===i.length)throw Error("pick: all items are forbidden")}if(null===s){let t=Math.floor(r()*i.length);return c&&(t+=c,(t%=i.length)<0&&(t+=i.length)),i[t]}if(!l){let t=s.reduce((t,e)=>t+e,0);s=s.map(e=>e/t)}let h=r(),d=0;for(let t=0;t<i.length;t++)if(h<(d+=s[t]))return i[t];throw Error("among: unreachable")}let h={seed:e,seedMax:function(){return 2147483647},reset:function(){return e(123456),h},next:function(){return t=o(t),h},random:r,between:c,around:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];let[o=1,i=s]=e,a=2*r();return(a>1?1:-1)*i(a>1?a-1:a)*o},int:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];let[o,i,s]=l(e);return o+Math.floor(s(r())*(i-o))},chance:function(t){return r()<t},shuffle:function(t){let{mutate:e=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e&&Array.isArray(t)?t:[...t],o=n.length;for(let t=0;t<o;t++){let e=Math.floor(o*r()),i=n[t];n[t]=n[e],n[e]=i}return n},pick:u,createPicker:function(t){let e=t.map(t=>{let[e]=t;return e}),r=t.map(t=>{let[e,r]=t;return r}),n=r.reduce((t,e)=>t+e,0);for(let[t,e]of r.entries())r[t]=e/n;return()=>u(e,r,{weightsAreNormalized:!0})},vector:function(t,e){let[r=0,n=1]=Array.isArray(e)?e:[null==e?void 0:e.min,null==e?void 0:e.max];for(let e of Object.keys(t))t[e]=c(r,n);return t},unitVector:function(t,e){let[r=-1,n=1]=Array.isArray(e)?e:[null==e?void 0:e.min,null==e?void 0:e.max],o=Object.keys(t),i=o.map(()=>c(r,n)),s=Math.sqrt(i.reduce((t,e)=>t+e*e,0));for(let[e,r]of o.entries())t[r]=i[e]/s;return t},boxMuller:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=r(),o=r(),i=Math.sqrt(-2*Math.log(n)),s=2*Math.PI*o;return[t+e*i*Math.cos(s),t+e*i*Math.sin(s)]}};return h}let c=class{constructor(t){Object.assign(this,l().seed(t))}};Object.assign(c,l())}}]);