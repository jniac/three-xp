"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[385],{1463:function(e,t,r){r.d(t,{_:function(){return n}});function n(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}},3935:function(e,t,r){r.d(t,{Z:function(){return i}});var n=r(2983);class i extends n.x12{constructor(e,t){let r=new n.u9r;r.setAttribute("position",new n.a$l([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),r.computeBoundingSphere(),super(r,new n.nls({fog:!1})),this.light=e,this.color=t,this.type="RectAreaLightHelper";let i=new n.u9r;i.setAttribute("position",new n.a$l([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),i.computeBoundingSphere(),this.add(new n.Kj0(i,new n.vBJ({side:n._Li,fog:!1})))}updateMatrixWorld(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);let e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this.children[0].matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}},8516:function(e,t,r){r.d(t,{I:function(){return Z}});var n=r(2983),i={},l=Uint8Array,a=Uint16Array,o=Int32Array,s=new l([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),f=new l([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),u=new l([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=function(e,t){for(var r=new a(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new o(r[30]),n=1;n<30;++n)for(var l=r[n];l<r[n+1];++l)i[l]=l-r[n]<<5|n;return{b:r,r:i}},h=c(s,2),d=h.b,p=h.r;d[28]=258,p[258]=28;for(var v=c(f,0),w=v.b,g=v.r,m=new a(32768),y=0;y<32768;++y){var b=(43690&y)>>1|(21845&y)<<1;b=(61680&(b=(52428&b)>>2|(13107&b)<<2))>>4|(3855&b)<<4,m[y]=((65280&b)>>8|(255&b)<<8)>>1}for(var E=function(e,t,r){for(var n,i=e.length,l=0,o=new a(t);l<i;++l)e[l]&&++o[e[l]-1];var s=new a(t);for(l=1;l<t;++l)s[l]=s[l-1]+o[l-1]<<1;if(r){n=new a(1<<t);var f=15-t;for(l=0;l<i;++l)if(e[l])for(var u=l<<4|e[l],c=t-e[l],h=s[e[l]-1]++<<c,d=h|(1<<c)-1;h<=d;++h)n[m[h]>>f]=u}else for(l=0,n=new a(i);l<i;++l)e[l]&&(n[l]=m[s[e[l]-1]++]>>15-e[l]);return n},S=new l(288),y=0;y<144;++y)S[y]=8;for(var y=144;y<256;++y)S[y]=9;for(var y=256;y<280;++y)S[y]=7;for(var y=280;y<288;++y)S[y]=8;for(var A=new l(32),y=0;y<32;++y)A[y]=5;var M=E(S,9,1),C=E(A,5,1),U=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},R=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},k=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},O=function(e){return(e+7)/8|0},x=function(e,t,r){return(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length),new l(e.subarray(t,r))},L=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],z=function(e,t,r){var n=Error(t||L[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,z),!r)throw n;return n},I=function(e,t,r,n){var i=e.length,a=n?n.length:0;if(!i||t.f&&!t.l)return r||new l(0);var o=!r,c=o||2!=t.i,h=t.i;o&&(r=new l(3*i));var p=function(e){var t=r.length;if(e>t){var n=new l(Math.max(2*t,e));n.set(r),r=n}},v=t.f||0,g=t.p||0,m=t.b||0,y=t.l,b=t.d,S=t.m,A=t.n,L=8*i;do{if(!y){v=R(e,g,1);var I=R(e,g+1,3);if(g+=3,I){if(1==I)y=M,b=C,S=9,A=5;else if(2==I){var P=R(e,g,31)+257,N=R(e,g+10,15)+4,_=P+R(e,g+5,31)+1;g+=14;for(var H=new l(_),T=new l(19),D=0;D<N;++D)T[u[D]]=R(e,g+3*D,7);g+=3*N;for(var B=U(T),W=(1<<B)-1,F=E(T,B,1),D=0;D<_;){var V=F[R(e,g,W)];g+=15&V;var X=V>>4;if(X<16)H[D++]=X;else{var G=0,Y=0;for(16==X?(Y=3+R(e,g,3),g+=2,G=H[D-1]):17==X?(Y=3+R(e,g,7),g+=3):18==X&&(Y=11+R(e,g,127),g+=7);Y--;)H[D++]=G}}var Z=H.subarray(0,P),$=H.subarray(P);S=U(Z),A=U($),y=E(Z,S,1),b=E($,A,1)}else z(1)}else{var X=O(g)+4,j=e[X-4]|e[X-3]<<8,q=X+j;if(q>i){h&&z(0);break}c&&p(m+j),r.set(e.subarray(X,q),m),t.b=m+=j,t.p=g=8*q,t.f=v;continue}if(g>L){h&&z(0);break}}c&&p(m+131072);for(var J=(1<<S)-1,K=(1<<A)-1,Q=g;;Q=g){var G=y[k(e,g)&J],ee=G>>4;if((g+=15&G)>L){h&&z(0);break}if(G||z(2),ee<256)r[m++]=ee;else if(256==ee){Q=g,y=null;break}else{var et=ee-254;if(ee>264){var D=ee-257,er=s[D];et=R(e,g,(1<<er)-1)+d[D],g+=er}var en=b[k(e,g)&K],ei=en>>4;en||z(3),g+=15&en;var $=w[ei];if(ei>3){var er=f[ei];$+=k(e,g)&(1<<er)-1,g+=er}if(g>L){h&&z(0);break}c&&p(m+131072);var el=m+et;if(m<$){var ea=a-$,eo=Math.min($,el);for(ea+m<0&&z(3);m<eo;++m)r[m]=n[ea+m]}for(;m<el;++m)r[m]=r[m-$]}}t.l=y,t.p=Q,t.b=m,t.f=v,y&&(v=1,t.m=S,t.d=b,t.n=A)}while(!v);return m!=r.length&&o?x(r,0,m):r.subarray(0,m)},P=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},N=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},_=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,o=r.slice();if(!i)return{t:V,l:0};if(1==i){var s=new l(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(e,t){return e.f-t.f}),r.push({s:-1,f:25001});var f=r[0],u=r[1],c=0,h=1,d=2;for(r[0]={s:-1,f:f.f+u.f,l:f,r:u};h!=i-1;)f=r[r[c].f<r[d].f?c++:d++],u=r[c!=h&&r[c].f<r[d].f?c++:d++],r[h++]={s:-1,f:f.f+u.f,l:f,r:u};for(var p=o[0].s,n=1;n<i;++n)o[n].s>p&&(p=o[n].s);var v=new a(p+1),w=H(r[h-1],v,0);if(w>t){var n=0,g=0,m=w-t,y=1<<m;for(o.sort(function(e,t){return v[t.s]-v[e.s]||e.f-t.f});n<i;++n){var b=o[n].s;if(v[b]>t)g+=y-(1<<w-v[b]),v[b]=t;else break}for(g>>=m;g>0;){var E=o[n].s;v[E]<t?g-=1<<t-v[E]++-1:++n}for(;n>=0&&g;--n){var S=o[n].s;v[S]==t&&(--v[S],++g)}w=t}return{t:new l(v),l:w}},H=function(e,t,r){return -1==e.s?Math.max(H(e.l,t,r+1),H(e.r,t,r+1)):t[e.s]=r},T=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new a(++t),n=0,i=e[0],l=1,o=function(e){r[n++]=e},s=1;s<=t;++s)if(e[s]==i&&s!=t)++l;else{if(!i&&l>2){for(;l>138;l-=138)o(32754);l>2&&(o(l>10?l-11<<5|28690:l-3<<5|12305),l=0)}else if(l>3){for(o(i),--l;l>6;l-=6)o(8304);l>2&&(o(l-3<<5|8208),l=0)}for(;l--;)o(i);l=1,i=e[s]}return{c:r.subarray(0,n),n:t}},D=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},B=function(e,t,r){var n=r.length,i=O(t+2);e[i]=255&n,e[i+1]=n>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var l=0;l<n;++l)e[i+l+4]=r[l];return(i+4+n)*8},W=function(e,t,r,n,i,l,o,c,h,d,p){P(t,p++,r),++i[256];for(var v,w,g,m,y=_(i,15),b=y.t,M=y.l,C=_(l,15),U=C.t,R=C.l,k=T(b),O=k.c,x=k.n,L=T(U),z=L.c,I=L.n,H=new a(19),W=0;W<O.length;++W)++H[31&O[W]];for(var W=0;W<z.length;++W)++H[31&z[W]];for(var F=_(H,7),V=F.t,X=F.l,G=19;G>4&&!V[u[G-1]];--G);var Y=d+5<<3,Z=D(i,S)+D(l,A)+o,$=D(i,b)+D(l,U)+o+14+3*G+D(H,V)+2*H[16]+3*H[17]+7*H[18];if(h>=0&&Y<=Z&&Y<=$)return B(t,p,e.subarray(h,h+d));if(P(t,p,1+($<Z)),p+=2,$<Z){v=E(b,M,0),w=b,g=E(U,R,0),m=U;var j=E(V,X,0);P(t,p,x-257),P(t,p+5,I-1),P(t,p+10,G-4),p+=14;for(var W=0;W<G;++W)P(t,p+3*W,V[u[W]]);p+=3*G;for(var q=[O,z],J=0;J<2;++J)for(var K=q[J],W=0;W<K.length;++W){var Q=31&K[W];P(t,p,j[Q]),p+=V[Q],Q>15&&(P(t,p,K[W]>>5&127),p+=K[W]>>12)}}else v=null,w=S,g=null,m=A;for(var W=0;W<c;++W){var ee=n[W];if(ee>255){var Q=ee>>18&31;N(t,p,v[Q+257]),p+=w[Q+257],Q>7&&(P(t,p,ee>>23&31),p+=s[Q]);var et=31&ee;N(t,p,g[et]),p+=m[et],et>3&&(N(t,p,ee>>5&8191),p+=f[et])}else N(t,p,v[ee]),p+=w[ee]}return N(t,p,v[256]),p+w[256]},F=new o([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),V=new l(0),X=function(e,t,r,n,i,u){var c=u.z||e.length,h=new l(n+c+5*(1+Math.ceil(c/7e3))+i),d=h.subarray(n,h.length-i),v=u.l,w=7&(u.r||0);if(t){w&&(d[0]=u.r>>3);for(var m=F[t-1],y=m>>13,b=8191&m,E=(1<<r)-1,S=u.p||new a(32768),A=u.h||new a(E+1),M=Math.ceil(r/3),C=2*M,U=function(t){return(e[t]^e[t+1]<<M^e[t+2]<<C)&E},R=new o(25e3),k=new a(288),L=new a(32),z=0,I=0,P=u.i||0,N=0,_=u.w||0,H=0;P+2<c;++P){var T=U(P),D=32767&P,V=A[T];if(S[D]=V,A[T]=D,_<=P){var X=c-P;if((z>7e3||N>24576)&&(X>423||!v)){w=W(e,d,0,R,k,L,I,N,H,P-H,w),N=z=I=0,H=P;for(var G=0;G<286;++G)k[G]=0;for(var G=0;G<30;++G)L[G]=0}var Y=2,Z=0,$=b,j=D-V&32767;if(X>2&&T==U(P-j))for(var q=Math.min(y,X)-1,J=Math.min(32767,P),K=Math.min(258,X);j<=J&&--$&&D!=V;){if(e[P+Y]==e[P+Y-j]){for(var Q=0;Q<K&&e[P+Q]==e[P+Q-j];++Q);if(Q>Y){if(Y=Q,Z=j,Q>q)break;for(var ee=Math.min(j,Q-2),et=0,G=0;G<ee;++G){var er=P-j+G&32767,en=S[er],ei=er-en&32767;ei>et&&(et=ei,V=er)}}}V=S[D=V],j+=D-V&32767}if(Z){R[N++]=268435456|p[Y]<<18|g[Z];var el=31&p[Y],ea=31&g[Z];I+=s[el]+f[ea],++k[257+el],++L[ea],_=P+Y,++z}else R[N++]=e[P],++k[e[P]]}}for(P=Math.max(P,_);P<c;++P)R[N++]=e[P],++k[e[P]];w=W(e,d,v,R,k,L,I,N,H,P-H,w),v||(u.r=7&w|d[w/8|0]<<3,w-=7,u.h=A,u.p=S,u.i=P,u.w=_)}else{for(var P=u.w||0;P<c+v;P+=65535){var eo=P+65535;eo>=c&&(d[w/8|0]=v,eo=c),w=B(d,w+1,e.subarray(P,eo))}u.i=c}return x(h,0,n+O(w)+i)};function G(e,t){var r;return I(e.subarray((r=t&&t.dictionary,((15&e[0])!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&z(6,"invalid zlib data"),(e[1]>>5&1)==+!r&&z(6,"invalid zlib data: "+(32&e[1]?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2),-4),{i:2},t&&t.out,t&&t.dictionary)}var Y="undefined"!=typeof TextDecoder&&new TextDecoder;try{Y.decode(V,{stream:!0})}catch(e){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;class Z extends n.yxD{constructor(e){super(e),this.type=n.cLu}parse(e){let t={l:0,c:0,lc:0};function r(e,r,n,i,l){for(;n<e;)r=r<<8|U(i,l),n+=8;n-=e,t.l=r>>n&(1<<e)-1,t.c=r,t.lc=n}let i=Array(59),l={c:0,lc:0};function a(e,t,r,n){e=e<<8|U(r,n),t+=8,l.c=e,l.lc=t}let o={c:0,lc:0};function s(e,t,r,n,i,s,f,u,c){if(e==t){n<8&&(a(r,n,i,s),r=l.c,n=l.lc);let e=r>>(n-=8);if(e=new Uint8Array([e])[0],u.value+e>c)return!1;let t=f[u.value-1];for(;e-- >0;)f[u.value++]=t}else{if(!(u.value<c))return!1;f[u.value++]=e}o.c=r,o.lc=n}function f(e){let t=65535&e;return t>32767?t-65536:t}let u={a:0,b:0};function c(e,t){let r=f(e),n=f(t),i=r+(1&n)+(n>>1),l=i-n;u.a=i,u.b=l}function h(e,t){let r=65535&t,n=(65535&e)-(r>>1)&65535;u.a=r+n-32768&65535,u.b=n}function d(e,n,f,u,c,h){let d=f.value,p=C(n,f),v=C(n,f);f.value+=4;let w=C(n,f);if(f.value+=4,p<0||p>=65537||v<0||v>=65537)throw Error("Something wrong with HUF_ENCSIZE");let g=Array(65537),m=Array(16384);!function(e){for(let t=0;t<16384;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}(m);let y=u-(f.value-d);if(!function(e,n,l,a,o,s){let f=0,u=0;for(;a<=o;a++){if(n.value-n.value>l)return!1;r(6,f,u,e,n);let i=t.l;if(f=t.c,u=t.lc,s[a]=i,63==i){if(n.value-n.value>l)throw Error("Something wrong with hufUnpackEncTable");r(8,f,u,e,n);let i=t.l+6;if(f=t.c,u=t.lc,a+i>o+1)throw Error("Something wrong with hufUnpackEncTable");for(;i--;)s[a++]=0;a--}else if(i>=59){let e=i-59+2;if(a+e>o+1)throw Error("Something wrong with hufUnpackEncTable");for(;e--;)s[a++]=0;a--}}!function(e){for(let e=0;e<=58;++e)i[e]=0;for(let t=0;t<65537;++t)i[e[t]]+=1;let t=0;for(let e=58;e>0;--e){let r=t+i[e]>>1;i[e]=t,t=r}for(let t=0;t<65537;++t){let r=e[t];r>0&&(e[t]=r|i[r]++<<6)}}(s)}(e,f,y,p,v,g),w>8*(u-(f.value-d)))throw Error("Something wrong with hufUncompress");!function(e,t,r,n){for(;t<=r;t++){let r=e[t]>>6,i=63&e[t];if(r>>i)throw Error("Invalid table entry");if(i>14){let e=n[r>>i-14];if(e.len)throw Error("Invalid table entry");if(e.lit++,e.p){let t=e.p;e.p=Array(e.lit);for(let r=0;r<e.lit-1;++r)e.p[r]=t[r]}else e.p=[,];e.p[e.lit-1]=t}else if(i){let e=0;for(let l=1<<14-i;l>0;l--){let l=n[(r<<14-i)+e];if(l.len||l.p)throw Error("Invalid table entry");l.len=i,l.lit=t,e++}}}}(g,p,v,m),function(e,t,r,n,i,f,u,c,h){let d=0,p=0,v=Math.trunc(n.value+(i+7)/8);for(;n.value<v;)for(a(d,p,r,n),d=l.c,p=l.lc;p>=14;){let i=t[d>>p-14&16383];if(i.len)p-=i.len,s(i.lit,f,d,p,r,n,c,h,u),d=o.c,p=o.lc;else{let t;if(!i.p)throw Error("hufDecode issues");for(t=0;t<i.lit;t++){let w=63&e[i.p[t]];for(;p<w&&n.value<v;)a(d,p,r,n),d=l.c,p=l.lc;if(p>=w&&e[i.p[t]]>>6==(d>>p-w&(1<<w)-1)){p-=w,s(i.p[t],f,d,p,r,n,c,h,u),d=o.c,p=o.lc;break}}if(t==i.lit)throw Error("hufDecode issues")}}let w=8-i&7;for(d>>=w,p-=w;p>0;){let e=t[d<<14-p&16383];if(e.len)p-=e.len,s(e.lit,f,d,p,r,n,c,h,u),d=o.c,p=o.lc;else throw Error("hufDecode issues")}}(g,m,e,f,w,v,h,c,{value:0})}function p(e){for(let t=1;t<e.length;t++){let r=e[t-1]+e[t]-128;e[t]=r}}function v(e,t){let r=0,n=Math.floor((e.length+1)/2),i=0,l=e.length-1;for(;!(i>l)&&(t[i++]=e[r++],!(i>l));)t[i++]=e[n++]}function w(e){let t=e.byteLength,r=[],n=0,i=new DataView(e);for(;t>0;){let e=i.getInt8(n++);if(e<0){let l=-e;t-=l+1;for(let e=0;e<l;e++)r.push(i.getUint8(n++))}else{t-=2;let l=i.getUint8(n++);for(let t=0;t<e+1;t++)r.push(l)}}return r}function g(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function m(e){let t=new Uint8Array(w(e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size))),r=new Uint8Array(t.length);return p(t),v(t,r),new DataView(r.buffer)}function y(e){let t=G(e.array.slice(e.offset.value,e.offset.value+e.size)),r=new Uint8Array(t.length);return p(t),v(t,r),new DataView(r.buffer)}function b(e){let t=e.viewer,r={value:e.offset.value},n=new Uint16Array(e.columns*e.lines*(e.inputChannels.length*e.type)),i=new Uint8Array(8192),l=0,a=Array(e.inputChannels.length);for(let t=0,r=e.inputChannels.length;t<r;t++)a[t]={},a[t].start=l,a[t].end=a[t].start,a[t].nx=e.columns,a[t].ny=e.lines,a[t].size=e.type,l+=a[t].nx*a[t].ny*a[t].size;let o=z(t,r),s=z(t,r);if(s>=8192)throw Error("Something is wrong with PIZ_COMPRESSION BITMAP_SIZE");if(o<=s)for(let e=0;e<s-o+1;e++)i[e+o]=R(t,r);let f=new Uint16Array(65536),p=function(e,t){let r=0;for(let n=0;n<65536;++n)(0==n||e[n>>3]&1<<(7&n))&&(t[r++]=n);let n=r-1;for(;r<65536;)t[r++]=0;return n}(i,f),v=C(t,r);d(e.array,t,r,v,n,l);for(let t=0;t<e.inputChannels.length;++t){let e=a[t];for(let r=0;r<a[t].size;++r)!function(e,t,r,n,i,l,a){let o,s;let f=a<16384,d=r>i?i:r,p=1;for(;p<=d;)p<<=1;for(p>>=1,o=p,p>>=1;p>=1;){let a,d,v,w;let g=(s=0)+l*(i-o),m=l*p,y=l*o,b=n*p,E=n*o;for(;s<=g;s+=y){let i=s,l=s+n*(r-o);for(;i<=l;i+=E){let r=i+b,n=i+m,l=n+b;f?(c(e[i+t],e[n+t]),a=u.a,v=u.b,c(e[r+t],e[l+t]),d=u.a,w=u.b,c(a,d),e[i+t]=u.a,e[r+t]=u.b,c(v,w)):(h(e[i+t],e[n+t]),a=u.a,v=u.b,h(e[r+t],e[l+t]),d=u.a,w=u.b,h(a,d),e[i+t]=u.a,e[r+t]=u.b,h(v,w)),e[n+t]=u.a,e[l+t]=u.b}if(r&p){let r=i+m;f?c(e[i+t],e[r+t]):h(e[i+t],e[r+t]),a=u.a,e[r+t]=u.b,e[i+t]=a}}if(i&p){let i=s,l=s+n*(r-o);for(;i<=l;i+=E){let r=i+b;f?c(e[i+t],e[r+t]):h(e[i+t],e[r+t]),a=u.a,e[r+t]=u.b,e[i+t]=a}}o=p,p>>=1}}(n,e.start+r,e.nx,e.size,e.ny,e.nx*e.size,p)}!function(e,t,r){for(let n=0;n<r;++n)t[n]=e[t[n]]}(f,n,l);let w=0,g=new Uint8Array(n.buffer.byteLength);for(let t=0;t<e.lines;t++)for(let t=0;t<e.inputChannels.length;t++){let e=a[t],r=e.nx*e.size,i=new Uint8Array(n.buffer,2*e.end,2*r);g.set(i,w),w+=2*r,e.end+=r}return new DataView(g.buffer)}function E(e){let t=G(e.array.slice(e.offset.value,e.offset.value+e.size)),r=new DataView(new ArrayBuffer(e.inputChannels.length*e.lines*e.columns*e.totalBytes)),n=0,i=0,l=[,,,,];for(let a=0;a<e.lines;a++)for(let a=0;a<e.inputChannels.length;a++){let o=0;switch(e.inputChannels[a].pixelType){case 1:l[0]=n,l[1]=l[0]+e.columns,n=l[1]+e.columns;for(let n=0;n<e.columns;++n)o+=t[l[0]++]<<8|t[l[1]++],r.setUint16(i,o,!0),i+=2;break;case 2:l[0]=n,l[1]=l[0]+e.columns,l[2]=l[1]+e.columns,n=l[2]+e.columns;for(let n=0;n<e.columns;++n)o+=t[l[0]++]<<24|t[l[1]++]<<16|t[l[2]++]<<8,r.setUint32(i,o,!0),i+=4}}return r}function S(e){let t,r,i;let l=e.viewer,a={value:e.offset.value},o=new Uint8Array(e.columns*e.lines*(e.inputChannels.length*e.type*2)),s={version:k(l,a),unknownUncompressedSize:k(l,a),unknownCompressedSize:k(l,a),acCompressedSize:k(l,a),dcCompressedSize:k(l,a),rleCompressedSize:k(l,a),rleUncompressedSize:k(l,a),rleRawSize:k(l,a),totalAcUncompressedCount:k(l,a),totalDcUncompressedCount:k(l,a),acCompression:k(l,a)};if(s.version<2)throw Error("EXRLoader.parse: "+B.compression+" version "+s.version+" is unsupported");let f=[],u=z(l,a)-2;for(;u>0;){let e=A(l.buffer,a),t=R(l,a),r=t>>2&3,n=new Int8Array([(t>>4)-1])[0],i=R(l,a);f.push({name:e,index:n,type:i,compression:r}),u-=e.length+3}let c=B.channels,h=Array(e.inputChannels.length);for(let t=0;t<e.inputChannels.length;++t){let r=h[t]={},n=c[t];r.name=n.name,r.compression=0,r.decoded=!1,r.type=n.pixelType,r.pLinear=n.pLinear,r.width=e.columns,r.height=e.lines}let p={idx:[,,,]};for(let t=0;t<e.inputChannels.length;++t){let e=h[t];for(let r=0;r<f.length;++r){let n=f[r];e.name==n.name&&(e.compression=n.compression,n.index>=0&&(p.idx[n.index]=t),e.offset=t)}}if(s.acCompressedSize>0)switch(s.acCompression){case 0:t=new Uint16Array(s.totalAcUncompressedCount),d(e.array,l,a,s.acCompressedSize,t,s.totalAcUncompressedCount);break;case 1:t=new Uint16Array(G(e.array.slice(a.value,a.value+s.totalAcUncompressedCount)).buffer),a.value+=s.totalAcUncompressedCount}s.dcCompressedSize>0&&(r=new Uint16Array(y({array:e.array,offset:a,size:s.dcCompressedSize}).buffer),a.value+=s.dcCompressedSize),s.rleRawSize>0&&(i=w(G(e.array.slice(a.value,a.value+s.rleCompressedSize)).buffer),a.value+=s.rleCompressedSize);let v=0,g=Array(h.length);for(let e=0;e<g.length;++e)g[e]=[];for(let t=0;t<e.lines;++t)for(let t=0;t<h.length;++t)g[t].push(v),v+=h[t].width*e.type*2;!function(e,t,r,i,l,a){let o=new DataView(a.buffer),s=r[e.idx[0]].width,f=r[e.idx[0]].height,u=Math.floor(s/8),c=Math.ceil(s/8),h=Math.ceil(f/8),d=s-(c-1)*8,p=f-(h-1)*8,v={value:0},w=[,,,],g=[,,,],m=[,,,],y=[,,,],b=[,,,];for(let r=0;r<3;++r)b[r]=t[e.idx[r]],w[r]=r<1?0:w[r-1]+c*h,g[r]=new Float32Array(64),m[r]=new Uint16Array(64),y[r]=new Uint16Array(64*c);for(let t=0;t<h;++t){let a=8;t==h-1&&(a=p);let s=8;for(let e=0;e<c;++e){e==c-1&&(s=d);for(let e=0;e<3;++e){var E,S;m[e].fill(0),m[e][0]=l[w[e]++],function(e,t,r){let n;let i=1;for(;i<64;)65280==(n=t[e.value])?i=64:n>>8==255?i+=255&n:(r[i]=n,i++),e.value++}(v,i,m[e]),E=m[e],(S=g[e])[0]=L(E[0]),S[1]=L(E[1]),S[2]=L(E[5]),S[3]=L(E[6]),S[4]=L(E[14]),S[5]=L(E[15]),S[6]=L(E[27]),S[7]=L(E[28]),S[8]=L(E[2]),S[9]=L(E[4]),S[10]=L(E[7]),S[11]=L(E[13]),S[12]=L(E[16]),S[13]=L(E[26]),S[14]=L(E[29]),S[15]=L(E[42]),S[16]=L(E[3]),S[17]=L(E[8]),S[18]=L(E[12]),S[19]=L(E[17]),S[20]=L(E[25]),S[21]=L(E[30]),S[22]=L(E[41]),S[23]=L(E[43]),S[24]=L(E[9]),S[25]=L(E[11]),S[26]=L(E[18]),S[27]=L(E[24]),S[28]=L(E[31]),S[29]=L(E[40]),S[30]=L(E[44]),S[31]=L(E[53]),S[32]=L(E[10]),S[33]=L(E[19]),S[34]=L(E[23]),S[35]=L(E[32]),S[36]=L(E[39]),S[37]=L(E[45]),S[38]=L(E[52]),S[39]=L(E[54]),S[40]=L(E[20]),S[41]=L(E[22]),S[42]=L(E[33]),S[43]=L(E[38]),S[44]=L(E[46]),S[45]=L(E[51]),S[46]=L(E[55]),S[47]=L(E[60]),S[48]=L(E[21]),S[49]=L(E[34]),S[50]=L(E[37]),S[51]=L(E[47]),S[52]=L(E[50]),S[53]=L(E[56]),S[54]=L(E[59]),S[55]=L(E[61]),S[56]=L(E[35]),S[57]=L(E[36]),S[58]=L(E[48]),S[59]=L(E[49]),S[60]=L(E[57]),S[61]=L(E[58]),S[62]=L(E[62]),S[63]=L(E[63]),function(e){let t=.5*Math.cos(3*3.14159/16),r=.5*Math.cos(3*3.14159/8),n=[,,,,],i=[,,,,],l=[,,,,],a=[,,,,];for(let o=0;o<8;++o){let s=8*o;n[0]=.4619398297234211*e[s+2],n[1]=r*e[s+2],n[2]=.4619398297234211*e[s+6],n[3]=r*e[s+6],i[0]=.4903926563794112*e[s+1]+t*e[s+3]+.2777854612564676*e[s+5]+.09754573032714427*e[s+7],i[1]=t*e[s+1]-.09754573032714427*e[s+3]-.4903926563794112*e[s+5]-.2777854612564676*e[s+7],i[2]=.2777854612564676*e[s+1]-.4903926563794112*e[s+3]+.09754573032714427*e[s+5]+t*e[s+7],i[3]=.09754573032714427*e[s+1]-.2777854612564676*e[s+3]+t*e[s+5]-.4903926563794112*e[s+7],l[0]=.35355362513961314*(e[s+0]+e[s+4]),l[3]=.35355362513961314*(e[s+0]-e[s+4]),l[1]=n[0]+n[3],l[2]=n[1]-n[2],a[0]=l[0]+l[1],a[1]=l[3]+l[2],a[2]=l[3]-l[2],a[3]=l[0]-l[1],e[s+0]=a[0]+i[0],e[s+1]=a[1]+i[1],e[s+2]=a[2]+i[2],e[s+3]=a[3]+i[3],e[s+4]=a[3]-i[3],e[s+5]=a[2]-i[2],e[s+6]=a[1]-i[1],e[s+7]=a[0]-i[0]}for(let o=0;o<8;++o)n[0]=.4619398297234211*e[16+o],n[1]=r*e[16+o],n[2]=.4619398297234211*e[48+o],n[3]=r*e[48+o],i[0]=.4903926563794112*e[8+o]+t*e[24+o]+.2777854612564676*e[40+o]+.09754573032714427*e[56+o],i[1]=t*e[8+o]-.09754573032714427*e[24+o]-.4903926563794112*e[40+o]-.2777854612564676*e[56+o],i[2]=.2777854612564676*e[8+o]-.4903926563794112*e[24+o]+.09754573032714427*e[40+o]+t*e[56+o],i[3]=.09754573032714427*e[8+o]-.2777854612564676*e[24+o]+t*e[40+o]-.4903926563794112*e[56+o],l[0]=.35355362513961314*(e[o]+e[32+o]),l[3]=.35355362513961314*(e[o]-e[32+o]),l[1]=n[0]+n[3],l[2]=n[1]-n[2],a[0]=l[0]+l[1],a[1]=l[3]+l[2],a[2]=l[3]-l[2],a[3]=l[0]-l[1],e[0+o]=a[0]+i[0],e[8+o]=a[1]+i[1],e[16+o]=a[2]+i[2],e[24+o]=a[3]+i[3],e[32+o]=a[3]-i[3],e[40+o]=a[2]-i[2],e[48+o]=a[1]-i[1],e[56+o]=a[0]-i[0]}(g[e])}!function(e){for(let t=0;t<64;++t){let r=e[0][t],n=e[1][t],i=e[2][t];e[0][t]=r+1.5747*i,e[1][t]=r-.1873*n-.4682*i,e[2][t]=r+1.8556*n}}(g);for(let t=0;t<3;++t)!function(e,t,r){for(let l=0;l<64;++l){var i;t[r+l]=n.A5E.toHalfFloat((i=e[l])<=1?Math.sign(i)*Math.pow(Math.abs(i),2.2):Math.sign(i)*Math.pow(9.025013291561939,Math.abs(i)-1))}}(g[t],y[t],64*e)}let f=0;for(let n=0;n<3;++n){let i=r[e.idx[n]].type;for(let e=8*t;e<8*t+a;++e){f=b[n][e];for(let t=0;t<u;++t){let r=64*t+(7&e)*8;o.setUint16(f+0*i,y[n][r+0],!0),o.setUint16(f+2*i,y[n][r+1],!0),o.setUint16(f+4*i,y[n][r+2],!0),o.setUint16(f+6*i,y[n][r+3],!0),o.setUint16(f+8*i,y[n][r+4],!0),o.setUint16(f+10*i,y[n][r+5],!0),o.setUint16(f+12*i,y[n][r+6],!0),o.setUint16(f+14*i,y[n][r+7],!0),f+=16*i}}if(u!=c)for(let e=8*t;e<8*t+a;++e){let t=b[n][e]+8*u*2*i,r=64*u+(7&e)*8;for(let e=0;e<s;++e)o.setUint16(t+2*e*i,y[n][r+e],!0)}}}let A=new Uint16Array(s);o=new DataView(a.buffer);for(let t=0;t<3;++t){r[e.idx[t]].decoded=!0;let n=r[e.idx[t]].type;if(2==r[t].type)for(let e=0;e<f;++e){let r=b[t][e];for(let e=0;e<s;++e)A[e]=o.getUint16(r+2*e*n,!0);for(let e=0;e<s;++e)o.setFloat32(r+2*e*n,L(A[e]),!0)}}}(p,g,h,t,r,o);for(let t=0;t<h.length;++t){let r=h[t];if(!r.decoded){if(2===r.compression){let n=0,l=0;for(let a=0;a<e.lines;++a){let e=g[t][n];for(let t=0;t<r.width;++t){for(let t=0;t<2*r.type;++t)o[e++]=i[l+t*r.width*r.height];l++}n++}}else throw Error("EXRLoader.parse: unsupported channel compression")}}return new DataView(o.buffer)}function A(e,t){let r=new Uint8Array(e),n=0;for(;0!=r[t.value+n];)n+=1;let i=new TextDecoder().decode(r.slice(t.value,t.value+n));return t.value=t.value+n+1,i}function M(e,t){let r=e.getInt32(t.value,!0);return t.value=t.value+4,r}function C(e,t){let r=e.getUint32(t.value,!0);return t.value=t.value+4,r}function U(e,t){let r=e[t.value];return t.value=t.value+1,r}function R(e,t){let r=e.getUint8(t.value);return t.value=t.value+1,r}let k=function(e,t){let r;return"getBigInt64"in DataView.prototype?r=Number(e.getBigInt64(t.value,!0)):r=e.getUint32(t.value+4,!0)+Number(e.getUint32(t.value,!0)<<32),t.value+=8,r};function O(e,t){let r=e.getFloat32(t.value,!0);return t.value+=4,r}function x(e,t){return n.A5E.toHalfFloat(O(e,t))}function L(e){let t=(31744&e)>>10,r=1023&e;return(e>>15?-1:1)*(t?31===t?r?NaN:1/0:Math.pow(2,t-15)*(1+r/1024):r/1024*6103515625e-14)}function z(e,t){let r=e.getUint16(t.value,!0);return t.value+=2,r}function I(e,t){return L(z(e,t))}function P(e,t,r,n){let i=Array(e);for(let l=0;l<e;l++){let e=1<<l,a=t/e|0;"ROUND_UP"==n&&a*e<t&&(a+=1);let o=Math.max(a,1);i[l]=(o+r-1)/r|0}return i}function N(){let e=this.offset,t={value:0};for(let r=0;r<this.tileCount;r++){let r=M(this.viewer,e),n=M(this.viewer,e);e.value+=8,this.size=C(this.viewer,e);let i=r*this.blockWidth,l=n*this.blockHeight;this.columns=i+this.blockWidth>this.width?this.width-i:this.blockWidth,this.lines=l+this.blockHeight>this.height?this.height-l:this.blockHeight;let a=this.columns*this.totalBytes,o=this.size<this.lines*a?this.uncompress(this):g(this);e.value+=this.size;for(let e=0;e<this.lines;e++){let r=e*this.columns*this.totalBytes;for(let n=0;n<this.inputChannels.length;n++){let a=B.channels[n].name,s=this.channelByteOffsets[a]*this.columns,f=this.decodeChannels[a];if(void 0===f)continue;t.value=r+s;let u=(this.height-(1+l+e))*this.outLineWidth;for(let e=0;e<this.columns;e++){let r=u+(e+i)*this.outputChannels+f;this.byteArray[r]=this.getter(o,t)}}}}}function _(){let e=this.offset,t={value:0};for(let r=0;r<this.height/this.blockHeight;r++){let n=M(this.viewer,e)-B.dataWindow.yMin;this.size=C(this.viewer,e),this.lines=n+this.blockHeight>this.height?this.height-n:this.blockHeight;let i=this.columns*this.totalBytes,l=this.size<this.lines*i?this.uncompress(this):g(this);e.value+=this.size;for(let e=0;e<this.blockHeight;e++){let n=r*this.blockHeight,a=e+this.scanOrder(n);if(a>=this.height)continue;let o=e*i,s=(this.height-1-a)*this.outLineWidth;for(let e=0;e<this.inputChannels.length;e++){let r=B.channels[e].name,n=this.channelByteOffsets[r]*this.columns,i=this.decodeChannels[r];if(void 0!==i){t.value=o+n;for(let e=0;e<this.columns;e++){let r=s+e*this.outputChannels+i;this.byteArray[r]=this.getter(l,t)}}}}}}let H={value:0},T=new DataView(e),D=new Uint8Array(e),B=function(e,t,r){let n={};if(20000630!=e.getUint32(0,!0))throw Error("THREE.EXRLoader: Provided file doesn't appear to be in OpenEXR format.");n.version=e.getUint8(4);let i=e.getUint8(5);n.spec={singleTile:!!(2&i),longName:!!(4&i),deepFormat:!!(8&i),multiPart:!!(16&i)},r.value=8;let l=!0;for(;l;){let i=A(t,r);if(0==i)l=!1;else{let l=A(t,r),a=C(e,r),o=function(e,t,r,n,i){if("string"===n||"stringvector"===n||"iccProfile"===n)return function(e,t,r){let n=new TextDecoder().decode(new Uint8Array(e).slice(t.value,t.value+r));return t.value=t.value+r,n}(t,r,i);if("chlist"===n)return function(e,t,r,n){let i=r.value,l=[];for(;r.value<i+n-1;){let n=A(t,r),i=M(e,r),a=R(e,r);r.value+=3;let o=M(e,r),s=M(e,r);l.push({name:n,pixelType:i,pLinear:a,xSampling:o,ySampling:s})}return r.value+=1,l}(e,t,r,i);if("chromaticities"===n)return function(e,t){let r=O(e,t),n=O(e,t),i=O(e,t),l=O(e,t),a=O(e,t);return{redX:r,redY:n,greenX:i,greenY:l,blueX:a,blueY:O(e,t),whiteX:O(e,t),whiteY:O(e,t)}}(e,r);if("compression"===n)return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][R(e,r)];if("box2i"===n)return function(e,t){let r=M(e,t);return{xMin:r,yMin:M(e,t),xMax:M(e,t),yMax:M(e,t)}}(e,r);if("envmap"===n)return["ENVMAP_LATLONG","ENVMAP_CUBE"][R(e,r)];if("tiledesc"===n)return function(e,t){let r=C(e,t),n=C(e,t),i=R(e,t);return{xSize:r,ySize:n,levelMode:["ONE_LEVEL","MIPMAP_LEVELS","RIPMAP_LEVELS"][15&i],roundingMode:["ROUND_DOWN","ROUND_UP"][i>>4]}}(e,r);if("lineOrder"===n)return["INCREASING_Y","DECREASING_Y","RANDOM_Y"][R(e,r)];if("float"===n)return O(e,r);if("v2f"===n)return[O(e,r),O(e,r)];if("v3f"===n){var l,a;return[O(l=e,a=r),O(l,a),O(l,a)]}return"int"===n?M(e,r):"rational"===n?[M(e,r),C(e,r)]:"timecode"===n?[C(e,r),C(e,r)]:"preview"===n?(r.value+=i,"skipped"):void(r.value+=i)}(e,t,r,l,a);void 0===o?console.warn(`THREE.EXRLoader: Skipped unknown header attribute type '${l}'.`):n[i]=o}}if((-7&i)!=0)throw console.error("THREE.EXRHeader:",n),Error("THREE.EXRLoader: Provided file is currently unsupported.");return n}(T,e,H),W=function(e,t,r,i,l){let a={size:0,viewer:t,array:r,offset:i,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,inputChannels:e.channels,channelByteOffsets:{},scanOrder:null,totalBytes:null,columns:null,lines:null,type:null,uncompress:null,getter:null,format:null,colorSpace:n.GUF};switch(e.compression){case"NO_COMPRESSION":a.blockHeight=1,a.uncompress=g;break;case"RLE_COMPRESSION":a.blockHeight=1,a.uncompress=m;break;case"ZIPS_COMPRESSION":a.blockHeight=1,a.uncompress=y;break;case"ZIP_COMPRESSION":a.blockHeight=16,a.uncompress=y;break;case"PIZ_COMPRESSION":a.blockHeight=32,a.uncompress=b;break;case"PXR24_COMPRESSION":a.blockHeight=16,a.uncompress=E;break;case"DWAA_COMPRESSION":a.blockHeight=32,a.uncompress=S;break;case"DWAB_COMPRESSION":a.blockHeight=256,a.uncompress=S;break;default:throw Error("EXRLoader.parse: "+e.compression+" is unsupported")}let o={};for(let t of e.channels)switch(t.name){case"Y":case"R":case"G":case"B":case"A":o[t.name]=!0,a.type=t.pixelType}let s=!1;if(o.R&&o.G&&o.B)s=!o.A,a.outputChannels=4,a.decodeChannels={R:0,G:1,B:2,A:3};else if(o.Y)a.outputChannels=1,a.decodeChannels={Y:0};else throw Error("EXRLoader.parse: file contains unsupported data channels.");if(1==a.type)switch(l){case n.VzW:a.getter=I;break;case n.cLu:a.getter=z}else if(2==a.type)switch(l){case n.VzW:a.getter=O;break;case n.cLu:a.getter=x}else throw Error("EXRLoader.parse: unsupported pixelType "+a.type+" for "+e.compression+".");a.columns=a.width;let f=a.width*a.height*a.outputChannels;switch(l){case n.VzW:a.byteArray=new Float32Array(f),s&&a.byteArray.fill(1,0,f);break;case n.cLu:a.byteArray=new Uint16Array(f),s&&a.byteArray.fill(15360,0,f);break;default:console.error("THREE.EXRLoader: unsupported type: ",l)}let u=0;for(let t of e.channels)void 0!==a.decodeChannels[t.name]&&(a.channelByteOffsets[t.name]=u),u+=2*t.pixelType;if(a.totalBytes=u,a.outLineWidth=a.width*a.outputChannels,"INCREASING_Y"===e.lineOrder?a.scanOrder=e=>e:a.scanOrder=e=>a.height-1-e,4==a.outputChannels?(a.format=n.wk1,a.colorSpace=n.GUF):(a.format=n.hEm,a.colorSpace=n.aCh),e.spec.singleTile){a.blockHeight=e.tiles.ySize,a.blockWidth=e.tiles.xSize;let r=function(e,t,r){let n=0;switch(e.levelMode){case"ONE_LEVEL":n=1;break;case"MIPMAP_LEVELS":n=function(e,t){let r=Math.log2(e);return"ROUND_DOWN"==t?Math.floor(r):Math.ceil(r)}(Math.max(t,r),e.roundingMode)+1;break;case"RIPMAP_LEVELS":throw Error("THREE.EXRLoader: RIPMAP_LEVELS tiles currently unsupported.")}return n}(e.tiles,a.width,a.height),n=P(r,a.width,e.tiles.xSize,e.tiles.roundingMode),l=P(r,a.height,e.tiles.ySize,e.tiles.roundingMode);a.tileCount=n[0]*l[0];for(let e=0;e<r;e++)for(let r=0;r<l[e];r++)for(let r=0;r<n[e];r++)k(t,i);a.decode=N.bind(a)}else{a.blockWidth=a.width;let e=Math.ceil(a.height/a.blockHeight);for(let r=0;r<e;r++)k(t,i);a.decode=_.bind(a)}return a}(B,T,D,H,this.type);return W.decode(),{header:B,width:W.width,height:W.height,data:W.byteArray,format:W.format,colorSpace:W.colorSpace,type:this.type}}setDataType(e){return this.type=e,this}load(e,t,r,i){return super.load(e,function(e,r){e.colorSpace=r.colorSpace,e.minFilter=n.wem,e.magFilter=n.wem,e.generateMipmaps=!1,e.flipY=!1,t&&t(e,r)},r,i)}}},3356:function(e,t,r){r.d(t,{x:function(){return i}});var n=r(2983);class i extends n.yxD{constructor(e){super(e),this.type=n.cLu}parse(e){let t,r,i;let l=function(e,t){switch(e){case 1:throw Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw Error("THREE.RGBELoader: Memory Error: "+(t||""))}},a=function(e,t,r){t=t||1024;let n=e.pos,i=-1,l=0,a="",o=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));for(;0>(i=o.indexOf("\n"))&&l<t&&n<e.byteLength;)a+=o,l+=o.length,n+=128,o+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));return -1<i&&(!1!==r&&(e.pos+=l+i+1),a+o.slice(0,i))},o=new Uint8Array(e);o.pos=0;let s=function(e){let t,r;let n=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,i=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*FORMAT=(\S+)\s*$/,s=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,f={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};for(!(e.pos>=e.byteLength)&&(t=a(e))||l(1,"no header found"),(r=t.match(/^#\?(\S+)/))||l(3,"bad initial token"),f.valid|=1,f.programtype=r[1],f.string+=t+"\n";!1!==(t=a(e));){if(f.string+=t+"\n","#"===t.charAt(0)){f.comments+=t+"\n";continue}if((r=t.match(n))&&(f.gamma=parseFloat(r[1])),(r=t.match(i))&&(f.exposure=parseFloat(r[1])),(r=t.match(o))&&(f.valid|=2,f.format=r[1]),(r=t.match(s))&&(f.valid|=4,f.height=parseInt(r[1],10),f.width=parseInt(r[2],10)),2&f.valid&&4&f.valid)break}return 2&f.valid||l(3,"missing format specifier"),4&f.valid||l(3,"missing image size specifier"),f}(o),f=s.width,u=s.height,c=function(e,t,r){if(t<8||t>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);t!==(e[2]<<8|e[3])&&l(3,"wrong scanline width");let n=new Uint8Array(4*t*r);n.length||l(4,"unable to allocate buffer space");let i=0,a=0,o=4*t,s=new Uint8Array(4),f=new Uint8Array(o),u=r;for(;u>0&&a<e.byteLength;){a+4>e.byteLength&&l(1),s[0]=e[a++],s[1]=e[a++],s[2]=e[a++],s[3]=e[a++],(2!=s[0]||2!=s[1]||(s[2]<<8|s[3])!=t)&&l(3,"bad rgbe scanline format");let r=0,c;for(;r<o&&a<e.byteLength;){let t=(c=e[a++])>128;if(t&&(c-=128),(0===c||r+c>o)&&l(3,"bad scanline data"),t){let t=e[a++];for(let e=0;e<c;e++)f[r++]=t}else f.set(e.subarray(a,a+c),r),r+=c,a+=c}for(let e=0;e<t;e++){let r=0;n[i]=f[e+r],r+=t,n[i+1]=f[e+r],r+=t,n[i+2]=f[e+r],r+=t,n[i+3]=f[e+r],i+=4}u--}return n}(o.subarray(o.pos),f,u);switch(this.type){case n.VzW:let h=new Float32Array(4*(i=c.length/4));for(let e=0;e<i;e++)!function(e,t,r,n){let i=Math.pow(2,e[t+3]-128)/255;r[n+0]=e[t+0]*i,r[n+1]=e[t+1]*i,r[n+2]=e[t+2]*i,r[n+3]=1}(c,4*e,h,4*e);t=h,r=n.VzW;break;case n.cLu:let d=new Uint16Array(4*(i=c.length/4));for(let e=0;e<i;e++)!function(e,t,r,i){let l=Math.pow(2,e[t+3]-128)/255;r[i+0]=n.A5E.toHalfFloat(Math.min(e[t+0]*l,65504)),r[i+1]=n.A5E.toHalfFloat(Math.min(e[t+1]*l,65504)),r[i+2]=n.A5E.toHalfFloat(Math.min(e[t+2]*l,65504)),r[i+3]=n.A5E.toHalfFloat(1)}(c,4*e,d,4*e);t=d,r=n.cLu;break;default:throw Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:f,height:u,data:t,header:s.string,gamma:s.gamma,exposure:s.exposure,type:r}}setDataType(e){return this.type=e,this}load(e,t,r,i){return super.load(e,function(e,r){switch(e.type){case n.VzW:case n.cLu:e.colorSpace=n.GUF,e.minFilter=n.wem,e.magFilter=n.wem,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,r)},r,i)}}}}]);