"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5033],{16465:(t,e,n)=>{n.d(e,{Y:()=>s});var r=n(49797),i=n(7147);let o={shadowColor:"#808080",luminosity:1,rampPower:1,onBeforeCompile:void 0};class s extends r.V9B{constructor(t){let{rampPower:e,shadowColor:n,luminosity:s,onBeforeCompile:l,...h}={...o,...t},u={uSunPosition:{value:new r.Pq0(.5,.7,.3)},uShadowColor:{value:new r.Q1f(n)},uRampPower:{value:e},uLuminosity:{value:s}};super(h),this.onBeforeCompile=t=>{i.bI.with(t).uniforms(u).varying({vWorldNormal:"vec3"}).vertex.mainAfterAll("\n          vWorldNormal = mat3(modelMatrix) * normal;\n          #ifdef USE_INSTANCING\n            vWorldNormal = mat3(instanceMatrix) * vWorldNormal;\n          #endif\n        ").fragment.after("map_fragment","\n          vec3 normal = normalize(vWorldNormal);\n          vec3 lightDirection = normalize(uSunPosition);\n          float light = dot(normal, lightDirection) * 0.5 + 0.5;\n          light = pow(light, uRampPower);\n          diffuseColor.rgb *= mix(uShadowColor * uLuminosity, vec3(1.0), light);\n        "),null==l||l(t)},this.sunPosition=u.uSunPosition.value}}},17099:(t,e,n)=>{n.d(e,{c:()=>l});var r=n(79105);let i=t=>t,o={weightsAreNormalized:!1,indexOffset:0,forbiddenItems:[]};function s(){let t=(0,r.K2)((0,r.K2)((0,r.Ts)(r.KP)));function e(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.KP;return"string"==typeof e&&(e=e.split("").reduce((t,e)=>7*t+e.charCodeAt(0),0)),t=(0,r.K2)((0,r.K2)((0,r.Ts)(e))),a}function n(){return t=(0,r.K2)(t),(0,r.Tj)(t)}function s(t){switch(t.length){default:return[0,1,i];case 1:return[0,t[0],i];case 2:return[t[0],t[1],i];case 3:return[t[0],t[1],t[2]]}}function l(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let[i,o,l]=s(e);return i+(o-i)*l(n())}function h(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];let[s,l,{weightsAreNormalized:h,indexOffset:u,forbiddenItems:a}]=function(t){let[e,n=null,r]=t,i={...o,...r};if(Array.isArray(e))return[e,n,i];if("object"==typeof e)return[Object.values(e),n?Object.values(n):null,i];throw Error("pick: unsupported options type")}(r);if(a.length>0){let e=new Set;for(let t of a){let n=s.indexOf(t);n>=0&&e.add(n)}if(s=s.filter((t,n)=>!e.has(n)),l=null!=(t=null==l?void 0:l.filter((t,n)=>!e.has(n)))?t:null,0===s.length)throw Error("pick: all items are forbidden")}if(null===l){let t=Math.floor(n()*s.length);return u&&(t+=u,(t%=s.length)<0&&(t+=s.length)),s[t]}if(!h){let t=l.reduce((t,e)=>t+e,0);l=l.map(e=>e/t)}let c=n(),f=0;for(let t=0;t<s.length;t++)if(c<(f+=l[t]))return s[t];throw Error("among: unreachable")}function u(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=n(),i=n(),o=Math.sqrt(-2*Math.log(r)),s=2*Math.PI*i;return[t+e*o*Math.cos(s),t+e*o*Math.sin(s)]}let a={seed:e,seedMax:function(){return r.Zu},reset:function(){return e(r.KP),a},next:function(){return t=(0,r.K2)(t),a},getState:function(){return t},setState:function(e){return t=e&r.Zu,a},random:n,between:l,around:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let[o=1,s=i]=e,l=2*n();return(l>1?1:-1)*s(l>1?l-1:l)*o},int:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let[i,o,l]=s(e);return i+Math.floor(l(n())*(o-i))},chance:function(t){return n()<t},shuffle:function(t){let{mutate:e=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e&&Array.isArray(t)?t:[...t],i=r.length;for(let t=0;t<i;t++){let e=Math.floor(i*n()),o=r[t];r[t]=r[e],r[e]=o}return r},pick:h,createPicker:function(t){let e=t.map(t=>{let[e]=t;return e}),n=t.map(t=>{let[e,n]=t;return n}),r=n.reduce((t,e)=>t+e,0);for(let[t,e]of n.entries())n[t]=e/r;return()=>h(e,n,{weightsAreNormalized:!0})},vector:function(t,e){let[n=0,r=1]=Array.isArray(e)?e:[null==e?void 0:e.min,null==e?void 0:e.max];for(let e of Object.keys(t))t[e]=l(n,r);return t},unitVector2:function(t){let e=2*Math.PI*n();return t.x=Math.cos(e),t.y=Math.sin(e),t},unitVector3:function(t){let e=n(),r=n(),i=2*Math.PI*e,o=Math.acos(1-2*r);return t.x=Math.sin(o)*Math.cos(i),t.y=Math.sin(o)*Math.sin(i),t.z=Math.cos(o),t},normalVector:function(t){let e=Object.keys(t),n=e.length,r=Math.sqrt(n);for(let i=0;i<n;i+=2){let[o,s]=u();t[e[i]]=o/r,i+1<n&&(t[e[i+1]]=s/r)}return t},unitVector:function(t){let e=Object.keys(t),n=e.length,r=0;for(let i=0;i<n;i+=2){let[o,s]=u();t[e[i]]=o,r+=o*o,i+1<n&&(t[e[i+1]]=s,r+=s*s)}r=Math.sqrt(r);for(let i=0;i<n;i++)t[e[i]]/=r;return t},boxMuller:u,quaternion:function(t){let e=n(),r=n(),i=n(),o=Math.sqrt(1-e),s=Math.sqrt(e);return t.x=o*Math.sin(2*Math.PI*r),t.y=o*Math.cos(2*Math.PI*r),t.z=s*Math.sin(2*Math.PI*i),t.w=s*Math.cos(2*Math.PI*i),t},insideCircle:function(t,e){let r=2*n()*Math.PI,i=Math.sqrt(n())*t;return e.x=i*Math.cos(r),e.y=i*Math.sin(r),e}};return a}let l=class{constructor(t){Object.assign(this,s().seed(t))}};Object.assign(l,s())},68955:(t,e,n)=>{n.d(e,{AA:()=>k,HK:()=>V,Cx:()=>v});var r,i,o,s=n(49797);!function(t){t[t.X=0]="X",t[t.Y=2]="Y",t[t.Z=4]="Z"}(r||(r={})),function(t){t[t.R=0]="R",t[t.L=1]="L",t[t.U=2]="U",t[t.D=3]="D",t[t.F=4]="F",t[t.B=5]="B"}(i||(i={})),function(t){t[t.None=0]="None",t[t.All=63]="All",t[t.R=1]="R",t[t.L=2]="L",t[t.U=4]="U",t[t.D=8]="D",t[t.F=16]="F",t[t.B=32]="B"}(o||(o={}));let l=[i.B,i.F,i.R,i.L,i.R,i.L];i.U,i.U,i.B,i.F,i.U,i.U;let h=[new s.Pq0(1,0,0),new s.Pq0(-1,0,0),new s.Pq0(0,1,0),new s.Pq0(0,-1,0),new s.Pq0(0,0,1),new s.Pq0(0,0,-1)],u=0,a=0,c=0,f=0,d=[],z={A:()=>(d[u++]=a,d[u++]=c,d[u++]=f,z),B:()=>(d[u++]=a,d[u++]=c,d[u++]=f+1,z),C:()=>(d[u++]=a,d[u++]=c+1,d[u++]=f,z),D:()=>(d[u++]=a,d[u++]=c+1,d[u++]=f+1,z),E:()=>(d[u++]=a+1,d[u++]=c,d[u++]=f,z),F:()=>(d[u++]=a+1,d[u++]=c,d[u++]=f+1,z),G:()=>(d[u++]=a+1,d[u++]=c+1,d[u++]=f,z),H:()=>(d[u++]=a+1,d[u++]=c+1,d[u++]=f+1,z)},S={R:()=>(d[u++]=1,d[u++]=0,d[u++]=0,S),L:()=>(d[u++]=-1,d[u++]=0,d[u++]=0,S),U:()=>(d[u++]=0,d[u++]=1,d[u++]=0,S),D:()=>(d[u++]=0,d[u++]=-1,d[u++]=0,S),F:()=>(d[u++]=0,d[u++]=0,d[u++]=1,S),B:()=>(d[u++]=0,d[u++]=0,d[u++]=-1,S),R6:()=>S.R().R().R().R().R().R(),L6:()=>S.L().L().L().L().L().L(),U6:()=>S.U().U().U().U().U().U(),D6:()=>S.D().D().D().D().D().D(),F6:()=>S.F().F().F().F().F().F(),B6:()=>S.B().B().B().B().B().B()};class x{clone(){return new this.constructor(this.position.clone(),this.direction,this.tangent)}positionToArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{position:n,direction:r}=this;switch(d=t,u=e,a=n.x,c=n.y,f=n.z,r){case i.R:z.E().G().F().F().G().H();break;case i.L:z.A().B().D().A().D().C();break;case i.U:z.D().H().G().D().G().C();break;case i.D:z.A().E().F().A().F().B();break;case i.F:z.B().F().H().B().H().D();break;case i.B:z.A().C().E().E().C().G()}return t}normalToArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{direction:n}=this;switch(d=t,u=e,n){case i.R:S.R6();break;case i.L:S.L6();break;case i.U:S.U6();break;case i.D:S.D6();break;case i.F:S.F6();break;case i.B:S.B6()}return t}constructor(t,e,n=l[e]){this.position=t,this.direction=e,this.tangent=n}}let g=new x(new s.Pq0,0),w=t=>0!==t.getUint8(0);class k{get size(){return this.getSize()}mount(t,e,n){let r=t.metrics.fromIndexes(e,n,0),i=t.metrics.getAdjacentChunkIndexes(e,n);this.mountState={world:t,superChunkIndex:e,chunkIndex:n,position:r,adjacentChunksIndexes:i}}unmount(){this.mountState=null}getAdjacentChunk(t){let{mountState:e}=this;if(!e)return null;let{world:n,adjacentChunksIndexes:r}=e,i=r[t];return n.tryGetChunkByIndexes(i)}getSize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s.Pq0;return t.set(this.sizeX,this.sizeY,this.sizeZ)}getVoxelStateAtIndex(t){if(t<0||t>=this.sizeXYZ)throw Error("Index out of bounds: ".concat(t,", size: ").concat(this.sizeXYZ));return new DataView(this.voxelState,t*this.voxelStateByteSize,this.voxelStateByteSize)}getVoxelState(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];let[r,i,o]=1===e.length?[e[0].x,e[0].y,e[0].z]:e,{sizeX:s,sizeY:l,sizeZ:h,sizeXY:u,voxelStateByteSize:a,voxelState:c}=this;if(r<0||r>=s||i<0||i>=l||o<0||o>=h)throw Error("Coordinates out of bounds: ".concat(r,", ").concat(i,", ").concat(o,", size: (").concat(s,", ").concat(l,", ").concat(h,")"));return new DataView(c,(r+i*s+o*u)*a,a)}*voxelStates(){let{sizeX:t,sizeXY:e,sizeY:n,sizeZ:r}=this,{voxelState:i,voxelStateByteSize:o}=this;for(let s=0;s<r;s++)for(let r=0;r<n;r++)for(let n=0;n<t;n++){let l=n+r*t+s*e;yield new DataView(i,l*o,o)}}computeBounds(){let{voxelIsFullDelegate:t=t=>0!==t.getUint8(0),out:e=new s.NRn}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.makeEmpty();let{sizeX:n,sizeXY:r,sizeY:i,sizeZ:o,voxelState:l,voxelStateByteSize:h}=this;for(let u=0;u<o;u++)for(let o=0;o<i;o++)for(let i=0;i<n;i++)t(new DataView(l,(i+o*n+u*r)*h,h))&&e.expandByPoint(new s.Pq0(i,o,u));return e}tryGetVoxelState(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];let[r,i,o]=1===e.length?[e[0].x,e[0].y,e[0].z]:e,{sizeX:s,sizeY:l,sizeZ:h}=this;return r<0||r>=s||i<0||i>=l||o<0||o>=h?null:this.getVoxelState(r,i,o)}*voxelFaces(){let{offset:{x:t,y:e,z:n}={x:0,y:0,z:0},voxelIsFullDelegate:r=w,ignoreAdjacentChunks:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(t,e)=>t<0?e+t:t>=e?t-e:t,{sizeX:s,sizeXY:l,sizeY:u,sizeZ:a,voxelState:c,voxelStateByteSize:f}=this;for(let S=0;S<a;S++)for(let x=0;x<u;x++)for(let w=0;w<s;w++)if(r(new DataView(c,(w+x*s+S*l)*f,f)))for(let k=0;k<6;k++){let y=h[k],m=w+y.x,p=x+y.y,v=S+y.z,C=m<0||m>=s||p<0||p>=u||v<0||v>=a?k:null,M=!1;if(null===C)M=r(new DataView(c,(m+p*s+v*l)*f,f));else if(!i){var d,z;let t=null!=(z=null==(d=this.getAdjacentChunk(C))?void 0:d.getVoxelState(o(m,s),o(p,u),o(v,a)))?z:null;M=!!t&&r(t)}M||(g.position.set(t+w,e+x,n+S),g.direction=k,yield g)}}constructor(t=16,e=4){this.mountState=null;let[n,r,i]="number"==typeof t?[t,t,t]:[t.x,t.y,t.z];this.sizeX=n,this.sizeY=r,this.sizeZ=i,this.sizeXY=this.sizeX*this.sizeY,this.sizeXYZ=this.sizeX*this.sizeY*this.sizeZ,this.voxelStateByteSize=e,this.voxelState=new ArrayBuffer(this.sizeXYZ*e)}}class y{ensureSize(t){if(this.array.length<t){let e=new Float32Array(1<<Math.ceil(Math.log(t)/Math.log(2)));e.set(this.array),this.array=e}return this.array}copy(t){return new Float32Array(this.array.buffer,0,t).slice()}constructor(t=0){this.array=new Float32Array(0),this.ensureSize(t)}}let m=new y(768),p=new y(768);function v(t){let{geometry:e=new s.LoY}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="function"==typeof t?t():t;m.array.fill(0),p.array.fill(0);let r=0;for(let t of n){let e=18*r;m.ensureSize(e+18),p.ensureSize(e+18),t.positionToArray(m.array,e),t.normalToArray(p.array,e),r++}return 0===r?(e.setAttribute("position",new s.THS(new Float32Array(9),3)),e.setAttribute("normal",new s.THS(new Float32Array(9),3))):(e.setAttribute("position",new s.THS(m.copy(18*r),3)),e.setAttribute("normal",new s.THS(p.copy(18*r),3))),e}class C extends s.Pq0{get superChunk(){return this.x}get chunk(){return this.y}get voxel(){return this.z}}function M(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"_")}class A{get chunkSize(){return this.getChunkSize()}get superChunkSize(){return this.getSuperChunkSize()}clone(){return new A(this.chunkSizeX,this.chunkSizeY,this.chunkSizeZ,this.superChunkSizeX,this.superChunkSizeY,this.superChunkSizeZ,this.worldSizeX,this.worldSizeY,this.worldSizeZ)}getChunkSize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s.Pq0;return t.set(this.chunkSizeX,this.chunkSizeY,this.chunkSizeZ)}getSuperChunkSize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s.Pq0;return t.set(this.superChunkSizeX,this.superChunkSizeY,this.superChunkSizeZ)}getWorldSize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s.Pq0;return t.set(this.worldSizeX,this.worldSizeY,this.worldSizeZ)}computeSuperChunkIndex(t,e,n){let{worldSizeX:r,worldSizeY:i,worldSizeZ:o,worldSizeXY:s}=this;return+(t+(r>>1))+(e+(i>>1))*r+(n+(o>>1))*s}toIndexes(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new C,{chunkSizeX:i,chunkSizeY:o,chunkSizeZ:s,chunkSizeXY:l,superChunkSizeX:h,superChunkSizeXY:u,superChunkVoxelSizeX:a,superChunkVoxelSizeY:c,superChunkVoxelSizeZ:f,worldSizeX:d,worldSizeY:z,worldSizeZ:S,worldSizeXY:x,worldVoxelSizeX:g,worldVoxelSizeY:w,worldVoxelSizeZ:k}=this,y=g>>1,m=w>>1,p=k>>1;if(t<-y||t>=y)throw Error("X coordinate out of bounds: ".concat(t,", interval: (-").concat(y," incl., ").concat(y," excl.)"));if(e<-m||e>=m)throw Error("Y coordinate out of bounds: ".concat(e,", interval: (-").concat(m," incl., ").concat(m," excl.)"));if(n<-p||n>=p)throw Error("Z coordinate out of bounds: ".concat(n,", interval: (-").concat(p," incl., ").concat(p," excl.)"));let v=Math.floor(t/a),M=Math.floor(e/c),A=Math.floor(n/f),b=t-v*a,V=e-M*c,B=n-A*f,Y=Math.floor(b/this.chunkSizeX),P=Math.floor(V/this.chunkSizeY),I=Math.floor(B/this.chunkSizeZ);return r.set(+(v+(d>>1))+(M+(z>>1))*d+(A+(S>>1))*x,+Y+P*h+I*u,+(b-Y*i)+(V-P*o)*i+(B-I*s)*l),r}fromIndexes(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new s.Pq0,{chunkSizeX:i,chunkSizeY:o,chunkSizeZ:l,chunkSizeXY:h,chunkSizeXYZ:u,superChunkSizeX:a,superChunkSizeXY:c,superChunkSizeXYZ:f,superChunkVoxelSizeX:d,superChunkVoxelSizeY:z,superChunkVoxelSizeZ:S,worldSizeX:x,worldSizeY:g,worldSizeZ:w,worldSizeXY:k,worldSizeXYZ:y}=this;if(t<0||t>=y)throw Error("Superchunk index out of bounds: ".concat(M(t),", size: ").concat(M(y),"\nReceived: ").concat(t,", ").concat(e,", ").concat(n));if(e<0||e>=f)throw Error("Chunk index out of bounds: ".concat(M(e),", size: ").concat(M(f),"\nReceived: ").concat(t,", ").concat(e,", ").concat(n));if(n<0||n>=u)throw Error("Voxel index out of bounds: ".concat(M(n),", size: ").concat(M(u),"\nReceived: ").concat(t,", ").concat(e,", ").concat(n));let m=0,p=Math.floor((m=t)/k),v=Math.floor((m-=p*k)/x),C=m-=v*x;C-=x>>1,v-=g>>1,p-=w>>1;let A=Math.floor((m=e)/c),b=Math.floor((m-=A*c)/a),V=m-=b*a,B=Math.floor((m=n)/h),Y=Math.floor((m-=B*h)/i),P=m-=Y*i,I=C*d+V*i+P,X=v*z+b*o+Y,Z=p*S+A*l+B;return r.set(I,X,Z),r}getAdjacentChunkIndexes(t,e){let{chunkSizeX:n,chunkSizeY:r,chunkSizeZ:i}=this,{x:o,y:s,z:l}=this.fromIndexes(t,e,0);return[this.toIndexes(o+n,s,l),this.toIndexes(o-n,s,l),this.toIndexes(o,s+r,l),this.toIndexes(o,s-r,l),this.toIndexes(o,s,l+i),this.toIndexes(o,s,l-i)]}constructor(t,e,n,r,i,o,s,l,h){this.chunkSizeX=t,this.chunkSizeY=e,this.chunkSizeZ=n,this.chunkSizeXY=t*e,this.chunkSizeXYZ=t*e*n,this.superChunkSizeX=r,this.superChunkSizeY=i,this.superChunkSizeZ=o,this.superChunkSizeXY=r*i,this.superChunkSizeXYZ=r*i*o,this.superChunkVoxelSizeX=this.superChunkSizeX*this.chunkSizeX,this.superChunkVoxelSizeY=this.superChunkSizeY*this.chunkSizeY,this.superChunkVoxelSizeZ=this.superChunkSizeZ*this.chunkSizeZ,this.worldSizeX=s,this.worldSizeY=l,this.worldSizeZ=h,this.worldSizeXY=s*l,this.worldSizeXYZ=s*l*h,this.worldVoxelSizeX=this.worldSizeX*this.superChunkVoxelSizeX,this.worldVoxelSizeY=this.worldSizeY*this.superChunkVoxelSizeY,this.worldVoxelSizeZ=this.worldSizeZ*this.superChunkVoxelSizeZ,this.worldVoxelSizeXY=this.worldVoxelSizeX*this.worldVoxelSizeY,this.worldVoxelSizeXYZ=this.worldVoxelSizeX*this.worldVoxelSizeY*this.worldVoxelSizeZ}}let b={metrics:new A(16,16,16,1024,1024,1024,1024,1024,1024),voxelStateByteSize:4};class V{computeChunkCount(){let t=0;for(let e of this.superChunks.values())t+=e.size;return t}*enumerateChunks(){for(let[t,e]of this.superChunks)for(let[n,r]of e)yield{superChunkIndex:t,chunkIndex:n,chunk:r}}computeVoxelBounds(){let{voxelIsFullDelegate:t=t=>0!==t.getUint8(0),out:e=new s.NRn}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.makeEmpty();let n=new s.Pq0,r=new s.NRn;for(let{superChunkIndex:i,chunkIndex:o,chunk:s}of this.enumerateChunks())this.metrics.fromIndexes(i,o,0,n),s.computeBounds({voxelIsFullDelegate:t,out:r}),r.min.add(n),r.max.add(n),e.union(r);return e}computeChunkBounds(){let{out:t=new s.NRn}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.makeEmpty();let e=new s.Pq0;for(let{superChunkIndex:n,chunkIndex:r}of this.enumerateChunks())this.metrics.fromIndexes(n,r,0,e),t.expandByPoint(e);return t.max.x+=this.metrics.chunkSizeX-1,t.max.y+=this.metrics.chunkSizeY-1,t.max.z+=this.metrics.chunkSizeZ-1,t}tryGetChunk(){for(var t,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];let[i,o,s]=1===n.length?[n[0].x,n[0].y,n[0].z]:n,{chunkSizeX:l,chunkSizeY:h,chunkSizeZ:u,superChunkSizeX:a,superChunkSizeY:c,superChunkSizeZ:f,superChunkSizeXY:d}=this.metrics,z=Math.floor(i/l),S=Math.floor(o/h),x=Math.floor(s/u),g=this.metrics.computeSuperChunkIndex(z,S,x),w=this.superChunks.get(g);if(!w)return null;let k=i-z*a,y=o-S*c,m=s-x*f;return null!=(t=w.get(+k+y*a+m*d))?t:null}tryGetSurroundingChunkAt(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];let[r,i,o]=1===e.length?[e[0].x,e[0].y,e[0].z]:e,s=this.metrics.toIndexes(r,i,o);return this.tryGetChunkByIndexes(s)}tryGetChunkByIndexes(){for(var t,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];let[i,o]=1===n.length?[n[0].superChunk,n[0].chunk]:n,s=this.superChunks.get(i);return s&&null!=(t=s.get(o))?t:null}getVoxelState(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];let[r,i,o]=1===e.length?[e[0].x,e[0].y,e[0].z]:e,s=this.metrics.toIndexes(r,i,o),l=this.superChunks.get(s.x);if(!l)return this.emptyVoxelState;let h=l.get(s.y);return h?h.getVoxelStateAtIndex(s.z):this.emptyVoxelState}setVoxelState(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];let[r,i,o,s]=2===e.length?[e[0].x,e[0].y,e[0].z,e[1]]:e,l=function(t){for(let e=0;e<t.byteLength;e++)if(0!==t.getUint8(e))return!1;return!0}(s),h=this.metrics.toIndexes(r,i,o),{superChunks:u,voxelStateByteSize:a}=this,c=u.get(h.superChunk);if(!c){if(l)return!1;c=new Map,u.set(h.superChunk,c)}let f=c.get(h.chunk);if(!f){if(l)return!1;(f=new k(this.metrics.chunkSize,a)).mount(this,h.superChunk,h.chunk),c.set(h.chunk,f)}let d=f.getVoxelStateAtIndex(h.voxel),z=!1;for(let t=0;t<a;t++){let e=s.getUint8(t);e!==d.getUint8(t)&&(d.setUint8(t,e),z=!0)}return z}*chunkVoxelFaces(t){let{voxelIsFullDelegate:e=w}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{chunkSize:n,chunkSizeX:r,chunkSizeY:i,chunkSizeZ:o}=this.metrics,{x:l,y:h,z:u}=t.min.clone().divide(n).floor(),{x:a,y:c,z:f}=t.max.clone().divide(n).ceil(),d=new s.Pq0;for(let t=u;t<f;t++)for(let n=h;n<c;n++)for(let s=l;s<a;s++){let l=this.tryGetChunk(s,n,t);l&&(d.set(s*r,n*i,t*o),yield*l.voxelFaces({offset:d,voxelIsFullDelegate:e}))}}constructor(t){this.superChunks=new Map;let{metrics:e,voxelStateByteSize:n}={...b,...t};this.metrics=e.clone(),this.voxelStateByteSize=n,this.emptyVoxelState=new DataView(new ArrayBuffer(n))}}},79105:(t,e,n)=>{n.d(e,{K2:()=>s,KP:()=>i,Tj:()=>l,Ts:()=>o,Zu:()=>r});let r=0x7fffffff,i=123456,o=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;if(Number.isNaN(t))throw Error("NaN is not a valid seed.");let e=t;if(10>Math.abs(e)&&(e*=1e6),e%=r,(e=e<0?e+r:e)>1)return e&r;if(0===e)return i;throw Error("Impossible. ".concat(e))},s=t=>t=Math.imul(t,48271)&r,l=t=>(t-1)/(r-1)}}]);