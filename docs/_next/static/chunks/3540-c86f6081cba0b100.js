"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3540],{33540:(e,t,i)=>{i.d(t,{q:()=>r.ThreeInstance,uB:()=>r.ThreeProvider,dB:()=>n.useGroup,yk:()=>n.useThree,Fw:()=>n.useThreeWebGL});var n=i(87548),r=i(42436),s=i(63106);i(18479);var l=i(79911),a=i(67235);let o={hotkey:"g",show:void 0,hide:void 0,isHelper:e=>!0===e.userData.helper};class u{*initialize(){let{hotkey:e}=this.safeParams;yield(0,s.a)([[{key:e,keyCaseInsensitive:!0},()=>this.toggle()]])}toggle(){return this.currentShowHelpers=!this.currentShowHelpers,this.updateHelpers(),this.currentShowHelpers}updateHelpers(){let{isHelper:e}=this.safeParams;for(let t of(0,l.$z)(this.root))e(t)&&(t.visible=this.currentShowHelpers);a.Q.send("TOGGLE_HELPERS",this.currentShowHelpers?"SHOW":"HIDE")}set showHelpers(e){this.currentShowHelpers=null!=e?e:this.currentShowHelpers,this.updateHelpers()}constructor(e,t){var i;u.instances.set(e,this),this.safeParams={...o,...t},this.root=e.scene,this.currentShowHelpers=null!=(i=null==t?void 0:t.show)?i:(null==t?void 0:t.hide)!==!1,this.updateHelpers()}}u.instances=new Map},37821:(e,t,i)=>{i.d(t,{D:()=>r});var n=i(67203);function r(){let[e,t]=(0,n.useState)(!1);return(0,n.useLayoutEffect)(()=>{t(!0)},[]),e}},42436:(e,t,i)=>{i.r(t),i.d(t,{ThreeInstance:()=>m,ThreeProvider:()=>k});var n=i(70691),r=i(67203),s=i(30158),l=i(24223),a=i(63106),o=i(18479),u=i(37821),c=i(31763),d=i(40951),h=i(29338),p=i(82143),f=i(83628),y=i(67235),v=i(68571),g=i(87548);function m(e){return(0,g.useInstance)(e),null}let w={type:void 0,webgl:void 0,webgpu:void 0,className:"",assetsPath:"/",vertigoControls:!1,minActiveDuration:30,fullscreenKey:null};function b(e){var t;let i={...w,...e},{children:u,className:g,vertigoControls:m}=i,b=null!=(t=i.type)?t:i.webgpu?"webgpu":"webgl",k=(0,r.useRef)(void 0);k.current&&k.current!==b&&console.warn('ThreeProvider: the prop "type" is not intended to change after the component is mounted.'),k.current=b;let P=(0,r.useMemo)(()=>"webgl"===b?new p.XW:new f.K,[b]);P.ticker.set({minActiveDuration:i.minActiveDuration});let{ref:x}=(0,o.IZ)({debounce:!0},function*(e,t){let i=e.querySelector("#three-wrapper-canvas");yield P.initialize(i,document.body),P.pointer.setEventIgnore(d.K6.Type.Tap,e=>{let{downTarget:t}=e;return!1===(i===t||i.contains(t))}),t.triggerRender(),Object.assign(window,{three:P,THREE:s})},[]);(0,o.useEffects)(function*(){yield y.Q.on("THREE",e=>{e.setPayload(P)}),yield(0,l.O)(P.ticker.requestActivation);let e=()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()};if(i.fullscreenKey&&(yield(0,a.a)([[i.fullscreenKey,e]])),yield y.Q.on("TOGGLE_FULLSCREEN",e),m){var t,n,r;let e="object"==typeof m?m:{},i=new c.n(e).initialize("canvas"===e.eventTarget?P.domElement:x.current);Object.assign(i.inputConfig,e.inputConfig),i.parsePanInputs(null!=(t=e.panInput)?t:""),i.parseOrbitInputs(null!=(n=e.orbitInput)?n:""),i.focusPlane=null!=(r=e.focusPlane)?r:null,P.scene.add(i.group),e.fixed||i.start(),yield(0,a.a)([[{code:"Tab",modifiers:"alt"},e=>{e.event.preventDefault(),i.actions.toggleAlternative()}]]),yield i.destroy;let s=e=>{"SET"===e.type?i.vertigo.set(e.payload):e.setPayload(i)};yield y.Q.on("VERTIGO_CONTROLS",s),yield y.Q.on(c.n,s),yield P.ticker.onTick({name:"VertigoControls",phase:h.z.BeforeRender,order:-1},e=>{i.update(P.camera,P.aspect,e.deltaTime)})}},[m]);let I={position:"absolute",inset:0};return(0,n.jsx)("div",{ref:x,className:g,style:I,children:(0,n.jsxs)(v.h.Provider,{value:P,children:[(0,n.jsx)("div",{id:"three-wrapper-canvas",style:I}),(0,n.jsx)("div",{id:"three-wrapper-hud",style:I,className:"thru",children:P.initialized&&u})]})})}function k(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,u.D)()&&(0,n.jsx)(b,{...t[0]})}},63106:(e,t,i)=>{function n(e,t){return"*"===t||("string"==typeof t?t===e:t instanceof RegExp?t.test(e):"function"==typeof t&&t(e))}i.d(t,{a:()=>a});let r={preventDefault:!1,strictTarget:void 0},s={key:"*",keyCaseInsensitive:!0,code:"*",noModifiers:!1,modifiers:"",phase:"down"},l=0;function a(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let a=l++,[o,u,c]=1===t.length?[document.body,{},t[0]]:2===t.length?[t[0],{},t[1]]:t,{preventDefault:d}={...r,...u},h=null,p=e=>{var t;if((null!=(t=u.strictTarget)?!!t:o===document.body)&&e.target!==o)return;"keydown"===e.type&&(h=e);let{ctrlKey:i=!1,altKey:r=!1,shiftKey:l=!1,metaKey:p=!1}=null!=h?h:{},f={id:a,event:e,downEvent:h,modifiers:{ctrl:i,alt:r,shift:l,meta:p}};for(let t=0,a=c.length;t<a;t++){let[a,o]=c[t],{key:u,keyCaseInsensitive:y,code:v,noModifiers:g,modifiers:m,phase:w="down"}=function(e){let t="string"==typeof e?{...s,key:e}:{...s,...e};return t.keyCaseInsensitive&&"string"==typeof t.key&&(t.key=t.key.toLowerCase()),t}(a);switch(e.type){case"keydown":if("down"!==w)continue;break;case"keyup":if("up"!==w)continue}Object.values({key:n(y?e.key.toLowerCase():e.key,u),code:n(e.code,v),noModifiers:!g||!1===i&&!1===r&&!1===l&&!1===p,modifiers:function(e,t){let{ctrlKey:i,altKey:n,shiftKey:r,metaKey:s}=e;if("function"==typeof t)return t({ctrl:i,alt:n,shift:r,meta:s});let{ctrl:l=!1,alt:a=!1,shift:o=!1,meta:u=!1}=Object.fromEntries(t.split("-").map(e=>[e,!0]));return l===i&&a===n&&o===r&&u===s}(h,m)}).every(Boolean)&&(d&&e.preventDefault(),o(f))}};return o.addEventListener("keydown",p,{passive:!1}),o.addEventListener("keyup",p,{passive:!1}),{destroy:()=>{o.removeEventListener("keydown",p),o.removeEventListener("keyup",p)}}}},67235:(e,t,i)=>{i.d(t,{Q:()=>o});var n=i(54530);class r{_getId(){return r._idHash.init().update(++this._count).getValue()}_registerObject(e){let t=this._getId();return this._weakMap.set(e,t),t}_registerPrimitive(e){let t=this._getId();return this._map.set(e,t),t}_requirePrimitiveId(e){var t;return null!=(t=this._map.get(e))?t:this._registerPrimitive(e)}_requireObjectId(e){var t;return null!=(t=this._weakMap.get(e))?t:this._registerObject(e)}_requireArrayId(e){let{_arrayHash:t}=r;for(let i of(t.init(),e.flat(16)))t.update(this.requireId(i));return t.getValue()}requireId(e){return!function(e){if(null==e)return!0;switch(typeof e){case"function":case"object":return!1;default:return!0}}(e)?Array.isArray(e)?this._requireArrayId(e):this._requireObjectId(e):this._requirePrimitiveId(e)}constructor(){this._count=1,this._map=new Map,this._weakMap=new WeakMap}}r._idHash=new n.V,r._arrayHash=new n.V;class s{constructor(e,t){this.filter=e,this.callback=t,this.match="*"===e?()=>!0:"string"==typeof e?t=>t===e:e instanceof RegExp?t=>e.test(t):()=>!1}}let l=new r,a=new Map;class o{setPayload(e){return this.payload=e,this}assignPayload(e){let{overwrite:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.payload=t?{...this.payload,...e}:{...e,...this.payload},this}payloadAssign(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.assignPayload(...t)}assertPayload(){if(void 0!==this.payload)return this.payload;throw Error('Message.payloadAssert: assertion failed for message with target "'.concat(this.target,'"'))}constructor(e,t,i){var n;this.id=o.nextId++,this.debug={currentListenerIndex:-1,listenerCount:0},this.targetId=l.requireId(e),this.target=e,this.type=null!=t?t:"message",this.payload=i;let r=(null!=(n=a.get(this.targetId))?n:[]).filter(e=>e.match(this.type));for(let e of(this.debug.listenerCount=r.length,r))this.debug.currentListenerIndex++,e.callback(this)}}function u(e){if(2===e.length){let[t,i]=e;return[t,"*",i]}return e}function c(){for(var e,t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];let[r,o,c]=u(i),d=l.requireId(r),h=new s(o,c);return(null!=(e=a.get(d))?e:(()=>{let e=[];return a.set(d,e),e})()).push(h),{destroy:()=>{!function(e,t){let i=a.get(e);if(i){let n=i.indexOf(t);if(-1!==n)i.splice(n,1),0===i.length&&a.delete(e)}}(d,h)}}}o.send=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let[n,r,s]=function(e){let[t,...i]=e;if(2===i.length){let[e,{payload:n}]=i;return[t,e,n]}if(1===i.length){let[e]=i;return"string"==typeof e?[t,e]:[t,void 0,e.payload]}return[t]}(t);return new o(n,r,s)},o.on=c,o.wait=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return new Promise(e=>{let i=t=>{e(t)},[n,r]=u([...t,i]);c(n,r,i)})},o.debug={listenerMap:a,idRegister:l},o.nextId=0},68571:(e,t,i)=>{i.d(t,{h:()=>n});let n=(0,i(67203).createContext)(null)},83628:(e,t,i)=>{i.d(t,{K:()=>u});var n=i(17953),r=i(81074),s=i(49797),l=i(24223),a=i(52489),o=i(29338);class u extends a.${_onSetSize(){let{size:{x:e,y:t},pixelRatio:i}=this,{renderer:n,perspectiveCamera:r,orthographicCamera:s}=this;n.setSize(e,t),n.setPixelRatio(i);let l=e/t;r.aspect=l,r.updateProjectionMatrix(),s.left=-l,s.right=l,s.top=1,s.bottom=-1,s.updateProjectionMatrix()}initialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(this.initialized)return console.warn("ThreeWebGLContext is already initialized."),this;Object.defineProperty(this,"initialized",{value:!0,writable:!1,configurable:!1,enumerable:!1});let i=this.scenePass.getTextureNode("output");this.postProcessing.outputNode=i,new ResizeObserver(()=>{this.setSize({width:e.clientWidth,height:e.clientHeight,pixelRatio:window.devicePixelRatio})}).observe(e);let{domElement:n}=this.renderer;return n.style.display="block",n.style.width="100%",n.style.height="100%",e.appendChild(n),this.setSize({width:n.clientWidth,height:n.clientHeight,pixelRatio:window.devicePixelRatio}),this.internal.cancelTick=this.ticker.onTick({name:"WebGPU:Render",phase:o.z.Render},e=>{this.renderFrame(e)}).destroy,this.internal.cancelRequestActivation=(0,l.O)(document.body,this.ticker.requestActivation).destroy,this.internal.cancelPointer=this.pointer.initialize(this.renderer.domElement,t,this.camera,this.ticker),this.domContainer=e,this.domElement=n,this}renderFrame(e,t){(!1!==this._enabled||(null==t?void 0:t.force)===!0)&&(super.renderFrame(e,t),!1===this.skipRender&&this.postProcessing.renderAsync())}constructor(){super(o.s.WebGPU),this.renderer=new r.uV1({antialias:!0}),this.perspectiveCamera=new s.ubm,this.orthographicCamera=new s.qUd,this.camera=this.perspectiveCamera,this.postProcessing=new r.io7(this.renderer),this.scenePass=(0,n.IXH)(this.scene,this.perspectiveCamera),this.internal={observer:null,cancelRequestActivation:null,cancelTick:null,cancelPointer:null},this.initialized=!1,this.destroyed=!1,this.destroy=()=>{var e,t,i,n,r,s,l;if(this.destroyed)return void console.warn("ThreeWebGLContext is already destroyed.");Object.defineProperty(this,"destroyed",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.renderer.dispose(),null==(e=this.internal.observer)||e.disconnect(),null==(t=(i=this.internal).cancelTick)||t.call(i),null==(n=(r=this.internal).cancelRequestActivation)||n.call(r),null==(s=(l=this.internal).cancelPointer)||s.call(l)},this.camera.position.set(0,1,10),this.camera.lookAt(0,0,0),this.pointer.updatePosition(this.camera,{x:0,y:0},this.renderer.domElement.getBoundingClientRect())}}},87548:(e,t,i)=>{i.r(t),i.d(t,{useGroup:()=>h,useInstance:()=>p,useThree:()=>u,useThreeWebGL:()=>c,useThreeWebGPU:()=>d});var n=i(67203),r=i(49797),s=i(18479),l=i(29338),a=i(79911),o=i(68571);function u(e,t){let i=(0,n.useContext)(o.h);return(0,s.useEffects)(async function*(t,n){if(e){let t=e(i,n);if(t&&"function"==typeof t.next)do{let{value:e,done:i}=await t.next();if(i)break;yield e}while(n.mounted)}},null!=t?t:"always"),i}function c(e,t){let i=u(async function*(t,i){if(t.type===l.s.WebGL&&e){let n=e(t,i);if(n&&"function"==typeof n.next)for(;;){let{value:e,done:t}=await n.next();if(t)break;yield e}}},t);return i.type===l.s.WebGL?i:null}function d(e,t){let i=u(async function*(t,i){if(t.type===l.s.WebGPU&&e){let n=e(t,i);if(n&&"function"==typeof n.next)for(;;){let{value:e,done:t}=await n.next();if(t)break;yield e}}},t);return i.type===l.s.WebGPU?i:null}function h(e,t,i){let s=(0,n.useMemo)(()=>new r.YJl,[]);return s.name=e,u(async function*(e,i){if(e.scene.add(s),yield()=>{s.clear(),s.removeFromParent()},t){let n=t(s,e,i);if(n&&"function"==typeof n.next)do{let{value:e,done:t}=await n.next();if(t)break;yield e}while(i.mounted)}},i),s}function p(e){u(async function*(t){let{value:i,args:n=[],hidden:s}=e;if(!i)return;let l="function"==typeof i&&i.prototype&&r.B69.prototype.isPrototypeOf(i.prototype)?new i(...n):i;for(let i of((0,a.mj)(l,{parent:t.scene,...e.transform}),s&&(l.visible=!1),(0,a.$z)(l,{includeSelf:!0})))if("onInitialize"in i){let e=i.onInitialize(t);if(e&&"function"==typeof e.next)for(;;){let{value:t,done:i}=await e.next();if(i)break;yield t}}yield()=>{for(let t of(l.removeFromParent(),(0,a.$z)(l,{includeSelf:!0})))if("onDestroy"in t){var e;null==(e=t.onDestroy)||e.call(t)}}},"always")}}}]);