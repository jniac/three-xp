"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5406],{11561:function(e,t,r){r.d(t,{z:function(){return f}});var i=r(88780);let s={type:"change"},n={type:"start"},a={type:"end"},o=new i.zHn,l=new i.JOQ,h=Math.cos(70*i.M8C.DEG2RAD),u=new i.Pa4,c=2*Math.PI,d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};class f extends i.ZXd{constructor(e,t=null){super(e,t),this.state=d.NONE,this.enabled=!0,this.target=new i.Pa4,this.cursor=new i.Pa4,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:i.RsA.ROTATE,MIDDLE:i.RsA.DOLLY,RIGHT:i.RsA.PAN},this.touches={ONE:i.QmN.ROTATE,TWO:i.QmN.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new i.Pa4,this._lastQuaternion=new i._fP,this._lastTargetPosition=new i.Pa4,this._quat=new i._fP().setFromUnitVectors(e.up,new i.Pa4(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new i.$V,this._sphericalDelta=new i.$V,this._scale=1,this._panOffset=new i.Pa4,this._rotateStart=new i.FM8,this._rotateEnd=new i.FM8,this._rotateDelta=new i.FM8,this._panStart=new i.FM8,this._panEnd=new i.FM8,this._panDelta=new i.FM8,this._dollyStart=new i.FM8,this._dollyEnd=new i.FM8,this._dollyDelta=new i.FM8,this._dollyDirection=new i.Pa4,this._mouse=new i.FM8,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=m.bind(this),this._onPointerDown=p.bind(this),this._onPointerUp=g.bind(this),this._onContextMenu=y.bind(this),this._onMouseWheel=T.bind(this),this._onKeyDown=x.bind(this),this._onTouchStart=E.bind(this),this._onTouchMove=A.bind(this),this._onMouseDown=v.bind(this),this._onMouseMove=_.bind(this),this._interceptControlDown=b.bind(this),this._interceptControlUp=w.bind(this),null!==this.domElement&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){null!==this._domElementKeyEvents&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(s),this.update(),this.state=d.NONE}update(e=null){let t=this.object.position;u.copy(t).sub(this.target),u.applyQuaternion(this._quat),this._spherical.setFromVector3(u),this.autoRotate&&this.state===d.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let r=this.minAzimuthAngle,n=this.maxAzimuthAngle;isFinite(r)&&isFinite(n)&&(r<-Math.PI?r+=c:r>Math.PI&&(r-=c),n<-Math.PI?n+=c:n>Math.PI&&(n-=c),r<=n?this._spherical.theta=Math.max(r,Math.min(n,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(r+n)/2?Math.max(r,this._spherical.theta):Math.min(n,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),!0===this.enableDamping?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let a=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{let e=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),a=e!=this._spherical.radius}if(u.setFromSpherical(this._spherical),u.applyQuaternion(this._quatInverse),t.copy(this.target).add(u),this.object.lookAt(this.target),!0===this.enableDamping?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let e=null;if(this.object.isPerspectiveCamera){let t=u.length();e=this._clampDistance(t*this._scale);let r=t-e;this.object.position.addScaledVector(this._dollyDirection,r),this.object.updateMatrixWorld(),a=!!r}else if(this.object.isOrthographicCamera){let t=new i.Pa4(this._mouse.x,this._mouse.y,0);t.unproject(this.object);let r=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),a=r!==this.object.zoom;let s=new i.Pa4(this._mouse.x,this._mouse.y,0);s.unproject(this.object),this.object.position.sub(s).add(t),this.object.updateMatrixWorld(),e=u.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;null!==e&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(e).add(this.object.position):(o.origin.copy(this.object.position),o.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(o.direction))<h?this.object.lookAt(this.target):(l.setFromNormalAndCoplanarPoint(this.object.up,this.target),o.intersectPlane(l,this.target))))}else if(this.object.isOrthographicCamera){let e=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),e!==this.object.zoom&&(this.object.updateProjectionMatrix(),a=!0)}return this._scale=1,this._performCursorZoom=!1,!!(a||this._lastPosition.distanceToSquared(this.object.position)>1e-6||8*(1-this._lastQuaternion.dot(this.object.quaternion))>1e-6||this._lastTargetPosition.distanceToSquared(this.target)>1e-6)&&(this.dispatchEvent(s),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0)}_getAutoRotationAngle(e){return null!==e?c/60*this.autoRotateSpeed*e:c/60/60*this.autoRotateSpeed}_getZoomScale(e){return Math.pow(.95,this.zoomSpeed*Math.abs(.01*e))}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){u.setFromMatrixColumn(t,0),u.multiplyScalar(-e),this._panOffset.add(u)}_panUp(e,t){!0===this.screenSpacePanning?u.setFromMatrixColumn(t,1):(u.setFromMatrixColumn(t,0),u.crossVectors(this.object.up,u)),u.multiplyScalar(e),this._panOffset.add(u)}_pan(e,t){let r=this.domElement;if(this.object.isPerspectiveCamera){let i=this.object.position;u.copy(i).sub(this.target);let s=u.length();s*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*s/r.clientHeight,this.object.matrix),this._panUp(2*t*s/r.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/r.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/r.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;let r=this.domElement.getBoundingClientRect(),i=e-r.left,s=t-r.top,n=r.width,a=r.height;this._mouse.x=i/n*2-1,this._mouse.y=-(s/a*2)+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;this._rotateLeft(c*this._rotateDelta.x/t.clientHeight),this._rotateUp(c*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(c*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(-c*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(c*this.rotateSpeed/this.domElement.clientHeight):this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(-c*this.rotateSpeed/this.domElement.clientHeight):this._pan(-this.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(1===this._pointers.length)this._rotateStart.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this._rotateStart.set(r,i)}}_handleTouchStartPan(e){if(1===this._pointers.length)this._panStart.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this._panStart.set(r,i)}}_handleTouchStartDolly(e){let t=this._getSecondPointerPosition(e),r=e.pageX-t.x,i=e.pageY-t.y;this._dollyStart.set(0,Math.sqrt(r*r+i*i))}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(1==this._pointers.length)this._rotateEnd.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this._rotateEnd.set(r,i)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;this._rotateLeft(c*this._rotateDelta.x/t.clientHeight),this._rotateUp(c*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(1===this._pointers.length)this._panEnd.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this._panEnd.set(r,i)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){let t=this._getSecondPointerPosition(e),r=e.pageX-t.x,i=e.pageY-t.y;this._dollyEnd.set(0,Math.sqrt(r*r+i*i)),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);let s=(e.pageX+t.x)*.5,n=(e.pageY+t.y)*.5;this._updateZoomParameters(s,n)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];void 0===t&&(t=new i.FM8,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){let t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){let t=e.deltaMode,r={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:r.deltaY*=16;break;case 2:r.deltaY*=100}return e.ctrlKey&&!this._controlActive&&(r.deltaY*=10),r}}function p(e){!1!==this.enabled&&(0===this._pointers.length&&(this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._isTrackingPointer(e)||(this._addPointer(e),"touch"===e.pointerType?this._onTouchStart(e):this._onMouseDown(e)))}function m(e){!1!==this.enabled&&("touch"===e.pointerType?this._onTouchMove(e):this._onMouseMove(e))}function g(e){switch(this._removePointer(e),this._pointers.length){case 0:this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(a),this.state=d.NONE;break;case 1:let t=this._pointers[0],r=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:r.x,pageY:r.y})}}function v(e){let t;switch(e.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case i.RsA.DOLLY:if(!1===this.enableZoom)return;this._handleMouseDownDolly(e),this.state=d.DOLLY;break;case i.RsA.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===this.enablePan)return;this._handleMouseDownPan(e),this.state=d.PAN}else{if(!1===this.enableRotate)return;this._handleMouseDownRotate(e),this.state=d.ROTATE}break;case i.RsA.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===this.enableRotate)return;this._handleMouseDownRotate(e),this.state=d.ROTATE}else{if(!1===this.enablePan)return;this._handleMouseDownPan(e),this.state=d.PAN}break;default:this.state=d.NONE}this.state!==d.NONE&&this.dispatchEvent(n)}function _(e){switch(this.state){case d.ROTATE:if(!1===this.enableRotate)return;this._handleMouseMoveRotate(e);break;case d.DOLLY:if(!1===this.enableZoom)return;this._handleMouseMoveDolly(e);break;case d.PAN:if(!1===this.enablePan)return;this._handleMouseMovePan(e)}}function T(e){!1!==this.enabled&&!1!==this.enableZoom&&this.state===d.NONE&&(e.preventDefault(),this.dispatchEvent(n),this._handleMouseWheel(this._customWheelEvent(e)),this.dispatchEvent(a))}function x(e){!1!==this.enabled&&!1!==this.enablePan&&this._handleKeyDown(e)}function E(e){switch(this._trackPointer(e),this._pointers.length){case 1:switch(this.touches.ONE){case i.QmN.ROTATE:if(!1===this.enableRotate)return;this._handleTouchStartRotate(e),this.state=d.TOUCH_ROTATE;break;case i.QmN.PAN:if(!1===this.enablePan)return;this._handleTouchStartPan(e),this.state=d.TOUCH_PAN;break;default:this.state=d.NONE}break;case 2:switch(this.touches.TWO){case i.QmN.DOLLY_PAN:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchStartDollyPan(e),this.state=d.TOUCH_DOLLY_PAN;break;case i.QmN.DOLLY_ROTATE:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchStartDollyRotate(e),this.state=d.TOUCH_DOLLY_ROTATE;break;default:this.state=d.NONE}break;default:this.state=d.NONE}this.state!==d.NONE&&this.dispatchEvent(n)}function A(e){switch(this._trackPointer(e),this.state){case d.TOUCH_ROTATE:if(!1===this.enableRotate)return;this._handleTouchMoveRotate(e),this.update();break;case d.TOUCH_PAN:if(!1===this.enablePan)return;this._handleTouchMovePan(e),this.update();break;case d.TOUCH_DOLLY_PAN:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchMoveDollyPan(e),this.update();break;case d.TOUCH_DOLLY_ROTATE:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchMoveDollyRotate(e),this.update();break;default:this.state=d.NONE}}function y(e){!1!==this.enabled&&e.preventDefault()}function b(e){"Control"===e.key&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function w(e){"Control"===e.key&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}},95092:function(e,t,r){r.d(t,{I:function(){return Y}});var i=r(88780),s={},n=Uint8Array,a=Uint16Array,o=Int32Array,l=new n([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),h=new n([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),u=new n([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=function(e,t){for(var r=new a(31),i=0;i<31;++i)r[i]=t+=1<<e[i-1];for(var s=new o(r[30]),i=1;i<30;++i)for(var n=r[i];n<r[i+1];++n)s[n]=n-r[i]<<5|i;return{b:r,r:s}},d=c(l,2),f=d.b,p=d.r;f[28]=258,p[258]=28;for(var m=c(h,0),g=m.b,v=m.r,_=new a(32768),T=0;T<32768;++T){var x=(43690&T)>>1|(21845&T)<<1;x=(61680&(x=(52428&x)>>2|(13107&x)<<2))>>4|(3855&x)<<4,_[T]=((65280&x)>>8|(255&x)<<8)>>1}for(var E=function(e,t,r){for(var i,s=e.length,n=0,o=new a(t);n<s;++n)e[n]&&++o[e[n]-1];var l=new a(t);for(n=1;n<t;++n)l[n]=l[n-1]+o[n-1]<<1;if(r){i=new a(1<<t);var h=15-t;for(n=0;n<s;++n)if(e[n])for(var u=n<<4|e[n],c=t-e[n],d=l[e[n]-1]++<<c,f=d|(1<<c)-1;d<=f;++d)i[_[d]>>h]=u}else for(n=0,i=new a(s);n<s;++n)e[n]&&(i[n]=_[l[e[n]-1]++]>>15-e[n]);return i},A=new n(288),T=0;T<144;++T)A[T]=8;for(var T=144;T<256;++T)A[T]=9;for(var T=256;T<280;++T)A[T]=7;for(var T=280;T<288;++T)A[T]=8;for(var y=new n(32),T=0;T<32;++T)y[T]=5;var b=E(A,9,1),w=E(y,5,1),S=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},M=function(e,t,r){var i=t/8|0;return(e[i]|e[i+1]<<8)>>(7&t)&r},R=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},C=function(e){return(e+7)/8|0},P=function(e,t,r){return(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length),new n(e.subarray(t,r))},D=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],L=function(e,t,r){var i=Error(t||D[e]);if(i.code=e,Error.captureStackTrace&&Error.captureStackTrace(i,L),!r)throw i;return i},O=function(e,t,r,i){var s=e.length,a=i?i.length:0;if(!s||t.f&&!t.l)return r||new n(0);var o=!r,c=o||2!=t.i,d=t.i;o&&(r=new n(3*s));var p=function(e){var t=r.length;if(e>t){var i=new n(Math.max(2*t,e));i.set(r),r=i}},m=t.f||0,v=t.p||0,_=t.b||0,T=t.l,x=t.d,A=t.m,y=t.n,D=8*s;do{if(!T){m=M(e,v,1);var O=M(e,v+1,3);if(v+=3,O){if(1==O)T=b,x=w,A=9,y=5;else if(2==O){var I=M(e,v,31)+257,k=M(e,v+10,15)+4,N=I+M(e,v+5,31)+1;v+=14;for(var U=new n(N),B=new n(19),F=0;F<k;++F)B[u[F]]=M(e,v+3*F,7);v+=3*k;for(var H=S(B),z=(1<<H)-1,G=E(B,H,1),F=0;F<N;){var j=G[M(e,v,z)];v+=15&j;var K=j>>4;if(K<16)U[F++]=K;else{var V=0,X=0;for(16==K?(X=3+M(e,v,3),v+=2,V=U[F-1]):17==K?(X=3+M(e,v,7),v+=3):18==K&&(X=11+M(e,v,127),v+=7);X--;)U[F++]=V}}var Y=U.subarray(0,I),W=U.subarray(I);A=S(Y),y=S(W),T=E(Y,A,1),x=E(W,y,1)}else L(1)}else{var K=C(v)+4,Z=e[K-4]|e[K-3]<<8,Q=K+Z;if(Q>s){d&&L(0);break}c&&p(_+Z),r.set(e.subarray(K,Q),_),t.b=_+=Z,t.p=v=8*Q,t.f=m;continue}if(v>D){d&&L(0);break}}c&&p(_+131072);for(var q=(1<<A)-1,J=(1<<y)-1,$=v;;$=v){var V=T[R(e,v)&q],ee=V>>4;if((v+=15&V)>D){d&&L(0);break}if(V||L(2),ee<256)r[_++]=ee;else if(256==ee){$=v,T=null;break}else{var et=ee-254;if(ee>264){var F=ee-257,er=l[F];et=M(e,v,(1<<er)-1)+f[F],v+=er}var ei=x[R(e,v)&J],es=ei>>4;ei||L(3),v+=15&ei;var W=g[es];if(es>3){var er=h[es];W+=R(e,v)&(1<<er)-1,v+=er}if(v>D){d&&L(0);break}c&&p(_+131072);var en=_+et;if(_<W){var ea=a-W,eo=Math.min(W,en);for(ea+_<0&&L(3);_<eo;++_)r[_]=i[ea+_]}for(;_<en;++_)r[_]=r[_-W]}}t.l=T,t.p=$,t.b=_,t.f=m,T&&(m=1,t.m=A,t.d=x,t.n=y)}while(!m);return _!=r.length&&o?P(r,0,_):r.subarray(0,_)},I=function(e,t,r){r<<=7&t;var i=t/8|0;e[i]|=r,e[i+1]|=r>>8},k=function(e,t,r){r<<=7&t;var i=t/8|0;e[i]|=r,e[i+1]|=r>>8,e[i+2]|=r>>16},N=function(e,t){for(var r=[],i=0;i<e.length;++i)e[i]&&r.push({s:i,f:e[i]});var s=r.length,o=r.slice();if(!s)return{t:j,l:0};if(1==s){var l=new n(r[0].s+1);return l[r[0].s]=1,{t:l,l:1}}r.sort(function(e,t){return e.f-t.f}),r.push({s:-1,f:25001});var h=r[0],u=r[1],c=0,d=1,f=2;for(r[0]={s:-1,f:h.f+u.f,l:h,r:u};d!=s-1;)h=r[r[c].f<r[f].f?c++:f++],u=r[c!=d&&r[c].f<r[f].f?c++:f++],r[d++]={s:-1,f:h.f+u.f,l:h,r:u};for(var p=o[0].s,i=1;i<s;++i)o[i].s>p&&(p=o[i].s);var m=new a(p+1),g=U(r[d-1],m,0);if(g>t){var i=0,v=0,_=g-t,T=1<<_;for(o.sort(function(e,t){return m[t.s]-m[e.s]||e.f-t.f});i<s;++i){var x=o[i].s;if(m[x]>t)v+=T-(1<<g-m[x]),m[x]=t;else break}for(v>>=_;v>0;){var E=o[i].s;m[E]<t?v-=1<<t-m[E]++-1:++i}for(;i>=0&&v;--i){var A=o[i].s;m[A]==t&&(--m[A],++v)}g=t}return{t:new n(m),l:g}},U=function(e,t,r){return -1==e.s?Math.max(U(e.l,t,r+1),U(e.r,t,r+1)):t[e.s]=r},B=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new a(++t),i=0,s=e[0],n=1,o=function(e){r[i++]=e},l=1;l<=t;++l)if(e[l]==s&&l!=t)++n;else{if(!s&&n>2){for(;n>138;n-=138)o(32754);n>2&&(o(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(o(s),--n;n>6;n-=6)o(8304);n>2&&(o(n-3<<5|8208),n=0)}for(;n--;)o(s);n=1,s=e[l]}return{c:r.subarray(0,i),n:t}},F=function(e,t){for(var r=0,i=0;i<t.length;++i)r+=e[i]*t[i];return r},H=function(e,t,r){var i=r.length,s=C(t+2);e[s]=255&i,e[s+1]=i>>8,e[s+2]=255^e[s],e[s+3]=255^e[s+1];for(var n=0;n<i;++n)e[s+n+4]=r[n];return(s+4+i)*8},z=function(e,t,r,i,s,n,o,c,d,f,p){I(t,p++,r),++s[256];for(var m,g,v,_,T=N(s,15),x=T.t,b=T.l,w=N(n,15),S=w.t,M=w.l,R=B(x),C=R.c,P=R.n,D=B(S),L=D.c,O=D.n,U=new a(19),z=0;z<C.length;++z)++U[31&C[z]];for(var z=0;z<L.length;++z)++U[31&L[z]];for(var G=N(U,7),j=G.t,K=G.l,V=19;V>4&&!j[u[V-1]];--V);var X=f+5<<3,Y=F(s,A)+F(n,y)+o,W=F(s,x)+F(n,S)+o+14+3*V+F(U,j)+2*U[16]+3*U[17]+7*U[18];if(d>=0&&X<=Y&&X<=W)return H(t,p,e.subarray(d,d+f));if(I(t,p,1+(W<Y)),p+=2,W<Y){m=E(x,b,0),g=x,v=E(S,M,0),_=S;var Z=E(j,K,0);I(t,p,P-257),I(t,p+5,O-1),I(t,p+10,V-4),p+=14;for(var z=0;z<V;++z)I(t,p+3*z,j[u[z]]);p+=3*V;for(var Q=[C,L],q=0;q<2;++q)for(var J=Q[q],z=0;z<J.length;++z){var $=31&J[z];I(t,p,Z[$]),p+=j[$],$>15&&(I(t,p,J[z]>>5&127),p+=J[z]>>12)}}else m=null,g=A,v=null,_=y;for(var z=0;z<c;++z){var ee=i[z];if(ee>255){var $=ee>>18&31;k(t,p,m[$+257]),p+=g[$+257],$>7&&(I(t,p,ee>>23&31),p+=l[$]);var et=31&ee;k(t,p,v[et]),p+=_[et],et>3&&(k(t,p,ee>>5&8191),p+=h[et])}else k(t,p,m[ee]),p+=g[ee]}return k(t,p,m[256]),p+g[256]},G=new o([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),j=new n(0),K=function(e,t,r,i,s,u){var c=u.z||e.length,d=new n(i+c+5*(1+Math.ceil(c/7e3))+s),f=d.subarray(i,d.length-s),m=u.l,g=7&(u.r||0);if(t){g&&(f[0]=u.r>>3);for(var _=G[t-1],T=_>>13,x=8191&_,E=(1<<r)-1,A=u.p||new a(32768),y=u.h||new a(E+1),b=Math.ceil(r/3),w=2*b,S=function(t){return(e[t]^e[t+1]<<b^e[t+2]<<w)&E},M=new o(25e3),R=new a(288),D=new a(32),L=0,O=0,I=u.i||0,k=0,N=u.w||0,U=0;I+2<c;++I){var B=S(I),F=32767&I,j=y[B];if(A[F]=j,y[B]=F,N<=I){var K=c-I;if((L>7e3||k>24576)&&(K>423||!m)){g=z(e,f,0,M,R,D,O,k,U,I-U,g),k=L=O=0,U=I;for(var V=0;V<286;++V)R[V]=0;for(var V=0;V<30;++V)D[V]=0}var X=2,Y=0,W=x,Z=F-j&32767;if(K>2&&B==S(I-Z))for(var Q=Math.min(T,K)-1,q=Math.min(32767,I),J=Math.min(258,K);Z<=q&&--W&&F!=j;){if(e[I+X]==e[I+X-Z]){for(var $=0;$<J&&e[I+$]==e[I+$-Z];++$);if($>X){if(X=$,Y=Z,$>Q)break;for(var ee=Math.min(Z,$-2),et=0,V=0;V<ee;++V){var er=I-Z+V&32767,ei=A[er],es=er-ei&32767;es>et&&(et=es,j=er)}}}j=A[F=j],Z+=F-j&32767}if(Y){M[k++]=268435456|p[X]<<18|v[Y];var en=31&p[X],ea=31&v[Y];O+=l[en]+h[ea],++R[257+en],++D[ea],N=I+X,++L}else M[k++]=e[I],++R[e[I]]}}for(I=Math.max(I,N);I<c;++I)M[k++]=e[I],++R[e[I]];g=z(e,f,m,M,R,D,O,k,U,I-U,g),m||(u.r=7&g|f[g/8|0]<<3,g-=7,u.h=y,u.p=A,u.i=I,u.w=N)}else{for(var I=u.w||0;I<c+m;I+=65535){var eo=I+65535;eo>=c&&(f[g/8|0]=m,eo=c),g=H(f,g+1,e.subarray(I,eo))}u.i=c}return P(d,0,i+C(g)+s)};function V(e,t){var r;return O(e.subarray((r=t&&t.dictionary,((15&e[0])!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&L(6,"invalid zlib data"),(e[1]>>5&1)==+!r&&L(6,"invalid zlib data: "+(32&e[1]?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2),-4),{i:2},t&&t.out,t&&t.dictionary)}var X="undefined"!=typeof TextDecoder&&new TextDecoder;try{X.decode(j,{stream:!0})}catch(e){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;class Y extends i.yxD{constructor(e){super(e),this.type=i.cLu}parse(e){let t={l:0,c:0,lc:0};function r(e,r,i,s,n){for(;i<e;)r=r<<8|S(s,n),i+=8;i-=e,t.l=r>>i&(1<<e)-1,t.c=r,t.lc=i}let s=Array(59),n={c:0,lc:0};function a(e,t,r,i){e=e<<8|S(r,i),t+=8,n.c=e,n.lc=t}let o={c:0,lc:0};function l(e,t,r,i,s,l,h,u,c){if(e==t){i<8&&(a(r,i,s,l),r=n.c,i=n.lc);let e=r>>(i-=8);if(e=new Uint8Array([e])[0],u.value+e>c)return!1;let t=h[u.value-1];for(;e-- >0;)h[u.value++]=t}else{if(!(u.value<c))return!1;h[u.value++]=e}o.c=r,o.lc=i}function h(e){let t=65535&e;return t>32767?t-65536:t}let u={a:0,b:0};function c(e,t){let r=h(e),i=h(t),s=r+(1&i)+(i>>1),n=s-i;u.a=s,u.b=n}function d(e,t){let r=65535&t,i=(65535&e)-(r>>1)&65535;u.a=r+i-32768&65535,u.b=i}function f(e,i,h,u,c,d){let f=h.value,p=w(i,h),m=w(i,h);h.value+=4;let g=w(i,h);if(h.value+=4,p<0||p>=65537||m<0||m>=65537)throw Error("Something wrong with HUF_ENCSIZE");let v=Array(65537),_=Array(16384);!function(e){for(let t=0;t<16384;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}(_);let T=u-(h.value-f);if(!function(e,i,n,a,o,l){let h=0,u=0;for(;a<=o;a++){if(i.value-i.value>n)return!1;r(6,h,u,e,i);let s=t.l;if(h=t.c,u=t.lc,l[a]=s,63==s){if(i.value-i.value>n)throw Error("Something wrong with hufUnpackEncTable");r(8,h,u,e,i);let s=t.l+6;if(h=t.c,u=t.lc,a+s>o+1)throw Error("Something wrong with hufUnpackEncTable");for(;s--;)l[a++]=0;a--}else if(s>=59){let e=s-59+2;if(a+e>o+1)throw Error("Something wrong with hufUnpackEncTable");for(;e--;)l[a++]=0;a--}}!function(e){for(let e=0;e<=58;++e)s[e]=0;for(let t=0;t<65537;++t)s[e[t]]+=1;let t=0;for(let e=58;e>0;--e){let r=t+s[e]>>1;s[e]=t,t=r}for(let t=0;t<65537;++t){let r=e[t];r>0&&(e[t]=r|s[r]++<<6)}}(l)}(e,h,T,p,m,v),g>8*(u-(h.value-f)))throw Error("Something wrong with hufUncompress");!function(e,t,r,i){for(;t<=r;t++){let r=e[t]>>6,s=63&e[t];if(r>>s)throw Error("Invalid table entry");if(s>14){let e=i[r>>s-14];if(e.len)throw Error("Invalid table entry");if(e.lit++,e.p){let t=e.p;e.p=Array(e.lit);for(let r=0;r<e.lit-1;++r)e.p[r]=t[r]}else e.p=[,];e.p[e.lit-1]=t}else if(s){let e=0;for(let n=1<<14-s;n>0;n--){let n=i[(r<<14-s)+e];if(n.len||n.p)throw Error("Invalid table entry");n.len=s,n.lit=t,e++}}}}(v,p,m,_),function(e,t,r,i,s,h,u,c,d){let f=0,p=0,m=Math.trunc(i.value+(s+7)/8);for(;i.value<m;)for(a(f,p,r,i),f=n.c,p=n.lc;p>=14;){let s=t[f>>p-14&16383];if(s.len)p-=s.len,l(s.lit,h,f,p,r,i,c,d,u),f=o.c,p=o.lc;else{let t;if(!s.p)throw Error("hufDecode issues");for(t=0;t<s.lit;t++){let g=63&e[s.p[t]];for(;p<g&&i.value<m;)a(f,p,r,i),f=n.c,p=n.lc;if(p>=g&&e[s.p[t]]>>6==(f>>p-g&(1<<g)-1)){p-=g,l(s.p[t],h,f,p,r,i,c,d,u),f=o.c,p=o.lc;break}}if(t==s.lit)throw Error("hufDecode issues")}}let g=8-s&7;for(f>>=g,p-=g;p>0;){let e=t[f<<14-p&16383];if(e.len)p-=e.len,l(e.lit,h,f,p,r,i,c,d,u),f=o.c,p=o.lc;else throw Error("hufDecode issues")}}(v,_,e,h,g,m,d,c,{value:0})}function p(e){for(let t=1;t<e.length;t++){let r=e[t-1]+e[t]-128;e[t]=r}}function m(e,t){let r=0,i=Math.floor((e.length+1)/2),s=0,n=e.length-1;for(;!(s>n)&&(t[s++]=e[r++],!(s>n));)t[s++]=e[i++]}function g(e){let t=e.byteLength,r=[],i=0,s=new DataView(e);for(;t>0;){let e=s.getInt8(i++);if(e<0){let n=-e;t-=n+1;for(let e=0;e<n;e++)r.push(s.getUint8(i++))}else{t-=2;let n=s.getUint8(i++);for(let t=0;t<e+1;t++)r.push(n)}}return r}function v(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function _(e){let t=new Uint8Array(g(e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size))),r=new Uint8Array(t.length);return p(t),m(t,r),new DataView(r.buffer)}function T(e){let t=V(e.array.slice(e.offset.value,e.offset.value+e.size)),r=new Uint8Array(t.length);return p(t),m(t,r),new DataView(r.buffer)}function x(e){let t=e.viewer,r={value:e.offset.value},i=new Uint16Array(e.columns*e.lines*(e.inputChannels.length*e.type)),s=new Uint8Array(8192),n=0,a=Array(e.inputChannels.length);for(let t=0,r=e.inputChannels.length;t<r;t++)a[t]={},a[t].start=n,a[t].end=a[t].start,a[t].nx=e.columns,a[t].ny=e.lines,a[t].size=e.type,n+=a[t].nx*a[t].ny*a[t].size;let o=L(t,r),l=L(t,r);if(l>=8192)throw Error("Something is wrong with PIZ_COMPRESSION BITMAP_SIZE");if(o<=l)for(let e=0;e<l-o+1;e++)s[e+o]=M(t,r);let h=new Uint16Array(65536),p=function(e,t){let r=0;for(let i=0;i<65536;++i)(0==i||e[i>>3]&1<<(7&i))&&(t[r++]=i);let i=r-1;for(;r<65536;)t[r++]=0;return i}(s,h),m=w(t,r);f(e.array,t,r,m,i,n);for(let t=0;t<e.inputChannels.length;++t){let e=a[t];for(let r=0;r<a[t].size;++r)!function(e,t,r,i,s,n,a){let o,l;let h=a<16384,f=r>s?s:r,p=1;for(;p<=f;)p<<=1;for(p>>=1,o=p,p>>=1;p>=1;){let a,f,m,g;let v=(l=0)+n*(s-o),_=n*p,T=n*o,x=i*p,E=i*o;for(;l<=v;l+=T){let s=l,n=l+i*(r-o);for(;s<=n;s+=E){let r=s+x,i=s+_,n=i+x;h?(c(e[s+t],e[i+t]),a=u.a,m=u.b,c(e[r+t],e[n+t]),f=u.a,g=u.b,c(a,f),e[s+t]=u.a,e[r+t]=u.b,c(m,g)):(d(e[s+t],e[i+t]),a=u.a,m=u.b,d(e[r+t],e[n+t]),f=u.a,g=u.b,d(a,f),e[s+t]=u.a,e[r+t]=u.b,d(m,g)),e[i+t]=u.a,e[n+t]=u.b}if(r&p){let r=s+_;h?c(e[s+t],e[r+t]):d(e[s+t],e[r+t]),a=u.a,e[r+t]=u.b,e[s+t]=a}}if(s&p){let s=l,n=l+i*(r-o);for(;s<=n;s+=E){let r=s+x;h?c(e[s+t],e[r+t]):d(e[s+t],e[r+t]),a=u.a,e[r+t]=u.b,e[s+t]=a}}o=p,p>>=1}}(i,e.start+r,e.nx,e.size,e.ny,e.nx*e.size,p)}!function(e,t,r){for(let i=0;i<r;++i)t[i]=e[t[i]]}(h,i,n);let g=0,v=new Uint8Array(i.buffer.byteLength);for(let t=0;t<e.lines;t++)for(let t=0;t<e.inputChannels.length;t++){let e=a[t],r=e.nx*e.size,s=new Uint8Array(i.buffer,2*e.end,2*r);v.set(s,g),g+=2*r,e.end+=r}return new DataView(v.buffer)}function E(e){let t=V(e.array.slice(e.offset.value,e.offset.value+e.size)),r=new DataView(new ArrayBuffer(e.inputChannels.length*e.lines*e.columns*e.totalBytes)),i=0,s=0,n=[,,,,];for(let a=0;a<e.lines;a++)for(let a=0;a<e.inputChannels.length;a++){let o=0;switch(e.inputChannels[a].pixelType){case 1:n[0]=i,n[1]=n[0]+e.columns,i=n[1]+e.columns;for(let i=0;i<e.columns;++i)o+=t[n[0]++]<<8|t[n[1]++],r.setUint16(s,o,!0),s+=2;break;case 2:n[0]=i,n[1]=n[0]+e.columns,n[2]=n[1]+e.columns,i=n[2]+e.columns;for(let i=0;i<e.columns;++i)o+=t[n[0]++]<<24|t[n[1]++]<<16|t[n[2]++]<<8,r.setUint32(s,o,!0),s+=4}}return r}function A(e){let t,r,s;let n=e.viewer,a={value:e.offset.value},o=new Uint8Array(e.columns*e.lines*(e.inputChannels.length*e.type*2)),l={version:R(n,a),unknownUncompressedSize:R(n,a),unknownCompressedSize:R(n,a),acCompressedSize:R(n,a),dcCompressedSize:R(n,a),rleCompressedSize:R(n,a),rleUncompressedSize:R(n,a),rleRawSize:R(n,a),totalAcUncompressedCount:R(n,a),totalDcUncompressedCount:R(n,a),acCompression:R(n,a)};if(l.version<2)throw Error("EXRLoader.parse: "+H.compression+" version "+l.version+" is unsupported");let h=[],u=L(n,a)-2;for(;u>0;){let e=y(n.buffer,a),t=M(n,a),r=t>>2&3,i=new Int8Array([(t>>4)-1])[0],s=M(n,a);h.push({name:e,index:i,type:s,compression:r}),u-=e.length+3}let c=H.channels,d=Array(e.inputChannels.length);for(let t=0;t<e.inputChannels.length;++t){let r=d[t]={},i=c[t];r.name=i.name,r.compression=0,r.decoded=!1,r.type=i.pixelType,r.pLinear=i.pLinear,r.width=e.columns,r.height=e.lines}let p={idx:[,,,]};for(let t=0;t<e.inputChannels.length;++t){let e=d[t];for(let r=0;r<h.length;++r){let i=h[r];e.name==i.name&&(e.compression=i.compression,i.index>=0&&(p.idx[i.index]=t),e.offset=t)}}if(l.acCompressedSize>0)switch(l.acCompression){case 0:t=new Uint16Array(l.totalAcUncompressedCount),f(e.array,n,a,l.acCompressedSize,t,l.totalAcUncompressedCount);break;case 1:t=new Uint16Array(V(e.array.slice(a.value,a.value+l.totalAcUncompressedCount)).buffer),a.value+=l.totalAcUncompressedCount}l.dcCompressedSize>0&&(r=new Uint16Array(T({array:e.array,offset:a,size:l.dcCompressedSize}).buffer),a.value+=l.dcCompressedSize),l.rleRawSize>0&&(s=g(V(e.array.slice(a.value,a.value+l.rleCompressedSize)).buffer),a.value+=l.rleCompressedSize);let m=0,v=Array(d.length);for(let e=0;e<v.length;++e)v[e]=[];for(let t=0;t<e.lines;++t)for(let t=0;t<d.length;++t)v[t].push(m),m+=d[t].width*e.type*2;!function(e,t,r,s,n,a){let o=new DataView(a.buffer),l=r[e.idx[0]].width,h=r[e.idx[0]].height,u=Math.floor(l/8),c=Math.ceil(l/8),d=Math.ceil(h/8),f=l-(c-1)*8,p=h-(d-1)*8,m={value:0},g=[,,,],v=[,,,],_=[,,,],T=[,,,],x=[,,,];for(let r=0;r<3;++r)x[r]=t[e.idx[r]],g[r]=r<1?0:g[r-1]+c*d,v[r]=new Float32Array(64),_[r]=new Uint16Array(64),T[r]=new Uint16Array(64*c);for(let t=0;t<d;++t){let a=8;t==d-1&&(a=p);let l=8;for(let e=0;e<c;++e){e==c-1&&(l=f);for(let e=0;e<3;++e){var E,A;_[e].fill(0),_[e][0]=n[g[e]++],function(e,t,r){let i;let s=1;for(;s<64;)65280==(i=t[e.value])?s=64:i>>8==255?s+=255&i:(r[s]=i,s++),e.value++}(m,s,_[e]),E=_[e],(A=v[e])[0]=D(E[0]),A[1]=D(E[1]),A[2]=D(E[5]),A[3]=D(E[6]),A[4]=D(E[14]),A[5]=D(E[15]),A[6]=D(E[27]),A[7]=D(E[28]),A[8]=D(E[2]),A[9]=D(E[4]),A[10]=D(E[7]),A[11]=D(E[13]),A[12]=D(E[16]),A[13]=D(E[26]),A[14]=D(E[29]),A[15]=D(E[42]),A[16]=D(E[3]),A[17]=D(E[8]),A[18]=D(E[12]),A[19]=D(E[17]),A[20]=D(E[25]),A[21]=D(E[30]),A[22]=D(E[41]),A[23]=D(E[43]),A[24]=D(E[9]),A[25]=D(E[11]),A[26]=D(E[18]),A[27]=D(E[24]),A[28]=D(E[31]),A[29]=D(E[40]),A[30]=D(E[44]),A[31]=D(E[53]),A[32]=D(E[10]),A[33]=D(E[19]),A[34]=D(E[23]),A[35]=D(E[32]),A[36]=D(E[39]),A[37]=D(E[45]),A[38]=D(E[52]),A[39]=D(E[54]),A[40]=D(E[20]),A[41]=D(E[22]),A[42]=D(E[33]),A[43]=D(E[38]),A[44]=D(E[46]),A[45]=D(E[51]),A[46]=D(E[55]),A[47]=D(E[60]),A[48]=D(E[21]),A[49]=D(E[34]),A[50]=D(E[37]),A[51]=D(E[47]),A[52]=D(E[50]),A[53]=D(E[56]),A[54]=D(E[59]),A[55]=D(E[61]),A[56]=D(E[35]),A[57]=D(E[36]),A[58]=D(E[48]),A[59]=D(E[49]),A[60]=D(E[57]),A[61]=D(E[58]),A[62]=D(E[62]),A[63]=D(E[63]),function(e){let t=.5*Math.cos(3*3.14159/16),r=.5*Math.cos(3*3.14159/8),i=[,,,,],s=[,,,,],n=[,,,,],a=[,,,,];for(let o=0;o<8;++o){let l=8*o;i[0]=.4619398297234211*e[l+2],i[1]=r*e[l+2],i[2]=.4619398297234211*e[l+6],i[3]=r*e[l+6],s[0]=.4903926563794112*e[l+1]+t*e[l+3]+.2777854612564676*e[l+5]+.09754573032714427*e[l+7],s[1]=t*e[l+1]-.09754573032714427*e[l+3]-.4903926563794112*e[l+5]-.2777854612564676*e[l+7],s[2]=.2777854612564676*e[l+1]-.4903926563794112*e[l+3]+.09754573032714427*e[l+5]+t*e[l+7],s[3]=.09754573032714427*e[l+1]-.2777854612564676*e[l+3]+t*e[l+5]-.4903926563794112*e[l+7],n[0]=.35355362513961314*(e[l+0]+e[l+4]),n[3]=.35355362513961314*(e[l+0]-e[l+4]),n[1]=i[0]+i[3],n[2]=i[1]-i[2],a[0]=n[0]+n[1],a[1]=n[3]+n[2],a[2]=n[3]-n[2],a[3]=n[0]-n[1],e[l+0]=a[0]+s[0],e[l+1]=a[1]+s[1],e[l+2]=a[2]+s[2],e[l+3]=a[3]+s[3],e[l+4]=a[3]-s[3],e[l+5]=a[2]-s[2],e[l+6]=a[1]-s[1],e[l+7]=a[0]-s[0]}for(let o=0;o<8;++o)i[0]=.4619398297234211*e[16+o],i[1]=r*e[16+o],i[2]=.4619398297234211*e[48+o],i[3]=r*e[48+o],s[0]=.4903926563794112*e[8+o]+t*e[24+o]+.2777854612564676*e[40+o]+.09754573032714427*e[56+o],s[1]=t*e[8+o]-.09754573032714427*e[24+o]-.4903926563794112*e[40+o]-.2777854612564676*e[56+o],s[2]=.2777854612564676*e[8+o]-.4903926563794112*e[24+o]+.09754573032714427*e[40+o]+t*e[56+o],s[3]=.09754573032714427*e[8+o]-.2777854612564676*e[24+o]+t*e[40+o]-.4903926563794112*e[56+o],n[0]=.35355362513961314*(e[o]+e[32+o]),n[3]=.35355362513961314*(e[o]-e[32+o]),n[1]=i[0]+i[3],n[2]=i[1]-i[2],a[0]=n[0]+n[1],a[1]=n[3]+n[2],a[2]=n[3]-n[2],a[3]=n[0]-n[1],e[0+o]=a[0]+s[0],e[8+o]=a[1]+s[1],e[16+o]=a[2]+s[2],e[24+o]=a[3]+s[3],e[32+o]=a[3]-s[3],e[40+o]=a[2]-s[2],e[48+o]=a[1]-s[1],e[56+o]=a[0]-s[0]}(v[e])}!function(e){for(let t=0;t<64;++t){let r=e[0][t],i=e[1][t],s=e[2][t];e[0][t]=r+1.5747*s,e[1][t]=r-.1873*i-.4682*s,e[2][t]=r+1.8556*i}}(v);for(let t=0;t<3;++t)!function(e,t,r){for(let n=0;n<64;++n){var s;t[r+n]=i.A5E.toHalfFloat((s=e[n])<=1?Math.sign(s)*Math.pow(Math.abs(s),2.2):Math.sign(s)*Math.pow(9.025013291561939,Math.abs(s)-1))}}(v[t],T[t],64*e)}let h=0;for(let i=0;i<3;++i){let s=r[e.idx[i]].type;for(let e=8*t;e<8*t+a;++e){h=x[i][e];for(let t=0;t<u;++t){let r=64*t+(7&e)*8;o.setUint16(h+0*s,T[i][r+0],!0),o.setUint16(h+2*s,T[i][r+1],!0),o.setUint16(h+4*s,T[i][r+2],!0),o.setUint16(h+6*s,T[i][r+3],!0),o.setUint16(h+8*s,T[i][r+4],!0),o.setUint16(h+10*s,T[i][r+5],!0),o.setUint16(h+12*s,T[i][r+6],!0),o.setUint16(h+14*s,T[i][r+7],!0),h+=16*s}}if(u!=c)for(let e=8*t;e<8*t+a;++e){let t=x[i][e]+8*u*2*s,r=64*u+(7&e)*8;for(let e=0;e<l;++e)o.setUint16(t+2*e*s,T[i][r+e],!0)}}}let y=new Uint16Array(l);o=new DataView(a.buffer);for(let t=0;t<3;++t){r[e.idx[t]].decoded=!0;let i=r[e.idx[t]].type;if(2==r[t].type)for(let e=0;e<h;++e){let r=x[t][e];for(let e=0;e<l;++e)y[e]=o.getUint16(r+2*e*i,!0);for(let e=0;e<l;++e)o.setFloat32(r+2*e*i,D(y[e]),!0)}}}(p,v,d,t,r,o);for(let t=0;t<d.length;++t){let r=d[t];if(!r.decoded){if(2===r.compression){let i=0,n=0;for(let a=0;a<e.lines;++a){let e=v[t][i];for(let t=0;t<r.width;++t){for(let t=0;t<2*r.type;++t)o[e++]=s[n+t*r.width*r.height];n++}i++}}else throw Error("EXRLoader.parse: unsupported channel compression")}}return new DataView(o.buffer)}function y(e,t){let r=new Uint8Array(e),i=0;for(;0!=r[t.value+i];)i+=1;let s=new TextDecoder().decode(r.slice(t.value,t.value+i));return t.value=t.value+i+1,s}function b(e,t){let r=e.getInt32(t.value,!0);return t.value=t.value+4,r}function w(e,t){let r=e.getUint32(t.value,!0);return t.value=t.value+4,r}function S(e,t){let r=e[t.value];return t.value=t.value+1,r}function M(e,t){let r=e.getUint8(t.value);return t.value=t.value+1,r}let R=function(e,t){let r;return"getBigInt64"in DataView.prototype?r=Number(e.getBigInt64(t.value,!0)):r=e.getUint32(t.value+4,!0)+Number(e.getUint32(t.value,!0)<<32),t.value+=8,r};function C(e,t){let r=e.getFloat32(t.value,!0);return t.value+=4,r}function P(e,t){return i.A5E.toHalfFloat(C(e,t))}function D(e){let t=(31744&e)>>10,r=1023&e;return(e>>15?-1:1)*(t?31===t?r?NaN:1/0:Math.pow(2,t-15)*(1+r/1024):r/1024*6103515625e-14)}function L(e,t){let r=e.getUint16(t.value,!0);return t.value+=2,r}function O(e,t){return D(L(e,t))}function I(e,t,r,i){let s=Array(e);for(let n=0;n<e;n++){let e=1<<n,a=t/e|0;"ROUND_UP"==i&&a*e<t&&(a+=1);let o=Math.max(a,1);s[n]=(o+r-1)/r|0}return s}function k(){let e=this.offset,t={value:0};for(let r=0;r<this.tileCount;r++){let r=b(this.viewer,e),i=b(this.viewer,e);e.value+=8,this.size=w(this.viewer,e);let s=r*this.blockWidth,n=i*this.blockHeight;this.columns=s+this.blockWidth>this.width?this.width-s:this.blockWidth,this.lines=n+this.blockHeight>this.height?this.height-n:this.blockHeight;let a=this.columns*this.totalBytes,o=this.size<this.lines*a?this.uncompress(this):v(this);e.value+=this.size;for(let e=0;e<this.lines;e++){let r=e*this.columns*this.totalBytes;for(let i=0;i<this.inputChannels.length;i++){let a=H.channels[i].name,l=this.channelByteOffsets[a]*this.columns,h=this.decodeChannels[a];if(void 0===h)continue;t.value=r+l;let u=(this.height-(1+n+e))*this.outLineWidth;for(let e=0;e<this.columns;e++){let r=u+(e+s)*this.outputChannels+h;this.byteArray[r]=this.getter(o,t)}}}}}function N(){let e=this.offset,t={value:0};for(let r=0;r<this.height/this.blockHeight;r++){let i=b(this.viewer,e)-H.dataWindow.yMin;this.size=w(this.viewer,e),this.lines=i+this.blockHeight>this.height?this.height-i:this.blockHeight;let s=this.columns*this.totalBytes,n=this.size<this.lines*s?this.uncompress(this):v(this);e.value+=this.size;for(let e=0;e<this.blockHeight;e++){let i=r*this.blockHeight,a=e+this.scanOrder(i);if(a>=this.height)continue;let o=e*s,l=(this.height-1-a)*this.outLineWidth;for(let e=0;e<this.inputChannels.length;e++){let r=H.channels[e].name,i=this.channelByteOffsets[r]*this.columns,s=this.decodeChannels[r];if(void 0!==s){t.value=o+i;for(let e=0;e<this.columns;e++){let r=l+e*this.outputChannels+s;this.byteArray[r]=this.getter(n,t)}}}}}}let U={value:0},B=new DataView(e),F=new Uint8Array(e),H=function(e,t,r){let i={};if(20000630!=e.getUint32(0,!0))throw Error("THREE.EXRLoader: Provided file doesn't appear to be in OpenEXR format.");i.version=e.getUint8(4);let s=e.getUint8(5);i.spec={singleTile:!!(2&s),longName:!!(4&s),deepFormat:!!(8&s),multiPart:!!(16&s)},r.value=8;let n=!0;for(;n;){let s=y(t,r);if(0==s)n=!1;else{let n=y(t,r),a=w(e,r),o=function(e,t,r,i,s){if("string"===i||"stringvector"===i||"iccProfile"===i)return function(e,t,r){let i=new TextDecoder().decode(new Uint8Array(e).slice(t.value,t.value+r));return t.value=t.value+r,i}(t,r,s);if("chlist"===i)return function(e,t,r,i){let s=r.value,n=[];for(;r.value<s+i-1;){let i=y(t,r),s=b(e,r),a=M(e,r);r.value+=3;let o=b(e,r),l=b(e,r);n.push({name:i,pixelType:s,pLinear:a,xSampling:o,ySampling:l})}return r.value+=1,n}(e,t,r,s);if("chromaticities"===i)return function(e,t){let r=C(e,t),i=C(e,t),s=C(e,t),n=C(e,t),a=C(e,t);return{redX:r,redY:i,greenX:s,greenY:n,blueX:a,blueY:C(e,t),whiteX:C(e,t),whiteY:C(e,t)}}(e,r);if("compression"===i)return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][M(e,r)];if("box2i"===i)return function(e,t){let r=b(e,t);return{xMin:r,yMin:b(e,t),xMax:b(e,t),yMax:b(e,t)}}(e,r);if("envmap"===i)return["ENVMAP_LATLONG","ENVMAP_CUBE"][M(e,r)];if("tiledesc"===i)return function(e,t){let r=w(e,t),i=w(e,t),s=M(e,t);return{xSize:r,ySize:i,levelMode:["ONE_LEVEL","MIPMAP_LEVELS","RIPMAP_LEVELS"][15&s],roundingMode:["ROUND_DOWN","ROUND_UP"][s>>4]}}(e,r);if("lineOrder"===i)return["INCREASING_Y","DECREASING_Y","RANDOM_Y"][M(e,r)];if("float"===i)return C(e,r);if("v2f"===i)return[C(e,r),C(e,r)];if("v3f"===i){var n,a;return[C(n=e,a=r),C(n,a),C(n,a)]}return"int"===i?b(e,r):"rational"===i?[b(e,r),w(e,r)]:"timecode"===i?[w(e,r),w(e,r)]:"preview"===i?(r.value+=s,"skipped"):void(r.value+=s)}(e,t,r,n,a);void 0===o?console.warn(`THREE.EXRLoader: Skipped unknown header attribute type '${n}'.`):i[s]=o}}if((-7&s)!=0)throw console.error("THREE.EXRHeader:",i),Error("THREE.EXRLoader: Provided file is currently unsupported.");return i}(B,e,U),z=function(e,t,r,s,n){let a={size:0,viewer:t,array:r,offset:s,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,inputChannels:e.channels,channelByteOffsets:{},scanOrder:null,totalBytes:null,columns:null,lines:null,type:null,uncompress:null,getter:null,format:null,colorSpace:i.GUF};switch(e.compression){case"NO_COMPRESSION":a.blockHeight=1,a.uncompress=v;break;case"RLE_COMPRESSION":a.blockHeight=1,a.uncompress=_;break;case"ZIPS_COMPRESSION":a.blockHeight=1,a.uncompress=T;break;case"ZIP_COMPRESSION":a.blockHeight=16,a.uncompress=T;break;case"PIZ_COMPRESSION":a.blockHeight=32,a.uncompress=x;break;case"PXR24_COMPRESSION":a.blockHeight=16,a.uncompress=E;break;case"DWAA_COMPRESSION":a.blockHeight=32,a.uncompress=A;break;case"DWAB_COMPRESSION":a.blockHeight=256,a.uncompress=A;break;default:throw Error("EXRLoader.parse: "+e.compression+" is unsupported")}let o={};for(let t of e.channels)switch(t.name){case"Y":case"R":case"G":case"B":case"A":o[t.name]=!0,a.type=t.pixelType}let l=!1;if(o.R&&o.G&&o.B)l=!o.A,a.outputChannels=4,a.decodeChannels={R:0,G:1,B:2,A:3};else if(o.Y)a.outputChannels=1,a.decodeChannels={Y:0};else throw Error("EXRLoader.parse: file contains unsupported data channels.");if(1==a.type)switch(n){case i.VzW:a.getter=O;break;case i.cLu:a.getter=L}else if(2==a.type)switch(n){case i.VzW:a.getter=C;break;case i.cLu:a.getter=P}else throw Error("EXRLoader.parse: unsupported pixelType "+a.type+" for "+e.compression+".");a.columns=a.width;let h=a.width*a.height*a.outputChannels;switch(n){case i.VzW:a.byteArray=new Float32Array(h),l&&a.byteArray.fill(1,0,h);break;case i.cLu:a.byteArray=new Uint16Array(h),l&&a.byteArray.fill(15360,0,h);break;default:console.error("THREE.EXRLoader: unsupported type: ",n)}let u=0;for(let t of e.channels)void 0!==a.decodeChannels[t.name]&&(a.channelByteOffsets[t.name]=u),u+=2*t.pixelType;if(a.totalBytes=u,a.outLineWidth=a.width*a.outputChannels,"INCREASING_Y"===e.lineOrder?a.scanOrder=e=>e:a.scanOrder=e=>a.height-1-e,4==a.outputChannels?(a.format=i.wk1,a.colorSpace=i.GUF):(a.format=i.hEm,a.colorSpace=i.aCh),e.spec.singleTile){a.blockHeight=e.tiles.ySize,a.blockWidth=e.tiles.xSize;let r=function(e,t,r){let i=0;switch(e.levelMode){case"ONE_LEVEL":i=1;break;case"MIPMAP_LEVELS":i=function(e,t){let r=Math.log2(e);return"ROUND_DOWN"==t?Math.floor(r):Math.ceil(r)}(Math.max(t,r),e.roundingMode)+1;break;case"RIPMAP_LEVELS":throw Error("THREE.EXRLoader: RIPMAP_LEVELS tiles currently unsupported.")}return i}(e.tiles,a.width,a.height),i=I(r,a.width,e.tiles.xSize,e.tiles.roundingMode),n=I(r,a.height,e.tiles.ySize,e.tiles.roundingMode);a.tileCount=i[0]*n[0];for(let e=0;e<r;e++)for(let r=0;r<n[e];r++)for(let r=0;r<i[e];r++)R(t,s);a.decode=k.bind(a)}else{a.blockWidth=a.width;let e=Math.ceil(a.height/a.blockHeight);for(let r=0;r<e;r++)R(t,s);a.decode=N.bind(a)}return a}(H,B,F,U,this.type);return z.decode(),{header:H,width:z.width,height:z.height,data:z.byteArray,format:z.format,colorSpace:z.colorSpace,type:this.type}}setDataType(e){return this.type=e,this}load(e,t,r,s){return super.load(e,function(e,r){e.colorSpace=r.colorSpace,e.minFilter=i.wem,e.magFilter=i.wem,e.generateMipmaps=!1,e.flipY=!1,t&&t(e,r)},r,s)}}},91067:function(e,t,r){r.d(t,{E:function(){return n}});var i=r(88780),s=r(27834);class n extends i.aNw{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new c(e)}),this.register(function(e){return new d(e)}),this.register(function(e){return new E(e)}),this.register(function(e){return new A(e)}),this.register(function(e){return new y(e)}),this.register(function(e){return new p(e)}),this.register(function(e){return new m(e)}),this.register(function(e){return new g(e)}),this.register(function(e){return new v(e)}),this.register(function(e){return new u(e)}),this.register(function(e){return new _(e)}),this.register(function(e){return new f(e)}),this.register(function(e){return new x(e)}),this.register(function(e){return new T(e)}),this.register(function(e){return new l(e)}),this.register(function(e){return new b(e)}),this.register(function(e){return new w(e)})}load(e,t,r,s){let n;let a=this;if(""!==this.resourcePath)n=this.resourcePath;else if(""!==this.path){let t=i.Zp0.extractUrlBase(e);n=i.Zp0.resolveURL(t,this.path)}else n=i.Zp0.extractUrlBase(e);this.manager.itemStart(e);let o=function(t){s?s(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},l=new i.hH6(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(r){try{a.parse(r,n,function(r){t(r),a.manager.itemEnd(e)},o)}catch(e){o(e)}},r,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return -1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return -1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,i){let s;let n={},a={},l=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer){if(l.decode(new Uint8Array(e,0,4))===S){try{n[o.KHR_BINARY_GLTF]=new R(e)}catch(e){i&&i(e);return}s=JSON.parse(n[o.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e))}else s=e;if(void 0===s.asset||s.asset.version[0]<2){i&&i(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let u=new Z(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){let t=this.pluginCallbacks[e](u);t.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[t.name]=t,n[t.name]=!0}if(s.extensionsUsed)for(let e=0;e<s.extensionsUsed.length;++e){let t=s.extensionsUsed[e],r=s.extensionsRequired||[];switch(t){case o.KHR_MATERIALS_UNLIT:n[t]=new h;break;case o.KHR_DRACO_MESH_COMPRESSION:n[t]=new C(s,this.dracoLoader);break;case o.KHR_TEXTURE_TRANSFORM:n[t]=new P;break;case o.KHR_MESH_QUANTIZATION:n[t]=new D;break;default:r.indexOf(t)>=0&&void 0===a[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}u.setExtensions(n),u.setPlugins(a),u.parse(r,i)}parseAsync(e,t){let r=this;return new Promise(function(i,s){r.parse(e,t,i,s)})}}function a(){let e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}let o={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class l{constructor(e){this.parser=e,this.name=o.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let r=0,i=t.length;r<i;r++){let i=t[r];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(e){let t;let r=this.parser,s="light:"+e,n=r.cache.get(s);if(n)return n;let a=r.json,o=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e],l=new i.Ilk(16777215);void 0!==o.color&&l.setRGB(o.color[0],o.color[1],o.color[2],i.GUF);let h=void 0!==o.range?o.range:0;switch(o.type){case"directional":(t=new i.Ox3(l)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new i.cek(l)).distance=h;break;case"spot":(t=new i.PMe(l)).distance=h,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,t.angle=o.spot.outerConeAngle,t.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return t.position.set(0,0,0),t.decay=2,V(t,o),void 0!==o.intensity&&(t.intensity=o.intensity),t.name=r.createUniqueName(o.name||"light_"+e),n=Promise.resolve(t),r.cache.add(s,n),n}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){let t=this,r=this.parser,i=r.json.nodes[e],s=(i.extensions&&i.extensions[this.name]||{}).light;return void 0===s?null:this._loadLight(s).then(function(e){return r._getNodeRef(t.cache,s,e)})}}class h{constructor(){this.name=o.KHR_MATERIALS_UNLIT}getMaterialType(){return i.vBJ}extendParams(e,t,r){let s=[];e.color=new i.Ilk(1,1,1),e.opacity=1;let n=t.pbrMetallicRoughness;if(n){if(Array.isArray(n.baseColorFactor)){let t=n.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],i.GUF),e.opacity=t[3]}void 0!==n.baseColorTexture&&s.push(r.assignTexture(e,"map",n.baseColorTexture,i.KI_))}return Promise.all(s)}}class u{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let i=r.extensions[this.name].emissiveStrength;return void 0!==i&&(t.emissiveIntensity=i),Promise.resolve()}}class c{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let n=[],a=s.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&n.push(r.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&n.push(r.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(n.push(r.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){let e=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new i.FM8(e,e)}return Promise.all(n)}}class d{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_DISPERSION}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let i=r.extensions[this.name];return t.dispersion=void 0!==i.dispersion?i.dispersion:0,Promise.resolve()}}class f{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let s=[],n=i.extensions[this.name];return void 0!==n.iridescenceFactor&&(t.iridescence=n.iridescenceFactor),void 0!==n.iridescenceTexture&&s.push(r.assignTexture(t,"iridescenceMap",n.iridescenceTexture)),void 0!==n.iridescenceIor&&(t.iridescenceIOR=n.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==n.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=n.iridescenceThicknessMinimum),void 0!==n.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=n.iridescenceThicknessMaximum),void 0!==n.iridescenceThicknessTexture&&s.push(r.assignTexture(t,"iridescenceThicknessMap",n.iridescenceThicknessTexture)),Promise.all(s)}}class p{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_SHEEN}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let n=[];t.sheenColor=new i.Ilk(0,0,0),t.sheenRoughness=0,t.sheen=1;let a=s.extensions[this.name];if(void 0!==a.sheenColorFactor){let e=a.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],i.GUF)}return void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&n.push(r.assignTexture(t,"sheenColorMap",a.sheenColorTexture,i.KI_)),void 0!==a.sheenRoughnessTexture&&n.push(r.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(n)}}class m{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let s=[],n=i.extensions[this.name];return void 0!==n.transmissionFactor&&(t.transmission=n.transmissionFactor),void 0!==n.transmissionTexture&&s.push(r.assignTexture(t,"transmissionMap",n.transmissionTexture)),Promise.all(s)}}class g{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_VOLUME}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let n=[],a=s.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&n.push(r.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;let o=a.attenuationColor||[1,1,1];return t.attenuationColor=new i.Ilk().setRGB(o[0],o[1],o[2],i.GUF),Promise.all(n)}}class v{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_IOR}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let i=r.extensions[this.name];return t.ior=void 0!==i.ior?i.ior:1.5,Promise.resolve()}}class _{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_SPECULAR}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let n=[],a=s.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&n.push(r.assignTexture(t,"specularIntensityMap",a.specularTexture));let o=a.specularColorFactor||[1,1,1];return t.specularColor=new i.Ilk().setRGB(o[0],o[1],o[2],i.GUF),void 0!==a.specularColorTexture&&n.push(r.assignTexture(t,"specularColorMap",a.specularColorTexture,i.KI_)),Promise.all(n)}}class T{constructor(e){this.parser=e,this.name=o.EXT_MATERIALS_BUMP}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let s=[],n=i.extensions[this.name];return t.bumpScale=void 0!==n.bumpFactor?n.bumpFactor:1,void 0!==n.bumpTexture&&s.push(r.assignTexture(t,"bumpMap",n.bumpTexture)),Promise.all(s)}}class x{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let s=[],n=i.extensions[this.name];return void 0!==n.anisotropyStrength&&(t.anisotropy=n.anisotropyStrength),void 0!==n.anisotropyRotation&&(t.anisotropyRotation=n.anisotropyRotation),void 0!==n.anisotropyTexture&&s.push(r.assignTexture(t,"anisotropyMap",n.anisotropyTexture)),Promise.all(s)}}class E{constructor(e){this.parser=e,this.name=o.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,r=t.json,i=r.textures[e];if(!i.extensions||!i.extensions[this.name])return null;let s=i.extensions[this.name],n=t.options.ktx2Loader;if(!n){if(!(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures")}return t.loadTextureImage(e,s.source,n)}}class A{constructor(e){this.parser=e,this.name=o.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;let n=s.extensions[t],a=i.images[n.source],o=r.textureLoader;if(a.uri){let e=r.options.manager.getHandler(a.uri);null!==e&&(o=e)}return this.detectSupport().then(function(s){if(s)return r.loadTextureImage(e,n.source,o);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class y{constructor(e){this.parser=e,this.name=o.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){let t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;let n=s.extensions[t],a=i.images[n.source],o=r.textureLoader;if(a.uri){let e=r.options.manager.getHandler(a.uri);null!==e&&(o=e)}return this.detectSupport().then(function(s){if(s)return r.loadTextureImage(e,n.source,o);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class b{constructor(e){this.name=o.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,r=t.bufferViews[e];if(!r.extensions||!r.extensions[this.name])return null;{let e=r.extensions[this.name],i=this.parser.getDependency("buffer",e.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(!(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files")}return i.then(function(t){let r=e.byteOffset||0,i=e.byteLength||0,n=e.count,a=e.byteStride,o=new Uint8Array(t,r,i);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(n,a,o,e.mode,e.filter).then(function(e){return e.buffer}):s.ready.then(function(){let t=new ArrayBuffer(n*a);return s.decodeGltfBuffer(new Uint8Array(t),n,a,o,e.mode,e.filter),t})})}}}class w{constructor(e){this.name=o.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){let t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||void 0===r.mesh)return null;for(let e of t.meshes[r.mesh].primitives)if(e.mode!==k.TRIANGLES&&e.mode!==k.TRIANGLE_STRIP&&e.mode!==k.TRIANGLE_FAN&&void 0!==e.mode)return null;let s=r.extensions[this.name].attributes,n=[],a={};for(let e in s)n.push(this.parser.getDependency("accessor",s[e]).then(t=>(a[e]=t,a[e])));return n.length<1?null:(n.push(this.parser.createNodeMesh(e)),Promise.all(n).then(e=>{let t=e.pop(),r=t.isGroup?t.children:[t],s=e[0].count,n=[];for(let e of r){let t=new i.yGw,r=new i.Pa4,o=new i._fP,l=new i.Pa4(1,1,1),h=new i.SPe(e.geometry,e.material,s);for(let e=0;e<s;e++)a.TRANSLATION&&r.fromBufferAttribute(a.TRANSLATION,e),a.ROTATION&&o.fromBufferAttribute(a.ROTATION,e),a.SCALE&&l.fromBufferAttribute(a.SCALE,e),h.setMatrixAt(e,t.compose(r,o,l));for(let t in a)if("_COLOR_0"===t){let e=a[t];h.instanceColor=new i.lb7(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==t&&"ROTATION"!==t&&"SCALE"!==t&&e.geometry.setAttribute(t,a[t]);i.Tme.prototype.copy.call(h,e),this.parser.assignFinalMaterial(h),n.push(h)}return t.isGroup?(t.clear(),t.add(...n),t):n[0]}))}}let S="glTF",M={JSON:1313821514,BIN:5130562};class R{constructor(e){this.name=o.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,12),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==S)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw Error("THREE.GLTFLoader: Legacy binary file detected.");let i=this.header.length-12,s=new DataView(e,12),n=0;for(;n<i;){let t=s.getUint32(n,!0);n+=4;let i=s.getUint32(n,!0);if(n+=4,i===M.JSON){let i=new Uint8Array(e,12+n,t);this.content=r.decode(i)}else if(i===M.BIN){let r=12+n;this.body=e.slice(r,r+t)}n+=t}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.")}}class C{constructor(e,t){if(!t)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=o.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let r=this.json,s=this.dracoLoader,n=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},l={},h={};for(let e in a)o[H[e]||e.toLowerCase()]=a[e];for(let t in e.attributes){let i=H[t]||t.toLowerCase();if(void 0!==a[t]){let s=r.accessors[e.attributes[t]],n=N[s.componentType];h[i]=n.name,l[i]=!0===s.normalized}}return t.getDependency("bufferView",n).then(function(e){return new Promise(function(t,r){s.decodeDracoFile(e,function(e){for(let t in e.attributes){let r=e.attributes[t],i=l[t];void 0!==i&&(r.normalized=i)}t(e)},o,h,i.GUF,r)})})}}class P{constructor(){this.name=o.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class D{constructor(){this.name=o.KHR_MESH_QUANTIZATION}}class L extends i._C8{constructor(e,t,r,i){super(e,t,r,i)}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i*3+i;for(let e=0;e!==i;e++)t[e]=r[s+e];return t}interpolate_(e,t,r,i){let s=this.resultBuffer,n=this.sampleValues,a=this.valueSize,o=2*a,l=3*a,h=i-t,u=(r-t)/h,c=u*u,d=c*u,f=e*l,p=f-l,m=-2*d+3*c,g=d-c,v=1-m,_=g-c+u;for(let e=0;e!==a;e++){let t=n[p+e+a],r=n[p+e+o]*h,i=n[f+e+a],l=n[f+e]*h;s[e]=v*t+_*r+m*i+g*l}return s}}let O=new i._fP;class I extends L{interpolate_(e,t,r,i){let s=super.interpolate_(e,t,r,i);return O.fromArray(s).normalize().toArray(s),s}}let k={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},N={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},U={9728:i.TyD,9729:i.wem,9984:i.YLQ,9985:i.qyh,9986:i.aH4,9987:i.D1R},B={33071:i.uWy,33648:i.OoA,10497:i.rpg},F={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},H={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},z={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},G={CUBICSPLINE:void 0,LINEAR:i.NMF,STEP:i.Syv},j={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function K(e,t,r){for(let i in r.extensions)void 0===e[i]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[i]=r.extensions[i])}function V(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function X(e){let t="",r=Object.keys(e).sort();for(let i=0,s=r.length;i<s;i++)t+=r[i]+":"+e[r[i]]+";";return t}function Y(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}let W=new i.yGw;class Z{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new a,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,s=-1,n=!1,o=-1;if("undefined"!=typeof navigator){let e=navigator.userAgent;r=!0===/^((?!chrome|android).)*safari/i.test(e);let t=e.match(/Version\/(\d+)/);s=r&&t?parseInt(t[1],10):-1,o=(n=e.indexOf("Firefox")>-1)?e.match(/Firefox\/([0-9]+)\./)[1]:-1}"undefined"==typeof createImageBitmap||r&&s<17||n&&o<98?this.textureLoader=new i.dpR(this.options.manager):this.textureLoader=new i.QRU(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new i.hH6(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let r=this,i=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(t){let n={scene:t[0][i.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:i.asset,parser:r,userData:{}};return K(s,n,i),V(n,i),Promise.all(r._invokeAll(function(e){return e.afterRoot&&e.afterRoot(n)})).then(function(){for(let e of n.scenes)e.updateMatrixWorld();e(n)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let r=0,i=t.length;r<i;r++){let i=t[r].joints;for(let t=0,r=i.length;t<r;t++)e[i[t]].isBone=!0}for(let t=0,i=e.length;t<i;t++){let i=e[t];void 0!==i.mesh&&(this._addNodeRef(this.meshCache,i.mesh),void 0!==i.skin&&(r[i.mesh].isSkinnedMesh=!0)),void 0!==i.camera&&this._addNodeRef(this.cameraCache,i.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;let i=r.clone(),s=(e,t)=>{let r=this.associations.get(e);for(let[i,n]of(null!=r&&this.associations.set(t,r),e.children.entries()))s(n,t.children[i])};return s(r,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){let i=e(t[r]);if(i)return i}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let r=[];for(let i=0;i<t.length;i++){let s=e(t[i]);s&&r.push(s)}return r}getDependency(e,t){let r=e+":"+t,i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(e){return e.loadNode&&e.loadNode(t)});break;case"mesh":i=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(!(i=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)})))throw Error("Unknown type: "+e)}this.cache.add(r,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){let r=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(t,i){return r.getDependency(e,i)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[o.KHR_BINARY_GLTF].body);let s=this.options;return new Promise(function(e,n){r.load(i.Zp0.resolveURL(t.uri,s.path),e,void 0,function(){n(Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){let r=t.byteLength||0,i=t.byteOffset||0;return e.slice(i,i+r)})}loadAccessor(e){let t=this,r=this.json,s=this.json.accessors[e];if(void 0===s.bufferView&&void 0===s.sparse){let e=F[s.type],t=N[s.componentType],r=!0===s.normalized,n=new t(s.count*e);return Promise.resolve(new i.TlE(n,e,r))}let n=[];return void 0!==s.bufferView?n.push(this.getDependency("bufferView",s.bufferView)):n.push(null),void 0!==s.sparse&&(n.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),n.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(n).then(function(e){let n,a;let o=e[0],l=F[s.type],h=N[s.componentType],u=h.BYTES_PER_ELEMENT,c=u*l,d=s.byteOffset||0,f=void 0!==s.bufferView?r.bufferViews[s.bufferView].byteStride:void 0,p=!0===s.normalized;if(f&&f!==c){let e=Math.floor(d/f),r="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+e+":"+s.count,c=t.cache.get(r);c||(n=new h(o,e*f,s.count*f/u),c=new i.vpT(n,f/u),t.cache.add(r,c)),a=new i.kB5(c,l,d%f/u,p)}else n=null===o?new h(s.count*l):new h(o,d,s.count*l),a=new i.TlE(n,l,p);if(void 0!==s.sparse){let t=F.SCALAR,r=N[s.sparse.indices.componentType],n=s.sparse.indices.byteOffset||0,u=s.sparse.values.byteOffset||0,c=new r(e[1],n,s.sparse.count*t),d=new h(e[2],u,s.sparse.count*l);null!==o&&(a=new i.TlE(a.array.slice(),a.itemSize,a.normalized)),a.normalized=!1;for(let e=0,t=c.length;e<t;e++){let t=c[e];if(a.setX(t,d[e*l]),l>=2&&a.setY(t,d[e*l+1]),l>=3&&a.setZ(t,d[e*l+2]),l>=4&&a.setW(t,d[e*l+3]),l>=5)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}a.normalized=p}return a})}loadTexture(e){let t=this.json,r=this.options,i=t.textures[e].source,s=t.images[i],n=this.textureLoader;if(s.uri){let e=r.manager.getHandler(s.uri);null!==e&&(n=e)}return this.loadTextureImage(e,i,n)}loadTextureImage(e,t,r){let s=this,n=this.json,a=n.textures[e],o=n.images[t],l=(o.uri||o.bufferView)+":"+a.sampler;if(this.textureCache[l])return this.textureCache[l];let h=this.loadImageSource(t,r).then(function(t){t.flipY=!1,t.name=a.name||o.name||"",""===t.name&&"string"==typeof o.uri&&!1===o.uri.startsWith("data:image/")&&(t.name=o.uri);let r=(n.samplers||{})[a.sampler]||{};return t.magFilter=U[r.magFilter]||i.wem,t.minFilter=U[r.minFilter]||i.D1R,t.wrapS=B[r.wrapS]||i.rpg,t.wrapT=B[r.wrapT]||i.rpg,t.generateMipmaps=!t.isCompressedTexture&&t.minFilter!==i.TyD&&t.minFilter!==i.wem,s.associations.set(t,{textures:e}),t}).catch(function(){return null});return this.textureCache[l]=h,h}loadImageSource(e,t){let r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());let n=r.images[e],a=self.URL||self.webkitURL,o=n.uri||"",l=!1;if(void 0!==n.bufferView)o=this.getDependency("bufferView",n.bufferView).then(function(e){l=!0;let t=new Blob([e],{type:n.mimeType});return o=a.createObjectURL(t)});else if(void 0===n.uri)throw Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let h=Promise.resolve(o).then(function(e){return new Promise(function(r,n){let a=r;!0===t.isImageBitmapLoader&&(a=function(e){let t=new i.xEZ(e);t.needsUpdate=!0,r(t)}),t.load(i.Zp0.resolveURL(e,s.path),a,void 0,n)})}).then(function(e){var t;return!0===l&&a.revokeObjectURL(o),V(e,n),e.userData.mimeType=n.mimeType||((t=n.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":t.search(/\.ktx2($|\?)/i)>0||0===t.search(/^data\:image\/ktx2/)?"image/ktx2":"image/png"),e}).catch(function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),e});return this.sourceCache[e]=h,h}assignTexture(e,t,r,i){let s=this;return this.getDependency("texture",r.index).then(function(n){if(!n)return null;if(void 0!==r.texCoord&&r.texCoord>0&&((n=n.clone()).channel=r.texCoord),s.extensions[o.KHR_TEXTURE_TRANSFORM]){let e=void 0!==r.extensions?r.extensions[o.KHR_TEXTURE_TRANSFORM]:void 0;if(e){let t=s.associations.get(n);n=s.extensions[o.KHR_TEXTURE_TRANSFORM].extendTexture(n,e),s.associations.set(n,t)}}return void 0!==i&&(n.colorSpace=i),e[t]=n,n})}assignFinalMaterial(e){let t=e.geometry,r=e.material,s=void 0===t.attributes.tangent,n=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){let e="PointsMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new i.UY4,i.F5T.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,t.sizeAttenuation=!1,this.cache.add(e,t)),r=t}else if(e.isLine){let e="LineBasicMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new i.nls,i.F5T.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,this.cache.add(e,t)),r=t}if(s||n||a){let e="ClonedMaterial:"+r.uuid+":";s&&(e+="derivative-tangents:"),n&&(e+="vertex-colors:"),a&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=r.clone(),n&&(t.vertexColors=!0),a&&(t.flatShading=!0),s&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(r))),r=t}e.material=r}getMaterialType(){return i.Wid}loadMaterial(e){let t;let r=this,s=this.json,n=this.extensions,a=s.materials[e],l={},h=a.extensions||{},u=[];if(h[o.KHR_MATERIALS_UNLIT]){let e=n[o.KHR_MATERIALS_UNLIT];t=e.getMaterialType(),u.push(e.extendParams(l,a,r))}else{let s=a.pbrMetallicRoughness||{};if(l.color=new i.Ilk(1,1,1),l.opacity=1,Array.isArray(s.baseColorFactor)){let e=s.baseColorFactor;l.color.setRGB(e[0],e[1],e[2],i.GUF),l.opacity=e[3]}void 0!==s.baseColorTexture&&u.push(r.assignTexture(l,"map",s.baseColorTexture,i.KI_)),l.metalness=void 0!==s.metallicFactor?s.metallicFactor:1,l.roughness=void 0!==s.roughnessFactor?s.roughnessFactor:1,void 0!==s.metallicRoughnessTexture&&(u.push(r.assignTexture(l,"metalnessMap",s.metallicRoughnessTexture)),u.push(r.assignTexture(l,"roughnessMap",s.metallicRoughnessTexture))),t=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,l)})))}!0===a.doubleSided&&(l.side=i.ehD);let c=a.alphaMode||j.OPAQUE;if(c===j.BLEND?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,c===j.MASK&&(l.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&t!==i.vBJ&&(u.push(r.assignTexture(l,"normalMap",a.normalTexture)),l.normalScale=new i.FM8(1,1),void 0!==a.normalTexture.scale)){let e=a.normalTexture.scale;l.normalScale.set(e,e)}if(void 0!==a.occlusionTexture&&t!==i.vBJ&&(u.push(r.assignTexture(l,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(l.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&t!==i.vBJ){let e=a.emissiveFactor;l.emissive=new i.Ilk().setRGB(e[0],e[1],e[2],i.GUF)}return void 0!==a.emissiveTexture&&t!==i.vBJ&&u.push(r.assignTexture(l,"emissiveMap",a.emissiveTexture,i.KI_)),Promise.all(u).then(function(){let i=new t(l);return a.name&&(i.name=a.name),V(i,a),r.associations.set(i,{materials:e}),a.extensions&&K(n,i,a),i})}createUniqueName(e){let t=i.iUV.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,r=this.extensions,s=this.primitiveCache,n=[];for(let a=0,l=e.length;a<l;a++){let l=e[a],h=function(e){let t;let r=e.extensions&&e.extensions[o.KHR_DRACO_MESH_COMPRESSION];if(t=r?"draco:"+r.bufferView+":"+r.indices+":"+X(r.attributes):e.indices+":"+X(e.attributes)+":"+e.mode,void 0!==e.targets)for(let r=0,i=e.targets.length;r<i;r++)t+=":"+X(e.targets[r]);return t}(l),u=s[h];if(u)n.push(u.promise);else{let e;e=l.extensions&&l.extensions[o.KHR_DRACO_MESH_COMPRESSION]?function(e){return r[o.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(r){return Q(r,e,t)})}(l):Q(new i.u9r,l,t),s[h]={primitive:l,promise:e},n.push(e)}}return Promise.all(n)}loadMesh(e){let t=this,r=this.json,n=this.extensions,a=r.meshes[e],o=a.primitives,l=[];for(let e=0,t=o.length;e<t;e++){var h;let t=void 0===o[e].material?(void 0===(h=this.cache).DefaultMaterial&&(h.DefaultMaterial=new i.Wid({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:i.Wl3})),h.DefaultMaterial):this.getDependency("material",o[e].material);l.push(t)}return l.push(t.loadGeometries(o)),Promise.all(l).then(function(r){let l=r.slice(0,r.length-1),h=r[r.length-1],u=[];for(let r=0,c=h.length;r<c;r++){let c;let d=h[r],f=o[r],p=l[r];if(f.mode===k.TRIANGLES||f.mode===k.TRIANGLE_STRIP||f.mode===k.TRIANGLE_FAN||void 0===f.mode)!0===(c=!0===a.isSkinnedMesh?new i.TUv(d,p):new i.Kj0(d,p)).isSkinnedMesh&&c.normalizeSkinWeights(),f.mode===k.TRIANGLE_STRIP?c.geometry=(0,s.Vs)(c.geometry,i.UlW):f.mode===k.TRIANGLE_FAN&&(c.geometry=(0,s.Vs)(c.geometry,i.z$h));else if(f.mode===k.LINES)c=new i.ejS(d,p);else if(f.mode===k.LINE_STRIP)c=new i.x12(d,p);else if(f.mode===k.LINE_LOOP)c=new i.blk(d,p);else if(f.mode===k.POINTS)c=new i.woe(d,p);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+f.mode);Object.keys(c.geometry.morphAttributes).length>0&&function(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let r=0,i=t.weights.length;r<i;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){let r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(let t=0,i=r.length;t<i;t++)e.morphTargetDictionary[r[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}(c,a),c.name=t.createUniqueName(a.name||"mesh_"+e),V(c,a),f.extensions&&K(n,c,f),t.assignFinalMaterial(c),u.push(c)}for(let r=0,i=u.length;r<i;r++)t.associations.set(u[r],{meshes:e,primitives:r});if(1===u.length)return a.extensions&&K(n,u[0],a),u[0];let c=new i.ZAu;a.extensions&&K(n,c,a),t.associations.set(c,{meshes:e});for(let e=0,t=u.length;e<t;e++)c.add(u[e]);return c})}loadCamera(e){let t;let r=this.json.cameras[e],s=r[r.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return"perspective"===r.type?t=new i.cPb(i.M8C.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):"orthographic"===r.type&&(t=new i.iKG(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),V(t,r),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],r=[];for(let e=0,i=t.joints.length;e<i;e++)r.push(this._loadNodeShallow(t.joints[e]));return void 0!==t.inverseBindMatrices?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(e){let r=e.pop(),s=[],n=[];for(let a=0,o=e.length;a<o;a++){let o=e[a];if(o){s.push(o);let e=new i.yGw;null!==r&&e.fromArray(r.array,16*a),n.push(e)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[a])}return new i.OdW(s,n)})}loadAnimation(e){let t=this.json,r=this,s=t.animations[e],n=s.name?s.name:"animation_"+e,a=[],o=[],l=[],h=[],u=[];for(let e=0,t=s.channels.length;e<t;e++){let t=s.channels[e],r=s.samplers[t.sampler],i=t.target,n=i.node,c=void 0!==s.parameters?s.parameters[r.input]:r.input,d=void 0!==s.parameters?s.parameters[r.output]:r.output;void 0!==i.node&&(a.push(this.getDependency("node",n)),o.push(this.getDependency("accessor",c)),l.push(this.getDependency("accessor",d)),h.push(r),u.push(i))}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(l),Promise.all(h),Promise.all(u)]).then(function(e){let t=e[0],s=e[1],a=e[2],o=e[3],l=e[4],h=[];for(let e=0,i=t.length;e<i;e++){let i=t[e],n=s[e],u=a[e],c=o[e],d=l[e];if(void 0===i)continue;i.updateMatrix&&i.updateMatrix();let f=r._createAnimationTracks(i,n,u,c,d);if(f)for(let e=0;e<f.length;e++)h.push(f[e])}return new i.m7l(n,void 0,h)})}createNodeMesh(e){let t=this.json,r=this,i=t.nodes[e];return void 0===i.mesh?null:r.getDependency("mesh",i.mesh).then(function(e){let t=r._getNodeRef(r.meshCache,i.mesh,e);return void 0!==i.weights&&t.traverse(function(e){if(e.isMesh)for(let t=0,r=i.weights.length;t<r;t++)e.morphTargetInfluences[t]=i.weights[t]}),t})}loadNode(e){let t=this.json.nodes[e],r=this._loadNodeShallow(e),i=[],s=t.children||[];for(let e=0,t=s.length;e<t;e++)i.push(this.getDependency("node",s[e]));let n=void 0===t.skin?Promise.resolve(null):this.getDependency("skin",t.skin);return Promise.all([r,Promise.all(i),n]).then(function(e){let t=e[0],r=e[1],i=e[2];null!==i&&t.traverse(function(e){e.isSkinnedMesh&&e.bind(i,W)});for(let e=0,i=r.length;e<i;e++)t.add(r[e]);return t})}_loadNodeShallow(e){let t=this.json,r=this.extensions,s=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];let n=t.nodes[e],a=n.name?s.createUniqueName(n.name):"",o=[],l=s._invokeOne(function(t){return t.createNodeMesh&&t.createNodeMesh(e)});return l&&o.push(l),void 0!==n.camera&&o.push(s.getDependency("camera",n.camera).then(function(e){return s._getNodeRef(s.cameraCache,n.camera,e)})),s._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)}).forEach(function(e){o.push(e)}),this.nodeCache[e]=Promise.all(o).then(function(t){let o;if((o=!0===n.isBone?new i.N$j:t.length>1?new i.ZAu:1===t.length?t[0]:new i.Tme)!==t[0])for(let e=0,r=t.length;e<r;e++)o.add(t[e]);if(n.name&&(o.userData.name=n.name,o.name=a),V(o,n),n.extensions&&K(r,o,n),void 0!==n.matrix){let e=new i.yGw;e.fromArray(n.matrix),o.applyMatrix4(e)}else void 0!==n.translation&&o.position.fromArray(n.translation),void 0!==n.rotation&&o.quaternion.fromArray(n.rotation),void 0!==n.scale&&o.scale.fromArray(n.scale);return s.associations.has(o)||s.associations.set(o,{}),s.associations.get(o).nodes=e,o}),this.nodeCache[e]}loadScene(e){let t=this.extensions,r=this.json.scenes[e],s=this,n=new i.ZAu;r.name&&(n.name=s.createUniqueName(r.name)),V(n,r),r.extensions&&K(t,n,r);let a=r.nodes||[],o=[];for(let e=0,t=a.length;e<t;e++)o.push(s.getDependency("node",a[e]));return Promise.all(o).then(function(e){for(let t=0,r=e.length;t<r;t++)n.add(e[t]);return s.associations=(e=>{let t=new Map;for(let[e,r]of s.associations)(e instanceof i.F5T||e instanceof i.xEZ)&&t.set(e,r);return e.traverse(e=>{let r=s.associations.get(e);null!=r&&t.set(e,r)}),t})(n),n})}_createAnimationTracks(e,t,r,s,n){let a;let o=[],l=e.name?e.name:e.uuid,h=[];switch(z[n.path]===z.weights?e.traverse(function(e){e.morphTargetInfluences&&h.push(e.name?e.name:e.uuid)}):h.push(l),z[n.path]){case z.weights:a=i.dUE;break;case z.rotation:a=i.iLg;break;case z.position:case z.scale:a=i.yC1;break;default:a=1===r.itemSize?i.dUE:i.yC1}let u=void 0!==s.interpolation?G[s.interpolation]:i.NMF,c=this._getArrayFromAccessor(r);for(let e=0,r=h.length;e<r;e++){let r=new a(h[e]+"."+z[n.path],t.array,c,u);"CUBICSPLINE"===s.interpolation&&this._createCubicSplineTrackInterpolant(r),o.push(r)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let e=Y(t.constructor),r=new Float32Array(t.length);for(let i=0,s=t.length;i<s;i++)r[i]=t[i]*e;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof i.iLg?I:L)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Q(e,t,r){let s=t.attributes,n=[];for(let t in s){let i=H[t]||t.toLowerCase();i in e.attributes||n.push(function(t,i){return r.getDependency("accessor",t).then(function(t){e.setAttribute(i,t)})}(s[t],i))}if(void 0!==t.indices&&!e.index){let i=r.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});n.push(i)}return i.epp.workingColorSpace!==i.GUF&&"COLOR_0"in s&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${i.epp.workingColorSpace}" not supported.`),V(e,t),!function(e,t,r){let s=t.attributes,n=new i.ZzF;if(void 0===s.POSITION)return;{let e=r.json.accessors[s.POSITION],t=e.min,a=e.max;if(void 0!==t&&void 0!==a){if(n.set(new i.Pa4(t[0],t[1],t[2]),new i.Pa4(a[0],a[1],a[2])),e.normalized){let t=Y(N[e.componentType]);n.min.multiplyScalar(t),n.max.multiplyScalar(t)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}let a=t.targets;if(void 0!==a){let e=new i.Pa4,t=new i.Pa4;for(let i=0,s=a.length;i<s;i++){let s=a[i];if(void 0!==s.POSITION){let i=r.json.accessors[s.POSITION],n=i.min,a=i.max;if(void 0!==n&&void 0!==a){if(t.setX(Math.max(Math.abs(n[0]),Math.abs(a[0]))),t.setY(Math.max(Math.abs(n[1]),Math.abs(a[1]))),t.setZ(Math.max(Math.abs(n[2]),Math.abs(a[2]))),i.normalized){let e=Y(N[i.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(e)}e.boundingBox=n;let o=new i.aLr;n.getCenter(o.center),o.radius=n.min.distanceTo(n.max)/2,e.boundingSphere=o}(e,t,r),Promise.all(n).then(function(){return void 0!==t.targets?function(e,t,r){let i=!1,s=!1,n=!1;for(let e=0,r=t.length;e<r;e++){let r=t[e];if(void 0!==r.POSITION&&(i=!0),void 0!==r.NORMAL&&(s=!0),void 0!==r.COLOR_0&&(n=!0),i&&s&&n)break}if(!i&&!s&&!n)return Promise.resolve(e);let a=[],o=[],l=[];for(let h=0,u=t.length;h<u;h++){let u=t[h];if(i){let t=void 0!==u.POSITION?r.getDependency("accessor",u.POSITION):e.attributes.position;a.push(t)}if(s){let t=void 0!==u.NORMAL?r.getDependency("accessor",u.NORMAL):e.attributes.normal;o.push(t)}if(n){let t=void 0!==u.COLOR_0?r.getDependency("accessor",u.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(l)]).then(function(t){let r=t[0],a=t[1],o=t[2];return i&&(e.morphAttributes.position=r),s&&(e.morphAttributes.normal=a),n&&(e.morphAttributes.color=o),e.morphTargetsRelative=!0,e})}(e,t.targets,r):e})}},47133:function(e,t,r){r.d(t,{x:function(){return s}});var i=r(88780);class s extends i.yxD{constructor(e){super(e),this.type=i.cLu}parse(e){let t,r,s;let n=function(e,t){switch(e){case 1:throw Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw Error("THREE.RGBELoader: Memory Error: "+(t||""))}},a=function(e,t,r){t=t||1024;let i=e.pos,s=-1,n=0,a="",o=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));for(;0>(s=o.indexOf("\n"))&&n<t&&i<e.byteLength;)a+=o,n+=o.length,i+=128,o+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));return -1<s&&(!1!==r&&(e.pos+=n+s+1),a+o.slice(0,s))},o=new Uint8Array(e);o.pos=0;let l=function(e){let t,r;let i=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,h={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};for(!(e.pos>=e.byteLength)&&(t=a(e))||n(1,"no header found"),(r=t.match(/^#\?(\S+)/))||n(3,"bad initial token"),h.valid|=1,h.programtype=r[1],h.string+=t+"\n";!1!==(t=a(e));){if(h.string+=t+"\n","#"===t.charAt(0)){h.comments+=t+"\n";continue}if((r=t.match(i))&&(h.gamma=parseFloat(r[1])),(r=t.match(s))&&(h.exposure=parseFloat(r[1])),(r=t.match(o))&&(h.valid|=2,h.format=r[1]),(r=t.match(l))&&(h.valid|=4,h.height=parseInt(r[1],10),h.width=parseInt(r[2],10)),2&h.valid&&4&h.valid)break}return 2&h.valid||n(3,"missing format specifier"),4&h.valid||n(3,"missing image size specifier"),h}(o),h=l.width,u=l.height,c=function(e,t,r){if(t<8||t>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);t!==(e[2]<<8|e[3])&&n(3,"wrong scanline width");let i=new Uint8Array(4*t*r);i.length||n(4,"unable to allocate buffer space");let s=0,a=0,o=4*t,l=new Uint8Array(4),h=new Uint8Array(o),u=r;for(;u>0&&a<e.byteLength;){a+4>e.byteLength&&n(1),l[0]=e[a++],l[1]=e[a++],l[2]=e[a++],l[3]=e[a++],(2!=l[0]||2!=l[1]||(l[2]<<8|l[3])!=t)&&n(3,"bad rgbe scanline format");let r=0,c;for(;r<o&&a<e.byteLength;){let t=(c=e[a++])>128;if(t&&(c-=128),(0===c||r+c>o)&&n(3,"bad scanline data"),t){let t=e[a++];for(let e=0;e<c;e++)h[r++]=t}else h.set(e.subarray(a,a+c),r),r+=c,a+=c}for(let e=0;e<t;e++){let r=0;i[s]=h[e+r],r+=t,i[s+1]=h[e+r],r+=t,i[s+2]=h[e+r],r+=t,i[s+3]=h[e+r],s+=4}u--}return i}(o.subarray(o.pos),h,u);switch(this.type){case i.VzW:let d=new Float32Array(4*(s=c.length/4));for(let e=0;e<s;e++)!function(e,t,r,i){let s=Math.pow(2,e[t+3]-128)/255;r[i+0]=e[t+0]*s,r[i+1]=e[t+1]*s,r[i+2]=e[t+2]*s,r[i+3]=1}(c,4*e,d,4*e);t=d,r=i.VzW;break;case i.cLu:let f=new Uint16Array(4*(s=c.length/4));for(let e=0;e<s;e++)!function(e,t,r,s){let n=Math.pow(2,e[t+3]-128)/255;r[s+0]=i.A5E.toHalfFloat(Math.min(e[t+0]*n,65504)),r[s+1]=i.A5E.toHalfFloat(Math.min(e[t+1]*n,65504)),r[s+2]=i.A5E.toHalfFloat(Math.min(e[t+2]*n,65504)),r[s+3]=i.A5E.toHalfFloat(1)}(c,4*e,f,4*e);t=f,r=i.cLu;break;default:throw Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:h,height:u,data:t,header:l.string,gamma:l.gamma,exposure:l.exposure,type:r}}setDataType(e){return this.type=e,this}load(e,t,r,s){return super.load(e,function(e,r){switch(e.type){case i.VzW:case i.cLu:e.colorSpace=i.GUF,e.minFilter=i.wem,e.magFilter=i.wem,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,r)},r,s)}}},52241:function(e,t,r){r.d(t,{x:function(){return h}});var i=r(88780),s=r(19297),n=r(5461),a=r(14778);class o extends a.w{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,r){let i,s;let n=e.getContext(),a=e.state;a.buffers.color.setMask(!1),a.buffers.depth.setMask(!1),a.buffers.color.setLocked(!0),a.buffers.depth.setLocked(!0),this.inverse?(i=0,s=1):(i=1,s=0),a.buffers.stencil.setTest(!0),a.buffers.stencil.setOp(n.REPLACE,n.REPLACE,n.REPLACE),a.buffers.stencil.setFunc(n.ALWAYS,i,4294967295),a.buffers.stencil.setClear(s),a.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),a.buffers.color.setLocked(!1),a.buffers.depth.setLocked(!1),a.buffers.color.setMask(!0),a.buffers.depth.setMask(!0),a.buffers.stencil.setLocked(!1),a.buffers.stencil.setFunc(n.EQUAL,1,4294967295),a.buffers.stencil.setOp(n.KEEP,n.KEEP,n.KEEP),a.buffers.stencil.setLocked(!0)}}class l extends a.w{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class h{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),void 0===t){let r=e.getSize(new i.FM8);this._width=r.width,this._height=r.height,(t=new i.dd2(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:i.cLu})).texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new n.T(s.C),this.copyPass.material.blending=i.jFi,this.clock=new i.SUY}swapBuffers(){let e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){let t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());let t=this.renderer.getRenderTarget(),r=!1;for(let t=0,i=this.passes.length;t<i;t++){let i=this.passes[t];if(!1!==i.enabled){if(i.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(t),i.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),i.needsSwap){if(r){let t=this.renderer.getContext(),r=this.renderer.state.buffers.stencil;r.setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),r.setFunc(t.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==o&&(i instanceof o?r=!0:i instanceof l&&(r=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){let t=this.renderer.getSize(new i.FM8);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;let r=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget1.setSize(r,i),this.renderTarget2.setSize(r,i);for(let e=0;e<this.passes.length;e++)this.passes[e].setSize(r,i)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}},63310:function(e,t,r){r.d(t,{f:function(){return a}});var i=r(88780),s=r(14778),n=r(19297);class a extends s.w{constructor(e,t,r,a){super(),this.renderScene=t,this.renderCamera=r,this.selectedObjects=void 0!==a?a:[],this.visibleEdgeColor=new i.Ilk(1,1,1),this.hiddenEdgeColor=new i.Ilk(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this._selectionCache=new Set,this.resolution=void 0!==e?new i.FM8(e.x,e.y):new i.FM8(256,256);let o=Math.round(this.resolution.x/this.downSampleRatio),l=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new i.dd2(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new i.lRF,this.depthMaterial.side=i.ehD,this.depthMaterial.depthPacking=i.mSO,this.depthMaterial.blending=i.jFi,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=i.ehD,this.prepareMaskMaterial.fragmentShader=function(e,t){let r=t.isPerspectiveCamera?"perspective":"orthographic";return e.replace(/DEPTH_TO_VIEW_Z/g,r+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new i.dd2(this.resolution.x,this.resolution.y,{type:i.cLu}),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new i.dd2(o,l,{type:i.cLu}),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new i.dd2(o,l,{type:i.cLu}),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new i.dd2(Math.round(o/2),Math.round(l/2),{type:i.cLu}),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new i.dd2(o,l,{type:i.cLu}),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new i.dd2(Math.round(o/2),Math.round(l/2),{type:i.cLu}),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1,this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value.set(o,l),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(o/2),Math.round(l/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial();let h=n.C;this.copyUniforms=i.rDY.clone(h.uniforms),this.materialCopy=new i.jyz({uniforms:this.copyUniforms,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,blending:i.jFi,depthTest:!1,depthWrite:!1}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new i.Ilk,this.oldClearAlpha=1,this.fsQuad=new s.T(null),this.tempPulseColor1=new i.Ilk,this.tempPulseColor2=new i.Ilk,this.textureMatrix=new i.yGw}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose(),this.depthMaterial.dispose(),this.prepareMaskMaterial.dispose(),this.edgeDetectionMaterial.dispose(),this.separableBlurMaterial1.dispose(),this.separableBlurMaterial2.dispose(),this.overlayMaterial.dispose(),this.materialCopy.dispose(),this.fsQuad.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let r=Math.round(e/this.downSampleRatio),i=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(r,i),this.renderTargetBlurBuffer1.setSize(r,i),this.renderTargetEdgeBuffer1.setSize(r,i),this.separableBlurMaterial1.uniforms.texSize.value.set(r,i),r=Math.round(r/2),i=Math.round(i/2),this.renderTargetBlurBuffer2.setSize(r,i),this.renderTargetEdgeBuffer2.setSize(r,i),this.separableBlurMaterial2.uniforms.texSize.value.set(r,i)}updateSelectionCache(){let e=this._selectionCache;function t(t){t.isMesh&&e.add(t)}e.clear();for(let e=0;e<this.selectedObjects.length;e++)this.selectedObjects[e].traverse(t)}changeVisibilityOfSelectedObjects(e){let t=this._visibilityCache;for(let r of this._selectionCache)!0===e?r.visible=t.get(r):(t.set(r,r.visible),r.visible=e)}changeVisibilityOfNonSelectedObjects(e){let t=this._visibilityCache,r=this._selectionCache;this.renderScene.traverse(function(i){if(i.isMesh||i.isSprite){if(!r.has(i)){let r=i.visible;(!1===e||!0===t.get(i))&&(i.visible=e),t.set(i,r)}}else(i.isPoints||i.isLine)&&(!0===e?i.visible=t.get(i):(t.set(i,i.visible),i.visible=e))})}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,r,i,s){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();let t=e.autoClear;e.autoClear=!1,s&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.updateSelectionCache(),this.changeVisibilityOfSelectedObjects(!1);let i=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this._selectionCache.clear(),this.renderScene.background=i,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){let e=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(e),this.tempPulseColor2.multiplyScalar(e)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=a.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=a.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=a.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=a.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(r),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=t}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=r.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new i.jyz({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new i.FM8(.5,.5)},textureMatrix:{value:null}},vertexShader:`#include <morphtarget_pars_vertex>
				#include <skinning_pars_vertex>

				varying vec4 projTexCoord;
				varying vec4 vPosition;
				uniform mat4 textureMatrix;

				void main() {

					#include <skinbase_vertex>
					#include <begin_vertex>
					#include <morphtarget_vertex>
					#include <skinning_vertex>
					#include <project_vertex>

					vPosition = mvPosition;

					vec4 worldPosition = vec4( transformed, 1.0 );

					#ifdef USE_INSTANCING

						worldPosition = instanceMatrix * worldPosition;

					#endif

					worldPosition = modelMatrix * worldPosition;

					projTexCoord = textureMatrix * worldPosition;

				}`,fragmentShader:`#include <packing>
				varying vec4 vPosition;
				varying vec4 projTexCoord;
				uniform sampler2D depthTexture;
				uniform vec2 cameraNearFar;

				void main() {

					float depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));
					float viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );
					float depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;
					gl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);

				}`})}getEdgeDetectionMaterial(){return new i.jyz({uniforms:{maskTexture:{value:null},texSize:{value:new i.FM8(.5,.5)},visibleEdgeColor:{value:new i.Pa4(1,1,1)},hiddenEdgeColor:{value:new i.Pa4(1,1,1)}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;

				uniform sampler2D maskTexture;
				uniform vec2 texSize;
				uniform vec3 visibleEdgeColor;
				uniform vec3 hiddenEdgeColor;

				void main() {
					vec2 invSize = 1.0 / texSize;
					vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);
					vec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);
					vec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);
					vec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);
					vec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);
					float diff1 = (c1.r - c2.r)*0.5;
					float diff2 = (c3.r - c4.r)*0.5;
					float d = length( vec2(diff1, diff2) );
					float a1 = min(c1.g, c2.g);
					float a2 = min(c3.g, c4.g);
					float visibilityFactor = min(a1, a2);
					vec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;
					gl_FragColor = vec4(edgeColor, 1.0) * vec4(d);
				}`})}getSeperableBlurMaterial(e){return new i.jyz({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new i.FM8(.5,.5)},direction:{value:new i.FM8(.5,.5)},kernelRadius:{value:1}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;
				uniform float kernelRadius;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}

				void main() {
					vec2 invSize = 1.0 / texSize;
					float sigma = kernelRadius/2.0;
					float weightSum = gaussianPdf(0.0, sigma);
					vec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;
					vec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);
					vec2 uvOffset = delta;
					for( int i = 1; i <= MAX_RADIUS; i ++ ) {
						float x = kernelRadius * float(i) / float(MAX_RADIUS);
						float w = gaussianPdf(x, sigma);
						vec4 sample1 = texture2D( colorTexture, vUv + uvOffset);
						vec4 sample2 = texture2D( colorTexture, vUv - uvOffset);
						diffuseSum += ((sample1 + sample2) * w);
						weightSum += (2.0 * w);
						uvOffset += delta;
					}
					gl_FragColor = diffuseSum/weightSum;
				}`})}getOverlayMaterial(){return new i.jyz({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;

				uniform sampler2D maskTexture;
				uniform sampler2D edgeTexture1;
				uniform sampler2D edgeTexture2;
				uniform sampler2D patternTexture;
				uniform float edgeStrength;
				uniform float edgeGlow;
				uniform bool usePatternTexture;

				void main() {
					vec4 edgeValue1 = texture2D(edgeTexture1, vUv);
					vec4 edgeValue2 = texture2D(edgeTexture2, vUv);
					vec4 maskColor = texture2D(maskTexture, vUv);
					vec4 patternColor = texture2D(patternTexture, 6.0 * vUv);
					float visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;
					vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;
					vec4 finalColor = edgeStrength * maskColor.r * edgeValue;
					if(usePatternTexture)
						finalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);
					gl_FragColor = finalColor;
				}`,blending:i.WMw,depthTest:!1,depthWrite:!1,transparent:!0})}}a.BlurDirectionX=new i.FM8(1,0),a.BlurDirectionY=new i.FM8(0,1)},44792:function(e,t,r){r.d(t,{v:function(){return a}});var i=r(88780),s=r(14778);let n={name:"OutputShader",uniforms:{tDiffuse:{value:null},toneMappingExposure:{value:1}},vertexShader:`
		precision highp float;

		uniform mat4 modelViewMatrix;
		uniform mat4 projectionMatrix;

		attribute vec3 position;
		attribute vec2 uv;

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`
	
		precision highp float;

		uniform sampler2D tDiffuse;

		#include <tonemapping_pars_fragment>
		#include <colorspace_pars_fragment>

		varying vec2 vUv;

		void main() {

			gl_FragColor = texture2D( tDiffuse, vUv );

			// tone mapping

			#ifdef LINEAR_TONE_MAPPING

				gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );

			#elif defined( REINHARD_TONE_MAPPING )

				gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );

			#elif defined( CINEON_TONE_MAPPING )

				gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );

			#elif defined( ACES_FILMIC_TONE_MAPPING )

				gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );

			#elif defined( AGX_TONE_MAPPING )

				gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );

			#elif defined( NEUTRAL_TONE_MAPPING )

				gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );

			#endif

			// color space

			#ifdef SRGB_TRANSFER

				gl_FragColor = sRGBTransferOETF( gl_FragColor );

			#endif

		}`};class a extends s.w{constructor(){super(),this.uniforms=i.rDY.clone(n.uniforms),this.material=new i.FIo({name:n.name,uniforms:this.uniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader}),this.fsQuad=new s.T(this.material),this._outputColorSpace=null,this._toneMapping=null}render(e,t,r){this.uniforms.tDiffuse.value=r.texture,this.uniforms.toneMappingExposure.value=e.toneMappingExposure,(this._outputColorSpace!==e.outputColorSpace||this._toneMapping!==e.toneMapping)&&(this._outputColorSpace=e.outputColorSpace,this._toneMapping=e.toneMapping,this.material.defines={},i.epp.getTransfer(this._outputColorSpace)===i.j17&&(this.material.defines.SRGB_TRANSFER=""),this._toneMapping===i.EoG?this.material.defines.LINEAR_TONE_MAPPING="":this._toneMapping===i.CdI?this.material.defines.REINHARD_TONE_MAPPING="":this._toneMapping===i.YGz?this.material.defines.CINEON_TONE_MAPPING="":this._toneMapping===i.LY2?this.material.defines.ACES_FILMIC_TONE_MAPPING="":this._toneMapping===i.Bgp?this.material.defines.AGX_TONE_MAPPING="":this._toneMapping===i.ORg&&(this.material.defines.NEUTRAL_TONE_MAPPING=""),this.material.needsUpdate=!0),!0===this.renderToScreen?e.setRenderTarget(null):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil)),this.fsQuad.render(e)}dispose(){this.material.dispose(),this.fsQuad.dispose()}}},14778:function(e,t,r){r.d(t,{T:function(){return l},w:function(){return s}});var i=r(88780);class s{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}let n=new i.iKG(-1,1,1,-1,0,1);class a extends i.u9r{constructor(){super(),this.setAttribute("position",new i.a$l([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new i.a$l([0,2,0,0,2,0],2))}}let o=new a;class l{constructor(e){this._mesh=new i.Kj0(o,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,n)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}},79456:function(e,t,r){r.d(t,{C:function(){return n}});var i=r(88780),s=r(14778);class n extends s.w{constructor(e,t,r=null,s=null,n=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=s,this.clearAlpha=n,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new i.Ilk}render(e,t,r){let i,s;let n=e.autoClear;e.autoClear=!1,null!==this.overrideMaterial&&(s=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),null!==this.clearColor&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),null!==this.clearAlpha&&(i=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),!0==this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),!0===this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),null!==this.clearColor&&e.setClearColor(this._oldClearColor),null!==this.clearAlpha&&e.setClearAlpha(i),null!==this.overrideMaterial&&(this.scene.overrideMaterial=s),e.autoClear=n}}},5461:function(e,t,r){r.d(t,{T:function(){return n}});var i=r(88780),s=r(14778);class n extends s.w{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof i.jyz?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=i.rDY.clone(e.uniforms),this.material=new i.jyz({name:void 0!==e.name?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new s.T(this.material)}render(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?e.setRenderTarget(null):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil)),this.fsQuad.render(e)}dispose(){this.material.dispose(),this.fsQuad.dispose()}}},19297:function(e,t,r){r.d(t,{C:function(){return i}});let i={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`}},9573:function(e,t,r){r.d(t,{C:function(){return i}});let i={name:"FXAAShader",uniforms:{tDiffuse:{value:null},resolution:{value:new(r(88780)).FM8(1/1024,1/512)}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		// FXAA algorithm from NVIDIA, C# implementation by Jasper Flick, GLSL port by Dave Hoskins
		// http://developer.download.nvidia.com/assets/gamedev/files/sdk/11/FXAA_WhitePaper.pdf
		// https://catlikecoding.com/unity/tutorials/advanced-rendering/fxaa/

		uniform sampler2D tDiffuse;
		uniform vec2 resolution;
		varying vec2 vUv;

		#define EDGE_STEP_COUNT 6
		#define EDGE_GUESS 8.0
		#define EDGE_STEPS 1.0, 1.5, 2.0, 2.0, 2.0, 4.0
		const float edgeSteps[EDGE_STEP_COUNT] = float[EDGE_STEP_COUNT]( EDGE_STEPS );

		float _ContrastThreshold = 0.0312;
		float _RelativeThreshold = 0.063;
		float _SubpixelBlending = 1.0;

		vec4 Sample( sampler2D  tex2D, vec2 uv ) {

			return texture( tex2D, uv );

		}

		float SampleLuminance( sampler2D tex2D, vec2 uv ) {

			return dot( Sample( tex2D, uv ).rgb, vec3( 0.3, 0.59, 0.11 ) );

		}

		float SampleLuminance( sampler2D tex2D, vec2 texSize, vec2 uv, float uOffset, float vOffset ) {

			uv += texSize * vec2(uOffset, vOffset);
			return SampleLuminance(tex2D, uv);

		}

		struct LuminanceData {

			float m, n, e, s, w;
			float ne, nw, se, sw;
			float highest, lowest, contrast;

		};

		LuminanceData SampleLuminanceNeighborhood( sampler2D tex2D, vec2 texSize, vec2 uv ) {

			LuminanceData l;
			l.m = SampleLuminance( tex2D, uv );
			l.n = SampleLuminance( tex2D, texSize, uv,  0.0,  1.0 );
			l.e = SampleLuminance( tex2D, texSize, uv,  1.0,  0.0 );
			l.s = SampleLuminance( tex2D, texSize, uv,  0.0, -1.0 );
			l.w = SampleLuminance( tex2D, texSize, uv, -1.0,  0.0 );

			l.ne = SampleLuminance( tex2D, texSize, uv,  1.0,  1.0 );
			l.nw = SampleLuminance( tex2D, texSize, uv, -1.0,  1.0 );
			l.se = SampleLuminance( tex2D, texSize, uv,  1.0, -1.0 );
			l.sw = SampleLuminance( tex2D, texSize, uv, -1.0, -1.0 );

			l.highest = max( max( max( max( l.n, l.e ), l.s ), l.w ), l.m );
			l.lowest = min( min( min( min( l.n, l.e ), l.s ), l.w ), l.m );
			l.contrast = l.highest - l.lowest;
			return l;

		}

		bool ShouldSkipPixel( LuminanceData l ) {

			float threshold = max( _ContrastThreshold, _RelativeThreshold * l.highest );
			return l.contrast < threshold;

		}

		float DeterminePixelBlendFactor( LuminanceData l ) {

			float f = 2.0 * ( l.n + l.e + l.s + l.w );
			f += l.ne + l.nw + l.se + l.sw;
			f *= 1.0 / 12.0;
			f = abs( f - l.m );
			f = clamp( f / l.contrast, 0.0, 1.0 );

			float blendFactor = smoothstep( 0.0, 1.0, f );
			return blendFactor * blendFactor * _SubpixelBlending;

		}

		struct EdgeData {

			bool isHorizontal;
			float pixelStep;
			float oppositeLuminance, gradient;

		};

		EdgeData DetermineEdge( vec2 texSize, LuminanceData l ) {

			EdgeData e;
			float horizontal =
				abs( l.n + l.s - 2.0 * l.m ) * 2.0 +
				abs( l.ne + l.se - 2.0 * l.e ) +
				abs( l.nw + l.sw - 2.0 * l.w );
			float vertical =
				abs( l.e + l.w - 2.0 * l.m ) * 2.0 +
				abs( l.ne + l.nw - 2.0 * l.n ) +
				abs( l.se + l.sw - 2.0 * l.s );
			e.isHorizontal = horizontal >= vertical;

			float pLuminance = e.isHorizontal ? l.n : l.e;
			float nLuminance = e.isHorizontal ? l.s : l.w;
			float pGradient = abs( pLuminance - l.m );
			float nGradient = abs( nLuminance - l.m );

			e.pixelStep = e.isHorizontal ? texSize.y : texSize.x;
			
			if (pGradient < nGradient) {

				e.pixelStep = -e.pixelStep;
				e.oppositeLuminance = nLuminance;
				e.gradient = nGradient;

			} else {

				e.oppositeLuminance = pLuminance;
				e.gradient = pGradient;

			}

			return e;

		}

		float DetermineEdgeBlendFactor( sampler2D  tex2D, vec2 texSize, LuminanceData l, EdgeData e, vec2 uv ) {

			vec2 uvEdge = uv;
			vec2 edgeStep;
			if (e.isHorizontal) {

				uvEdge.y += e.pixelStep * 0.5;
				edgeStep = vec2( texSize.x, 0.0 );

			} else {

				uvEdge.x += e.pixelStep * 0.5;
				edgeStep = vec2( 0.0, texSize.y );

			}

			float edgeLuminance = ( l.m + e.oppositeLuminance ) * 0.5;
			float gradientThreshold = e.gradient * 0.25;

			vec2 puv = uvEdge + edgeStep * edgeSteps[0];
			float pLuminanceDelta = SampleLuminance( tex2D, puv ) - edgeLuminance;
			bool pAtEnd = abs( pLuminanceDelta ) >= gradientThreshold;

			for ( int i = 1; i < EDGE_STEP_COUNT && !pAtEnd; i++ ) {

				puv += edgeStep * edgeSteps[i];
				pLuminanceDelta = SampleLuminance( tex2D, puv ) - edgeLuminance;
				pAtEnd = abs( pLuminanceDelta ) >= gradientThreshold;

			}

			if ( !pAtEnd ) {

				puv += edgeStep * EDGE_GUESS;

			}

			vec2 nuv = uvEdge - edgeStep * edgeSteps[0];
			float nLuminanceDelta = SampleLuminance( tex2D, nuv ) - edgeLuminance;
			bool nAtEnd = abs( nLuminanceDelta ) >= gradientThreshold;

			for ( int i = 1; i < EDGE_STEP_COUNT && !nAtEnd; i++ ) {

				nuv -= edgeStep * edgeSteps[i];
				nLuminanceDelta = SampleLuminance( tex2D, nuv ) - edgeLuminance;
				nAtEnd = abs( nLuminanceDelta ) >= gradientThreshold;

			}

			if ( !nAtEnd ) {

				nuv -= edgeStep * EDGE_GUESS;

			}

			float pDistance, nDistance;
			if ( e.isHorizontal ) {

				pDistance = puv.x - uv.x;
				nDistance = uv.x - nuv.x;

			} else {
				
				pDistance = puv.y - uv.y;
				nDistance = uv.y - nuv.y;

			}

			float shortestDistance;
			bool deltaSign;
			if ( pDistance <= nDistance ) {

				shortestDistance = pDistance;
				deltaSign = pLuminanceDelta >= 0.0;

			} else {

				shortestDistance = nDistance;
				deltaSign = nLuminanceDelta >= 0.0;

			}

			if ( deltaSign == ( l.m - edgeLuminance >= 0.0 ) ) {

				return 0.0;

			}

			return 0.5 - shortestDistance / ( pDistance + nDistance );

		}

		vec4 ApplyFXAA( sampler2D  tex2D, vec2 texSize, vec2 uv ) {

			LuminanceData luminance = SampleLuminanceNeighborhood( tex2D, texSize, uv );
			if ( ShouldSkipPixel( luminance ) ) {

				return Sample( tex2D, uv );

			}

			float pixelBlend = DeterminePixelBlendFactor( luminance );
			EdgeData edge = DetermineEdge( texSize, luminance );
			float edgeBlend = DetermineEdgeBlendFactor( tex2D, texSize, luminance, edge, uv );
			float finalBlend = max( pixelBlend, edgeBlend );

			if (edge.isHorizontal) {

				uv.y += edge.pixelStep * finalBlend;

			} else {

				uv.x += edge.pixelStep * finalBlend;

			}

			return Sample( tex2D, uv );

		}

		void main() {

			gl_FragColor = ApplyFXAA( tDiffuse, resolution.xy, vUv );
			
		}`}},27834:function(e,t,r){r.d(t,{Vs:function(){return a},n4:function(){return s}});var i=r(88780);function s(e,t=!1){let r=null!==e[0].index,s=new Set(Object.keys(e[0].attributes)),a=new Set(Object.keys(e[0].morphAttributes)),o={},l={},h=e[0].morphTargetsRelative,u=new i.u9r,c=0;for(let i=0;i<e.length;++i){let n=e[i],d=0;if(r!==(null!==n.index))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+i+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let e in n.attributes){if(!s.has(e))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+i+'. All geometries must have compatible attributes; make sure "'+e+'" attribute exists among all geometries, or in none of them.'),null;void 0===o[e]&&(o[e]=[]),o[e].push(n.attributes[e]),d++}if(d!==s.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+i+". Make sure all geometries have the same number of attributes."),null;if(h!==n.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+i+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let e in n.morphAttributes){if(!a.has(e))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+i+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===l[e]&&(l[e]=[]),l[e].push(n.morphAttributes[e])}if(t){let e;if(r)e=n.index.count;else{if(void 0===n.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+i+". The geometry must have either an index or a position attribute"),null;e=n.attributes.position.count}u.addGroup(c,e,i),c+=e}}if(r){let t=0,r=[];for(let i=0;i<e.length;++i){let s=e[i].index;for(let e=0;e<s.count;++e)r.push(s.getX(e)+t);t+=e[i].attributes.position.count}u.setIndex(r)}for(let e in o){let t=n(o[e]);if(!t)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+e+" attribute."),null;u.setAttribute(e,t)}for(let e in l){let t=l[e][0].length;if(0===t)break;u.morphAttributes=u.morphAttributes||{},u.morphAttributes[e]=[];for(let r=0;r<t;++r){let t=[];for(let i=0;i<l[e].length;++i)t.push(l[e][i][r]);let i=n(t);if(!i)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+e+" morphAttribute."),null;u.morphAttributes[e].push(i)}}return u}function n(e){let t,r,s;let n=-1,a=0;for(let i=0;i<e.length;++i){let o=e[i];if(void 0===t&&(t=o.array.constructor),t!==o.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===r&&(r=o.itemSize),r!==o.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===s&&(s=o.normalized),s!==o.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(-1===n&&(n=o.gpuType),n!==o.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;a+=o.count*r}let o=new t(a),l=new i.TlE(o,r,s),h=0;for(let t=0;t<e.length;++t){let i=e[t];if(i.isInterleavedBufferAttribute){let e=h/r;for(let t=0,s=i.count;t<s;t++)for(let s=0;s<r;s++){let r=i.getComponent(t,s);l.setComponent(t+e,s,r)}}else o.set(i.array,h);h+=i.count*r}return void 0!==n&&(l.gpuType=n),l}function a(e,t){if(t===i.WwZ)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t!==i.z$h&&t!==i.UlW)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e;{let r=e.getIndex();if(null===r){let t=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<i.count;e++)t.push(e);e.setIndex(t),r=e.getIndex()}let s=r.count-2,n=[];if(t===i.z$h)for(let e=1;e<=s;e++)n.push(r.getX(0)),n.push(r.getX(e)),n.push(r.getX(e+1));else for(let e=0;e<s;e++)e%2==0?(n.push(r.getX(e)),n.push(r.getX(e+1)),n.push(r.getX(e+2))):(n.push(r.getX(e+2)),n.push(r.getX(e+1)),n.push(r.getX(e)));n.length/3!==s&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let a=e.clone();return a.setIndex(n),a.clearGroups(),a}}}}]);