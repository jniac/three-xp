"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5731],{25731:function(e,t,r){r.d(t,{Main:function(){return ee}});var n,o,i,s=r(78485),l=r(53171),a=r(48181),c=r(8834),u=r(52471),h=r(63221),d=r(63549),f=r(38137),p=r(87858),g=r(28142),y=r(9710),w=r(74831),m=r(494),v=r(1296),x=r(48437),V=r(88156),C=r(74175),M=r(81796),S=r(82446),A=r(49635),k=r(16573);let b=new u.Vector3(6,4,9),P=[new u.Vector3(0,0,4).multiplyScalar(1),new u.Vector3(0,4,0).multiplyScalar(1),new u.Vector3(6,0,9).multiplyScalar(1),new u.Vector3(6,4,6).multiplyScalar(1)],z=new u.Vector3(0,-4,8);function F(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,{x:o,y:i,z:s}=t,l=o+r,a=i+r,c=s+r;for(let t=s;t<c;t++)for(let r=i;r<a;r++)for(let i=o;i<l;i++)e.getVoxelState(i,r,t).setInt8(0,n)}function G(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=b.clone().multiplyScalar(4/t),n=[];for(let o of(0,k.KA)(r)){let r=o.x*t,i=o.y*t,s=o.z*t;(function(e,t,r,n){var o,i,s,l,a,c;let u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return e.getVoxelState(t,r,n).getInt8(0)>0&&!((null!==(l=null===(o=e.tryGetVoxelState(t-u,r,n))||void 0===o?void 0:o.getInt8(0))&&void 0!==l?l:0)>0)&&!((null!==(a=null===(i=e.tryGetVoxelState(t,r+u,n))||void 0===i?void 0:i.getInt8(0))&&void 0!==a?a:0)>0)&&!((null!==(c=null===(s=e.tryGetVoxelState(t,r,n+u))||void 0===s?void 0:s.getInt8(0))&&void 0!==c?c:0)>0)})(e,r,i,s,t)&&g.T.chance(1-o.py)&&n.push(new u.Vector3(r,i,s))}return n}function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=b.clone().multiplyScalar(4/t),n=[];for(let o of(0,k.KA)(r)){let r=o.x*t,i=o.y*t,s=o.z*t;(function(e,t,r,n){var o,i,s,l,a,c;let u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return!(e.getVoxelState(t,r,n).getInt8(0)>0)&&(null!==(l=null===(o=e.tryGetVoxelState(t+u,r,n))||void 0===o?void 0:o.getInt8(0))&&void 0!==l?l:0)>0&&(null!==(a=null===(i=e.tryGetVoxelState(t,r-u,n))||void 0===i?void 0:i.getInt8(0))&&void 0!==a?a:0)>0&&(null!==(c=null===(s=e.tryGetVoxelState(t,r,n-u))||void 0===s?void 0:s.getInt8(0))&&void 0!==c?c:0)>0})(e,r,i,s,t)&&g.T.chance(1-o.py)&&n.push(new u.Vector3(r,i,s))}return n}class B extends u.Mesh{createDots(){let e=new u.InstancedMesh(new u.IcosahedronGeometry(.1,8),new d.P,4);for(let[t,r]of((0,p.cY)(e,this),P.entries()))e.setMatrixAt(t,(0,A.$)({position:r})),e.setColorAt(t,(0,A.E)("#ffffff"));return this.dots=e,this}updateDots(e){this.dots||this.createDots();let t=this.dots;for(let[r,n]of P.entries()){t.setMatrixAt(r,(0,A.$)({position:n}));let o=e.isWithin(n)?"#00ffa6":"#ff0000";t.setColorAt(r,(0,A.E)(o))}t.instanceMatrix.needsUpdate=!0,t.instanceColor.needsUpdate=!0}get gridCoords(){return this._gridCoords}setGridCoords(e){(0,M.iK)(e,this._gridCoords);let{x:t,y:r}=this._gridCoords;this.scale.setScalar(.5**r),function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new u.Vector3,n=.5**t;r.set(6*e*n,4*(.5*n*2-1),6*e*n+8*(1-n)).multiplyScalar(1)}(t,r,this.position)}constructor({world:e=null,color:t=16777215*g.T.random()}={}){let r=new S.z(Math.ceil(115.19999999999999),1),n=new u.Vector3;for(let{x:e,y:t}of(0,k.B0)(6,4))n.set(e,t,e+4-1-t).multiplyScalar(4),F(r,n,4);for(let e=0;e<6;e+=2)n.set(e+1,3,e).multiplyScalar(4),F(r,n,4),g.T.chance(.8)&&(n.set(e+1,4,e).multiplyScalar(4),F(r,n,4));{let e=I(r,2),t=G(r,2);for(let t of e)F(r,t,2,1);for(let e of t)F(r,e,2,0)}{let e=I(r,1),t=G(r,1);for(let t of e)g.T.chance(.25)&&F(r,t,1,1);for(let e of t)g.T.chance(.25)&&F(r,e,1,0)}console.time("geometry");let o=(0,S.eO)(r.voxelFaces());console.timeEnd("geometry"),o.scale(.25,.25,.25),super(o,new d.P({color:t})),this._gridCoords=new u.Vector2,this.world=null,this.dots=null,(0,p.cY)(new u.AxesHelper,this),this.chunk=r,this.color=t,this.world=e}}let _=new u.Vector3(1,0,1).normalize(),D=new u.Vector3(0,1,-1).normalize(),E=new u.Vector3().crossVectors(_,D).normalize();D.crossVectors(E,_).normalize();let L=new u.Matrix4().makeBasis(_,D,E);class N extends u.Group{static current(){if(0===this.instances.length)throw Error("No Scope!");return this.instances[this.instances.length-1]}updateScope(){let{aspect:e=1,size:t=4}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e>1?t:t*e,n=r/e;(r!==this.state.width||n!==this.state.height)&&(this.parts.lines.clear().circle({radius:1}).rectangle([-r/2,-n/2,r,n]).plus([0,0],.2).draw(),this.parts.lines.geometry.computeBoundingSphere(),this.state.width=r,this.state.height=n)}isWithin(e){let{x:t,y:r}=e.clone().applyMatrix4(this.matrixWorldInverse),{width:n,height:o}=this.state;return t>=-n/2&&t<=n/2&&r>=-o/2&&r<=o/2}chunkIntersects(e){this.updateMatrixWorld(),e.updateMatrixWorld();let t=!0,r=!0,n=!0,o=!0,i=this.state.width/2,s=this.state.height/2;for(let l=0;l<4;l++){let{x:a,y:c,z:u}=N._chunkIntersectsVectors[l].copy(P[l]).applyMatrix4(e.matrixWorld).applyMatrix4(this.matrixWorldInverse);if(t&&(t=a<-i),n&&(n=a>i),r&&(r=c<-s),o&&(o=c>s),!1===(t||r||n||o))return!0}return!1}toVertigoProps(){let{width:e,height:t}=this.state;return{perspective:.5,size:[e,t],focus:this.position,rotation:this.rotation}}constructor(){super(),this.parts={axes:(0,p.cY)(new u.Mesh(new h.w,new d.P({vertexColors:!0})),{parent:this,visible:!1}),lines:(0,p.cY)(new V.O,this),debugLines:(0,p.cY)(new V.O,this)},this.state={width:4,height:4},this.matrixWorldInverse=new u.Matrix4,this.destroy=()=>{let e=N.instances.indexOf(this);if(-1===e)throw Error("Scope instance not found");N.instances.splice(e,1)},N.instances.push(this),this.position.set(0,0,6),this.rotation.setFromRotationMatrix(L,x.a.default.rotation.order),this.rotation.x+=(0,C.FE)("20deg"),this.updateMatrix(),this.updateMatrixWorld(),this.matrixWorldInverse.copy(this.matrixWorld).invert()}}function O(e,t){if(e<-32768||e>=32768||t<-32768||t>=32768)throw RangeError("x and y must be in the range -0x8000 to 0x7fff, received: ".concat(e," (0x").concat(e.toString(16),"), ").concat(t," (0x").concat(t.toString(16),")"));return(e+=32768)<<16|(t+=32768)}N.instances=[],N._chunkIntersectsVectors=[new u.Vector3,new u.Vector3,new u.Vector3,new u.Vector3];let R=new u.Vector2;function*W(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[n,o]=(()=>{if(1!==t.length)return t;{let{x:e,y:r}=(0,C.iK)(t[0]);return[e,r]}})();yield R.set(Math.floor((n-1)/2),o-1),yield R.set(Math.floor((n+1)/2),o-1),yield R.set(n-1,o),yield R.set(n+1,o),yield R.set(2*n-1,o+1),yield R.set(2*n,o+1),yield R.set(2*n+1,o+1),yield R.set(2*n+2,o+1)}class T extends u.Group{static current(){if(0===this.instances.length)throw Error("No World!");return this.instances[this.instances.length-1]}getChunk(e,t){var r;return null!==(r=this.chunks.get(O(e,t)))&&void 0!==r?r:null}ensureChunk(e,t){let r=O(e,t),n=this.chunks.get(r);if(n)return n;{let r=(0,p.cY)(new B({world:this}),this.chunkGroup);return this.chunks.set(O(e,t),r),r.setGridCoords([e,t]),r}}ensureChunkNeighbors(e,t){for(let r of(this.ensureChunk(e,t),W(e,t)))this.ensureChunk(r.x,r.y)}ensureScopeChunks(){let e=new Set([O(0,0)]),t=[this.ensureChunk(0,0)],r=0;for(;t.length>0;){if(r++>100){console.error("Exceeded maximum chunk count of ".concat(100));break}let n=t.pop();if(this.scope.chunkIntersects(n))for(let r of W(n.gridCoords)){let n=O(r.x,r.y);e.has(n)||(e.add(n),t.push(this.ensureChunk(r.x,r.y)))}}}white(){for(let e of this.chunks.values())e.material.color.set(16777215)}color(){for(let e of this.chunks.values())e.material.color.set(e.color)}constructor(){super(),this.origin=(0,p.cY)(new u.AxesHelper,{parent:this,position:z}),this.chunkWrapper=(0,p.cY)(new u.Group,{parent:this,position:z}),this.chunkGroup=(0,p.cY)(new u.Group,{parent:this.chunkWrapper,position:z.clone().negate()}),this.sphere=(0,p.cY)(new u.Mesh(new u.IcosahedronGeometry(1,8),new d.P({wireframe:!0})),{parent:this.chunkWrapper}),this.scope=(0,p.cY)(new N,this),this.chunks=new Map,this.destroy=()=>{this.scope.destroy(),this.chunks.clear(),this.clear();let e=T.instances.indexOf(this);if(-1===e)throw Error("World instance not found");T.instances.splice(e,1)},T.instances.push(this)}}T.instances=[],(n=o||(o={}))[n.Free=0]="Free",n[n.Scope=1]="Scope";class U{initialize(e){return this.element=e,this}*doStart(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(i=this.element)&&void 0!==i?i:document.body;yield(0,w.w)(e,{onDrag:e=>{this.position.x+=.01*e.delta.x,this.position.y+=-(.01*e.delta.y)}}),yield(0,y.RC)("three",e=>{let t=T.current();N.current(),this.dampedPosition.lerp(this.position,1-Math.exp(-(10*e.deltaTime)));let r=this.dampedPosition.y;t.chunkWrapper.scale.setScalar(2**(.33*r))})}start(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this._started||(this._destroyables.collect(this.doStart(...t)),this._started=!0)}stop(){this._started&&(this._destroyables.destroy(),this._started=!1)}toggle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this._started;e?this.start():this.stop()}update(e,t,r){this.vertigoControls.update(e,t,r)}constructor(){this.position=new u.Vector2,this.dampedPosition=new u.Vector2,this._destroyables=new v.N,this.vertigoControls=new m.F({perspective:.5}),this._started=!1,this.destroy=()=>{this._destroyables.destroy()}}}class Y{get mode(){return this._mode}set mode(e){this.setMode(e)}initialize(e,t){this.camera=e,this.freeVertigoControls.initialize(t).toggle(0===this._mode),this.scopeCameraHandler.initialize(t).toggle(1===this._mode);let r=N.current().toVertigoProps();return this.scopeCameraHandler.vertigoControls.vertigo.set(r),this.scopeCameraHandler.vertigoControls.dampedVertigo.set(r),this}setMode(e){if(e%=2,this._mode!==e)switch(this._mode=e,this.freeVertigoControls.toggle(0===e),this.scopeCameraHandler.toggle(1===e),e){case 0:(()=>{this.mode=Y.Mode.Free,this.freeVertigoControls.dampedVertigo.copy(this.scopeCameraHandler.vertigoControls.dampedVertigo)})();break;case 1:(()=>{this.mode=Y.Mode.Scope,this.scopeCameraHandler.vertigoControls.dampedVertigo.copy(this.freeVertigoControls.dampedVertigo),this.scopeCameraHandler.vertigoControls.vertigo.set(N.current().toVertigoProps())})()}}onTick(e,t){switch(this._mode){case 0:this.freeVertigoControls.update(this.camera,t,e.deltaTime);break;case 1:this.scopeCameraHandler.update(this.camera,t,e.deltaTime)}}constructor(){this._mode=1,this.freeVertigoControls=new m.F({size:24,perspective:1}),this.scopeCameraHandler=new U,this.destroy=()=>{this.freeVertigoControls.destroy(),this.scopeCameraHandler.destroy();let e=Y.instances.indexOf(this);if(-1===e)throw Error("CameraHandler instance not found");Y.instances.splice(e,1)},Y.instances.push(this)}}Y.Mode=o,Y.instances=[];var j=r(27275),H=r(48583);r(94588);let K=(0,j.createContext)(null);function X(e,t){let r=(0,j.useContext)(K);return(0,H.sv)(async function*(t,n){if(e){let t=e(r,n);if(t&&"function"==typeof t.next)do{let{value:e,done:r}=await t.next();if(r)break;yield e}while(n.mounted)}},null!=t?t:"always"),r}let Z={className:"",assetsPath:"/"};function Q(e){let{children:t,className:r,assetsPath:n}={...Z,...e},o=(0,j.useMemo)(()=>new a.Vu,[]);o.loader.setPath(n);let{ref:i}=(0,H.Nv)({debounce:!0},function*(e,t){yield o.initialize(e),t.triggerRender(),Object.assign(window,{three:o})},[]);return(0,s.jsx)("div",{ref:i,className:r,style:{position:"absolute",inset:0},children:(0,s.jsx)(K.Provider,{value:o,children:o.initialized&&t})})}function q(e){return function(){let[e,t]=(0,j.useState)(!1);return(0,j.useLayoutEffect)(()=>{t(!0)},[]),e}()&&(0,s.jsx)(Q,{...e})}function $(){return!function(e,t,r){let n=(0,j.useMemo)(()=>new u.Group,[]);n.name=e,X(async function*(e,r){if(e.scene.add(n),yield()=>{n.clear(),n.removeFromParent()},t){let o=t(n,e,r);if(o&&"function"==typeof o.next)do{let{value:e,done:t}=await o.next();if(t)break;yield e}while(r.mounted)}},r)}("fractal-grid",function*(e,t){(0,p.cY)(new f.w({color:"#110512"}),e),(0,p.cY)(new u.Mesh(new u.TorusKnotGeometry(2.5,.025,512,32),new d.P({color:"#0cf"})),e).visible=!1,g.T.seed(98763);let r=(0,p.cY)(new T,e);yield r.destroy,r.scope.updateScope({aspect:t.aspect}),r.ensureScopeChunks();let n=new Y().initialize(t.camera,t.renderer.domElement);yield(0,y.RC)("three",e=>{n.onTick(e,t.aspect),r.scope.updateScope({aspect:t.aspect})}),Object.assign(window,{world:r,cameraHandler:n}),(0,p.cY)(new u.Mesh(new h.w,new d.P({vertexColors:!0})),e)},[]),null}function J(){return X(function*(e){let t=new l.n(e.scene,e.camera);t.updatePdMaterial({lumaPhi:10,depthPhi:2,normalPhi:3,radius:2,radiusExponent:2,rings:2,samples:24}),yield e.pipeline.addPass(t,{type:a.GR.PostProcessing}),(0,c.a)({three:e})},[]),null}function ee(){return(0,s.jsx)("div",{className:"FractalGrid",children:(0,s.jsxs)(q,{children:[(0,s.jsx)("h1",{children:"FractalGrid"}),(0,s.jsx)(J,{}),(0,s.jsx)($,{})]})})}},8834:function(e,t,r){r.d(t,{Leak:function(){return l},a:function(){return s}});var n=r(40855),o=r(79509),i=r(28142);function s(e){Object.assign(window,{...o,...n,...e,PRNG:i.T})}function l(e){return s(e),null}},82446:function(e,t,r){r.d(t,{z:function(){return x},eO:function(){return S}});var n,o,i,s,l,a,c=r(52471);(n=s||(s={}))[n.X=0]="X",n[n.Y=2]="Y",n[n.Z=4]="Z",(o=l||(l={}))[o.R=0]="R",o[o.L=1]="L",o[o.U=2]="U",o[o.D=3]="D",o[o.F=4]="F",o[o.B=5]="B",(i=a||(a={}))[i.None=0]="None",i[i.All=63]="All",i[i.R=1]="R",i[i.L=2]="L",i[i.U=4]="U",i[i.D=8]="D",i[i.F=16]="F",i[i.B=32]="B";let u=[5,4,0,1,0,1],h=[new c.Vector3(1,0,0),new c.Vector3(-1,0,0),new c.Vector3(0,1,0),new c.Vector3(0,-1,0),new c.Vector3(0,0,1),new c.Vector3(0,0,-1)],d=0,f=0,p=0,g=0,y=[],w={A:()=>(y[d++]=f,y[d++]=p,y[d++]=g,w),B:()=>(y[d++]=f,y[d++]=p,y[d++]=g+1,w),C:()=>(y[d++]=f,y[d++]=p+1,y[d++]=g,w),D:()=>(y[d++]=f,y[d++]=p+1,y[d++]=g+1,w),E:()=>(y[d++]=f+1,y[d++]=p,y[d++]=g,w),F:()=>(y[d++]=f+1,y[d++]=p,y[d++]=g+1,w),G:()=>(y[d++]=f+1,y[d++]=p+1,y[d++]=g,w),H:()=>(y[d++]=f+1,y[d++]=p+1,y[d++]=g+1,w)},m={R:()=>(y[d++]=1,y[d++]=0,y[d++]=0,m),L:()=>(y[d++]=-1,y[d++]=0,y[d++]=0,m),U:()=>(y[d++]=0,y[d++]=1,y[d++]=0,m),D:()=>(y[d++]=0,y[d++]=-1,y[d++]=0,m),F:()=>(y[d++]=0,y[d++]=0,y[d++]=1,m),B:()=>(y[d++]=0,y[d++]=0,y[d++]=-1,m),R6:()=>m.R().R().R().R().R().R(),L6:()=>m.L().L().L().L().L().L(),U6:()=>m.U().U().U().U().U().U(),D6:()=>m.D().D().D().D().D().D(),F6:()=>m.F().F().F().F().F().F(),B6:()=>m.B().B().B().B().B().B()};class v{positionToArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{position:r,direction:n}=this;switch(y=e,d=t,f=r.x,p=r.y,g=r.z,n){case l.R:w.E().G().F().F().G().H();break;case l.L:w.A().B().D().A().D().C();break;case l.U:w.D().H().G().D().G().C();break;case l.D:w.A().E().F().A().F().B();break;case l.F:w.B().F().H().B().H().D();break;case l.B:w.A().C().E().E().C().G()}return e}normalToArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{direction:r}=this;switch(y=e,d=t,r){case l.R:m.R6();break;case l.L:m.L6();break;case l.U:m.U6();break;case l.D:m.D6();break;case l.F:m.F6();break;case l.B:m.B6()}return e}constructor(e,t,r=u[t]){this.position=e,this.direction=t,this.tangent=r}}class x{getVoxelState(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[n,o,i]=1===t.length?[t[0].x,t[0].y,t[0].z]:t,{size:s,size2:l,voxelStateByteSize:a,voxelState:c}=this;if(n<0||n>=s||o<0||o>=s||i<0||i>=s)throw Error("Coordinates out of bounds: ".concat(n,", ").concat(o,", ").concat(i,", size: ").concat(s));return new DataView(c,(n+o*s+i*l)*a,a)}tryGetVoxelState(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[n,o,i]=1===t.length?[t[0].x,t[0].y,t[0].z]:t,{size:s}=this;return n<0||n>=s||o<0||o>=s||i<0||i>=s?null:this.getVoxelState(n,o,i)}*voxelFaces(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>0!==e.getUint8(0),{size:t}=this,r=new v(new c.Vector3,0);for(let n=0;n<t;n++)for(let o=0;o<t;o++)for(let i=0;i<t;i++)if(e(this.getVoxelState(n,o,i)))for(let t=0;t<6;t++){let s=h[t],l=this.tryGetVoxelState(n+s.x,o+s.y,i+s.z);l&&e(l)||(r.position.set(n,o,i),r.direction=t,yield r)}}constructor(e=16,t=4){this.worldConnection=null,this.size=e,this.size2=e*e,this.size3=e*e*e,this.voxelStateByteSize=t,this.voxelState=new ArrayBuffer(e**3*t)}}class V{ensureSize(e){if(this.array.length<e){let t=new Float32Array(1<<Math.ceil(Math.log(e)/Math.log(2)));t.set(this.array),this.array=t}return this.array}copy(e){return new Float32Array(this.array.buffer,0,e).slice()}constructor(e=0){this.array=new Float32Array(0),this.ensureSize(e)}}let C=new V(768),M=new V(768);function S(e){let{geometry:t=new c.BufferGeometry}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="function"==typeof e?e():e;C.array.fill(0),M.array.fill(0);let n=0;for(let e of r){let t=18*n;C.ensureSize(t+18),M.ensureSize(t+18),e.positionToArray(C.array,t),e.normalToArray(M.array,t),n++}return t.setAttribute("position",new c.BufferAttribute(C.copy(18*n),3)),t.setAttribute("normal",new c.BufferAttribute(M.copy(18*n),3)),t}},63221:function(e,t,r){r.d(t,{w:function(){return c}});var n=r(52471),o=r(66666);let i={axis:"x",length:1,radialSegments:12,radius:.01,coneRatio:.1,radiusScale:1,vertexColor:!0,baseCap:"flat",color:"white"},s=new n.Color;function l(e){let{axis:t,length:r,radius:l,radialSegments:a,coneRatio:c,radiusScale:u,vertexColor:h,baseCap:d,color:f}={...i,...e},p=l*u,g=r*c,y=new n.ConeGeometry(3*p,g,a),w=new n.CylinderGeometry(p,p,1,a,1,!0),m=r-g,v=r-.5*g;y.rotateZ(-Math.PI/2).translate(v,0,0),w.scale(1,m,1).rotateZ(-Math.PI/2).translate(.5*m,0,0);let x="none"===d?new n.BufferGeometry:"flat"===d?new n.CircleGeometry(p,a).rotateY(-Math.PI/2):new n.SphereGeometry(p,a,3,0,2*Math.PI,0,.5*Math.PI).rotateZ(Math.PI/2).rotateX(Math.PI/2),V=(0,o.n4)([y,w,x]);switch(t){case"y":V.rotateZ(Math.PI/2);break;case"z":V.rotateY(-Math.PI/2)}if(h){let e=V.attributes.position.count,t=new n.BufferAttribute(new Float32Array(3*e),3);V.setAttribute("color",t),s.set(f);for(let r=0;r<e;r++)t.setXYZ(r,s.r,s.g,s.b)}return V}let a={xColor:"#ff3333",yColor:"#33cc66",zColor:"#3366ff"};class c extends n.BufferGeometry{constructor(e){super();let{xColor:t,yColor:r,zColor:n,...i}={...a,...e},s=l({...i,axis:"x",color:t}),c=l({...i,axis:"y",color:r}),u=l({...i,axis:"z",color:n}),h=(0,o.n4)([s,c,u]);this.copy(h),h.dispose()}}},88156:function(e,t,r){r.d(t,{O:function(){return u}});var n=r(52471),o=r(58648),i=r(81796);let s=new n.Vector2,l=new n.Vector3,a=new n.Matrix4;function c(e,t,r){if(null==r?void 0:r.transform)for(let e of((0,i.Xe)(r.transform,a),t))e.applyMatrix4(a);e.push(...t)}class u extends n.LineSegments{showOccludedLines(){let{opacity:e=.2}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new n.LineBasicMaterial({color:this.material.color,transparent:!0,depthFunc:n.GreaterDepth,opacity:e}),r=new n.LineSegments(this.geometry,t);return this.add(r),this}clear(){return this.points.length=0,this.geometry.setFromPoints(this.points),this}draw(){return this.geometry.setFromPoints(this.points),this.geometry.computeBoundingSphere(),this}line(e,t,r){let n=(0,i.Q7)(e),o=(0,i.Q7)(t);return c(this.points,[n,o],r),this}circle(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let{x:o,y:l,radius:a,segments:h,...d}={...u.circleDefaultOptions,...(()=>{if(t.length>1){let[e,r,n]=t,{x:o,y:l}=(0,i.iK)(e,s);return{x:o,y:l,radius:r,...n}}return t[0]})()},f=new n.Vector3(1,0,0),p=new n.Vector3(0,1,0),g=[];for(let e=0;e<h;e++){let t=e/h*Math.PI*2,r=(e+1)/h*Math.PI*2,i=Math.cos(t)*a,s=Math.sin(t)*a,c=Math.cos(r)*a,u=Math.sin(r)*a,d=new n.Vector3(o,l,0).addScaledVector(f,i).addScaledVector(p,s),y=new n.Vector3(o,l,0).addScaledVector(f,c).addScaledVector(p,u);g.push(d,y)}return c(this.points,g,d),this}rectangle(e,t){let{centerX:r,centerY:i,width:s,height:l}=o.Ae.from(e),a=s/2,u=l/2,h=new n.Vector3(r-a,i-u,0),d=new n.Vector3(r+a,i-u,0),f=new n.Vector3(r+a,i+u,0),p=new n.Vector3(r-a,i+u,0);return c(this.points,[h,d,d,f,f,p,p,h],t),this}box(){let{center:e=[0,0,0],size:t=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{x:r,y:o,z:s}=(0,i.Q7)(e,l),{x:a,y:c,z:u}=(0,i.Q7)(t,l),h=a/2,d=c/2,f=u/2,p=new n.Vector3(r-h,o-d,s-f),g=new n.Vector3(r+h,o-d,s-f),y=new n.Vector3(r+h,o+d,s-f),w=new n.Vector3(r-h,o+d,s-f),m=new n.Vector3(r-h,o-d,s+f),v=new n.Vector3(r+h,o-d,s+f),x=new n.Vector3(r+h,o+d,s+f),V=new n.Vector3(r-h,o+d,s+f);return this.points.push(p,g,g,y,y,w,w,p),this.points.push(m,v,v,x,x,V,V,m),this.points.push(p,m,g,v,y,x,w,V),this}plus(e,t,r){let o=t/2,{x:l,y:a}=(0,i.iK)(e,s),u=new n.Vector3(l-o,a,0),h=new n.Vector3(l+o,a,0),d=new n.Vector3(l,a-o,0),f=new n.Vector3(l,a+o,0);return c(this.points,[u,h,d,f],r),this}cross(e,t,r){let o=t/2,{x:l,y:a}=(0,i.iK)(e,s),u=new n.Vector3(l-o,a-o,0),h=new n.Vector3(l+o,a+o,0),d=new n.Vector3(l-o,a+o,0),f=new n.Vector3(l+o,a-o,0);return c(this.points,[u,h,d,f],r),this}constructor(...e){super(...e),this.points=[]}}u.circleDefaultOptions={x:0,y:0,radius:.5,segments:96}},63549:function(e,t,r){r.d(t,{P:function(){return i}});var n=r(52471);let o={vertexColors:!0,color:"white",luminosity:.5};class i extends n.ShaderMaterial{get color(){return this.uniforms.uColor.value}constructor(e){let{color:t,luminosity:r,vertexColors:i,...s}={...o,...e};super({...s,uniforms:{uColor:{value:new n.Color(t)},uSunPosition:{value:new n.Vector3(.5,.7,.3)},uLuminosity:{value:r}},vertexColors:i,vertexShader:"\nvarying vec3 vWorldNormal;\nvarying vec3 vColor;\n\nvoid main() {\n  vWorldNormal = mat3(modelMatrix) * normal;\n  vColor = color;\n#ifdef USE_INSTANCING\n  gl_Position = projectionMatrix * viewMatrix * modelMatrix * instanceMatrix * vec4(position, 1.0);\n#else\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n#endif\n#ifdef USE_INSTANCING_COLOR\n	vColor.xyz *= instanceColor.xyz;\n#endif\n}\n",fragmentShader:"\nvarying vec3 vWorldNormal;\nvarying vec3 vColor;\n\nuniform vec3 uSunPosition;\nuniform vec3 uColor;\nuniform float uLuminosity;\n\nvoid main() {\n  vec3 lightDirection = normalize(uSunPosition);\n  float light = dot(vWorldNormal, lightDirection) * 0.5 + 0.5;\n  light = pow(light, 2.0);\n  light = mix(uLuminosity, 1.0, light);\n  gl_FragColor = vec4(vColor * uColor * light, 1.0);\n}\n"}),this.sunPosition=this.uniforms.uSunPosition.value}}},38137:function(e,t,r){r.d(t,{w:function(){return i}});var n=r(52471);let o=new n.IcosahedronGeometry(1,4);class i extends n.Mesh{constructor(e){super(o,new n.MeshBasicMaterial({color:"#0c529d",...e,side:n.BackSide,depthWrite:!1,depthTest:!1})),this.renderOrder=-1,this.frustumCulled=!1,this.matrixAutoUpdate=!1,this.onBeforeRender=(e,t,r)=>{let n=(r.near+r.far)/2;this.position.copy(r.position),this.scale.setScalar(n),this.updateMatrix(),this.updateMatrixWorld()}}}},49635:function(e,t,r){r.d(t,{$:function(){return s},E:function(){return a}});var n=r(52471),o=r(81796);let i=new n.Matrix4;function s(e){return(0,o.Xe)(e,i)}let l=new n.Color;function a(e){return l.set(e)}},16573:function(e,t,r){function*n(e){let t=0,r={get i(){return t},get t(){return t/e},get p(){return t/(e-1)}};for(t=0;t<e;t++)yield r}function*o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=0,o=0;2===t.length?(n=t[0],o=t[1]):Array.isArray(t[0])?(n=t[0][0],o=t[0][1]):(n=t[0].x,o=t[0].y);let i=0,s=0,l=0,a={get i(){return i},get x(){return s},get y(){return l},get tx(){return s/n},get ty(){return l/o},get px(){return s/(n-1)},get py(){return l/(o-1)}};for(l=0;l<o;l++)for(s=0;s<n;s++)yield a,i++}function*i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=0,o=0,i=0;3===t.length?(n=t[0],o=t[1],i=t[2]):Array.isArray(t[0])?(n=t[0][0],o=t[0][1],i=t[0][2]):(n=t[0].x,o=t[0].y,i=t[0].z);let s=0,l=0,a=0,c=0,u={get i(){return s},get x(){return l},get y(){return a},get z(){return c},get tx(){return l/n},get ty(){return a/o},get tz(){return c/i},get px(){return l/(n-1)},get py(){return a/(o-1)},get pz(){return c/(i-1)}};for(c=0;c<i;c++)for(a=0;a<o;a++)for(l=0;l<n;l++)yield u,s++}r.d(t,{B0:function(){return o},KA:function(){return i},VX:function(){return n}})},28142:function(e,t,r){r.d(t,{T:function(){return c}});let n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:123456;return(e=(e=(7*e+Math.sqrt(e)+16087*Math.sin(e))%2147483647)<0?e+2147483647:e)>1?2147483647&e:0===e?345678:123456},o=e=>e=2147483647&Math.imul(e,48271),i=e=>(e-1)/2147483646,s=e=>e,l={weightsAreNormalized:!1,indexOffset:0,forbiddenItems:[]};function a(){let e=o(o(n(123456)));function t(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:123456;return"string"==typeof t&&(t=t.split("").reduce((e,t)=>7*e+t.charCodeAt(0),0)),e=o(o(n(t))),h}function r(){return i(e=o(e))}function a(e){switch(e.length){default:return[0,1,s];case 1:return[0,e[0],s];case 2:return[e[0],e[1],s];case 3:return[e[0],e[1],e[2]]}}function c(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[o,i,s]=a(t);return o+(i-o)*s(r())}function u(){for(var e,t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];let[i,s,{weightsAreNormalized:a,indexOffset:c,forbiddenItems:u}]=function(e){let[t,r=null,n]=e,o={...l,...n};if(Array.isArray(t))return[t,r,o];if("object"==typeof t)return[Object.values(t),r?Object.values(r):null,o];throw Error("pick: unsupported options type")}(n);if(u.length>0){let t=new Set;for(let e of u){let r=i.indexOf(e);r>=0&&t.add(r)}if(i=i.filter((e,r)=>!t.has(r)),s=null!==(e=null==s?void 0:s.filter((e,r)=>!t.has(r)))&&void 0!==e?e:null,0===i.length)throw Error("pick: all items are forbidden")}if(null===s){let e=Math.floor(r()*i.length);return c&&(e+=c,(e%=i.length)<0&&(e+=i.length)),i[e]}if(!a){let e=s.reduce((e,t)=>e+t,0);s=s.map(t=>t/e)}let h=r(),d=0;for(let e=0;e<i.length;e++)if(h<(d+=s[e]))return i[e];throw Error("among: unreachable")}let h={seed:t,seedMax:function(){return 2147483647},reset:function(){return t(123456),h},next:function(){return e=o(e),h},random:r,between:c,around:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[o=1,i=s]=t,l=2*r();return(l>1?1:-1)*i(l>1?l-1:l)*o},int:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[o,i,s]=a(t);return o+Math.floor(s(r())*(i-o))},chance:function(e){return r()<e},shuffle:function(e){let{mutate:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t&&Array.isArray(e)?e:[...e],o=n.length;for(let e=0;e<o;e++){let t=Math.floor(o*r()),i=n[e];n[e]=n[t],n[t]=i}return n},pick:u,createPicker:function(e){let t=e.map(e=>{let[t]=e;return t}),r=e.map(e=>{let[t,r]=e;return r}),n=r.reduce((e,t)=>e+t,0);for(let[e,t]of r.entries())r[e]=t/n;return()=>u(t,r,{weightsAreNormalized:!0})},vector:function(e,t){let[r=0,n=1]=Array.isArray(t)?t:[null==t?void 0:t.min,null==t?void 0:t.max];for(let t of Object.keys(e))e[t]=c(r,n);return e},unitVector:function(e,t){let[r=-1,n=1]=Array.isArray(t)?t:[null==t?void 0:t.min,null==t?void 0:t.max],o=Object.keys(e),i=o.map(()=>c(r,n)),s=Math.sqrt(i.reduce((e,t)=>e+t*t,0));for(let[t,r]of o.entries())e[r]=i[t]/s;return e},boxMuller:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=r(),o=r(),i=Math.sqrt(-2*Math.log(n)),s=2*Math.PI*o;return[e+t*i*Math.cos(s),e+t*i*Math.sin(s)]}};return h}let c=class{constructor(e){Object.assign(this,a().seed(e))}};Object.assign(c,a())}}]);