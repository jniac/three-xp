"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3540],{33540:(e,t,n)=>{n.d(t,{q:()=>r.ThreeInstance,uB:()=>r.ThreeProvider,dB:()=>i.useGroup,yk:()=>i.useThree,Fw:()=>i.useThreeWebGL});var i=n(87548),r=n(42436),s=n(63106);n(18479);var o=n(79911),l=n(67235);let a={hotkey:"g",show:void 0,hide:void 0,isHelper:e=>!0===e.userData.helper};class c{*initialize(){let{hotkey:e}=this.safeParams;yield(0,s.a)([[{key:e,keyCaseInsensitive:!0},()=>this.toggle()]])}toggle(){return this.currentShowHelpers=!this.currentShowHelpers,this.updateHelpers(),this.currentShowHelpers}updateHelpers(){let{isHelper:e}=this.safeParams;for(let t of(0,o.$z)(this.root))e(t)&&(t.visible=this.currentShowHelpers);l.Q.send("TOGGLE_HELPERS",this.currentShowHelpers?"SHOW":"HIDE")}set showHelpers(e){this.currentShowHelpers=null!=e?e:this.currentShowHelpers,this.updateHelpers()}constructor(e,t){var n;c.instances.set(e,this),this.safeParams={...a,...t},this.root=e.scene,this.currentShowHelpers=null!=(n=null==t?void 0:t.show)?n:(null==t?void 0:t.hide)!==!1,this.updateHelpers()}}c.instances=new Map},37821:(e,t,n)=>{n.d(t,{D:()=>r});var i=n(67203);function r(){let[e,t]=(0,i.useState)(!1);return(0,i.useLayoutEffect)(()=>{t(!0)},[]),e}},42436:(e,t,n)=>{n.r(t),n.d(t,{ThreeInstance:()=>w,ThreeProvider:()=>k});var i=n(70691),r=n(67203),s=n(30158),o=n(24223),l=n(63106),a=n(18479),c=n(37821),u=n(31763),d=n(40951),h=n(29338),p=n(82143),f=n(83628),y=n(67235),v=n(68571),m=n(87548);function w(e){return(0,m.useInstance)(e),null}let b={type:void 0,webgl:void 0,webgpu:void 0,className:"",assetsPath:"/",vertigoControls:!1,minActiveDuration:30,fullscreenKey:null};function g(e){var t;let n={...b,...e},{children:c,className:m,vertigoControls:w}=n,g=null!=(t=n.type)?t:n.webgpu?"webgpu":"webgl",k=(0,r.useRef)(void 0);k.current&&k.current!==g&&console.warn('ThreeProvider: the prop "type" is not intended to change after the component is mounted.'),k.current=g;let P=(0,r.useMemo)(()=>"webgl"===g?new p.XW:new f.K,[g]);P.ticker.set({minActiveDuration:n.minActiveDuration});let{ref:x}=(0,a.IZ)({debounce:!0},function*(e,t){let n=e.querySelector("#three-wrapper-canvas");yield P.initialize(n,document.body),P.pointer.setEventIgnore(d.K6.Type.Tap,e=>{let{downTarget:t}=e;return!1===(n===t||n.contains(t))}),t.triggerRender(),Object.assign(window,{three:P,THREE:s})},[]);(0,a.useEffects)(function*(){yield y.Q.on("THREE",e=>{e.setPayload(P)}),yield(0,o.O)(P.ticker.requestActivation);let e=()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()};if(n.fullscreenKey&&(yield(0,l.a)([[n.fullscreenKey,e]])),yield y.Q.on("TOGGLE_FULLSCREEN",e),w){var t,i,r;let e="object"==typeof w?w:{},n=new u.n(e).initialize("canvas"===e.eventTarget?P.domElement:x.current);Object.assign(n.inputConfig,e.inputConfig),n.parsePanInputs(null!=(t=e.panInput)?t:""),n.parseOrbitInputs(null!=(i=e.orbitInput)?i:""),n.focusPlane=null!=(r=e.focusPlane)?r:null,P.scene.add(n.group),e.fixed||n.start(),yield(0,l.a)([[{code:"Tab",modifiers:"alt"},e=>{e.event.preventDefault(),n.actions.toggleAlternative()}]]),yield n.destroy;let s=e=>{"SET"===e.type?n.vertigo.set(e.payload):e.setPayload(n)};yield y.Q.on("VERTIGO_CONTROLS",s),yield y.Q.on(u.n,s),yield y.Q.on([P,u.n],s),yield P.ticker.onTick({name:"VertigoControls",phase:h.z.BeforeRender,order:-1},e=>{n.update(P.camera,P.aspect,e.deltaTime)})}},[w]);let E={position:"absolute",inset:0};return(0,i.jsx)("div",{ref:x,className:m,style:E,children:(0,i.jsxs)(v.h.Provider,{value:P,children:[(0,i.jsx)("div",{id:"three-wrapper-canvas",style:E}),(0,i.jsx)("div",{id:"three-wrapper-hud",style:E,className:"thru",children:P.initialized&&c})]})})}function k(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,c.D)()&&(0,i.jsx)(g,{...t[0]})}},63106:(e,t,n)=>{function i(e,t){return"*"===t||("string"==typeof t?t===e:t instanceof RegExp?t.test(e):"function"==typeof t&&t(e))}n.d(t,{a:()=>l});let r={preventDefault:!1,strictTarget:void 0},s={key:"*",keyCaseInsensitive:!0,code:"*",noModifiers:!1,modifiers:"",phase:"down"},o=0;function l(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let l=o++,[a,c,u]=1===t.length?[document.body,{},t[0]]:2===t.length?[t[0],{},t[1]]:t,{preventDefault:d}={...r,...c},h=null,p=e=>{var t;if((null!=(t=c.strictTarget)?!!t:a===document.body)&&e.target!==a)return;"keydown"===e.type&&(h=e);let{ctrlKey:n=!1,altKey:r=!1,shiftKey:o=!1,metaKey:p=!1}=null!=h?h:{},f={id:l,event:e,downEvent:h,modifiers:{ctrl:n,alt:r,shift:o,meta:p}};for(let t=0,l=u.length;t<l;t++){let[l,a]=u[t],{key:c,keyCaseInsensitive:y,code:v,noModifiers:m,modifiers:w,phase:b="down"}=function(e){let t="string"==typeof e?{...s,key:e}:{...s,...e};return t.keyCaseInsensitive&&"string"==typeof t.key&&(t.key=t.key.toLowerCase()),t}(l);switch(e.type){case"keydown":if("down"!==b)continue;break;case"keyup":if("up"!==b)continue}Object.values({key:i(y?e.key.toLowerCase():e.key,c),code:i(e.code,v),noModifiers:!m||!1===n&&!1===r&&!1===o&&!1===p,modifiers:function(e,t){let{ctrlKey:n,altKey:i,shiftKey:r,metaKey:s}=e;if("function"==typeof t)return t({ctrl:n,alt:i,shift:r,meta:s});let{ctrl:o=!1,alt:l=!1,shift:a=!1,meta:c=!1}=Object.fromEntries(t.split("-").map(e=>[e,!0]));return o===n&&l===i&&a===r&&c===s}(h,w)}).every(Boolean)&&(d&&e.preventDefault(),a(f))}};return a.addEventListener("keydown",p,{passive:!1}),a.addEventListener("keyup",p,{passive:!1}),{destroy:()=>{a.removeEventListener("keydown",p),a.removeEventListener("keyup",p)}}}},68571:(e,t,n)=>{n.d(t,{h:()=>i});let i=(0,n(67203).createContext)(null)},83628:(e,t,n)=>{n.d(t,{K:()=>c});var i=n(17953),r=n(81074),s=n(49797),o=n(24223),l=n(52489),a=n(29338);class c extends l.${_onSetSize(){let{size:{x:e,y:t},pixelRatio:n}=this,{renderer:i,perspectiveCamera:r,orthographicCamera:s}=this;i.setSize(e,t),i.setPixelRatio(n);let o=e/t;r.aspect=o,r.updateProjectionMatrix(),s.left=-o,s.right=o,s.top=1,s.bottom=-1,s.updateProjectionMatrix()}initialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(this.initialized)return console.warn("ThreeWebGLContext is already initialized."),this;Object.defineProperty(this,"initialized",{value:!0,writable:!1,configurable:!1,enumerable:!1});let n=this.scenePass.getTextureNode("output");this.postProcessing.outputNode=n,new ResizeObserver(()=>{this.setSize({width:e.clientWidth,height:e.clientHeight,pixelRatio:window.devicePixelRatio})}).observe(e);let{domElement:i}=this.renderer;return i.style.display="block",i.style.width="100%",i.style.height="100%",e.appendChild(i),this.setSize({width:i.clientWidth,height:i.clientHeight,pixelRatio:window.devicePixelRatio}),this.internal.cancelTick=this.ticker.onTick({name:"WebGPU:Render",phase:a.z.Render},e=>{this.renderFrame(e)}).destroy,this.internal.cancelRequestActivation=(0,o.O)(document.body,this.ticker.requestActivation).destroy,this.internal.cancelPointer=this.pointer.initialize(this.renderer.domElement,t,this.camera,this.ticker),this.domContainer=e,this.domElement=i,this}renderFrame(e,t){(!1!==this._enabled||(null==t?void 0:t.force)===!0)&&(super.renderFrame(e,t),!1===this.skipRender&&this.postProcessing.renderAsync())}constructor(){super(a.s.WebGPU),this.renderer=new r.uV1({antialias:!0}),this.perspectiveCamera=new s.ubm,this.orthographicCamera=new s.qUd,this.camera=this.perspectiveCamera,this.postProcessing=new r.io7(this.renderer),this.scenePass=(0,i.IXH)(this.scene,this.perspectiveCamera),this.internal={observer:null,cancelRequestActivation:null,cancelTick:null,cancelPointer:null},this.initialized=!1,this.destroyed=!1,this.destroy=()=>{var e,t,n,i,r,s,o;if(this.destroyed)return void console.warn("ThreeWebGLContext is already destroyed.");Object.defineProperty(this,"destroyed",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.renderer.dispose(),null==(e=this.internal.observer)||e.disconnect(),null==(t=(n=this.internal).cancelTick)||t.call(n),null==(i=(r=this.internal).cancelRequestActivation)||i.call(r),null==(s=(o=this.internal).cancelPointer)||s.call(o)},this.camera.position.set(0,1,10),this.camera.lookAt(0,0,0),this.pointer.updatePosition(this.camera,{x:0,y:0},this.renderer.domElement.getBoundingClientRect())}}},87548:(e,t,n)=>{n.r(t),n.d(t,{useGroup:()=>h,useInstance:()=>p,useThree:()=>c,useThreeWebGL:()=>u,useThreeWebGPU:()=>d});var i=n(67203),r=n(49797),s=n(18479),o=n(29338),l=n(79911),a=n(68571);function c(e,t){let n=(0,i.useContext)(a.h);return(0,s.useEffects)(async function*(t,i){if(e){let t=e(n,i);if(t&&"function"==typeof t.next)do{let{value:e,done:n}=await t.next();if(n)break;yield e}while(i.mounted)}},null!=t?t:"always"),n}function u(e,t){let n=c(async function*(t,n){if(t.type===o.s.WebGL&&e){let i=e(t,n);if(i&&"function"==typeof i.next)for(;;){let{value:e,done:t}=await i.next();if(t)break;yield e}}},t);if(n.type===o.s.WebGL)return n;throw Error("No WebGL context available")}function d(e,t){let n=c(async function*(t,n){if(t.type===o.s.WebGPU&&e){let i=e(t,n);if(i&&"function"==typeof i.next)for(;;){let{value:e,done:t}=await i.next();if(t)break;yield e}}},t);return n.type===o.s.WebGPU?n:null}function h(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[s,o,a,u]=function(e){if(e.length>=3&&"function"==typeof e[2])return e;{let[t,n=function*(){},i]=e;return[t,{},n,i]}}(t),d=(0,i.useMemo)(()=>new r.YJl,[]);return d.name=s,(0,l.mj)(d,o),c(async function*(e,t){if((0,l.mj)(d,{parent:e.scene,...o}),yield()=>{d.clear(),d.removeFromParent()},a){let n=a(d,e,t);if(n&&"function"==typeof n.next)do{let{value:e,done:t}=await n.next();if(t)break;yield e}while(t.mounted)}},u),d}function p(e){c(async function*(t){let{value:n,args:i=[],hidden:s}=e;if(!n)return;let o="function"==typeof n&&n.prototype&&r.B69.prototype.isPrototypeOf(n.prototype)?new n(...i):n;for(let n of((0,l.mj)(o,{parent:t.scene,...e.transform}),s&&(o.visible=!1),(0,l.$z)(o,{includeSelf:!0})))if("onInitialize"in n){let e=n.onInitialize(t);if(e&&"function"==typeof e.next)for(;;){let{value:t,done:n}=await e.next();if(n)break;yield t}}yield()=>{for(let t of(o.removeFromParent(),(0,l.$z)(o,{includeSelf:!0})))if("onDestroy"in t){var e;null==(e=t.onDestroy)||e.call(t)}}},"always")}}}]);