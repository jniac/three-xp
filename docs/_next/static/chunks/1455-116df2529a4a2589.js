"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1455],{25462:function(t,e,n){n.d(e,{H7:function(){return d},Ky:function(){return s}});var r=n(78485),a=n(27275),i=n(48583),o=n(48181);n(94588);let l=(0,a.createContext)(null);function s(t,e){let n=(0,a.useContext)(l);return(0,i.sv)(async function*(e,r){if(t){let e=t(n,r);if(e&&"function"==typeof e.next)do{let{value:t,done:n}=await e.next();if(n)break;yield t}while(r.mounted)}},null!=e?e:"always"),n}let u={className:"",assetsPath:"/"};function c(t){let{children:e,className:n,assetsPath:s}={...u,...t},c=(0,a.useMemo)(()=>new o.Vu,[]);c.loader.setPath(s);let{ref:d}=(0,i.Nv)({debounce:!0},function*(t,e){yield c.initialize(t.firstElementChild),e.triggerRender(),Object.assign(window,{three:c})},[]);return(0,r.jsx)("div",{ref:d,className:n,style:{position:"absolute",inset:0},children:(0,r.jsxs)(l.Provider,{value:c,children:[(0,r.jsx)("div",{style:{position:"absolute",inset:"0"}}),(0,r.jsx)("div",{style:{position:"absolute",inset:"0"},className:"thru",children:c.initialized&&e})]})})}function d(t){return function(){let[t,e]=(0,a.useState)(!1);return(0,a.useLayoutEffect)(()=>{e(!0)},[]),t}()&&(0,r.jsx)(c,{...t})}},18737:function(t,e,n){n.d(e,{m:function(){return x}});var r,a,i=n(85679),o=n(47174),l=n(49635),s=n(77405);function u(){return[...new Set(["�",..."abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",..."\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff",..."0123456789",..." .,!?\xbf:;-+*/=%&|()[]{}<>$'’\""])].join("")}class c{constructor(){let t=u(),e=new i.Vector2(16,24),n=e.x/e.y,r=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new i.Vector2;return n.x=Math.ceil(Math.sqrt(t/e)),n.y=Math.ceil(t/n.x),n}(t.length,n),a=e.clone().multiplyScalar(3),o=(0,s.h3)(a.x*r.x),l=(0,s.h3)(a.y*r.y),c=o/(a.x*r.x),d=l/(a.y*r.y),h=document.createElement("canvas");h.width=o,h.height=l;let f=h.getContext("2d");f.font="".concat(.8*a.y,"px monospace"),f.textBaseline="top",f.fillStyle="black",f.fillRect(0,0,o,l),f.fillStyle="white",f.transform(c,0,0,d,0,0);for(let e=0;e<t.length;e++){let n=Math.floor(e/r.x),i=(e-n*r.x+.12)*a.x,o=a.y*(n+.19999999999999996);f.fillText(t[e],i,o)}this.canvas=h,this.texture=new i.CanvasTexture(h),this.symbols=t,this.charGrid=r}}c.getDefaultSymbols=u;class d{get textCount(){return this.metadata.textCount}get lineCount(){return this.metadata.lineCount}get lineLength(){return this.metadata.lineLength}get strideHeaderByteSize(){return this.metadata.strideHeaderByteSize}get strideByteSize(){return this.metadata.strideByteSize}get textureSize(){return new i.Vector2(this.metadata.textureWidth,this.metadata.textureHeight)}encode(){let t=JSON.stringify(this.metadata),e=new TextEncoder().encode(t),n=e.length,r=new Uint8Array(4);new DataView(r.buffer).setUint32(0,n,!0);let a=new Uint8Array(4+n+this.array.length);return a.set(r,0),a.set(e,4),a.set(this.array,4+n),a}static decode(t){let e=new DataView(t.buffer).getUint32(0,!0),n=t.slice(4,4+e),r=JSON.parse(new TextDecoder().decode(n)),a=new d(r.symbols,r.textCount,r.lineCount,r.lineLength),i=t.slice(4+e);return a.array.set(i),a}info(){return"data: ".concat(this.array.length," bytes, ").concat(this.textureSize.x,"x").concat(this.textureSize.y)}getTextAt(t){let{array:e}=this,{symbols:n,lineCount:r,lineLength:a,strideByteSize:i,strideHeaderByteSize:o}=this.metadata,l=t*i,s=e[l+0],u=e[l+16],c=t=>t.toString(16).padStart(2,"0"),d="#".concat(c(e[l+4])).concat(c(e[l+4+1])).concat(c(e[l+4+2])),h=e[l+4+3],f="#".concat(c(e[l+8])).concat(c(e[l+8+1])).concat(c(e[l+8+2])),x=e[l+8+3],g=[];for(let t=0;t<s;t++){let r=l+o+t*a,i=[];for(let t=0;t<u;t++){let a=n[e[r+t]];i.push(a)}g.push(i.join(""))}return{text:g.join("\n"),textColor:d,textOpacity:h,backgroundColor:f,backgroundOpacity:x}}setSizeAt(t,e){let{array:n}=this,{strideByteSize:r}=this.metadata;return new DataView(n.buffer).setFloat32(t*r+12,e),this}setColorAt(t,e){let{color:n="#ffffff",textColor:r=n,textOpacity:a=1,backgroundColor:i=r,backgroundOpacity:o=0}=e,{array:u}=this,{strideByteSize:c}=this.metadata;{let{r:e,g:n,b:i}=(0,l.E)(r),o=t*c+4;u[o+0]=255*e,u[o+1]=255*n,u[o+2]=255*i,u[o+3]=(0,s.UM)(a)}{let{r:e,g:n,b:r}=(0,l.E)(i),a=t*c+8;u[a+0]=255*e,u[a+1]=255*n,u[a+2]=255*r,u[a+3]=(0,s.UM)(o)}return this}setTextAt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{trim:r=!1,size:a=1,...i}=n;this.setColorAt(t,i),this.setSizeAt(t,a);let{array:o}=this,{symbols:l,lineCount:s,lineLength:u,strideByteSize:c,strideHeaderByteSize:d}=this.metadata,h=(r?e.trim():e).split("\n");h.length>s&&(console.warn("TextHelper: Text has more lines than ".concat(s,", truncating.")),h=h.slice(0,s)),h=h.map(t=>(r&&(t=t.trim()),t.length>u)?(console.warn("TextHelper: Line length is greater than ".concat(u," characters, clamping.")),t.slice(0,u)):t),o[t*c+0]=h.length;let f=t*c,x=h.length;for(let t=0;t<s;t++){let e=0;t<x&&(o[f+16+4*t]=h[t].length,e=h[t].length);let n=f+d+t*u;for(let r=0;r<u;r++){let a=n+r;if(t>=x||r>=e)o[a]=0;else{let e=l.indexOf(h[t].charAt(r));o[a]=-1===e?0:e}}}}constructor(t,e,n,r){let a=16+4*n,i=a+4*Math.ceil(n*r/4),o=Math.ceil((a+e*i)/4),l=(0,s.h3)(Math.sqrt(o)),u=Math.ceil(o/l);this.metadata={symbols:t,textCount:e,lineCount:n,lineLength:r,strideHeaderByteSize:a,strideByteSize:i,textureWidth:l,textureHeight:u},this.array=new Uint8Array(l*u*4)}}(r=a||(a={}))[r.Normal=0]="Normal",r[r.Billboard=1]="Billboard";let h={textCount:1e3,lineLength:24,lineCount:2,charSize:new i.Vector2(.2,.3),textSize:1,orientation:1},f=0;class x extends i.InstancedMesh{setData(t){return this.data=t,this.dataTexture.image.data=t.array,this.dataTexture.needsUpdate=!0,this}setTextAt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.data.setTextAt(t,e,n),this.dataTexture.needsUpdate=!0,this.setMatrixAt(t,(0,l.$)(n)),this.instanceMatrix.needsUpdate=!0,this}setColorAt(t,e){this.data.setColorAt(t,{color:e}),this.dataTexture.needsUpdate=!0}getDataStringView(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return function(t,e,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:3,l=Array.from({length:e.length/4},(t,n)=>{let r=4*n,a=e[r+0];return[a,e[r+1],e[r+2],e[r+3]]}).slice(i*n/4,o*n/4),s=[];s.push("\nData texture array (".concat(e.length," bytes):")),s.push("\ndataStride: ".concat(n," (").concat(n/4," x 4 bytes)"));let u=4+r;for(let e=0;e<l.length;e++){let i=e%(n/4);0===i&&(s.push("\npack #".concat(e/(n/4))),s.push("info:")),4===i&&s.push("lines (".concat(r,"):")),i===u&&s.push("chars (".concat(a,"):"));let[o,c,d,h]=l[e],f="".concat(e.toString().padEnd(3)," - ").concat((4*e).toString().padEnd(4),":   ").concat(o.toString().padStart(3),", ").concat(c.toString().padStart(3),", ").concat(d.toString().padStart(3),", ").concat(h.toString().padStart(3));i>=u&&(f+="     ".concat(t.symbols[o]).concat(t.symbols[c]).concat(t.symbols[d]).concat(t.symbols[h])),s.push("  "+f)}return s.join("\n")}(this.atlas,this.data.array,this.data.strideByteSize,this.options.lineCount,this.options.lineLength,t,e)}constructor(t){let e=new c,n={...h,...t},r=new i.Vector2(n.textSize*n.lineLength*n.charSize.x,n.textSize*n.lineCount*n.charSize.y),a=new i.PlaneGeometry(r.width,r.height),l=new d(e.symbols,n.textCount,n.lineCount,n.lineLength),s=new i.DataTexture(l.array,l.textureSize.width,l.textureSize.height,i.RGBAFormat,i.UnsignedByteType);s.needsUpdate=!0;let u=new i.MeshBasicMaterial({map:e.texture,transparent:!0,alphaTest:.5,side:i.DoubleSide});u.name="TextHelperMaterial",u.onBeforeCompile=t=>o.b.with(t).uniforms({uOrientation:{value:n.orientation},uPlaneSize:{value:r},uCharSize:{value:n.charSize},uLineLength:{value:n.lineLength},uLineCount:{value:n.lineCount},uAtlasCharGrid:{value:e.charGrid},uDataStrideHeader:{value:l.strideHeaderByteSize},uDataStride:{value:l.strideByteSize/4},uDataTexture:{value:s},uDataTextureSize:{value:l.textureSize},uBoxBorderWidth:{value:0}}).varying({vInstanceId:"float",vTextColor:"vec4",vBackgroundColor:"vec4",vCurrentLineCount:"float"}).top("\n        vec4 getData4(int instanceId, int offset) {\n          int width = int(uDataTextureSize.x);\n          int index = instanceId * int(uDataStride) + offset;\n          int dataY = index / width;\n          int dataX = index - dataY * width;\n          return texelFetch(uDataTexture, ivec2(dataX, dataY), 0);\n        }\n        vec4 getData4(float instanceId, int offset) {\n          return getData4(int(instanceId), offset);\n        }\n          \n        vec2 getCharOffset(float instanceId, float charIndex) {\n          int p = int(uDataStrideHeader + charIndex);\n          int q = p / 4;\n          int r = p - q * 4; // p % 4;\n          vec4 charIndexes = getData4(instanceId, q);\n          float i = charIndexes[r] * 255.0;\n          float x = mod(i, uAtlasCharGrid.x);\n          float y = floor(i / uAtlasCharGrid.x);\n          return vec2(x, uAtlasCharGrid.y - y - 1.0) / uAtlasCharGrid;\n        }\n        vec2 getCharOffset(float instanceId, float line, float char) {\n          // return vec2(line * 82.0 + char, 0.0) / uAtlasCharGrid;\n          return getCharOffset(instanceId, line * uLineLength + char);\n        }\n      ").vertex.replace("project_vertex","\n        vec4 infoTexel = getData4(gl_InstanceID, 0);\n        vCurrentLineCount = infoTexel.r * 255.0;\n\n        vTextColor = getData4(gl_InstanceID, 1);\n        vBackgroundColor = getData4(gl_InstanceID, 2);\n\n        vec4 sizeBytes = getData4(gl_InstanceID, 3) * 255.0;\n        uint encoded =\n          uint(sizeBytes.x) << 24 |\n          uint(sizeBytes.y) << 16 |\n          uint(sizeBytes.z) << 8  |\n          uint(sizeBytes.w);\n        float size = uintBitsToFloat(encoded);\n\n        vec4 mvPosition = vec4(transformed * size, 1.0);\n\n        mat4 localMatrix = instanceMatrix;\n\n        if (uOrientation == 1.0) {\n          mat3 v = mat3(viewMatrix);\n          v = inverse(v);\n          localMatrix = mat4(v);\n          localMatrix[3] = vec4(instanceMatrix[3].xyz, 1.0);\n        }\n\n        mvPosition = viewMatrix * modelMatrix * localMatrix * mvPosition;\n\n        gl_Position = projectionMatrix * mvPosition;\n\n        vInstanceId = float(gl_InstanceID);\n      ").fragment.top("\n        float sdBox(in vec2 p, in vec2 b) {\n          vec2 d = abs(p) - b;\n          return length(max(d, 0.0)) + min(max(d.x, d.y), 0.0);\n        }\n\n        vec4 getCharColor() {\n          vec2 uv = vMapUv * vec2(uLineLength, uLineCount);\n\n          uv.y += (uLineCount - vCurrentLineCount) * 0.5;\n          float lineIndex = floor((uLineCount - uv.y));\n\n          if (lineIndex < 0.0 || lineIndex >= vCurrentLineCount)\n            discard;\n\n          float currentLineLength = getData4(vInstanceId, 4 + int(lineIndex)).r * 255.0;\n          // vec2 ddx = dFdx(uv);\n          // vec2 ddy = dFdy(uv);\n          uv.x += (uLineLength - currentLineLength) * -0.5;\n          float charIndex = floor(uv.x);\n\n          if (charIndex < 0.0 || charIndex >= currentLineLength)\n            discard;\n\n          uv = fract(uv);\n          // diffuseColor = vec4(uv, 1.0, 1.0);\n          uv /= uAtlasCharGrid;\n\n          uv += getCharOffset(vInstanceId, lineIndex, charIndex);\n          // float lod = log2(max(length(dFdx(vMapUv)), length(dFdy(vMapUv))));\n          vec4 charColor = textureLod(map, uv, 0.0);\n          // Use textureGrad for better quality, when the square texture will be used\n          // vec4 sampledDiffuseColor = textureGrad(map, uv, ddx, ddy);\n          float char = charColor.r;\n          \n          return vec4(\n            mix(vBackgroundColor.rgb, vTextColor.rgb, charColor.r),\n            mix(vBackgroundColor.a, vTextColor.a, charColor.r));\n        }\n\n        vec4 getCharColorWithBorder() {\n          if (uBoxBorderWidth > 0.0) {\n            vec2 p = (vMapUv - 0.5) * uPlaneSize;\n            float d = sdBox(p, uPlaneSize * 0.5) + uBoxBorderWidth;\n            if (d > 0.0) {\n              return vTextColor;\n            }\n          }\n          return getCharColor();\n        }\n      ").fragment.replace("map_fragment","\n        diffuseColor = getCharColorWithBorder();\n      "),super(a,u,n.textCount),this.textHelperId=f++,this.options=n,this.atlas=e,this.data=l,this.dataTexture=s,this.derived={planeSize:r}}}x.defaultOptions=h,x.Orientation=a,x.Atlas=c,x.Data=d},49635:function(t,e,n){n.d(e,{$:function(){return o},E:function(){return s}});var r=n(85679),a=n(81796);let i=new r.Matrix4;function o(t){return(0,a.Xe)(t,i)}let l=new r.Color;function s(t){return l.set(t)}},28142:function(t,e,n){n.d(e,{T:function(){return u}});let r=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:123456;return(t=(t=(7*t+Math.sqrt(t)+16087*Math.sin(t))%2147483647)<0?t+2147483647:t)>1?2147483647&t:0===t?345678:123456},a=t=>t=2147483647&Math.imul(t,48271),i=t=>(t-1)/2147483646,o=t=>t,l={weightsAreNormalized:!1,indexOffset:0,forbiddenItems:[]};function s(){let t=a(a(r(123456)));function e(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:123456;return"string"==typeof e&&(e=e.split("").reduce((t,e)=>7*t+e.charCodeAt(0),0)),t=a(a(r(e))),h}function n(){return i(t=a(t))}function s(t){switch(t.length){default:return[0,1,o];case 1:return[0,t[0],o];case 2:return[t[0],t[1],o];case 3:return[t[0],t[1],t[2]]}}function u(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let[a,i,o]=s(e);return a+(i-a)*o(n())}function c(){for(var t,e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];let[i,o,{weightsAreNormalized:s,indexOffset:u,forbiddenItems:c}]=function(t){let[e,n=null,r]=t,a={...l,...r};if(Array.isArray(e))return[e,n,a];if("object"==typeof e)return[Object.values(e),n?Object.values(n):null,a];throw Error("pick: unsupported options type")}(r);if(c.length>0){let e=new Set;for(let t of c){let n=i.indexOf(t);n>=0&&e.add(n)}if(i=i.filter((t,n)=>!e.has(n)),o=null!==(t=null==o?void 0:o.filter((t,n)=>!e.has(n)))&&void 0!==t?t:null,0===i.length)throw Error("pick: all items are forbidden")}if(null===o){let t=Math.floor(n()*i.length);return u&&(t+=u,(t%=i.length)<0&&(t+=i.length)),i[t]}if(!s){let t=o.reduce((t,e)=>t+e,0);o=o.map(e=>e/t)}let d=n(),h=0;for(let t=0;t<i.length;t++)if(d<(h+=o[t]))return i[t];throw Error("among: unreachable")}function d(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=n(),a=n(),i=Math.sqrt(-2*Math.log(r)),o=2*Math.PI*a;return[t+e*i*Math.cos(o),t+e*i*Math.sin(o)]}let h={seed:e,seedMax:function(){return 2147483647},reset:function(){return e(123456),h},next:function(){return t=a(t),h},random:n,between:u,around:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let[a=1,i=o]=e,l=2*n();return(l>1?1:-1)*i(l>1?l-1:l)*a},int:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let[a,i,o]=s(e);return a+Math.floor(o(n())*(i-a))},chance:function(t){return n()<t},shuffle:function(t){let{mutate:e=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e&&Array.isArray(t)?t:[...t],a=r.length;for(let t=0;t<a;t++){let e=Math.floor(a*n()),i=r[t];r[t]=r[e],r[e]=i}return r},pick:c,createPicker:function(t){let e=t.map(t=>{let[e]=t;return e}),n=t.map(t=>{let[e,n]=t;return n}),r=n.reduce((t,e)=>t+e,0);for(let[t,e]of n.entries())n[t]=e/r;return()=>c(e,n,{weightsAreNormalized:!0})},vector:function(t,e){let[n=0,r=1]=Array.isArray(e)?e:[null==e?void 0:e.min,null==e?void 0:e.max];for(let e of Object.keys(t))t[e]=u(n,r);return t},unitVector2:function(t){let e=2*Math.PI*n();return t.x=Math.cos(e),t.y=Math.sin(e),t},unitVector3:function(t){let e=n(),r=n(),a=2*Math.PI*e,i=Math.acos(1-2*r);return t.x=Math.sin(i)*Math.cos(a),t.y=Math.sin(i)*Math.sin(a),t.z=Math.cos(i),t},normalVector:function(t){let e=Object.keys(t),n=e.length,r=Math.sqrt(n);for(let a=0;a<n;a+=2){let[i,o]=d();t[e[a]]=i/r,a+1<n&&(t[e[a+1]]=o/r)}return t},unitVector:function(t){let e=Object.keys(t),n=e.length,r=0;for(let a=0;a<n;a+=2){let[i,o]=d();t[e[a]]=i,r+=i*i,a+1<n&&(t[e[a+1]]=o,r+=o*o)}r=Math.sqrt(r);for(let a=0;a<n;a++)t[e[a]]/=r;return t},boxMuller:d};return h}let u=class{constructor(t){Object.assign(this,s().seed(t))}};Object.assign(u,s())}}]);