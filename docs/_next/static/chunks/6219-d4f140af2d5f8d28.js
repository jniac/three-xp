"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6219],{16219:(t,e,r)=>{r.d(e,{n:()=>E});var i,n,a=r(28535),s=r(76999),o=r(57368),l=r(66620),h=r(66066),c=r(15940),d=r(49797),u=r(49303),p=r(29717),f=r(63126),g=r(39787),y=r(95736),m=r(92381),v=r(31107),x=r(21712);let w=new d.PTz,z=new d.Pq0,M=new d.Pq0,b=new d.Pq0,S=new d.Zcv,A=new d.RlV,P=new d.Pq0,C=new d.Pq0;function O(t){w.setFromEuler(t),z.set(1,0,0).applyQuaternion(w),M.set(0,1,0).applyQuaternion(w),b.crossVectors(z,M)}let T=["shift","alt","control","meta"];function D(t,e){return e.every(e=>t["".concat(e,"Key")])}function I(t){return t.split("+").filter(t=>{if(""===t)return!1;let e=T.includes(t);return e||console.warn("Invalid input: ".concat(t)),e})}var _=new WeakMap,V=new WeakMap,B=new WeakSet,k=new WeakSet,F=new WeakSet,q=new WeakSet;class E{get currentVertigo(){return(0,a._)(this,_).secondaryIsActive?(0,a._)(this,_).secondaryVertigo:this.vertigo}get currentDampedVertigo(){return(0,a._)(this,_).secondaryIsActive?(0,a._)(this,_).secondaryDampedVertigo:this.dampedVertigo}get secondaryIsActive(){return(0,h._)(this,k,Y).call(this)}set secondaryIsActive(t){t?(0,h._)(this,F,W).call(this):(0,h._)(this,q,L).call(this)}parsePanInputs(t){this.panInputs=I(t)}parseOrbitInputs(t){this.orbitInputs=I(t)}get destroyed(){return(0,a._)(this,V)}set(t){return this.currentVertigo.set(t),this.currentDampedVertigo.set(t),this}pan(t,e){O(this.currentVertigo.rotation);let r=1/this.currentVertigo.zoom;this.currentVertigo.focus.addScaledVector(z,t*r).addScaledVector(M,e*r),this.focusPlane&&this.currentVertigo===this.vertigo&&((0,m.Fx)(this.focusPlane,S),A.origin.copy(this.currentVertigo.focus),A.direction.copy(b),function(t,e,r){let{x:i,y:n,z:a}=t.origin,{x:s,y:o,z:l}=t.direction,{x:h,y:c,z:d}=e.normal,u=h*s+c*o+d*l;if(1e-6>Math.abs(u))return null;let p=-(i*h+n*c+a*d+e.constant)/u;return null!=r||(r={x:0,y:0,z:0}),r.x=i+s*p,r.y=n+o*p,r.z=a+l*p,r}(A,S,b)&&this.currentVertigo.focus.copy(b))}dolly(t){O(this.currentVertigo.rotation);let e=1/this.currentVertigo.zoom;this.currentVertigo.focus.addScaledVector(b,t*e)}orbit(t,e){this.currentVertigo.rotation.x+=t,this.currentVertigo.rotation.y+=e}rotate(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.orbit(...e)}zoomAt(t,e){this.currentVertigo.update(this.currentDampedVertigo.state.aspect);let r=this.currentVertigo.state.realSize.x,i=this.currentVertigo.state.realSize.y,n=this.currentVertigo.state.realSize.x/(t/this.currentVertigo.zoom),a=this.currentVertigo.state.realSize.y/(t/this.currentVertigo.zoom);O(this.currentVertigo.rotation);let{x:s,y:o}=e;this.currentVertigo.focus.addScaledVector(z,-(.5*(n-r)*s)).addScaledVector(M,-(.5*(a-i)*o)),this.currentVertigo.zoom=t}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;if("string"==typeof t&&(t=document.querySelector(t)),!(t instanceof HTMLElement))throw Error("Invalid element: ".concat(t));return this.element=t,this}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!=(i=this.element)?i:document.body;return!1===this.started&&(this.started=!0,(0,a._)(this,_).startDestroyableInstance.onDestroy((0,h._)(this,B,j).call(this,t))),this}stop(){this.started&&(this.started=!1,(0,a._)(this,_).startDestroyableInstance.destroy(),(0,a._)(this,_).startDestroyableInstance=new g.el)}toggle(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.started;t?this.start():this.stop()}update(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/60,i=(0,f.calculateExponentialDecayLerpRatio)(this.dampingDecayFactor,r);this.vertigo.update(e),(0,a._)(this,_).secondaryExiting?(this.dampedVertigo.lerp(this.vertigo,i),(0,a._)(this,_).secondaryDampedVertigo.lerp(this.vertigo,i),P.setFromMatrixPosition((0,a._)(this,_).secondaryDampedVertigo.state.matrix),C.setFromMatrixPosition(this.dampedVertigo.state.matrix),1e-4>P.distanceToSquared(C)&&(0,h._)(this,q,L).call(this)):this.currentDampedVertigo.lerp(this.currentVertigo,i),this.currentDampedVertigo.apply(t,e)}constructor(t={}){(0,c._)(this,B),(0,c._)(this,k),(0,c._)(this,F),(0,c._)(this,q),(0,s._)(this,_,{writable:!0,value:void 0}),(0,s._)(this,V,{writable:!0,value:void 0}),this.dampingDecayFactor=1e-4,this.vertigo=new v.B,this.dampedVertigo=new v.B,this.focusPlane=null,this.group=new d.YJl,(0,o._)(this,_,{secondaryActivationCount:0,secondaryIsActive:!1,secondaryVertigo:new v.B,secondaryDampedVertigo:new v.B,secondaryExiting:!1,helper:null,startDestroyableInstance:new g.el}),this.inputConfig={wheel:"zoom"},this.actions={togglePerspective:()=>{let t=this.currentVertigo.perspective>.5?0:1;p.X5.tween({target:[this.currentVertigo,"perspective"],to:{perspective:t},duration:1,ease:"inOut3"})},focus:t=>{p.X5.tween({target:this.currentVertigo.focus,to:(0,m.jj)(t),duration:1,ease:"inOut3"})},rotate:(t,e,r)=>{let i=new d.PTz().setFromEuler(this.currentVertigo.rotation),n=new d.PTz().setFromEuler(new d.O9p(t,e,r,"YXZ")),a=new d.PTz;p.X5.during({target:[this.currentVertigo,"rotation"],duration:1}).onUpdate(t=>{let{progress:e}=t;a.slerpQuaternions(i,n,p.X5.ease("inOut3")(e)),this.currentVertigo.rotation.setFromQuaternion(a)})},enterSecondary:()=>{(0,h._)(this,F,W).call(this)},exitSecondary:()=>{(0,a._)(this,_).secondaryExiting=!0},toggleSecondary:t=>{null!=t||(t=!(0,h._)(this,k,Y).call(this)),t?this.actions.enterSecondary():this.actions.exitSecondary()},positiveXAlign:()=>{this.actions.rotate(0,Math.PI/2,0)},negativeXAlign:()=>{this.actions.rotate(0,-Math.PI/2,0)},positiveYAlign:()=>{this.actions.rotate(-Math.PI/2,0,0)},negativeYAlign:()=>{this.actions.rotate(Math.PI/2,0,0)},positiveZAlign:()=>{this.actions.rotate(0,0,0)},negativeZAlign:()=>{this.actions.rotate(0,Math.PI,0)}},this.panInputs=[],this.orbitInputs=[],(0,o._)(this,V,!1),this.destroy=()=>{(0,a._)(this,V)||((0,o._)(this,V,!0),(0,a._)(this,_).startDestroyableInstance.destroy())},this.started=!1,this.currentVertigo.set(t),this.currentDampedVertigo.set(t)}}function*j(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!=(n=this.element)?n:document.body;yield function(t,e){for(let[r,i]of Object.entries(e))t.addEventListener(r,i);return{destroy(){for(let[r,i]of Object.entries(e))t.removeEventListener(r,i)}}}(t,{contextmenu:t=>{t.preventDefault()}}),yield(0,y.a)([[{code:"Tab",modifiers:"alt"},t=>{t.event.preventDefault(),this.actions.toggleSecondary()}]]);let e=new d.I9Y;yield(0,u.s)(t,{onChange:r=>{let i=t.getBoundingClientRect(),n=(r.localPosition.x-i.x)/i.width*2-1,a=-((r.localPosition.y-i.y)/i.height*2-1);e.set(n,a)},dragButton:-1,onDrag:t=>{let e=t.altKey?.2:t.shiftKey?5:1;switch(t.button===u.m.Left&&t.touchCount<=1?"orbit":"pan"){case"orbit":D(t,this.orbitInputs)&&this.orbit(-.01*t.delta.y*e,-.01*t.delta.x*e);break;case"pan":D(t,this.panInputs)&&this.pan(-.025*t.delta.x*e,.025*t.delta.y*e)}},wheelPreventDefault:!0,onWheel:t=>{switch(this.inputConfig.wheel){case"zoom":{let r=this.currentVertigo.zoom*(1-.001*t.delta.y);t.event.altKey?t.event.shiftKey?this.currentVertigo.perspective*=1-.001*t.delta.y:this.zoomAt(r,e):this.zoomAt(r,{x:0,y:0});break}case"dolly":this.dolly(.01*t.delta.y)}}})}function Y(){return(0,a._)(this,_).secondaryIsActive&&!1===(0,a._)(this,_).secondaryExiting}function W(){if((0,a._)(this,_).secondaryExiting=!1,!(0,a._)(this,_).secondaryIsActive){(0,a._)(this,_).secondaryIsActive=!0,(0,a._)(this,_).secondaryDampedVertigo.copy(this.dampedVertigo);let t=new x.T(this.vertigo,{color:"red"});this.group.add(t),(0,a._)(this,_).helper=t,0===(0,a._)(this,_).secondaryActivationCount&&((0,a._)(this,_).secondaryVertigo.copy(this.vertigo),(0,a._)(this,_).secondaryDampedVertigo.copy(this.dampedVertigo)),(0,l._)(this,_).value.secondaryActivationCount++}}function L(){(0,a._)(this,_).secondaryIsActive=!1,(0,a._)(this,_).secondaryExiting=!1,(0,a._)(this,_).helper&&(this.group.remove((0,a._)(this,_).helper),(0,a._)(this,_).helper=null)}},21712:(t,e,r)=>{r.d(e,{T:()=>s});var i=r(49797),n=r(50926),a=r(87381);class s extends i.YJl{static createParts(t){let e;return{plane:(0,a.mj)(new i.eaF(new i.bdM(1,.25),new i.V9B({color:t.color,alphaMap:null!=e?e:e=(()=>{let t=document.createElement("canvas"),e=t.getContext("2d");t.width=1024,t.height=256,e.fillStyle="white",e.font="200px Fira Code",e.textBaseline="top",e.fillText("Vertigo",20,20);let r=new i.gPd(t);return r.needsUpdate=!0,r})(),transparent:!0,side:i.$EB})),t),debugHelper:(0,a.mj)(new n.u,t)}}onTick(){let{vertigo:t,color:e}=this,{x:r,y:i}=t.size,{debugHelper:n,plane:a}=this.parts;if(this.position.copy(t.focus),this.rotation.copy(t.rotation),a.position.set(-r/2+.5+.1,i/2-.125-.1,0),n.clear(),n.rect([-r/2,-i/2,r,i],{color:e}),1!==t.zoom){let a=r/t.zoom,s=i/t.zoom;n.rect([-a/2,-s/2,a,s],{color:e})}let{realSize:s}=this.vertigo.state;n.rect([-s.x/2,-s.y/2,s.x,s.y],{color:e})}constructor(t,{color:e="#ffff00"}={}){super(),this.color=e,this.vertigo=t,this.parts=s.createParts(this)}}},29717:(t,e,r)=>{r.d(e,{X5:()=>B});let i=t=>{let e=typeof t;return"number"===e||"bigint"===e||"boolean"===e||"string"===e};class n{get(t){if(!Array.isArray(t))return i(t)?this._valueMap.get(t):this._objectMap.get(t);{let{_multiValueMap:e,_multiObjectMap:r}=this;for(let n=0,a=t.length;n<a;n++){let s=t[n],o=i(s)?e.get(s):r.get(s);if(o)for(let e of o){let{keyCount:r,valueKeys:n,objectKeys:s,value:o}=e;if(r===a&&t.every(t=>i(t)?n.has(t):s.has(t)))return o}}return}}delete(t){if(Array.isArray(t)){let{_multiValueMap:e,_multiObjectMap:r}=this;for(let n=0,a=t.length;n<a;n++){let s=t[n],o=i(s)?e.get(s):r.get(s);if(o)for(let n of o){let{keyCount:l,valueKeys:h,objectKeys:c}=n;if(l===a&&t.every(t=>i(t)?h.has(t):c.has(t)))return o.delete(n),0===o.size&&(i(s)?e.delete(s):r.delete(s)),!0}}return!1}return i(t)?this._valueMap.delete(t):this._objectMap.delete(t)}set(t,e){if(Array.isArray(t)){if(0===t.length)throw Error("Invalid array length!");let{_multiValueMap:r,_multiObjectMap:n}=this,a=t.length;for(let s=0;s<a;s++){let o=t[s],l=i(o)?r.get(o):n.get(o);if(l)for(let r of l){let{keyCount:n,valueKeys:s,objectKeys:o}=r;if(n===a&&t.every(t=>i(t)?s.has(t):o.has(t))){r.value=e;return}}}let s=new Set,o=new WeakSet;for(let e=0;e<a;e++){let r=t[e];i(r)?s.add(r):o.add(r)}let l={valueKeys:s,objectKeys:o,keyCount:a,value:e},h=t.find(t=>!1===i(t));if(void 0!==h){let t=n.get(h);if(t)t.add(l);else{let t=new Set;t.add(l),n.set(h,t)}}else{let e=t.find(t=>i(t)),n=r.get(e);if(n)n.add(l);else{let t=new Set;t.add(l),r.set(e,t)}}}else i(t)?this._valueMap.set(t,e):this._objectMap.set(t,e)}constructor(){this._valueMap=new Map,this._objectMap=new WeakMap,this._multiValueMap=new Map,this._multiObjectMap=new WeakMap}}var a=r(79285);function s(t){return null!==t&&"object"==typeof t}function o(t){if(Array.isArray(t)){let e=t.length,r=Array(e);for(let i=0;i<e;i++){let e=t[i];r[i]=s(e)?o(e):e}return r}{let e={};for(let r in t){let i=t[r];e[r]=s(i)?o(i):i}return e}}function l(t){return!1===s(t)?t:function t(e){for(let r in e){let i=e[r];if(s(i)&&t(i),r.includes("|")){delete e[r];let t=r.split("|");for(let r=t.length-1;r>=0;r--)e[t[r]]=s(i)?o(i):i}}return e}(function t(e){for(let r in e){let i=e[r];if(s(i)&&t(i),r.includes(".")){delete e[r];let t=r.split(".");for(let e=t.length-1;e>=1;e--)i={[t[e]]:i};e[t[0]]=i;continue}}return e}(o(t)))}var h=r(37197);let c=(t,e,r)=>{let i=1-r,n=r*r;return 3*i*i*r*t+3*i*n*e+n*r},d=function(t,e,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e-4,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;if(r<=n)return 0;if(r>=1-n)return 1;let h=0,d=0,u=0;for(let p=0;p<i;p++){if(Math.abs(h=r-(d=c(t,e,u=(a+s)/2)))<=n)return u;h<0?(s=u,l=d):(a=u,o=d)}return a+(s-a)*(r-o)/(l-o)},u=(t,e,r,i,n,a,s)=>c(e,i,d(t,r,n,a,s));var p=r(40074);let f={linear:p.kY.linear,in1:p.kY.in1,in2:p.kY.in2,in3:p.kY.in3,in4:p.kY.in4,in5:p.kY.in5,in6:p.kY.in6,out1:p.kY.out1,out2:p.kY.out2,out3:p.kY.out3,out4:p.kY.out4,out5:p.kY.out5,out6:p.kY.out6,inOut1:p.kY.inOut1,inOut2:p.kY.inOut2,inOut3:p.kY.inOut3,inOut4:p.kY.inOut4,inOut5:p.kY.inOut5,inOut6:p.kY.inOut6},g=new Map;function y(t){if("function"==typeof t)return t;if(t in f)return f[t];let e=g.get(t);if(e)return e;if(t.startsWith("cubic-bezier(")&&t.endsWith(")")){let[e,r,i,n]=t.slice(13,-1).trim().split(/\s*,\s*/).map(t=>Number.parseFloat(t)),a=t=>u(e,r,i,n,t);return g.set(t,a),a}if(t.startsWith("in(")&&t.endsWith(")")){let e=Number.parseFloat(t.trim().slice(3,-1).trim()),r=t=>p.kY.in(t,e);return g.set(t,r),r}if(t.startsWith("out(")&&t.endsWith(")")){let e=Number.parseFloat(t.trim().slice(4,-1).trim()),r=t=>p.kY.out(t,e);return g.set(t,r),r}if(t.startsWith("inOut(")&&t.endsWith(")")){let[e,r=.5]=t.trim().slice(6,-1).split(/\s*,\s*/).map(t=>Number.parseFloat(t)),i=t=>p.kY.inOut(t,e,r);return g.set(t,i),i}if("elasticInPlace"===t||t.startsWith("elasticInPlace(")&&t.endsWith(")")){let[e,r]=t.trim().slice(15,-1).split(/\s*,\s*/).map(t=>Number.parseFloat(t)),i=t=>h.$p.elastic(t,e,r);return g.set(t,i),i}throw Error('Invalid argument for Animation.ease(): "'.concat(t,'"'))}class m{add(t,e){var r;(null!=(r=this.map.get(t))?r:(t=>{let e=new Set;return this.map.set(t,e),e})(t)).add(e)}clear(t){var e;null==(e=this.map.get(t))||e.clear()}get(t){var e,r;return null!=(r=null==(e=this.map.get(t))?void 0:e[Symbol.iterator]())?r:m.empty}constructor(){this.map=new Map}}m.empty=[][Symbol.iterator]();let v=new m,x=new m,w=new n,z=0;class M{get progressOld(){return this.timeOld/this.duration}get complete(){return 1===this.progress}get delayed(){return this.unclampedTime<0}get deltaTime(){return this.time-this.timeOld}get direction(){return this.progress>=this.progressOld?"forward":"backward"}onUpdate(t){return v.add(this.id,t),this}onStart(t){return this.onUpdate(e=>{let{progress:r,progressOld:i}=e;r>0&&0===i&&t(this)})}onComplete(t){return this.onUpdate(()=>{1===this.progress&&t(this)})}onThreshold(t,e){let{threshold:r=.5,use:i="progress",direction:n="both",mode:a="reach"}=t;return"time"===i&&(r/=this.duration),this.onUpdate(t=>{let{progress:i,progressOld:s}=t;if("both"===n||this.direction===n){let t="reach"===a?i>=r&&s<r:i>r&&s<=r,n="reach"===a?i<=r&&s>r:i<r&&s>=r;(t||n)&&e(this)}})}onProgressPass(t,e){return this.onThreshold({threshold:t,use:"progress",mode:"pass"},e)}onProgressReach(t,e){return this.onThreshold({threshold:t,use:"progress",mode:"reach"},e)}onTimePass(t,e){return this.onThreshold({threshold:t,use:"time",mode:"pass"},e)}onTimeReach(t,e){return this.onThreshold({threshold:t,use:"time",mode:"reach"},e)}onPass(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.onProgressPass(...e)}onReach(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.onProgressReach(...e)}onDestroy(t){return x.add(this.id,t),this}requestDestroy(){this.destroyHasBeenRequested=!0}set(){let{paused:t,time:e,progress:r,timeScale:i,delay:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0!==r&&Number.isFinite(r)&&(e=r*this.duration),void 0!==e&&Number.isFinite(e)&&(this.unclampedTime=e),void 0!==t&&(this.paused=t),void 0!==i&&(this.timeScale=i),void 0!==n&&this.applyDelay(n),this}applyDelay(t){return this.timeScale>0?this.unclampedTime=-t:this.unclampedTime=this.duration+t,this}pause(t){return"number"==typeof t&&(t={time:t}),this.set({...t,paused:!0})}play(t){return"number"==typeof t&&(t={time:t}),this.set({...t,paused:!1})}reverse(t){return"number"==typeof t&&(t={time:t}),this.set({...t,timeScale:-this.timeScale})}didPassAbove(t){let{time:e,progress:r}=t;return void 0!==e?this.timeOld<e&&this.time>=e:void 0!==r&&this.progressOld<r&&this.progress>=r}didPassBelow(t){let{time:e,progress:r}=t;return void 0!==e?this.timeOld>=e&&this.time<e:void 0!==r&&this.progressOld>=r&&this.progress<r}didPass(t){return this.didPassAbove(t)||this.didPassBelow(t)}constructor(t,e,r,i,n,a){var s=this;this.id=z++,this.destroyHasBeenRequested=!1,this.paused=!1,this.time=0,this.timeOld=0,this.progress=0,this.destroy=()=>this.requestDestroy(),this.progressLerp=function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"linear";return t+(e-t)*y(r)(s.progress)},this.duration=t,this.delay=e,this.frame=0,this.timeScale=r,this.unclampedTimeOld=this.unclampedTime=-e,this.target=i,this.autoDestroy=n,this.prerun=null!=a?a:e>0}}let b=[],S=t=>{for(let e of x.get(t.id))e(t);v.clear(t.id),x.clear(t.id),function(t){let{target:e}=t;if(void 0!==e){let r=w.get(e);r&&(r.delete(t),0===r.size&&w.delete(e))}}(t)},A=t=>{let e=w.get(t);if(e)for(let t of e)t.requestDestroy()},P=(t,e)=>{!1===T&&D();let{target:r}=e;return void 0!==r&&(t&&A(r),!function(t){let{target:e}=t;if(void 0!==e){let r=w.get(e);void 0===r&&(r=new Set,w.set(e,r)),r.add(t)}}(e)),b.push(e),e},C=t=>{for(let e=0,r=b.length;e<r;e++){let r=b[e];if(r.destroyHasBeenRequested)continue;!1===r.paused&&(r.timeScale>0?r.unclampedTime<r.duration:r.unclampedTime>0)&&(r.unclampedTime+=t*r.timeScale),r.timeOld=r.time,r.time=(0,a.clamp)(r.unclampedTime,0,r.duration);let i=0===r.duration;r.progress=i?1:Number.isFinite(r.duration)?(0,a.saturate)(r.time/r.duration):0;let n=r.unclampedTime!==r.unclampedTimeOld&&(r.unclampedTimeOld>=0&&r.unclampedTimeOld<=r.duration||r.unclampedTime>=0&&r.unclampedTime<=r.duration),s=0===r.frame&&r.prerun;if(n||s||i)for(let t of v.get(r.id)){switch(t(r)){case"pause":r.pause();break;case"destroy":r.requestDestroy()}r.frame++}r.unclampedTimeOld=r.unclampedTime}let e=new Set;for(let t of(b=b.filter(t=>!t.destroyHasBeenRequested&&(!t.autoDestroy||!t.complete)||(e.add(t),!1)),e))S(t)},O=-1,T=!1;function D(){T=!0;let t=window.performance.now(),e=r=>{O=window.requestAnimationFrame(e),C((-t+(t=r))/1e3)};O=window.requestAnimationFrame(e)}let I={duration:1,delay:0,timeScale:1,target:void 0,clear:!1,autoDestroy:!0,prerun:void 0},_={...function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return Object.fromEntries(Object.entries(t).filter(t=>{let[e]=t;return!r.includes(e)}))}(I,"target"),ease:"inOut2"};class V extends M{add(t){for(let e of Array.isArray(t)?t:[t])!function t(e,r,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(Array.isArray(e)){for(let a=0,s=e.length;a<s;a++)t(e[a],r,i,n);return n}if(!1===s(e)||!1===s(null!=r?r:i))return n;for(let a in null!=r?r:i){let o=(null!=r?r:e)[a],l=(null!=i?i:e)[a];if(s(l))if(!1===s(o))throw Error("Tween from/to pair association error!");else t(e[a],r&&o,i&&l,n);else n.push({from:o,to:l,key:a,target:e})}return n}(e.target,l(e.from),l(e.to),this.entries);return this}constructor(...t){super(...t),this.entries=[]}}let B={remap:function(t,e,r,i,n){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"inOut2",s=(t-e)/(r-e);return i+(n-i)*("function"==typeof a?a:y(a))(s<0?0:s>1?1:s)},ease:y,lerp:a.lerp,during:function(t){"number"==typeof t&&(t={duration:t});let{clear:e,duration:r,delay:i,timeScale:n,target:a,autoDestroy:s,prerun:o}={...I,...t};return P(e,new M(r,i,n,a,s,o))},tween:function(t){let{clear:e,duration:r,delay:i,timeScale:n,ease:a,autoDestroy:s,prerun:o,target:l,from:h,to:c}={..._,...t},d=P(e,new V(r,i,n,l,s,o));(null!=h?h:c)&&d.add({target:l,from:h,to:c});let u="function"==typeof a?a:y(a);return d.onUpdate(t=>{let{progress:e}=t,r=u(e),{entries:i}=d;for(let t=0,e=i.length;t<e;t++){let{target:e,key:n,from:a,to:s}=i[t];e[n]=a+(s-a)*r}}),d},existing:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let i=[];for(let t of e){let e=w.get(t);e&&i.push(...e)}return i},clear:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];for(let t of e)A(t);return B},safewords:["pause","destroy"],core:{instancesCount:()=>b.length,instances:()=>[...b],updateInstances:C,startAnimationLoop:D,stopAnimationLoop:function(){window.cancelAnimationFrame(O)}}}},31107:(t,e,r)=>{r.d(e,{B:()=>o});var i=r(49797),n=r(28340),a=r(92381);let s={fov:"45deg",perspective:1,zoom:1,focus:[0,0,0],screenOffset:[0,0,0],size:[4,4],before:1e3,after:1e3,rotation:[0,0,0,"YXZ"],frame:"contain",allowOrthographic:!0,fovEpsilon:"1.5deg",nearMin:.1};class o{static get defaultRotationOrder(){return"YXZ"}static get default(){return l}set(t){let{perspective:e,fov:r,zoom:i,focus:n,screenOffset:s,size:o,before:l,after:h,rotation:c,frame:d,allowOrthographic:u,fovEpsilon:p,nearMin:f}=t;return void 0!==e&&(this.perspective=e),void 0!==r&&(this.fov=(0,a.ey)(r)),void 0!==i&&(this.zoom=i),void 0!==n&&(0,a.jj)(n,this.focus),void 0!==s&&(0,a.jj)(s,this.screenOffset),void 0!==o&&(0,a.wX)(o,this.size),void 0!==l&&(this.before=l),void 0!==h&&(this.after=h),void 0!==c&&(0,a.if)(c,{defaultOrder:"YXZ"},this.rotation),void 0!==d&&(this.frame="string"==typeof d?+("cover"!==d):d),void 0!==u&&(this.allowOrthographic=u),void 0!==p&&(this.fovEpsilon=(0,a.ey)(p)),void 0!==f&&(this.nearMin=f),this}copy(t){return this.perspective=t.perspective,this.fov=t.fov,this.zoom=t.zoom,this.focus.copy(t.focus),this.screenOffset.copy(t.screenOffset),this.size.copy(t.size),this.before=t.before,this.after=t.after,this.rotation.copy(t.rotation),this.frame=t.frame,this.allowOrthographic=t.allowOrthographic,this.fovEpsilon=t.fovEpsilon,this.nearMin=t.nearMin,this.update(),this}clone(){return new o().copy(this)}lerpVertigos(t,e,r){this.perspective=t.perspective+(e.perspective-t.perspective)*r,this.fov=t.fov+(e.fov-t.fov)*r;let i=Math.log(t.zoom)/Math.log(.001),n=i+(Math.log(e.zoom)/Math.log(.001)-i)*r;this.zoom=.001**n,this.focus.lerpVectors(t.focus,e.focus,r),this.screenOffset.lerpVectors(t.screenOffset,e.screenOffset,r),this.size.lerpVectors(t.size,e.size,r),this.before=t.before+(e.before-t.before)*r,this.after=t.after+(e.after-t.after)*r;let{_qa:a,_qb:s}=o.shared;return a.setFromEuler(t.rotation),s.setFromEuler(e.rotation),this.rotation.setFromQuaternion(a.slerp(s,r)),this.frame=t.frame+(e.frame-t.frame)*r,this.allowOrthographic=r<.5?t.allowOrthographic:e.allowOrthographic,this.fovEpsilon=t.fovEpsilon+(e.fovEpsilon-t.fovEpsilon)*r,this.nearMin=t.nearMin+(e.nearMin-t.nearMin)*r,this.update(),this}lerp(t,e){return this.lerpVertigos(this,t,e)}ndcToScreen(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return e.x=t.x*this.state.realSize.x*.5,e.y=t.y*this.state.realSize.y*.5,e}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.aspect,e=this.size.x/this.size.y/t,r=e>1?this.frame:1-this.frame,i=this.size.y/this.zoom,n=i*(1+r*(e-1)),a=this.fovEpsilon,s=this.perspective*this.fov;!this.allowOrthographic&&s<a&&(s=a);let l=i/2/Math.tan(s/2),h=s>=a,{matrix:c}=this.state;c.makeRotationFromEuler(this.rotation);let d=c.elements,u=h?l:this.before+this.nearMin,{_v0:p,_v1:f}=o.shared;return p.set(d[8],d[9],d[10]).multiplyScalar(u).add(this.focus),p.addScaledVector(f.set(d[0],d[1],d[2]),-this.screenOffset.x/this.zoom),p.addScaledVector(f.set(d[4],d[5],d[6]),-this.screenOffset.y/this.zoom),p.addScaledVector(f.set(d[8],d[9],d[10]),-this.screenOffset.z/this.zoom),d[12]=p.x,d[13]=p.y,d[14]=p.z,this.state.aspect=t,this.state.isPerspective=h,this.state.distance=l,this.state.fov=s,this.state.realSize.set(n*t,n),this}apply(t,e){this.update(e);let{isPerspective:r,distance:i,fov:n,realSize:{height:a}}=this.state;if(t.matrixAutoUpdate=!1,t.matrix.copy(this.state.matrix),t.updateMatrixWorld(!0),t.matrixAutoUpdate=!0,t.position.setFromMatrixPosition(this.state.matrix),t.quaternion.setFromRotationMatrix(this.state.matrix),t.rotation.setFromQuaternion(t.quaternion,"YXZ"),t.scale.set(1,1,1),t.isPerspectiveCamera=r,t.isOrthographicCamera=!r,r){let r=Math.max(this.nearMin/this.zoom,i-this.before),s=i+this.after,o=a*r/i/2,l=o*e;t.fov=180*n/Math.PI,t.near=r,t.far=s,t.projectionMatrix.makePerspective(-l,l,o,-o,r,s)}else{let r=-this.before,i=this.after+this.before,n=a/2,s=n*e;t.fov=0,t.near=r,t.far=i,t.projectionMatrix.makeOrthographic(-s,s,n,-n,r,i)}return t.projectionMatrixInverse.copy(t.projectionMatrix).invert(),this}toDeclaration(){let t=[(0,a.wz)(this.rotation.x,"deg"),(0,a.wz)(this.rotation.y,"deg"),(0,a.wz)(this.rotation.z,"deg"),this.rotation.order];return{perspective:this.perspective,fov:(0,a.wz)(this.fov,"deg"),zoom:this.zoom,focus:this.focus.toArray(),size:this.size.toArray(),before:this.before,after:this.after,rotation:t,frame:this.frame,allowOrthographic:this.allowOrthographic,fovEpsilon:(0,a.wz)(this.fovEpsilon,"deg"),nearMin:this.nearMin}}get computedNdcScalar(){return console.warn("Vertigo.computedNdcScalar is deprecated. Deprecated. What's the usage?"),new i.I9Y(this.state.realSize.x/this.size.x*this.zoom,this.state.realSize.y/this.size.y*this.zoom)}get computedSize(){return console.warn("Vertigo.computedSize is deprecated, use state.realSize instead."),this.state.realSize}constructor(t){this.focus=new i.Pq0,this.screenOffset=new i.Pq0,this.size=new i.I9Y,this.rotation=new i.O9p,this.state={aspect:0,isPerspective:!0,distance:0,fov:0,realSize:new i.I9Y,matrix:new i.kn4},this.set({...s,...t})}}o.shared={_matrix:new i.kn4,_v0:new i.Pq0,_v1:new i.Pq0,_qa:new i.PTz,_qb:new i.PTz};let l=(0,n.ol)(new o)},37197:(t,e,r)=>{r.d(e,{$p:()=>i});let i={sin:t=>Math.sin(Math.PI*t),cos:t=>.5+.5*Math.cos(2*Math.PI*(t-.5)),pow:(t,e)=>1-Math.abs(2*t-1)**e,iqPower:(t,e,r)=>Math.pow(e+r,e+r)/(Math.pow(e,e)*Math.pow(r,r))*Math.pow(t,e)*Math.pow(1-t,r),unnormalizedElastic:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return Math.sin(2*e*Math.PI*t)*Math.pow(1-t,r)},elastic:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=2/3+.4*(e-1)/e;return(Math.pow(1-1/(4*e),-r)*i+1-i)*Math.sin(2*e*Math.PI*t)*Math.pow(1-t,r)}}},40074:(t,e,r)=>{r.d(e,{kY:()=>o,o8:()=>s,ol:()=>a});let i=t=>Math.max(0,Math.min(1,t)),n=t=>i(t),a=t=>t<0?0:t>1?1:t<.5?2*t*t:1-2*(t=1-t)*t,s=t=>t<0?0:t>1?1:t<.5?8*t*t*t*t:1-8*(t=1-t)*t*t*t,o={linear:n,in:(t,e)=>i(t)**e,in1:n,in2:t=>(t=i(t))*t,in3:t=>(t=i(t))*t*t,in4:t=>(t=i(t))*t*t*t,in5:t=>(t=i(t))*t*t*t*t,in6:t=>(t=i(t))*t*t*t*t*t,out:(t,e)=>1-i(1-t)**e,out1:n,out2:t=>1-(t=i(1-t))*t,out3:t=>1-(t=i(1-t))*t*t,out4:t=>1-(t=i(1-t))*t*t*t,out5:t=>1-(t=i(1-t))*t*t*t*t,out6:t=>1-(t=i(1-t))*t*t*t*t*t,inOut:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return t<0?0:t>1?1:t<r?1/Math.pow(r,e-1)*Math.pow(t,e):1-1/Math.pow(1-r,e-1)*Math.pow(1-t,e)},inOut1:n,inOut2:a,inOut3:t=>t<0?0:t>1?1:t<.5?4*t*t*t:1-4*(t=1-t)*t*t,inOut4:s,inOut5:t=>t<0?0:t>1?1:t<.5?16*t*t*t*t*t:1-16*(t=1-t)*t*t*t*t,inOut6:t=>t<0?0:t>1?1:t<.5?32*t*t*t*t*t*t:1-32*(t=1-t)*t*t*t*t*t,inLinearOut:(t,e,r,i)=>{let n=1e-6>Math.abs(e-1)?1/Math.E:(1/e)**(1/(e-1)),a=1e-6>Math.abs(r-1)?1/Math.E:(1/r)**(1/(r-1)),s=(n+a)/(1-i),o=n**e,l=s-n+o-a+a**r;return t<0?0:t>1?1:i>=1?t:t<n/s?(t*s)**e/l:t>1-a/s?1-((1-t)*s)**r/l:(t*s-n+o)/l},asymmetricalInOut:(t,e,r)=>Math.pow(t,e)/(Math.pow(t,e)+Math.pow(1-t,r))}},50926:(t,e,r)=>{r.d(e,{u:()=>I,w:()=>_});var i=r(49797),n=r(92381),a=r(67840);class s{ensureKeyEntry(t,e,r){let i=this.keyMap.get(t);if(i){if(i.count!==r)throw Error("A key entry already exists with a different count. This is not allowed. Once a key is set, it cannot be changed.");return i}{let i={index:e,count:r};return this.keyMap.set(t,i),i}}applyTransform(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];throw Error("Not implemented!")}clear(){return this.keyMap.clear(),this}constructor(){this.keyMap=new Map,this.transformMatrix=new i.kn4}}var o=r(66066),l=r(15940),h=r(17953),c=r(81074),d=r(6726),u=r(60041);let p=new i.Pq0,f=new i.Pq0,g=new i.Pq0,y=new i.Pq0,m=new i.Pq0,v=new i.Pq0,x=new i.Pq0,w=new i.Q1f,z=new i.kn4;class M{static box(t){let[e,r,i,a,s,o,l,h]=M.boxPoints;if("min"in t||"max"in t){let{min:i=M.boxMinMaxDefaults.min,max:a=M.boxMinMaxDefaults.max}=t;(0,n.jj)(i,e),(0,n.jj)(a,r)}else if("center"in t||"size"in t){let{center:s=M.boxCenterSizeDefaults.center,size:o=M.boxCenterSizeDefaults.size}=t;(0,n.jj)(s,i),(0,n.jj)(o,a).multiplyScalar(.5),e.copy(i).sub(a),r.copy(i).add(a)}else e.copy(M.boxMinMaxDefaults.min),r.copy(M.boxMinMaxDefaults.max);t.inset&&(e.addScalar(t.inset),r.addScalar(-t.inset));let{x:c,y:d,z:u}=e,{x:p,y:f,z:g}=r;return r.set(p,d,u),i.set(p,d,g),a.set(c,d,g),s.set(c,f,u),o.set(p,f,u),l.set(p,f,g),h.set(c,f,g),t.transform&&((0,n.vl)(t.transform,z),e.applyMatrix4(z),r.applyMatrix4(z),i.applyMatrix4(z),a.applyMatrix4(z),s.applyMatrix4(z),o.applyMatrix4(z),l.applyMatrix4(z),h.applyMatrix4(z)),M}}M.boxPoints=[new i.Pq0,new i.Pq0,new i.Pq0,new i.Pq0,new i.Pq0,new i.Pq0,new i.Pq0,new i.Pq0],M.boxDefaults={inset:0,transform:void 0},M.boxMinMaxDefaults={min:new i.Pq0(-.5,-.5,-.5),max:new i.Pq0(.5,.5,.5)},M.boxCenterSizeDefaults={center:new i.Pq0(0,0,0),size:new i.Pq0(1,1,1)};let b={size:.1,proportionalSize:!1,position:"middle",skip:void 0,type:"single",scale:1},S={key:void 0,color:void 0,opacity:1,arrow:!1};var A=new WeakSet;class P extends s{static createParts(){let{nodeMaterial:t=!1,lineCount:e=2e4,defaultColor:r="white",defaultOpacity:n=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=new i.LoY,s={position:new i.THS(new Float32Array(3*e*2),3),color:new i.THS(new Float32Array(3*e*2),3),aOpacity:new i.THS(new Float32Array(2*e),1)};for(let[t,e]of Object.entries(s))a.setAttribute(t,e);let o=t?(()=>{let t=new c.e9u({vertexColors:!0,transparent:!0,depthWrite:!1}),e=(0,h.xIr)(s.aOpacity,"float",1,0);return t.opacityNode=(0,h.PCg)(e),t})():(()=>{let t=new i.mrM({vertexColors:!0,transparent:!0,depthWrite:!1});return t.onBeforeCompile=t=>u.b.with(t).varying({vOpacity:"float"}).vertex.top("\n          attribute float aOpacity;\n        ").vertex.mainAfterAll("\n          vOpacity = aOpacity;\n        ").fragment.after("color_fragment","\n          diffuseColor.a *= vOpacity;\n        "),t})(),l=new i.DXC(a,o);return l.frustumCulled=!1,{count:e,defaults:{color:r,opacity:n},geometry:a,attributes:s,lines:l}}applyTransform(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.parts.geometry.applyMatrix4((0,n.GD)(e))}clear(){return super.clear(),this.state.index=0,this.parts.geometry.setDrawRange(0,0),this}onTop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,{lines:e}=this.parts;return 0!==t?(e.renderOrder=t,e.material.depthTest=!1,e.material.depthWrite=!1):(e.renderOrder=0,e.material.depthTest=!0,e.material.depthWrite=!0),this}segmentsArray(t,e){let{position:r,color:i,aOpacity:n}=this.parts.attributes,{key:a,color:s,opacity:l}={...S,...this.parts.defaults,...e},{r:h,g:c,b:d}=w.set(s),u=t.length/3,z=function(t,e){var r,i;if(!1===e||void 0===e)return new Float32Array;let n=Array.isArray(e)?e:[!0===e?{}:e],a=0;for(let t of n){let e=null!=(r=null==t?void 0:t.type)?r:b.type,n=null!=(i=null==t?void 0:t.position)?i:b.position;a+=(Array.isArray(n)?n.length:1)*("triple"===e?3:"double"===e?2:1)}let s=t.length/3/2,o=new Float32Array(s*a*12),l=0;for(let e=0;e<s;e++){let r=6*e;p.set(t[r+0],t[r+1],t[r+2]),f.set(t[r+3],t[r+4],t[r+5]),g.subVectors(f,p);let i=g.lengthSq();for(let t of n){let{size:e=b.size,proportionalSize:r=b.proportionalSize,position:n=b.position,skip:a=b.skip,type:s=b.type,scale:h=b.scale}=null!=t?t:{};if(void 0!==a){if(!0===a||"less-than-size"===a){if(i<e*e)continue}else if("number"==typeof a&&i<a*a)continue}let c=Math.sqrt(i),d=(r?c:1)*e*h;y.copy(g).divideScalar(c);let u=Math.abs(y.x),w=Math.abs(y.y),z=Math.abs(y.z);for(let t of(u>=z&&w>=z?m.set(y.y,-y.x,0).normalize():w>=u?m.set(y.z,0,-y.x).normalize():m.set(0,y.z,-y.y).normalize(),Array.isArray(n)?n:[n])){let r="triple"===s?3:"double"===s?2:1;for(let i=0;i<r;i++){let n=function(t){if("number"==typeof t)return t;switch(t){case"end":return 1;case"start":return 0;case"middle":return .5;default:throw Error("Invalid arrow position: ".concat(t))}}(t);r>1&&(n+=(i/(r-1)-n)*e/c*.8),v.lerpVectors(p,f,n),v.toArray(o,(4*l+0)*3),x.copy(v).addScaledVector(y,-d).addScaledVector(m,-d).toArray(o,(4*l+1)*3),v.toArray(o,(4*l+2)*3),x.copy(v).addScaledVector(y,-d).addScaledVector(m,d).toArray(o,(4*l+3)*3),l++}}}}return o}(t,null==e?void 0:e.arrow),M=z.length/3,P=u+M,{index:O}=void 0!==a?this.ensureKeyEntry(a,this.state.index,u):this.state;if(O+P>this.parts.count)throw console.log("Overflow Handling Not implemented",O+P,this.parts.count),Error("Overflow Handling Not implemented");this.state.index=Math.max(this.state.index,O+P);{let{transformMatrix:e}=this;for(let a=0;a<u;a++)p.fromArray(t,3*a).applyMatrix4(e).toArray(r.array,(O+a)*3),i.setXYZ(O+a,h,c,d),n.setX(O+a,l)}{let t=O+u;for(let e=0;e<M;e++)p.fromArray(z,3*e).applyMatrix4(this.transformMatrix).toArray(r.array,(t+e)*3),i.setXYZ(t+e,h,c,d),n.setX(t+e,l)}return(0,o._)(this,A,C).call(this),this}segments(t,e){let r=t.length,i=new Float32Array(3*r);for(let e=0;e<r;e++){let{x:r,y:a,z:s}=(0,n.jj)(t[e],p),o=3*e;i[o+0]=r,i[o+1]=a,i[o+2]=s}return this.segmentsArray(i,e)}line(t,e,r){return this.segments([t,e],r)}axes(t){let{size:e=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{x:r,y:i,z:a}=(0,n.jj)(t,p);return this.segmentsArray(new Float32Array([r,i,a,r+e,i,a]),{color:"#ff0033"}).segmentsArray(new Float32Array([r,i,a,r,i+e,a]),{color:"#00ff33"}).segmentsArray(new Float32Array([r,i,a,r,i,a+e]),{color:"#0033ff"})}polyline(t,e){if(t.length<2)return this;let r=Array((t.length-1)*2);for(let e=1;e<t.length;e++)r[2*e-2]=t[e-1],r[2*e-1]=t[e];return this.segments(r,e)}polygon(t,e){return t.length<2||(this.polyline(t,e),this.line(t[t.length-1],t[0],e)),this}box(t,e){let[r,i,n,a,s,o,l,h]=M.box(t).boxPoints;return this.segmentsArray(new Float32Array([r.x,r.y,r.z,i.x,i.y,i.z,i.x,i.y,i.z,n.x,n.y,n.z,n.x,n.y,n.z,a.x,a.y,a.z,a.x,a.y,a.z,r.x,r.y,r.z,s.x,s.y,s.z,o.x,o.y,o.z,o.x,o.y,o.z,l.x,l.y,l.z,l.x,l.y,l.z,h.x,h.y,h.z,h.x,h.y,h.z,s.x,s.y,s.z,r.x,r.y,r.z,s.x,s.y,s.z,i.x,i.y,i.z,o.x,o.y,o.z,n.x,n.y,n.z,l.x,l.y,l.z,a.x,a.y,a.z,h.x,h.y,h.z]),e)}rect(t,e){let{minX:r,minY:i,maxX:n,maxY:a}=d.M_.from(t),{inset:s}={...P.rectDefaultOptions,...e};return r+=s,i+=s,n-=s,a-=s,this.segments([{x:r,y:i,z:0},{x:n,y:i,z:0},{x:n,y:i,z:0},{x:n,y:a,z:0},{x:n,y:a,z:0},{x:r,y:a,z:0},{x:r,y:a,z:0},{x:r,y:i,z:0}],e)}circle(){let{center:t=0,axis:e="z",radius:r=1,quality:i="medium",segments:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;null!=a||(a=P.circleQualityPresets[i]);let{x:o,y:l,z:h}=(0,n.jj)(t,p);(0,n.jj)(e,p).normalize(),f.set(p.y,p.z,p.x).cross(p).normalize(),g.crossVectors(p,f);let c=new Float32Array(3*a*2);for(let t=0;t<a;t++){let e=t/a*Math.PI*2,i=(t+1)/a*Math.PI*2,n=Math.cos(e)*r,s=Math.sin(e)*r,d=Math.cos(i)*r,u=Math.sin(i)*r,p=6*t;c[p+0]=o+n*f.x+s*g.x,c[p+1]=l+n*f.y+s*g.y,c[p+2]=h+n*f.z+s*g.z,c[p+3]=o+d*f.x+u*g.x,c[p+4]=l+d*f.y+u*g.y,c[p+5]=h+d*f.z+u*g.z}return this.segmentsArray(c,s),this}regularGrid(t){let{color:e,opacity:r,plane:i,size:n,subdivisions:a}={...P.regularGridDefaults,...t},s=a.length,l=a.map((t,e)=>a.slice(e).reduce((t,e)=>t*e,1)),h=l[0],c=new Float32Array((h+1)*12),d=new Float32Array((h+1)*12).fill(1),u=new Float32Array((h+1)*4).fill(1),p=Array.isArray(e)?e:[e],f=a.map((t,e)=>{let{r,g:i,b:n}=w.set(p[Math.min(e,p.length-1)]);return[r,i,n]}),g=Array.isArray(r)?r:[r],y=a.map((t,e)=>g[Math.min(e,g.length-1)]);for(let t=0;t<=h;t++){let e=s-1;for(;t%l[e]==0&&!(--e<=0););let[r,i,a]=f[e],o=y[e],p=t/h*n,g=12*t;c[g+0]=-n/2,c[g+1]=-n/2+p,c[g+2]=0,c[g+3]=n/2,c[g+4]=-n/2+p,c[g+5]=0,c[g+6]=-n/2+p,c[g+7]=-n/2,c[g+8]=0,c[g+9]=-n/2+p,c[g+10]=n/2,c[g+11]=0,d[g+0]=r,d[g+1]=i,d[g+2]=a,d[g+3]=r,d[g+4]=i,d[g+5]=a,d[g+6]=r,d[g+7]=i,d[g+8]=a,d[g+9]=r,d[g+10]=i,d[g+11]=a;let m=4*t;u[m+0]=o,u[m+1]=o,u[m+2]=o,u[m+3]=o}if("xz"===i)for(let t=0;t<c.length;t+=3)c[t+2]=c[t+1],c[t+1]=0;else if("yz"===i)for(let t=0;t<c.length;t+=3)c[t+2]=c[t+1],c[t+1]=c[t+0],c[t+0]=0;let{index:m}=this.state;return this.parts.attributes.position.array.set(c,3*m),this.parts.attributes.color.array.set(d,3*m),this.parts.attributes.aOpacity.array.set(u,m),this.state.index+=(h+1)*4,(0,o._)(this,A,C).call(this),this}constructor(t){super(),(0,l._)(this,A),this.state={index:0},this.parts=P.createParts(t)}}function C(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(let t of(this.parts.geometry.setDrawRange(0,this.state.index),Object.values(this.parts.attributes)))t.needsUpdate=!0;if(this.state.index>2*this.parts.count)throw Error("Not implemented!");if(t)for(let t of Object.values(this.parts.attributes))t.array.some(t=>isNaN(t))&&console.log(t.array.findIndex(t=>isNaN(t)))}P.rectDefaultOptions={inset:0},P.circleQualityPresets={low:18,medium:36,high:64,ultra:256},P.regularGridDefaults={plane:"xy",size:100,subdivisions:[10,2,5],opacity:[.2,.05,.01],color:"white"};class O extends s{static createParts(){let{pointCount:t=1e4}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new i.LoY,r={position:new i.THS(new Float32Array(3*t),3),color:new i.THS(new Float32Array(3*t),3),aScale:new i.THS(new Float32Array(t),1),aShape:new i.THS(new Float32Array(t),1)};for(let[t,i]of Object.entries(r))e.setAttribute(t,i);let n=new i.BH$({vertexColors:!0});n.onBeforeCompile=t=>u.b.with(t).varying({vShape:"float"}).vertex.top("\n        attribute float aScale;\n        attribute float aShape;\n      ").vertex.mainAfterAll("\n        gl_PointSize *= aScale;\n        vShape = aShape;\n      ").fragment.top("\n        float sdBox(in vec2 p, in vec2 b) {\n          vec2 d = abs(p) - b;\n          return length(max(d, 0.0)) + min(max(d.x, d.y), 0.0);\n        }\n      ").fragment.after("color_fragment","\n        float regular = .2;\n        float thin = .1;\n        float ultraThin = .033;\n\n        if (vShape == ".concat(O.shapes.circle,".0) {\n          float d = distance(gl_PointCoord * 2.0, vec2(1.0));\n          if (d > 1.0) discard;\n        }\n\n        if (vShape == ").concat(O.shapes.ring,".0) {\n          float d = distance(gl_PointCoord * 2.0, vec2(1.0));\n          if (d < 0.8 || d > 1.0) discard;\n        }\n\n        if (vShape == ").concat(O.shapes["ring-thin"],".0) {\n          float d = distance(gl_PointCoord * 2.0, vec2(1.0));\n          if (d < 0.9 || d > 1.0) discard;\n        }\n\n        else if (vShape == ").concat(O.shapes.plus,".0) {\n          float d0 = sdBox(gl_PointCoord * 2.0 - 1.0, vec2(1.0, regular));\n          float d1 = sdBox(gl_PointCoord * 2.0 - 1.0, vec2(regular, 1.0));\n          if (d0 > 0.0 && d1 > 0.0) discard;\n        }\n\n        else if (vShape == ").concat(O.shapes["plus-thin"],".0) {\n          float d0 = sdBox(gl_PointCoord * 2.0 - 1.0, vec2(1.0, thin));\n          float d1 = sdBox(gl_PointCoord * 2.0 - 1.0, vec2(thin, 1.0));\n          if (d0 > 0.0 && d1 > 0.0) discard;\n        }\n\n        else if (vShape == ").concat(O.shapes["plus-ultra-thin"],".0) {\n          float d0 = sdBox(gl_PointCoord * 2.0 - 1.0, vec2(1.0, ultraThin));\n          float d1 = sdBox(gl_PointCoord * 2.0 - 1.0, vec2(ultraThin, 1.0));\n          if (d0 > 0.0 && d1 > 0.0) discard;\n        }\n\n        else if (vShape == ").concat(O.shapes.x,".0) {\n          vec2 p = gl_PointCoord * 2.0 - 1.0;\n          float c = 0.70710678;\n          p = mat2(c, -c, c, c) * p;\n          float d0 = sdBox(p, vec2(1.0, regular));\n          float d1 = sdBox(p, vec2(regular, 1.0));\n          if (d0 > 0.0 && d1 > 0.0) discard;\n        }\n\n        else if (vShape == ").concat(O.shapes["x-thin"],".0) {\n          vec2 p = gl_PointCoord * 2.0 - 1.0;\n          float c = 0.70710678;\n          p = mat2(c, -c, c, c) * p;\n          float d0 = sdBox(p, vec2(1.0, thin));\n          float d1 = sdBox(p, vec2(thin, 1.0));\n          if (d0 > 0.0 && d1 > 0.0) discard;\n        }\n\n        else if (vShape == ").concat(O.shapes["x-ultra-thin"],".0) {\n          vec2 p = gl_PointCoord * 2.0 - 1.0;\n          float c = 0.70710678;\n          p = mat2(c, -c, c, c) * p;\n          float d0 = sdBox(p, vec2(1.0, ultraThin));\n          float d1 = sdBox(p, vec2(ultraThin, 1.0));\n          if (d0 > 0.0 && d1 > 0.0) discard;\n        }\n\n        // diffuseColor.rgb *= vec3(gl_PointCoord, 1.0);\n      "));let a=new i.ONl(e,n);return a.frustumCulled=!1,{count:t,geometry:e,attributes:r,points:a}}applyTransform(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.parts.geometry.applyMatrix4((0,n.GD)(e))}clear(){return super.clear(),this.state.index=0,this.parts.geometry.setDrawRange(0,0),this}onTop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,{points:e}=this.parts;return 0!==t?(e.renderOrder=t,e.material.depthTest=!1,e.material.depthWrite=!1,e.material.transparent=!0):(e.renderOrder=0,e.material.depthTest=!0,e.material.depthWrite=!0,e.material.transparent=!1),this}points(t){let{key:e,size:r=.1,scale:i=1,color:a="white",shape:s="square"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{transformMatrix:o}=this,l=void 0!==e,h=t.length,{index:c}=l?this.ensureKeyEntry(e,this.state.index,h):this.state,{position:d,color:u,aScale:f,aShape:g}=this.parts.attributes,{r:y,g:m,b:v}=w.set(a),x=i*r,z=O.shapes[s];for(let e=0;e<h;e++){let{x:r,y:i,z:a}=(0,n.jj)(t[e],p).applyMatrix4(o),s=c+e;d.setXYZ(s,r,i,a),u.setXYZ(s,y,m,v),f.setX(s,x),g.setX(s,z)}for(let t of(this.state.index=l?Math.max(this.state.index,c+h):c+h,this.parts.geometry.setDrawRange(0,this.state.index),Object.values(this.parts.attributes)))t.needsUpdate=!0;if(this.state.index>this.parts.count)throw Error("Overflow Handling Not implemented");return this}box(t,e){let{boxPoints:r}=M.box(t);return this.points(r,e)}point(t,e){return this.points([t],e)}constructor(t){super(),this.state={index:0},this.parts=O.createParts(t)}}O.shapes=(()=>{let t=0;return{square:t++,circle:t++,ring:t++,"ring-thin":t++,plus:t++,"plus-thin":t++,"plus-ultra-thin":t++,x:t++,"x-thin":t++,"x-ultra-thin":t++}})();class T extends s{static createParts(t){let e=new a.w({textCount:2e3,...t});return{count:e.count,textHelper:e}}applyTransform(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.parts.textHelper.applyTransform(...e)}clear(){return this.state.index=0,this.parts.textHelper.clearAllText(),this}onTop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return this.parts.textHelper.onTop(t),this}texts(t,e){let r=this.state.index,{texts:i,...a}={...T.textDefaults,...e},s="function"==typeof i?i:t=>i[t%i.length],o=0;for(let e of t){let{x:t,y:i,z:l}=(0,n.jj)(e,p);this.parts.textHelper.setTextAt(r,s(o),{...a,x:t,y:i,z:l}),r++,o++}return this.state.index=r,this}text(t,e,r){return this.texts([t],{...r,texts:[e]})}textAt(t,e,r){return this.parts.textHelper.setTextAt(t,e,{...r}),this}constructor(t){super(),this.state={index:0},this.parts=T.createParts(t)}}T.textDefaults={texts:t=>t.toString()};let D={color:void 0,size:.1,shape:"square",scale:1};class I extends i.YJl{static createParts(t,e){let{nodeMaterial:r}=null!=e?e:{},i=new O(null==e?void 0:e.points);t.add(i.parts.points);let n=new P({nodeMaterial:r,...null==e?void 0:e.lines});t.add(n.parts.lines);let a=new T({nodeMaterial:r,...null==e?void 0:e.texts});return t.add(a.parts.textHelper),{pointsManager:i,linesManager:n,textsManager:a}}points(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.pointsManager.points(...e),this}point(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.pointsManager.point(...e),this}segments(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.linesManager.segments(...e),this}line(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.linesManager.line(...e),this}axes(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.linesManager.axes(...e),this}polyline(t,e){return this.parts.linesManager.polyline(t,e),(null==e?void 0:e.points)&&this.points(t,{...D,color:e.color,...!0===e.points?{}:e.points}),this}polylines(t,e){for(let r of t)this.polyline(r,e);return this}polygon(t,e){return this.parts.linesManager.polygon(t,e),(null==e?void 0:e.points)&&this.points(t,{...D,color:e.color,...!0===e.points?{}:e.points}),this}polygons(t,e){for(let r of t)this.polygon(r,e);return this}box(t,e){return this.parts.linesManager.box(t,e),(null==e?void 0:e.points)&&this.parts.pointsManager.box(t,{...D,color:e.color,...!0===e.points?{}:e.points}),this}circle(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.linesManager.circle(...e),this}rect(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.linesManager.rect(...e),this}regularGrid(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.linesManager.regularGrid(...e),this}texts(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.textsManager.texts(...e),this}text(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.textsManager.text(...e),this}textAt(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.textsManager.textAt(...e),this}applyTransform(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.parts.pointsManager.applyTransform(...e),this.parts.linesManager.applyTransform(...e),this.parts.textsManager.applyTransform(...e),this}clear(){return this.parts.pointsManager.clear(),this.parts.linesManager.clear(),this.parts.textsManager.clear(),this}onTop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return this.renderOrder=t,this.parts.pointsManager.onTop(t),this.parts.linesManager.onTop(t),this.parts.textsManager.onTop(t),this}globalExpose(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"debugHelper";return Object.assign(globalThis,{[t]:this}),this}addTo(t){return t?t.add(this):this.removeFromParent(),this}constructor(t){super(),this.userData={helper:!0},this.parts=I.createParts(this,t)}}let _=new I},66851:(t,e,r)=>{r.d(e,{_:()=>l,w:()=>s});var i=r(49797),n=r(92381);let a=new i.kn4;function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;return(0,n.vl)(t,e)}let o=new i.Q1f;function l(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;return e.set(t)}},67840:(t,e,r)=>{r.d(e,{w:()=>y});var i=r(49797),n=r(92381),a=r(66851),s=r(79285);function o(){return[...new Set(["�",..."abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",..."\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff",..."0123456789",..." @#.,!?\xbf:;-+*/=%&|()[]{}<>$'’\""])].join("")}class l{constructor(){let t=o(),e=new i.I9Y(16,24),r=e.x/e.y,n=function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new i.I9Y;return r.x=Math.ceil(Math.sqrt(t/e)),r.y=Math.ceil(t/r.x),r}(t.length,r),a=e.clone().multiplyScalar(3),l=(0,s.ceilPowerOfTwo)(a.x*n.x),h=(0,s.ceilPowerOfTwo)(a.y*n.y),c=l/(a.x*n.x),d=h/(a.y*n.y);if("undefined"==typeof document){this.canvas=null,this.texture=null,this.symbols="",this.charGrid=new i.I9Y;return}let u=document.createElement("canvas");u.width=l,u.height=h;let p=u.getContext("2d");p.font="".concat(.8*a.y,"px monospace"),p.textBaseline="top",p.fillStyle="black",p.fillRect(0,0,l,h),p.fillStyle="white",p.transform(c,0,0,d,0,0);for(let e=0;e<t.length;e++){let r=Math.floor(e/n.x),i=(e-r*n.x+.12)*a.x,s=a.y*(r+.19999999999999996);p.fillText(t[e],i,s)}this.canvas=u,this.texture=new i.GOR(u),this.symbols=t,this.charGrid=n}}l.getDefaultSymbols=o;let h={oriented:0,billboard:1},c={nodeMaterial:!1,textCount:1e3,lineLength:24,lineCount:2,charSize:new i.I9Y(.2,.3),textSize:1,textOffset:0,orientation:"billboard",textDefaults:{color:"#ff00ff",size:1}};class d{get textCount(){return this.metadata.textCount}get lineCount(){return this.metadata.lineCount}get lineLength(){return this.metadata.lineLength}get strideHeaderByteSize(){return this.metadata.strideHeaderByteSize}get strideByteSize(){return this.metadata.strideByteSize}get textureSize(){return new i.I9Y(this.metadata.textureWidth,this.metadata.textureHeight)}encode(){let t=JSON.stringify(this.metadata),e=new TextEncoder().encode(t),r=e.length,i=new Uint8Array(4);new DataView(i.buffer).setUint32(0,r,!0);let n=new Uint8Array(4+r+this.array.length);return n.set(i,0),n.set(e,4),n.set(this.array,4+r),n}static decode(t){let e=new DataView(t.buffer).getUint32(0,!0),r=t.slice(4,4+e),i=JSON.parse(new TextDecoder().decode(r)),n=new d(i.symbols,i.textCount,i.lineCount,i.lineLength),a=t.slice(4+e);return n.array.set(a),n}info(){return"data: ".concat(this.array.length," bytes, ").concat(this.textureSize.x,"x").concat(this.textureSize.y)}getTextAt(t){let{array:e}=this,{symbols:r,lineLength:i,strideByteSize:n,strideHeaderByteSize:a}=this.metadata,s=t*n,o=e[s+0],l=e[s+16],h=t=>t.toString(16).padStart(2,"0"),c="#".concat(h(e[s+4])).concat(h(e[s+4+1])).concat(h(e[s+4+2])),d=e[s+4+3],u="#".concat(h(e[s+8])).concat(h(e[s+8+1])).concat(h(e[s+8+2])),p=e[s+8+3],f=[];for(let t=0;t<o;t++){let n=s+a+t*i,o=[];for(let t=0;t<l;t++){let i=r[e[n+t]];o.push(i)}f.push(o.join(""))}return{text:f.join("\n"),textColor:c,textOpacity:d,backgroundColor:u,backgroundOpacity:p,currentLineCount:o,currentLineLength:l}}setSizeAt(t,e){let{array:r}=this,{strideByteSize:i}=this.metadata;return new DataView(r.buffer).setFloat32(t*i+12,e),this}setColorAt(t,e){let{color:r,opacity:i,textColor:n=r,textOpacity:o=i,backgroundColor:l=n,backgroundOpacity:h=+(null!=i?!!i:!!e.backgroundColor)}=e,{array:c}=this,{strideByteSize:d}=this.metadata;{let e=t*d+4;if(void 0!==n){let{r:t,g:r,b:i}=(0,a._)(n);c[e+0]=255*t,c[e+1]=255*r,c[e+2]=255*i}void 0!==o&&(c[e+3]=(0,s.toff)(o))}{let e=t*d+8;if(void 0!==l){let{r:t,g:r,b:i}=(0,a._)(l);c[e+0]=255*t,c[e+1]=255*r,c[e+2]=255*i}void 0!==h&&(c[e+3]=(0,s.toff)(h))}return this.texture.needsUpdate=!0,this}setTextAt(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{trim:i=!1,size:n=1,...a}=r;this.setColorAt(t,a),this.setSizeAt(t,n);let{array:s}=this,{symbols:o,lineCount:l,lineLength:h,strideByteSize:c,strideHeaderByteSize:d}=this.metadata,u=(i?e.trim():e).split("\n");u.length>l&&(console.warn("TextHelper: Text has more lines than ".concat(l,", truncating.")),u=u.slice(0,l)),u=u.map(t=>(i&&(t=t.trim()),t.length>h)?(console.warn("TextHelper: Line length is greater than ".concat(h," characters, clamping.")),t.slice(0,h)):t),s[t*c+0]=u.length;let p=t*c,f=u.length;for(let t=0;t<l;t++){let e=0;t<f&&(s[p+16+4*t]=u[t].length,e=u[t].length);let r=p+d+t*h;for(let i=0;i<h;i++){let n=r+i;if(t>=f||i>=e)s[n]=0;else{let e=o.indexOf(u[t].charAt(i));s[n]=-1===e?0:e}}}this.texture.needsUpdate=!0}constructor(t,e,r,n,{defaultColor:o="#ffffff",defaultTextOpacity:l=1,defaultBackgroundOpacity:h=0}={}){let c=16+4*r,d=c+4*Math.ceil(r*n/4),u=Math.ceil((c+e*d)/4),p=(0,s.ceilPowerOfTwo)(Math.sqrt(u)),f=Math.ceil(u/p);this.metadata={symbols:t,textCount:e,lineCount:r,lineLength:n,strideHeaderByteSize:c,strideByteSize:d,textureWidth:p,textureHeight:f};let g=new Uint8Array(p*f*4),{r:y,g:m,b:v}=(0,a._)(o);for(let t=0;t<e;t++){let e=t*d;g[(e+=4)+0]=255*y,g[e+1]=255*m,g[e+2]=255*v,g[e+3]=255*l,g[(e+=4)+0]=255*y,g[e+1]=255*m,g[e+2]=255*v,g[e+3]=255*h}this.array=g,this.texture=new i.GYF(g,p,f,i.GWd,i.OUM),this.texture.needsUpdate=!0}}var u=r(17953),p=r(81074),f=r(60041);let g=0;class y extends i.ZLX{applyTransform(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let a=(0,n.GD)(e),s=new i.kn4,o=this.instanceMatrix.array.length;for(let t=0;t<o;t+=16)s.fromArray(this.instanceMatrix.array,t).multiply(a).toArray(this.instanceMatrix.array,t);return this}addTo(t){return t?t.add(this):this.removeFromParent(),this}onTop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return 0!==t?(this.renderOrder=t,this.material.depthTest=!1,this.material.depthWrite=!1,this.material.transparent=!0):(this.renderOrder=0,this.material.depthTest=!0,this.material.depthWrite=!0,this.material.transparent=!1),this}setData(t){return this.data=t,this}clearAllText(){return this.instanceMatrix.array.fill(0),this.instanceMatrix.needsUpdate=!0,this}setTextAt(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.data.setTextAt(t,e,{...this.options.textDefaults,...r}),this.setMatrixAt(t,(0,a.w)(r)),this.instanceMatrix.needsUpdate=!0,this}setColorAt(t,e){this.data.setColorAt(t,{color:e})}setTextColorAt(t,e){return this.data.setColorAt(t,e),this}getDataStringView(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return function(t,e,r,i,n){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:3,o=Array.from({length:e.length/4},(t,r)=>{let i=4*r,n=e[i+0],a=e[i+1];return[n,a,e[i+2],e[i+3]]}).slice(a*r/4,s*r/4),l=[];l.push("\nData texture array (".concat(e.length," bytes):")),l.push("\ndataStride: ".concat(r," (").concat(r/4," x 4 bytes)"));let h=4+i;for(let e=0;e<o.length;e++){let a=e%(r/4);0===a&&(l.push("\npack #".concat(e/(r/4))),l.push("info:")),4===a&&l.push("lines (".concat(i,"):")),a===h&&l.push("chars (".concat(n,"):"));let[s,c,d,u]=o[e],p="".concat(e.toString().padEnd(3)," - ").concat((4*e).toString().padEnd(4),":   ").concat(s.toString().padStart(3),", ").concat(c.toString().padStart(3),", ").concat(d.toString().padStart(3),", ").concat(u.toString().padStart(3));a>=h&&(p+="     ".concat(t.symbols[s]).concat(t.symbols[c]).concat(t.symbols[d]).concat(t.symbols[u])),l.push("  "+p)}return l.join("\n")}(this.atlas,this.data.array,this.data.strideByteSize,this.options.lineCount,this.options.lineLength,t,e)}constructor(t){let e={...c,...t},r=new l,a=new d(r.symbols,e.textCount,e.lineCount,e.lineLength),s=function(t,e,r){let a={...c,...t},s=new i.I9Y(a.textSize*a.lineLength*a.charSize.x,a.textSize*a.lineCount*a.charSize.y);return{uCameraMatrix:{value:new i.kn4},uOrientation:{value:function(t){if("string"==typeof t){if(t in h)return h[t];throw Error("Invalid orientation: ".concat(t))}if(Object.values(h).includes(t))return t;throw Error("Invalid orientation: ".concat(t))}(a.orientation)},uTextOffset:{value:(0,n.wX)(a.textOffset)},uPlaneSize:{value:s},uCharSize:{value:a.charSize},uLineLength:{value:a.lineLength},uLineCount:{value:a.lineCount},uAtlasCharGrid:{value:r.charGrid},uDataStrideHeader:{value:e.strideHeaderByteSize},uDataStride:{value:e.strideByteSize/4},uDataTexture:{value:e.texture},uDataTextureSize:{value:e.textureSize},uBoxBorderWidth:{value:0}}}(e,a,r),o=s.uPlaneSize.value;super(new i.bdM(o.width,o.height),e.nodeMaterial?function(t,e){let r=new p.P8l;r.name="TextHelperMaterial",r.transparent=!0,r.alphaTest=.5,r.side=i.$EB,console.warn("TextHelperMaterial is not supported in WebGPU yet, do not expect it to work.");let n=(0,u.PiW)(t.uDataTextureSize.value).onFrameUpdate(()=>t.uDataTextureSize.value),a=(0,u.PiW)(t.uDataStride.value).onFrameUpdate(()=>t.uDataStride.value);function s(e,r){let i=n.x,s=(0,u.WQq)((0,u.lKK)(e,a),r),o=(0,u.y4m)(s,i),l=(0,u.jbE)(s,(0,u.lKK)(o,i));return(0,u.wHr)(t.uDataTexture.value,(0,u.ZcS)(l,o))}(0,u.PiW)(t.uDataStrideHeader.value).onFrameUpdate(()=>t.uDataStrideHeader.value),(0,u.PiW)(t.uAtlasCharGrid.value).onFrameUpdate(()=>t.uAtlasCharGrid.value);let o=s(u.cGD,0);(0,u.PCg)((0,u.lKK)(o.r,255)),(0,u.PCg)(s(u.cGD,1)),(0,u.PCg)(s(u.cGD,2)),(0,u.fVC)(1);let l=(0,u.PiW)(1).onRenderUpdate(()=>t.uOrientation.value);return r.positionNode=(0,u.Fn)(()=>{let t=(0,u.eR5)().toVar();return(0,u.If)(l.equal(0),()=>{t.assign(u.WVU)}).Else(()=>{t.assign((0,u.w00)(u.FLB).mul(u.WVU))}),t})(),r.colorNode=(0,u.yWT)("yellow"),r}(s,0):function(t,e){let r=new i.V9B({map:e.texture,transparent:!0,alphaTest:.5,side:i.$EB});return r.name="TextHelperMaterial",r.onBeforeCompile=e=>f.b.with(e).uniforms(t).varying({vInstanceId:"float",vTextColor:"vec4",vBackgroundColor:"vec4",vCurrentLineCount:"float"}).top("\n      vec4 getData4(int instanceId, int offset) {\n        int width = int(uDataTextureSize.x);\n        int index = instanceId * int(uDataStride) + offset;\n        int dataY = index / width;\n        int dataX = index - dataY * width;\n        return texelFetch(uDataTexture, ivec2(dataX, dataY), 0);\n      }\n      vec4 getData4(float instanceId, int offset) {\n        return getData4(int(instanceId), offset);\n      }\n        \n      vec2 getCharOffset(float instanceId, float charIndex) {\n        int p = int(uDataStrideHeader + charIndex);\n        int q = p / 4;\n        int r = p - q * 4; // p % 4;\n        vec4 charIndexes = getData4(instanceId, q);\n        float i = charIndexes[r] * 255.0;\n        float x = mod(i, uAtlasCharGrid.x);\n        float y = floor(i / uAtlasCharGrid.x);\n        return vec2(x, uAtlasCharGrid.y - y - 1.0) / uAtlasCharGrid;\n      }\n      vec2 getCharOffset(float instanceId, float line, float char) {\n        // return vec2(line * 82.0 + char, 0.0) / uAtlasCharGrid;\n        return getCharOffset(instanceId, line * uLineLength + char);\n      }\n    ").vertex.replace("project_vertex","\n      vec4 infoTexel = getData4(gl_InstanceID, 0);\n      vCurrentLineCount = infoTexel.r * 255.0;\n\n      vTextColor = getData4(gl_InstanceID, 1);\n      vBackgroundColor = getData4(gl_InstanceID, 2);\n\n      vec4 sizeBytes = getData4(gl_InstanceID, 3) * 255.0;\n      uint encoded =\n        uint(sizeBytes.x) << 24 |\n        uint(sizeBytes.y) << 16 |\n        uint(sizeBytes.z) << 8  |\n        uint(sizeBytes.w);\n      float size = uintBitsToFloat(encoded);\n\n      vec4 mvPosition = vec4(transformed * size, 1.0);\n\n      mat4 textMatrix = uOrientation < 0.5\n        ? modelMatrix * instanceMatrix\n        : mat4(\n          uCameraMatrix[0],\n          uCameraMatrix[1],\n          uCameraMatrix[2],\n          modelMatrix * vec4(instanceMatrix[3].xyz, 1.0));\n\n      mvPosition.xy += uTextOffset;\n\n      mvPosition = viewMatrix * textMatrix * mvPosition;\n\n      gl_Position = projectionMatrix * mvPosition;\n\n      vInstanceId = float(gl_InstanceID);\n    ").fragment.top("\n      float sdBox(in vec2 p, in vec2 b) {\n        vec2 d = abs(p) - b;\n        return length(max(d, 0.0)) + min(max(d.x, d.y), 0.0);\n      }\n\n      vec4 getCharColor() {\n        vec2 uv = vMapUv * vec2(uLineLength, uLineCount);\n\n        uv.y += (uLineCount - vCurrentLineCount) * 0.5;\n        float lineIndex = floor((uLineCount - uv.y));\n\n        if (lineIndex < 0.0 || lineIndex >= vCurrentLineCount)\n          discard;\n\n        float currentLineLength = getData4(vInstanceId, 4 + int(lineIndex)).r * 255.0;\n        // vec2 ddx = dFdx(uv);\n        // vec2 ddy = dFdy(uv);\n        uv.x += (uLineLength - currentLineLength) * -0.5;\n        float charIndex = floor(uv.x);\n\n        if (charIndex < 0.0 || charIndex >= currentLineLength)\n          discard;\n\n        uv = fract(uv);\n        // diffuseColor = vec4(uv, 1.0, 1.0);\n        uv /= uAtlasCharGrid;\n\n        uv += getCharOffset(vInstanceId, lineIndex, charIndex);\n        // float lod = log2(max(length(dFdx(vMapUv)), length(dFdy(vMapUv))));\n        vec4 charColor = textureLod(map, uv, 0.0);\n        // Use textureGrad for better quality, when the square texture will be used\n        // vec4 sampledDiffuseColor = textureGrad(map, uv, ddx, ddy);\n        float char = charColor.r;\n        \n        return vec4(\n          mix(vBackgroundColor.rgb, vTextColor.rgb, charColor.r),\n          mix(vBackgroundColor.a, vTextColor.a, charColor.r));\n      }\n\n      vec4 getCharColorWithBorder() {\n        if (uBoxBorderWidth > 0.0) {\n          vec2 p = (vMapUv - 0.5) * uPlaneSize;\n          float d = sdBox(p, uPlaneSize * 0.5) + uBoxBorderWidth;\n          if (d > 0.0) {\n            return vTextColor;\n          }\n        }\n        return getCharColor();\n      }\n    ").fragment.replace("map_fragment","\n      diffuseColor = getCharColorWithBorder();\n    "),r}(s,r),e.textCount),this.textHelperId=g++,this.onBeforeRender=(t,e,r,i,n,a)=>{s.uCameraMatrix.value.copy(r.matrixWorld)},this.frustumCulled=!1,this.layers,this.options=e,this.atlas=r,this.data=a,this.derived={planeSize:o}}}y.defaultOptions=c,y.Atlas=l,y.Data=d}}]);