"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4266],{4266:(t,e,s)=>{s.d(e,{O0:()=>i,XW:()=>L});var i,n=s(49797),r=s(99613),o=s(50373),a=s(64416),l=s(27491),h=s(27146),c=s(71591),d=s(28334);function u(t){return t.isRenderPass}!function(t){t[t.Render=0]="Render",t[t.PostProcessing=1e3]="PostProcessing",t[t.GizmoRender=2e3]="GizmoRender",t[t.Outline=3e3]="Outline",t[t.Output=4e3]="Output",t[t.Antialiasing=5e3]="Antialiasing"}(i||(i={}));class p{get passes(){return this.composer.passes}sortPasses(){let t=[...this.passMap];for(let[e]of t)this.composer.removePass(e);for(let[e]of(t.sort((t,e)=>{let s=t[1],i=e[1];return s.type!==i.type?s.type-i.type:s.insertOrder-i.insertOrder}),t))this.composer.addPass(e);return this}*getPassesByType(t){for(let[e,s]of this.passMap)s.type===t&&(yield[e,s])}addPass(t){let{type:e=i.Render,insertOrder:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===s){var n,r,o;s=(null!=(o=null==(r=[...this.getPassesByType(e)].at(-1))||null==(n=r[1])?void 0:n.insertOrder)?o:-1)+1}return this.passMap.set(t,{type:e,insertOrder:s}),this.sortPasses(),{destroy:()=>this.removePass(t)}}removePass(t){return this.passMap.has(t)?(this.passMap.delete(t),this.composer.removePass(t),!0):(console.warn("The pass is not in the pipeline."),!1)}setSize(t,e,s){this.composer.setSize(t,e),this.composer.setPixelRatio(s),this.basicPasses.fxaa.uniforms.resolution.value.set(1/s/t,1/s/e),this.basicPasses.smaa.setSize(t*s,e*s)}setScene(t){let e=this.basicPasses.mainRender.scene;for(let s of this.composer.passes)u(s)&&s.scene===e&&(s.scene=t)}render(t){for(let e of this.composer.passes)u(e)&&e.scene.traverseVisible(e=>{"onTick"in e&&e.onTick(t)});this.composer.render(t.deltaTime)}getPassesInfo(){let t=["".concat(this.constructor.name," passes info:")],{composer:e,passMap:s}=this;for(let[n,r]of e.passes.entries()){let e=s.get(r);e?t.push("- ".concat(n,": ").concat(i[e.type]," (insertOrder: ").concat(e.insertOrder,") ").concat(r.constructor.name)):t.push("- ".concat(n,": NO METADATA for ").concat(r.constructor.name))}return t.join("\n")}constructor(t,e,s,u){let p=new r.s(t),b=new Map,f=new l.A(e,u);f.clearAlpha=0,b.set(f,{type:i.Render,insertOrder:0}),p.addPass(f);let w=new l.A(s,u);b.set(w,{type:i.GizmoRender,insertOrder:0}),w.clear=!1,w.clearDepth=!1,p.addPass(w);let g=new o.G(new n.I9Y,e,u);b.set(g,{type:i.GizmoRender,insertOrder:0}),p.addPass(g);let m=new a.X;b.set(m,{type:i.Output,insertOrder:0}),p.addPass(m);let v=new h.p(d.o);b.set(v,{type:i.Antialiasing,insertOrder:0}),p.addPass(v);let y=new c.I;y.enabled=!1,b.set(y,{type:i.Antialiasing,insertOrder:0}),p.addPass(y),this.composer=p,this.basicPasses={mainRender:f,gizmoRender:w,outline:g,output:m,fxaa:v,smaa:y},this.passMap=b}}var b=s(30158),f=s(17223),w=s(57165),g=s(39787),m=s(36508),v=s(96273),y=s(17475),P=s(43340),x=s(31484);class L{static current(){return this.instances[this.instances.length-1]}get aspect(){return this.width/this.height}get size(){return this.internal.size.set(this.width,this.height)}get fullSize(){return this.internal.fullSize.set(this.width*this.pixelRatio,this.height*this.pixelRatio)}setScene(t){this.scene=t}useOrbitControls(){var t,e;let{position:s=null,target:i=null,element:n=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"string"==typeof n&&(n=document.querySelector(n)),null!=(t=this.internal).orbitControls||(t.orbitControls=new f.N(this.camera,n)),n&&n!==this.internal.orbitControls.domElement&&(this.internal.orbitControls.dispose(),this.internal.orbitControls=new f.N(this.camera,n)),s&&(0,v.jj)(s,this.internal.orbitControls.object.position),i&&(0,v.jj)(i,this.internal.orbitControls.target),this.internal.orbitControls.update(),this.internal.orbitControls}initialize(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(this.initialized)return console.warn("ThreeWebGLContext is already initialized."),this;Object.defineProperty(this,"initialized",{value:!0,writable:!1,configurable:!1,enumerable:!1});let{onDestroy:s}=this,{domElement:i}=this.renderer;t.appendChild(i);let n=()=>{this.setSize({width:t.clientWidth,height:t.clientHeight,pixelRatio:window.devicePixelRatio})},r=new ResizeObserver(n);return r.observe(t),s(()=>{r.disconnect()}),n(),s(this.pointer.initialize(i,e,this.camera,this.ticker)),s((0,w.O)(this.ticker.requestActivation),this.ticker.onTick(this.renderFrame)),s(()=>{var t;null==(t=this.internal.orbitControls)||t.dispose()}),this.domContainer=t,this.domElement=i,this}setSize(t){let{width:e,height:s,pixelRatio:i}={...this,...t};if(e===this.width&&s===this.height&&i===this.pixelRatio)return this;this.width=e,this.height=s,this.pixelRatio=i;let{renderer:n,perspectiveCamera:r,pipeline:o}=this;return n.setSize(e,s),n.setPixelRatio(i),o.setSize(e,s,i),r.aspect=e/s,r.updateProjectionMatrix(),this}*findAll(t){let e="string"==typeof t?e=>e.name===t:t instanceof RegExp?e=>t.test(e.name):t,s=[this.scene];for(;s.length>0;){let t=s.shift();e(t)&&(yield t),s.push(...t.children)}}find(t){for(let e of this.findAll(t))return e;return null}isPartOfScene(t){let e=t;for(;e;){if(e===this.scene)return!0;e=e.parent}return!1}constructor(){this.type=x.s.WebGL,this.width=300,this.height=150,this.pixelRatio=1,this.renderer=new b.WebGLRenderer,this.perspectiveCamera=new n.ubm,this.orhtographicCamera=new n.ubm,this.scene=new n.Z58,this.gizmoScene=new n.Z58,this.pointer=new P.g,this.skipRender=!1,this.ticker=m.Rv.get("three").set({minActiveDuration:8}),this.pipeline=new p(this.renderer,this.scene,this.gizmoScene,this.perspectiveCamera),this.camera=this.perspectiveCamera,this.internal={size:new n.I9Y,fullSize:new n.I9Y,destroyables:[],orbitControls:null},this.onTick=this.ticker.onTick.bind(this.ticker),this.onDestroy=this.internal.destroyables.push.bind(this.internal.destroyables),this.loader=y.o.get("three"),this.initialized=!1,this.destroyed=!1,this.destroy=()=>{if(this.destroyed)return void console.warn("ThreeWebGLContext is already destroyed.");Object.defineProperty(this,"destroyed",{value:!0,writable:!1,configurable:!1,enumerable:!1}),(0,g.z)(this.internal.destroyables),this.internal.destroyables=[],this.renderer.dispose()},this.renderFrame=t=>{var e;let{scene:s,pipeline:i,pointer:n}=this;null==(e=this.internal.orbitControls)||e.update(t.deltaTime),n.update(s),s.traverse(t=>{"onTick"in t&&t.onTick(this.ticker,this)}),!1===this.skipRender&&i.render(t),n.updateEnd()},this.camera.position.set(0,1,10),this.camera.lookAt(0,0,0),L.instances.push(this)}}L.instances=[]},17475:(t,e,s)=>{s.d(e,{o:()=>d});var i=s(49797),n=s(9954),r=s(17775),o=s(5832);function a(t){let e,s,i=new Promise((i,n)=>{e=()=>{i(t)},s=t=>{n(t)}});return Object.assign(t,{then:i.then.bind(i),catch:i.catch.bind(i),finally:i.finally.bind(i),resolve:e,reject:s}),t}let l=["gltf","glb"],h=["png","jpg","jpeg","hdr","exr"];class c{add(t){return this.listeners.add(t),{destroy:()=>this.listeners.delete(t)}}call(){for(var t=arguments.length,e=Array(t),s=0;s<t;s++)e[s]=arguments[s];for(let t of this.listeners)t.apply(null,e)}constructor(){this.listeners=new Set}}class d{static current(){var t;return null!=(t=this.instances[this.instances.length-1])?t:new d}static get(t){var e;return null!=(e=this.instances.find(e=>e.name===t))?e:new d({name:t})}setPath(t){this.path=t}onAfterLoad(t){return this._onAfterLoad.add(t)}async loadGltf(t){return new Promise((e,s)=>{this.loaders.gltf.load(t,t=>{e(t),this._onAfterLoad.call()},void 0,s)})}async loadRgbe(t){let e=a(this.loaders.rgbeLoader.load(t,t=>{e.resolve(),this._onAfterLoad.call()},void 0,()=>{console.log("Failed to load RGBE: ".concat(t))}));return e}async loadExr(t){let e=a(this.loaders.exrLoader.load(t,t=>{e.resolve(),this._onAfterLoad.call()},void 0,()=>{console.log("Failed to load EXR: ".concat(t))}));return e}loadTexture(t,e){let s=new URL(this.path+t,window.location.href).href;if(this.textureCache.has(s)){let t=this.textureCache.get(s);return null==e||e(t),t}let i=a(this.loaders.texture.load(s,t=>{this.textureCache.set(s,i),null==e||e(t),i.resolve(),this._onAfterLoad.call()},void 0,()=>{console.log("Failed to load texture: ".concat(s))}));return i}async load(t){let e=t.split(".").pop();if(l.includes(e))return this.loadGltf(t);if(h.includes(e))return new Promise((e,s)=>{this.loaders.texture.load(t,t=>{e(t),this._onAfterLoad.call()},void 0,s)});throw Error("Unsupported extension: ".concat(e))}constructor({name:t}={}){this.id=d.nextId++,this.loaders={gltf:new r.B,texture:new i.Tap,rgbeLoader:new o.Y,exrLoader:new n.H},this.path="",this._onAfterLoad=new c,this.textureCache=new Map,this.name=null!=t?t:"UnifiedLoader-".concat(this.id),d.instances.push(this)}}d.nextId=0,d.instances=[]},31484:(t,e,s)=>{var i;s.d(e,{s:()=>i}),function(t){t.WebGL="webgl",t.WebGPU="webgpu"}(i||(i={}))},43340:(t,e,s)=>{s.d(e,{g:()=>d});var i,n=s(28535),r=s(76999),o=s(57368),a=s(49797),l=s(61567);!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"}(i||(i={}));class h{copy(t){return this.buttons=t.buttons,this.clientPosition.copy(t.clientPosition),this.screenPosition.copy(t.screenPosition),this}diff(t,e){return this.buttons=t.buttons^e.buttons,this.clientPosition.subVectors(t.clientPosition,e.clientPosition),this.screenPosition.subVectors(t.screenPosition,e.screenPosition),this}constructor(){this.buttons=0,this.clientPosition=new a.I9Y,this.screenPosition=new a.I9Y}}var c=new WeakMap;class d{get buttons(){return this.state.buttons}buttonDown(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.Left;return(this.state.buttons&1<<t)!=0}buttonDownOld(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.Left;return(this.stateOld.buttons&1<<t)!=0}buttonDownEnter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.Left;return this.buttonDown(t)&&!this.buttonDownOld(t)}buttonDownExit(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.Left;return!this.buttonDown(t)&&this.buttonDownOld(t)}buttonTap(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.Left,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.25;return!1!==this.buttonDownExit(t)&&this.upTimes.get(t)-this.downTimes.get(t)<e}get clientPosition(){return this.state.clientPosition}get screenPosition(){return this.state.screenPosition}get ray(){return this.raycaster.ray}intersectPlane(t){let{distance:e=1e3,out:s=(0,n._)(this,c).result.point}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{ray:i}=this.raycaster,{point:r,line:o,result:a,plane:l}=(0,n._)(this,c);if("string"==typeof t)switch(l.constant=0,t){case"X":l.normal.set(1,0,0);break;case"Y":l.normal.set(0,1,0);break;case"Z":l.normal.set(0,0,1)}else l.copy(t);return o.set(i.origin,r.copy(i.origin).addScaledVector(i.direction,e)),a.intersected=!!l.intersectLine(o,s),a}updatePosition(t,e,s){let{x:i,y:n}=e,r=(i-s.x)/s.width*2-1,o=-((n-s.y)/s.height*2)+1;this.camera=t,this.clientPosition.set(i,n),this.screenPosition.set(r,o),this.raycaster.setFromCamera(this.screenPosition,t)}raycastScene(t){let e=[];t.traverse(t=>{!0!==t.userData.ignorePointer&&(!1!==t.visible&&!0!==t.userData.helper||!0===t.userData.pointerArea)&&(0,l.uW)(t)&&this.raycaster.intersectObject(t,!1,e)}),e.sort((t,e)=>t.distance-e.distance);let[s]=e;if(s){var i,n;let t=null!=(n=s.object.userData.onPointerTap)?n:s.object.userData.pointerArea&&(null==(i=s.object.parent)?void 0:i.userData.onPointerTap);t&&this.buttonTap()&&t()}}update(t){this.diffState.diff(this.state,this.stateOld),this.raycastScene(t)}updateEnd(){this.stateOld.copy(this.state),this.event.reset()}initialize(t,e,s,i){let n=e=>{let i=t.getBoundingClientRect(),{clientX:n,clientY:r}=e;this.updatePosition(s,{x:n,y:r},i)},r=t=>{n(t)},o=t=>{n(t),this.state.buttons|=1<<t.button,this.downTimes.set(t.button,i.time)},a=t=>{this.state.buttons&=~(1<<t.button),this.upTimes.set(t.button,i.time)};return e.addEventListener("pointermove",r),e.addEventListener("pointerdown",o),e.addEventListener("pointerup",a),()=>{e.removeEventListener("pointermove",r),e.removeEventListener("pointerdown",o),e.removeEventListener("pointerup",a)}}constructor(){(0,r._)(this,c,{writable:!0,value:void 0}),this.state=new h,this.stateOld=new h,this.diffState=new h,this.downTimes=new Map,this.upTimes=new Map,this.event=new class{consume(){this.consumed=!0}reset(){this.consumed=!1}constructor(){this.consumed=!1}},this.camera=null,this.raycaster=new a.tBo,(0,o._)(this,c,{plane:new a.Zcv,point:new a.Pq0,line:new a.cZY,result:{intersected:!1,point:new a.Pq0}})}}}}]);